---
title: "Utilisation de Strava chez les coureurs amateurs"
subtitle: "*Quels impacts psychosociaux et quels impacts sur la pratique ?*"
author: "*Laura Costa - MASTER M1 STAPS UGA (ATDM)*"
date: "*Mars 2025*"
output:
  html_document:
    css: styles.css
    toc: TRUE #table des matières activée
    toc_depth: 4
    toc_float: TRUE
    highlight: "tango"
    code_download: FALSE
---

<style>
table {
  border-collapse: separate;
  border-spacing: 20px;
}
</style>



```{r library setup, include=FALSE}
### Librairies nécessaires
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE,fig.width=8, fig.height=6, dpi=80)
library(tidyverse)
library(readxl) # Lecture excel
library(glue) # Affichage variable dans texte
library(psy) # Alpha de Cronbach
library(vcd) # Calcul Khi² 
library(knitr) #Affichage kable 
library(ggpubr) # Anova et test t visualisation
library(purrr) # Optimisation code pour les fonctions
library(patchwork) # Affichage des graphiques côte à côté
library(corrplot) # corrélations

### Couleurs par défaut
default_fill_colors <- function() {
  scale_fill_manual(values = c("#FC4C02", "#4F4F4F"))
}
```

[![](UFRAPS.png){width=100}](https://staps.univ-grenoble-alpes.fr/)

# Présentation de l'étude

### Thématique
Strava est un réseau social créé en **2009** qui permet d'enregistrer et de partager ses activités sportives à un réseau d'abonnés. Strava regroupe plus de **135 millions d'utilisateurs en 2024** dans plus de 190 pays ^1^. 40 millions d'activités sont téléchargées chaque semaine. En 2023, la course à pied est le sport où le plus d'activités sont téléchargées^2^. Le réseau social propose différentes fonctionnalités : enregistrement des activités, suivi des progrès, encouragements(kudos), partage des activités, clubs... Le réseau social a également un important aspect de gamification avec les segments, les KOM/QOM, les Local Legends... En tant que réseau social dédié aux sportifs, et notamment aux coureurs amateurs, Strava permet aux utilisateurs d'entrer en interaction et de se comparer aux autres utilisateurs. Dans la communauté des utilisateurs se développe alors cette phrase, reprise par Strava ^1^ ("Strava or it didn't happen) : 

> *" Si ce n'est pas sur Strava, ça n'existe pas."*

Le but de l'étude est de savoir si **l'utilisation de Strava a des impacts psychosociaux chez les coureurs amateurs et si elle a une influence sur la pratique (kilomètres parcourus par semaine, nombre d'entraînements par semaine, nombre de compétitions par an).**

### Problématique
L'étude de Russell (2023) ^3^ met en avant les implications psychosociales de l'utilisation de Strava auprès de coureurs de clubs universitaires à travers les Etats-Unis. Des entretiens semi-structurés ont permis de mettre en avant trois thèmes principaux : **la présentation de soi, la pression sociale et la motivation**. 

L'étude présente réalisée dans le cadre de mon master STAPS s'intéresse à l'impact de l'utilisation de Strava sur les coureurs amateurs : elle s'adresse à un public plus large que l'étude de Russell (coureurs amateurs utilisateurs de Strava) et se fonde sur un questionnaire de 84 questions obligatoires. Cette étude cherche à quantifier l'utilisation de Strava, à caractériser la manière de se présenter sur Strava, à identifier si Strava est une source de motivation et/ou de stress et à identifier si l'utilisation de Strava impacte la pratique.

Ainsi, la problématique de l'étude présente est la suivante : 

**Quels sont les impacts psychosociaux de l'utilisation de Strava chez les coureurs amateurs et dans quelle mesure l'utilisation de ce réseau social a des impacts sur la pratique de la course à pied ? **

Cette étude porte sur plusieurs questions de recherche :

- L'utilisation de Strava impacte-t-elle la pratique des coureurs amateurs ? 
- Comment les coureurs amateurs se présentent-ils sur Strava ? 
- Est-ce que l'utilisation de Strava peut être une source de stress ?
- Est-ce que l'utilisation de Strava peut être une source de motivation ?

### Hypothèses
**Hypothèse 1**
Plus les coureurs amateurs utilisent Strava, plus le nombre de kilomètres et d’entraînements par semaine, et le nombre de compétitions par an sont élevés.

**Hypothèse 2 : **
Plus les coureurs amateurs utilisent Strava, plus ils sont susceptibles de filtrer ou modifier ce qu’ils partagent pour contrôler leur image.

**Hypothèse 3 :**
Plus les coureurs amateurs utilisent Strava, plus ils sont susceptibles de ressentir du stress.

**Hypothèse 4 : **
Plus les coureurs amateurs utilisent Strava, plus ils sont motivés dans leur pratique.

### Méthode
Le questionnaire a été construit suite à la lecture de différents articles, notamment l'étude de Russell (2023)^3^ qui s'intéresse aux implications psychosociales de l'utilisation de Strava chez des coureurs universitaires aux Etats-Unis, l'étude d'Evans (2019)^4^ qui s'intéresse aux sources de motivation chez les coureurs et la thèse de Chapman (2024)^5^ qui examine l'impact de l'utilisation de Strava et de la comparaison sociale sur le bien-être, l'épuisement sportif et le plaisir du sport chez de jeunes coureurs non-élites. L'étude d'Evans se base sur un questionnaire en ligne auprès de 25 000 coureurs de 7 pays, l'étude de Chapman se base sur un questionnaire en ligne également diffusé auprès de 200 coureurs et l'étude de Russell se base sur des entretiens semi-structurés auprès de 18 coureurs.

En partant de ces 3 articles, d'autres articles sont venus compléter la création du questionnaire afin d'avoir des échelles psychométriques pour mesurer la présentation de soi, la pression sociale et la motivation^6^^7^.

Le questionnaire a été construit de sorte d'avoir moins de 100 questions et une durée de passation de moins de 10 minutes afin de ne pas décourager les répondants et d'éviter que les réponses aux dernières questions soient faussées car les répondants répondent sans réfléchir pour terminer au plus vite.

Le questionnaire a été validée par notre enseignante à l'UGA avant diffusion. Le questionnaire comportait 84 questions : toutes les questions étaient obligatoires, sauf les questions comportant la mention "si oui". La durée de passation était estimée à 10 minutes. Les critères d'inclusion étaient d'être un **coureur amateur utilisateur de Strava et avoir plus de 18 ans**. Le questionnaire était totalement **anonyme**. 

Le questionnaire a été diffusé sur les réseaux sociaux : mon compte personnel LinkedIn, mon compte personnel Strava et dans les groupes Facebook "Bref, je fais du trail", "Coeur de runneuses", et "Courir après 50 ans". Le questionnaire a également été diffusé auprès de 2 clubs de course à pied : ACP Crolles et AL Echirolles. Le questionnaire a été ouvert du **28 janvier au 12 février 2025**.

Les données ont été récupérées sous Excel, pour faire un premier traitement (suppression des valeurs non exploitables et formatage de certaines valeurs (exemple : ancienneté pratique : "10 ans" > "10")). Les analyses ont été réalisées avec R (avec les librairies tidyverse, vcd et psy) Dans la base de données, chaque ligne représente un coureur et chaque colonne une variable.

Les mesures réalisées sont les suivantes :
- Données socio-démographiques : âge, sexe, catégorie socio-professionnelle
- Données d'utilisation de Strava : 
  - Intensité d'utilisation de Strava : Facebook Intensity Scale > Strava Intensity Scale (Elison, 2007^8^ et Ross, 2009^9^)
  - Utilisation des fonctions de sociabilité en ligne : Online Sociability Functions (Ross, 2019^9^)
  - Exposition des informations personnelles : Facebook Scale > Strava Scale (Ross, 2019^9^)
  - Compléments : but d'utilisation de Strava, fonctionnalité la plus appréciée...
- Quantification de la pratique : ancienneté, niveau, nombre de kilomètres et d'entraînements par semaine, nombre de compétitions par an, lieu et mode de pratique... 
- Mesure de l'auto-présentation sur Strava : Self-presentation and Upward Social Comparison Inclination Scale (Hjetland, 2022^10^ et Hjetland, 2024^17^)
- Mesure du stress perçu par l'utilisation de l'application : Perceived Stress Scale (Chiu, 2016^11^)
- Mesure de la motivation à courir : Behavioural Regulation In Exercise Questionnaire 3-12 items (Rocchi, 2023^12^)


```{r import donnees}
data<- read_excel("C:/Users/laura/Documents/UGA M1 STAPS ATDM/SHS/Résultats Strava/Utilisation de Strava chez les coureurs amateurs (réponses).xlsx", sheet="Traitement")
colnames(data)[colnames(data) == "Type_abonnement"] <- "Catégorie_abonnement"
```


```{r opérations sur les donnees}
data$Age<- as.numeric(as.character(data$Age))
data <- data %>% mutate(age_category = case_when(
    Age < 20 ~  "Moins de 20 ans",
    Age >=20 & Age <25 ~  "20-24 ans",
    Age >=25 & Age <30 ~  "25-29 ans",
    Age >=30 & Age <35 ~  "30-34 ans",
    Age >=35 & Age <40 ~  "35-39 ans",
    Age >=40 & Age <45 ~  "40-44 ans",
    Age >=45 & Age <50 ~  "45-49 ans",
    Age >=50 & Age <55 ~  "50-54 ans",
    Age >=55 & Age <60 ~  "55-59 ans",
    Age >=60 & Age <65 ~  "60-64 ans",
    Age >=65 & Age <70 ~  "65-69 ans",
    Age >=70 & Age <75 ~  "70-74 ans",
    Age >=75 ~  "75 ans et plus"
  ))

data$Ancienneté_pratique<- as.numeric(as.character(data$Ancienneté_pratique))
data <- data %>% mutate(anciennetecap_category = case_when(
    Ancienneté_pratique < 5 ~  " Moins de 5 ans",
    Ancienneté_pratique >=5 & Ancienneté_pratique <10 ~  "5-9 ans",
    Ancienneté_pratique >=10 & Ancienneté_pratique <15 ~  "10-14 ans",
    Ancienneté_pratique >=15 & Ancienneté_pratique <20 ~  "15-19 ans",
    Ancienneté_pratique >=20 & Ancienneté_pratique <25 ~  "20-24 ans",
    Ancienneté_pratique >=25 & Ancienneté_pratique <30 ~  "25-29 ans",
    Ancienneté_pratique >=30 & Ancienneté_pratique <35 ~  "30-34 ans",
    Ancienneté_pratique >=35 & Ancienneté_pratique <40 ~  "35-39 ans",
    Ancienneté_pratique >=40 & Ancienneté_pratique <45 ~  "40-44 ans",
    Ancienneté_pratique>=45 ~  "45 ans et plus"
  ))

data$Frequence_pratique<- as.numeric(as.character(data$Frequence_pratique))
data <- data %>% mutate(freqentrainement_category = case_when(
    Frequence_pratique < 2 ~  "1/semaine",
    Frequence_pratique >=2 & Frequence_pratique <3 ~  "2/semaine",
    Frequence_pratique >=3 & Frequence_pratique <4 ~  "3/semaine",
    Frequence_pratique >=4 & Frequence_pratique <5 ~  "4/semaine",
    Frequence_pratique >=5 & Frequence_pratique <6 ~  "5/semaine",
    Frequence_pratique >=6 & Frequence_pratique <7 ~  "6/semaine",
    Frequence_pratique >=7 & Frequence_pratique <8 ~  "7/semaine",
    Frequence_pratique >=8 & Frequence_pratique <9 ~  "8/semaine",
    Frequence_pratique >=9 ~  "9/semaine et plus"
  ))

data$Kilomètres<- as.numeric(as.character(data$Kilomètres))
data <- data %>% mutate(kmentrainement_category = case_when(
    Kilomètres < 15 ~  "Moins de 15 km /semaine",
    Kilomètres >=15 & Kilomètres <30 ~  "15 à 29 km/semaine",
    Kilomètres >=30 & Kilomètres <45 ~  "30 à 44 km/semaine",
    Kilomètres >=45 & Kilomètres <60 ~  "45 à 59 km/semaine",
    Kilomètres >=60 & Kilomètres <75 ~  "60 à 74 km/semaine",
    Kilomètres >=75 & Kilomètres <90 ~  "75 à 89 km/semaine",
    Kilomètres >=90 & Kilomètres <105 ~  "90 à 104 km/semaine",
    Kilomètres >=105 & Kilomètres <120 ~  "105 à 119 km/semaine",
    Kilomètres >=120 & Kilomètres <135 ~  "120 à 134 km/semaine",
    Kilomètres >=135 & Kilomètres <150 ~  "135 à 149 km/semaine",
    Kilomètres >=150 ~  "150 km/semaine et plus"
  ))

data <- data %>%
  mutate(
    kmentrainement_category = factor(kmentrainement_category, levels = c(
      "Moins de 15 km /semaine",
      "15 à 29 km/semaine",
      "30 à 44 km/semaine",
      "45 à 59 km/semaine",
      "60 à 74 km/semaine",
      "75 à 89 km/semaine",
      "90 à 104 km/semaine",
      "105 à 119 km/semaine",
      "120 à 134 km/semaine",
      "135 à 149 km/semaine",
      "150 km/semaine et plus"
    ))
  )


data$Compétitions<- as.numeric(as.character(data$Compétitions))
data <- data %>% mutate(competitionnb_category = case_when(
    Compétitions < 3 ~  "Moins de 3 / an",
    Compétitions  >=3 & Compétitions <6 ~  "Entre 3 et 5 / an",
    Compétitions >=6 & Compétitions <9 ~  "Entre 6 et 8 / an",
    Compétitions >=9 & Compétitions <12 ~  "Entre 9 et 11 / an",
    Compétitions >=12 & Compétitions <15 ~  "Entre 12 et 14 / an",
    Compétitions >=15 & Compétitions <18 ~  "Entre 15 et 17 / an",
    Compétitions >=18 & Compétitions <21 ~  "Entre 18 et 20 / an",
    Compétitions >=21 & Compétitions <24 ~  "Entre 21 et 23 / an",
    Compétitions >=24 & Compétitions <27 ~  "Entre 24 et 26 / an",
    Compétitions >=27 & Compétitions <30 ~  "Entre 27 et 29 / an",
    Compétitions >=30 ~  "15 / an et plus"
  ))

data$Fréquence_publication<- as.numeric(as.character(data$Fréquence_publication))
data <- data %>% mutate(freqpubli_category = case_when(
    Fréquence_publication < 1 ~  "Moins de 1 / semaine",
    Fréquence_publication  >=1 & Fréquence_publication <2 ~  "1 / semaine",
    Fréquence_publication  >=2 & Fréquence_publication <3 ~  "2 / semaine",
    Fréquence_publication  >=3 & Fréquence_publication <4 ~  "3 / semaine",
    Fréquence_publication  >=4 & Fréquence_publication <5 ~  "4 / semaine",
    Fréquence_publication  >=5 & Fréquence_publication <6 ~  "5 / semaine",
    Fréquence_publication  >=6 & Fréquence_publication <7 ~  "6 / semaine",
    Fréquence_publication  >=7 & Fréquence_publication <8 ~  "7 / semaine",
    Fréquence_publication >=8 ~  "8 / semaine et plus"
  ))

data <- data %>% mutate(freqpubli_categorystat = case_when(
    Fréquence_publication < 1 ~  "1",
    Fréquence_publication  >=1 & Fréquence_publication <2 ~  "2",
    Fréquence_publication  >=2 & Fréquence_publication <3 ~  "3",
    Fréquence_publication  >=3 & Fréquence_publication <4 ~  "4",
    Fréquence_publication  >=4 & Fréquence_publication <5 ~  "5",
    Fréquence_publication  >=5 & Fréquence_publication <6 ~  "6",
    Fréquence_publication  >=6 & Fréquence_publication <7 ~  "7",
    Fréquence_publication  >=7 & Fréquence_publication <8 ~  "8",
    Fréquence_publication >=8 ~  "8"
  ))

data$Fréquence_consultation<- as.numeric(as.character(data$Fréquence_consultation))
data <- data %>% mutate(freqcons_category = case_when(
    Fréquence_consultation < 2 ~  "Moins de 2 / semaine",
    Fréquence_consultation  >=2 & Fréquence_consultation <4 ~  "Entre 2 et 3 / semaine",
    Fréquence_consultation  >=4 & Fréquence_consultation <6 ~  "Entre 4 et 5 / semaine",
    Fréquence_consultation  >=6 & Fréquence_consultation <8 ~  "Entre 6 et 7 / semaine",
    Fréquence_consultation  >=8 & Fréquence_consultation <10 ~  "Entre 8 et 9 / semaine",
    Fréquence_consultation  >=10 & Fréquence_consultation <12 ~  "Entre 10 et 11 / semaine",
    Fréquence_consultation >=12 ~  "12 / semaine et plus"
  ))

data <- data %>% mutate(freqcons_categorystat = case_when(
    Fréquence_consultation < 2 ~  "1",
    Fréquence_consultation  >=2 & Fréquence_consultation <4 ~  "2",
    Fréquence_consultation  >=4 & Fréquence_consultation <6 ~  "3",
    Fréquence_consultation  >=6 & Fréquence_consultation <8 ~  "4",
    Fréquence_consultation  >=8 & Fréquence_consultation <10 ~  "5",
    Fréquence_consultation  >=10 & Fréquence_consultation <12 ~  "6",
    Fréquence_consultation >=6 ~  "7"
  ))

data$Ancienneté_Strava<- as.numeric(as.character(data$Ancienneté_Strava))
data <- data %>% mutate(anciennetestrava_category = case_when(
    Ancienneté_Strava < 2 ~  "Moins de 2 ans",
    Ancienneté_Strava >=2 & Ancienneté_Strava <4 ~  "2-3 ans",
    Ancienneté_Strava >=4 & Ancienneté_Strava <6 ~  "4-5 ans",
    Ancienneté_Strava >=6 & Ancienneté_Strava <8 ~  "6-7 ans",
    Ancienneté_Strava >=8 & Ancienneté_Strava <10 ~  "8-9 ans",
    Ancienneté_Strava >=10 & Ancienneté_Strava <12 ~  "10-11 ans",
    Ancienneté_Strava >=12 & Ancienneté_Strava <14 ~  "12-13 ans",
    Ancienneté_Strava >=14 & Ancienneté_Strava <16 ~  "14-15 ans",
    Ancienneté_Strava>=16 ~  "16 ans et plus"
  ))

data$Nb_abonnés<- as.numeric(as.character(data$Nb_abonnés))
data<- data %>% mutate(nbabonnés_category = case_when(
    Nb_abonnés < 50 ~  "49 ou moins",
    Nb_abonnés >=50 & Nb_abonnés <100 ~  "Entre 50 et 99",
    Nb_abonnés >=100 & Nb_abonnés <150 ~  "Entre 100 et 149",
    Nb_abonnés >=150 & Nb_abonnés <200 ~  "Entre 150 et 199",
    Nb_abonnés >=200 & Nb_abonnés <250 ~  "Entre 200 et 249",
    Nb_abonnés >=250 & Nb_abonnés <300 ~  "Entre 250 et 299",
    Nb_abonnés >=300 & Nb_abonnés <350 ~  "Entre 300 et 349",
    Nb_abonnés >=350 & Nb_abonnés <400 ~  "Entre 350 et 399",
    Nb_abonnés >=400 & Nb_abonnés <450 ~  "Entre 400 et 449",
    Nb_abonnés >=450 & Nb_abonnés <500 ~  "Entre 450 et 499",
    Nb_abonnés >=500 & Nb_abonnés <550 ~  "Entre 500 et 549",
    Nb_abonnés >=550 & Nb_abonnés <600 ~  "Entre 550 et 599",
    Nb_abonnés >=600 & Nb_abonnés <650 ~  "Entre 600 et 649",
    Nb_abonnés >=650 & Nb_abonnés <700 ~  "Entre 650 et 699",
    Nb_abonnés >=700 & Nb_abonnés <750 ~  "Entre 700 et 749",
    Nb_abonnés >=750 & Nb_abonnés <800 ~  "Entre 749 et 799",
    Nb_abonnés >=800 & Nb_abonnés <850 ~  "Entre 800 et 849",
    Nb_abonnés >=850 ~  "850 et plus"
))
data<- data %>% mutate(nbabonnés_categorystat = case_when(
    Nb_abonnés < 50 ~  "49 ou moins",
    Nb_abonnés >=50 & Nb_abonnés <100 ~  "1",
    Nb_abonnés >=100 & Nb_abonnés <150 ~  "2",
    Nb_abonnés >=150 & Nb_abonnés <200 ~  "3",
    Nb_abonnés >=200 & Nb_abonnés <250 ~  "4",
    Nb_abonnés >=250 & Nb_abonnés <300 ~  "5",
    Nb_abonnés >=300 & Nb_abonnés <350 ~  "6",
    Nb_abonnés >=350 & Nb_abonnés <400 ~  "7",
    Nb_abonnés >=400 & Nb_abonnés <450 ~  "8",
    Nb_abonnés >=450 & Nb_abonnés <500 ~  "9",
    Nb_abonnés >=500 & Nb_abonnés <550 ~  "10",
    Nb_abonnés >=550 & Nb_abonnés <600 ~  "11",
    Nb_abonnés >=600 & Nb_abonnés <650 ~  "12",
    Nb_abonnés >=650 & Nb_abonnés <700 ~  "13",
    Nb_abonnés >=700 & Nb_abonnés <750 ~  "14",
    Nb_abonnés >=750 & Nb_abonnés <800 ~  "15",
    Nb_abonnés >=800 & Nb_abonnés <850 ~  "16",
    Nb_abonnés >=850 ~  "17"
))

data$Nb_abonnements<- as.numeric(as.character(data$Nb_abonnements))
data<- data %>% mutate(nbabonnement_category = case_when(
    Nb_abonnements < 50 ~  "49 ou moins ",
    Nb_abonnements >=50 & Nb_abonnements <100 ~  "Entre 50 et 99",
    Nb_abonnements >=100 & Nb_abonnements <150 ~  "Entre 100 et 149",
    Nb_abonnements >=150 & Nb_abonnements <200 ~  "Entre 150 et 199",
    Nb_abonnements >=200 & Nb_abonnements <250 ~  "Entre 200 et 249",
    Nb_abonnements >=250 & Nb_abonnements <300 ~  "Entre 250 et 299",
    Nb_abonnements >=300 & Nb_abonnements <350 ~  "Entre 300 et 349",
    Nb_abonnements >=350 & Nb_abonnements <400 ~  "Entre 450 et 299",
    Nb_abonnements >=400 & Nb_abonnements <450 ~  "Entre 400 et 449",
    Nb_abonnements >=450 & Nb_abonnements <500 ~  "Entre 450 et 499",
    Nb_abonnements >=500 & Nb_abonnements <550 ~  "Entre 500 et 549",
    Nb_abonnements >=550 & Nb_abonnements <600 ~  "Entre 550 et 599",
    Nb_abonnements >=600 & Nb_abonnements <650 ~  "Entre 600 et 649",
    Nb_abonnements >=650 & Nb_abonnements <700 ~  "Entre 650 et 699",
    Nb_abonnements >=700 ~ "700 et plus"
))

data<- data %>% mutate(nbabonnement_categorystat = case_when(
    Nb_abonnements < 50 ~  "1 ",
    Nb_abonnements >=50 & Nb_abonnements <100 ~  "2",
    Nb_abonnements >=100 & Nb_abonnements <150 ~  "3",
    Nb_abonnements >=150 & Nb_abonnements <200 ~  "4",
    Nb_abonnements >=200 & Nb_abonnements <250 ~  "5",
    Nb_abonnements >=250 & Nb_abonnements <300 ~  "6",
    Nb_abonnements >=300 & Nb_abonnements <350 ~  "7",
    Nb_abonnements >=350 & Nb_abonnements <400 ~  "8",
    Nb_abonnements >=400 & Nb_abonnements <450 ~  "9",
    Nb_abonnements >=450 & Nb_abonnements <500 ~  "10",
    Nb_abonnements >=500 & Nb_abonnements <550 ~  "11",
    Nb_abonnements >=550 & Nb_abonnements <600 ~  "12",
    Nb_abonnements >=600 & Nb_abonnements <650 ~  "13",
    Nb_abonnements >=650 & Nb_abonnements <700 ~  "14",
    Nb_abonnements >=700 ~ "15"
))

data$Club_Strava<- as.numeric(as.character(data$Club_Strava))
data <- data %>% mutate(clubstrava_category = case_when(
    Club_Strava < 5 ~  "Moins de 5",
    Club_Strava  >=5 & Club_Strava <9 ~  "Entre 5 et 9",
    Club_Strava  >=10 & Club_Strava <15 ~  "Entre 10 et 14",
    Club_Strava  >=15 & Club_Strava <20 ~  "Entre 15 et 19",
    Club_Strava  >=20 & Club_Strava <25 ~  "Entre 20 et 24",
    Club_Strava  >=25 & Club_Strava <30 ~  "Entre 25 et 29",
    Club_Strava  >=30 & Club_Strava <35 ~  "Entre 30 et 34",
    Club_Strava  >=35 & Club_Strava <40 ~  "Entre 35 et 39",
    Club_Strava  >=40 & Club_Strava <45 ~  "Entre 40 et 44",
    Club_Strava  >=45 & Club_Strava <50 ~  "Entre 45 et 49",
    Club_Strava  >=50 & Club_Strava <55 ~  "Entre 50 et 54",
    Club_Strava  >=55 & Club_Strava <60 ~  "Entre 55 et 59",
    Club_Strava >=60 ~  "60 ou plus"
  ))

data <- data %>% mutate(clubstrava_categorystat = case_when(
    Club_Strava < 5 ~  "1",
    Club_Strava  >=5 & Club_Strava <9 ~  "2",
    Club_Strava  >=10 & Club_Strava <15 ~  "3",
    Club_Strava  >=15 & Club_Strava <20 ~  "4",
    Club_Strava  >=20 & Club_Strava <25 ~  "5",
    Club_Strava  >=25 & Club_Strava <30 ~  "6",
    Club_Strava  >=30 & Club_Strava <35 ~  "7",
    Club_Strava  >=35 & Club_Strava <40 ~  "8",
    Club_Strava  >=40 & Club_Strava <45 ~  "9",
    Club_Strava  >=45 & Club_Strava <50 ~  "10",
    Club_Strava  >=50 & Club_Strava <55 ~  "11",
    Club_Strava  >=55 & Club_Strava <60 ~  "12",
    Club_Strava >=60 ~  "13"
  ))

data$Kudos_reçus<- as.numeric(as.character(data$Kudos_reçus))
data <- data %>% mutate(kudosreçus_category = case_when(
    Kudos_reçus < 10 ~  "Moins de 10",
    Kudos_reçus  >=10 & Kudos_reçus <20 ~  "Entre 10 et 19",
    Kudos_reçus  >=20 & Kudos_reçus <30 ~  "Entre 20 et 29",
    Kudos_reçus  >=30 & Kudos_reçus <40 ~  "Entre 30 et 39",
    Kudos_reçus  >=40 & Kudos_reçus <50 ~  "Entre 40 et 49",
    Kudos_reçus  >=50 & Kudos_reçus <60 ~  "Entre 50 et 59",
    Kudos_reçus  >=60 & Kudos_reçus <70 ~  "Entre 60 et 69",
    Kudos_reçus  >=70 & Kudos_reçus <80 ~  "Entre 70 et 79",
    Kudos_reçus  >=80 & Kudos_reçus <90 ~  "Entre 80 et 89",
    Kudos_reçus  >=90 & Kudos_reçus <100 ~  "Entre 90 et 99",
    Kudos_reçus >=100 ~  "100 ou plus"
  ))

data <- data %>% mutate(kudosreçus_categorystat = case_when(
 Kudos_reçus < 10 ~  "1",
    Kudos_reçus  >=10 & Kudos_reçus <20 ~  "2",
    Kudos_reçus  >=20 & Kudos_reçus <30 ~  "3",
    Kudos_reçus  >=30 & Kudos_reçus <40 ~  "4",
    Kudos_reçus  >=40 & Kudos_reçus <50 ~  "5",
    Kudos_reçus  >=50 & Kudos_reçus <60 ~  "6",
    Kudos_reçus  >=60 & Kudos_reçus <70 ~  "7",
    Kudos_reçus  >=70 & Kudos_reçus <80 ~  "8",
    Kudos_reçus  >=80 & Kudos_reçus <90 ~  "9",
    Kudos_reçus  >=90 & Kudos_reçus <100 ~  "10",
    Kudos_reçus >=100 ~  "11"
  ))


data$nbabonnement_categorystat <- as.numeric(as.character(data$nbabonnement_categorystat))
data$nbabonnés_categorystat <- as.numeric(as.character(data$nbabonnés_categorystat))
data$freqcons_categorystat <-as.numeric(as.character(data$freqcons_categorystat))
data$freqpubli_categorystat<- as.numeric(as.character(data$freqpubli_categorystat))
data$clubstrava_categorystat<- as.numeric(as.character(data$clubstrava_categorystat))
data$kudosreçus_categorystat<- as.numeric(as.character(data$kudosreçus_categorystat))

```

```{r définition des fonctions statistiques utiles}
# Fonction générique d'analyse t-test
analyse_t_test <- function(var_score, var_group, data, 
                             title_group = var_group, 
                             title_score = var_score, 
                             group_names = NULL) {
  # Réalisation du test t
  t_test <- t.test(as.numeric(data[[var_score]]) ~ as.factor(data[[var_group]]), 
                   data = data, var.equal = TRUE)
  
  # Calcul des moyennes par groupe
  moyennes <- data %>%
    group_by(.data[[var_group]]) %>%
    summarise(Moyenne = mean(.data[[var_score]], na.rm = TRUE), .groups = "drop")
  
  # Récupération des noms originaux des groupes
  orig_groups <- as.character(unique(data[[var_group]]))
  
  # Si group_names est fourni, on remplace les noms originaux par les labels souhaités
  if (!is.null(group_names)) {
    noms_groupes <- sapply(orig_groups, function(x) if(x %in% names(group_names)) group_names[[x]] else x)
  } else {
    noms_groupes <- orig_groups
  }
  
  # Création du titre personnalisé
  titre <- paste("Lien", title_group, "et", title_score)
  
  # Création du tableau de résultats
  table_result <- data.frame(
    Variables = titre,
    Student = round(as.numeric(t_test$statistic), 2),
    P_Value = as.numeric(t_test$p.value),
    Significatif = ifelse(t_test$p.value < 0.05, "<0.05", "≥ 0.05")
  )
  
  # Ajout dynamique des moyennes des groupes avec renommage
  valeurs_moyennes <- round(moyennes$Moyenne, 2)
  names(valeurs_moyennes) <- noms_groupes
  table_result <- cbind(table_result, as.data.frame(t(valeurs_moyennes)))
  
  return(table_result)
}

  # Fonction pour calculer la corrélation et la p-value
compute_correlations <- function(var, ref_var, data) {
  cor_test <- function(x, y) {
    test <- cor.test(x, y, use = "complete.obs")
    list(cor = round(test$estimate, 2), p_value = round(test$p.value, 4))
  }

  res_total <- cor_test(data[[var]], data[[ref_var]])

  # Création du tibble avec les corrélations et p-values
  result <- tibble(
    Variable = var,
    !!paste0("Corr_",ref_var) := res_total$cor,
    P_value = res_total$p_value,
    Significatif = ifelse(res_total$p_value < 0.05, "<0.05", "≥0.05") 
    )

  return(result)
}

# Fonction générique pour le test du Khi² et l'indice de Cramer
compute_chi2_cramer <- function(var1, var2, data) {
  chi2_test <- chisq.test(table(data[[var1]], data[[var2]]))
  cramer_test <- assocstats(table(data[[var1]], data[[var2]]))$cramer
  
  # Création d'une liste contenant les résultats
  list(
    stats = tibble(
      Variable = paste("Lien entre", var1, "et", var2),
      Khi2_Indépendance = round(chi2_test$statistic, 2),
      P_Value = chi2_test$p.value,
      Significatif = ifelse(chi2_test$p.value < 0.05, "<0.05", "≥ 0.05"),
      Coefficient_Cramer = round(cramer_test, 2)
    ),
    observed = chi2_test$observed,
    expected = chi2_test$expected
  )
}


# Fonction pour exécuter l'ANOVA et extraire F et p-value
compute_anova <- function(var, cat_var, data) {
  model <- aov(data[[var]] ~ as.factor(data[[cat_var]]), data = data)
  summary_res <- summary(model)[[1]]
  
  tibble(
    Variable = var,
    F_value = round(summary_res["F value"][1, 1], 2),
    P_value = summary_res["Pr(>F)"][1, 1],
    Significatif = ifelse(summary_res["Pr(>F)"][1, 1] < 0.05, "< 0.05", "≥ 0.05")
  )
}

# Fonction pour calculer les moyennes par catégorie
compute_means <- function(var, cat_var, data) {
  data %>%
    group_by(.data[[cat_var]]) %>%
    summarise(Moyenne = mean(.data[[var]], na.rm = TRUE), .groups = "drop") %>%
    pivot_wider(names_from = cat_var, values_from = Moyenne) %>%
    mutate(Variable = var) %>%
    select(Variable, everything())
}



# Fonction pour exécuter le test de Tukey et extraire les comparaisons significatives
compute_tukey <- function(var, cat_var, data) {
  model <- aov(data[[var]] ~ as.factor(data[[cat_var]]), data = data)
  tukey_res <- TukeyHSD(model)[[1]]
  
  as.data.frame(tukey_res) %>%
    rownames_to_column(var = "Comparison") %>%  # Ajoute les comparaisons en colonne
    mutate(Variable = var) %>%
    select(Variable, Comparison, diff, lwr, upr, `p adj`)
}

# Fonction pour tracer les régressions linéaires avec coefficient corrélation
plot_correlation<-function(x_var, y_var, data, variable_labels = NULL) {
    corr <- round(cor(data[[x_var]], data[[y_var]], use = "complete.obs"), 2)
    
    # Utilisation des labels s'ils existent, sinon on garde les noms d'origine
    x_label <- if (!is.null(variable_labels) && x_var %in% names(variable_labels)) variable_labels[[x_var]] else x_var
    y_label <- if (!is.null(variable_labels) && y_var %in% names(variable_labels)) variable_labels[[y_var]] else y_var
    
    p <- ggplot(data, aes(x = .data[[x_var]], y = .data[[y_var]])) +
        geom_point(color = "#FC4C02") +
        geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed") +  
        annotate("text", x = max(data[[x_var]], na.rm = TRUE), 
                 y = min(data[[y_var]], na.rm = TRUE), 
                 label = paste0("R = ", corr), 
                 hjust = 1, vjust = 0, size = 5) +
        labs(title = paste("Relation entre", x_label, "et", y_label),
             x = x_label,
             y = y_label) +
        theme_minimal()
    
    return(p)
}

# Fonction pour une matrice de corrélation
correlation_matrix <- function(data, variables, labels = NULL, method = "pearson", plot = TRUE, kable_output = TRUE) {
  
  selected_data <- data[, variables, drop = FALSE]
  
  if (!all(sapply(selected_data, is.numeric))) {
    stop("Toutes les variables sélectionnées doivent être numériques.")
  }
  
  selected_data <- na.omit(selected_data)
  cor_matrix <- cor(selected_data, use = "complete.obs", method = method)
  
  p_matrix <- matrix(NA, ncol = ncol(selected_data), nrow = ncol(selected_data),
                     dimnames = list(colnames(selected_data), colnames(selected_data)))
  
  for (i in 1:ncol(selected_data)) {
    for (j in 1:ncol(selected_data)) {
      if (i > j) {  
        test <- cor.test(selected_data[[i]], selected_data[[j]], method = method)
        p_matrix[i, j] <- test$p.value
      } else if (i == j) {
        p_matrix[i, j] <- NA  
      }
    }
  }
  
    if (!is.null(labels)) {
    if (length(labels) != length(variables)) {
      stop("Le nombre de labels doit correspondre au nombre de variables sélectionnées.")
    }
    rownames(cor_matrix) <- labels
    colnames(cor_matrix) <- labels
  }

  if (plot) {
    col_fun <- colorRampPalette(c("#4F4F4F", "white", "#FC4C02"))  
    
    corrplot(cor_matrix, method = "color", col = col_fun(200), 
             tl.cex = 0.8, tl.col = "black",  
             addCoef.col = "black",  
             number.cex = 0.7,
             type = "lower")  
  }
  
  if (kable_output) {
    kable_table <- matrix("", ncol = ncol(cor_matrix), nrow = nrow(cor_matrix),
                          dimnames = list(rownames(cor_matrix), colnames(cor_matrix)))
    
    for (i in 1:ncol(cor_matrix)) {
      for (j in 1:ncol(cor_matrix)) {
        if (i >= j) {  
          corr_value <- sprintf("%.2f", cor_matrix[i, j])  
          p_value <- ifelse(is.na(p_matrix[i, j]), "", sprintf("(p=%.3f)", p_matrix[i, j]))  
          kable_table[i, j] <- paste0(corr_value, " ", p_value)  
        }
      }
    }
    
  print(kable(kable_table, format = "markdown"))
  }
  
  return(list(correlation = cor_matrix, p_value = p_matrix))
}

```



# Données socio-démographiques

```{r donnees generales}

### Taille échantillon et nombre h/f
taille_echantillon <- nrow(data)
nbfemmes <- sum(data$Sexe == 1, na.rm = TRUE)
nbhommes <- sum(data$Sexe == 2, na.rm = TRUE)

glue("La taille de l'échantillon est de {taille_echantillon} individus, avec {nbfemmes} femmes et {nbhommes} hommes.")
```



```{r caracteristiques individuelles}
### Moyenne âge et écart-type âge
moyenneage <- mean(data$Age, na.rm = TRUE)
ecarttypeage <- sd(data$Age, na.rm = TRUE)

### Conversion Sexe Catégorie en nombre dans data
if (is.factor(data$Sexe)) {
  data$Sexe <- as.numeric(levels(data$Sexe))[data$Sexe]
} else {
  data$Sexe <- as.numeric(as.character(data$Sexe))
}

if (is.factor(data$Catégorie)) {
  data$Catégorie <- as.numeric(levels(data$Catégorie))[data$Catégorie]
} else {
  data$Catégorie <- as.numeric(as.character(data$Catégorie))
}

### Pourcentage par CSP
catsociocadre <- (sum(data$Catégorie == 3, na.rm = TRUE) / nrow(data)) * 100
catsocioemployes <-  (sum(data$Catégorie == 5, na.rm = TRUE) / nrow(data)) * 100

```

```{r affichage caracteristiques individuelles}
glue("La moyenne d'âge est de {moyenneage} ans, avec un écart-type de {ecarttypeage} ans.")
glue ("La catégorie socio-professionelle la plus représentée est Cadres et professions intellectulles, qui représente {catsociocadre} % de l'échantillon, puis les employés avec {catsocioemployes} %. ")
```
### Âge et sexe{.tabset}

#### Répartition de l'âge
```{r graphique age}

### Calcul statistiques pour tableau
data_resumeAge<- data%>%
  summarise(
    Moyenne = mean(Age, na.rm = TRUE),
    Médiane = median(Age, na.rm = TRUE),
    Ecart_type = sd(Age, na.rm=TRUE)
  )

kable(data_resumeAge)

### Calcul statistiques pour graphique
data_resumeageround<- data%>%
  summarise(
    moyenne = round(mean(Age, na.rm = TRUE),0),
    mediane = round(median(Age, na.rm = TRUE),0),
    q1 = round(quantile(Age, 0.25, na.rm=T),0),
    q3 = round(quantile(Age, 0.75, na.rm=T),0),
    ecarttype = round(sd(Age, na.rm=TRUE),0)
  )

### Affichage statistiques graphique
vlinesage <- data.frame(
  label = c("Q1", "Médiane", "Moyenne", "Q3"),
  xintercept = c(data_resumeageround$q1, data_resumeageround$mediane, data_resumeageround$moyenne, data_resumeageround$q3)
)
vlinesage$annotation <- paste(vlinesage$label, ":", vlinesage$xintercept)

### Graphique
ggplot(data) +
  geom_histogram(aes(x = Age), fill = "#FC4C02", binwidth=5, colour="#FC4C02", alpha=0.5) +
  scale_x_continuous(breaks = seq(20, max(data$Age, na.rm = TRUE), by = 5))+
  labs(title = "Répartition des âges au sein de l'échantillon",
       x = "Âge (en années)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesage, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesage, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

#### Répartition des sexes
```{r graphique sexe}
### Graphique
ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
  geom_bar(aes(fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Répartition des sexes au sein de l'échantillon",
       x = "Sexe", y = "Nombre d'individus", fill="Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Répartition de l'âge en fonction des sexes
```{r graphique age en fonction des sexe}
### Graphique
ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Age,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "Répartition des âges en fonction des sexes au sein de l'échantillon",
       x = "Sexe",
       y = "Âge (en années)",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

### Catégories socio-professionnelles{.tabset}
```{r graphique categorie socio pro}
### Graphique
ggplot(data, aes(x = factor(Catégorie, 
                            levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                            labels = c("Agriculteurs exploitants",
                                       "Artisans, commerçants et chefs d'entreprise",
                                       "Cadres et professions intellectuelles supérieures",
                                       "Professions intermédiaires",
                                       "Employés",
                                       "Ouvriers",
                                       "Retraités",
                                       "Etudiants",
                                       "Autres personnes sans activité professionelle")))) +
  geom_bar(aes(fill = factor(Catégorie, 
                             levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                             labels = c("Agriculteurs exploitants",
                                        "Artisans, commerçants et chefs d'entreprise",
                                        "Cadres et professions intellectuelles supérieures",
                                        "Professions intermédiaires",
                                        "Employés",
                                        "Ouvriers",
                                        "Retraités",
                                        "Etudiants",
                                        "Autres personnes sans activité professionelle")), alpha=0.5)) +
  geom_text(aes(label = ..count..), 
            stat = "count",
            vjust = -0.5,
            size = 2) +
  labs(title = "Répartition des catégories socio-professionnelles au sein l'échantillon",
       x = "Catégorie socio-professionnelles",
       y = "Nombre d'individus", fill="Catégorie socio-professionelle") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
  theme(legend.position = "none")
```

# Utilisation de Strava

### Mesure de l'intensité d'utilisation{.tabset}
Les questions 20 à 24 (Echelle de Linkert) sont issues d'une traduction et adaptation du Facebook Intensity Scale, utilisé dans l'étude d'Ellison ^8^ et repris dans l'étude de Ross (2009)^9^, en remplaçant "Facebook" par "Strava". Il y a donc **5 items** pour cette échelle de mesure adaptée pour identifier à quel point l'utilisation de Strava fait partie du quotidien de l'utilisateur. Cette échelle est renommée pour l'étude en Strava Intensity Scale (SIS).

L'alpha de Cronbach dans l'étude d'Ellison (2007) est de 0.83 ^8^ et de 0.85 dans l'étude de Ross (2009) ^9^.

Un score bas au SIS indique que Strava fait peu partie du quotidien de l'utilisateur et qu'il y est peu attaché tandis qu'un score haut au SIS indique que l'utilisateur utilise Strava très fréquemment et est affecté négativement s'il ne peut pas l'utiliser.

```{r score SIS alpha cronbach}
### Calcul alpha de Cronbach
data_SIS <- data[, c("SIS_1", "SIS_2", "SIS_3", "SIS_4", "SIS_5")]
cronbachSIS<-cronbach(data_SIS)

### Affichage alpha de Cronbach
glue ("L'alpha de Cronbach sur les {cronbachSIS$number.of.items} items est de {cronbachSIS$alpha}.")
```
L'alpha de Cronbach est acceptable.

#### SIS 1
```{r graphique SIS 1}
### Statistiques
data_resumeSIS1 <- data%>%
  summarise(
    Moyenne = mean(SIS_1, na.rm = TRUE),
    Médiane = median(SIS_1, na.rm = TRUE),
    Ecart_type = sd(SIS_1, na.rm=TRUE))

kable(data_resumeSIS1)

### Graphique
ggplot(data, aes(x = factor(SIS_1, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Strava fait partie de mon activité quotidienne. ", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SIS 2
```{r graphique SIS 2}
### Statistiques
data_resumeSIS2 <- data%>%
  summarise(
    Moyenne = mean(SIS_2, na.rm = TRUE),
    Médiane = median(SIS_2, na.rm = TRUE),
    Ecart_type = sd(SIS_2, na.rm=TRUE))

kable(data_resumeSIS2)

### Graphique
ggplot(data, aes(x = factor(SIS_2, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je suis fier(fière) de dire aux gens que j’utilise Strava.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SIS 3
```{r graphique SIS 3}

### Statistiques
data_resumeSIS3 <- data%>%
  summarise(
    Moyenne = mean(SIS_3, na.rm = TRUE),
    Médiane = median(SIS_3, na.rm = TRUE),
    Ecart_type = sd(SIS_3, na.rm=TRUE))

kable(data_resumeSIS3)

### Graphique
ggplot(data, aes(x = factor(SIS_3, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je me sens déconnecté(e) lorsque je n’ai pas utilisé Strava depuis un certain temps.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SIS 4
```{r graphique SIS 4}

### Statistiques
data_resumeSIS4 <- data%>%
  summarise(
    Moyenne = mean(SIS_4, na.rm = TRUE),
    Médiane = median(SIS_4, na.rm = TRUE),
    Ecart_type = sd(SIS_4, na.rm=TRUE))

kable(data_resumeSIS4)

### Graphique
ggplot(data, aes(x = factor(SIS_4, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02",alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "J’ai l’impression de faire partie de la communauté Strava.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SIS 5
```{r graphique SIS 5}

### Statistiques
data_resumeSIS5 <- data%>%
  summarise(
    Moyenne = mean(SIS_5, na.rm = TRUE),
    Médiane = median(SIS_5, na.rm = TRUE),
    Ecart_type = sd(SIS_5, na.rm=TRUE))

kable(data_resumeSIS2)

### Graphique
ggplot(data, aes(x = factor(SIS_5, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je ne pourrais pas arrêter d'utiliser Strava.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SCORE SIS 
```{r graphique SCORE SIS}

### Création SCORE SIS
data <- data %>% mutate (SCORE_SIS = SIS_1 + SIS_2 + SIS_3 + SIS_4 + SIS_5)

### Transformation en catégorie
data <- data %>% mutate(scoreSIS_categorystat = case_when(
    SCORE_SIS < 5 ~  "1",
    SCORE_SIS  >=5 & SCORE_SIS <9 ~  "2",
    SCORE_SIS  >=9 & SCORE_SIS <13 ~  "3",
    SCORE_SIS  >=13 & SCORE_SIS <17 ~  "4",
    SCORE_SIS >=17 ~  "5"
  ))

### Statistiques pour graphique
data_resumesistotalround<- data%>%
  summarise(
    median = round(median(SCORE_SIS, na.rm = TRUE),0),
    moyenne= round(mean(SCORE_SIS, na.rm=TRUE),0),
    q1 = round(quantile(SCORE_SIS, 0.25, na.rm=T),0),
    q3 = round(quantile(SCORE_SIS, 0.75, na.rm=T),0)
  )

### Statistiques pour tableau
data_resumesistotal<- data%>%
  summarise(
    Médiane = median(SCORE_SIS, na.rm = TRUE),
    Moyenne= mean(SCORE_SIS, na.rm=TRUE),
    Ecart_type = sd(SCORE_SIS, na.rm=TRUE)
  )

### Affichage tableau recapitulatif
table_SIS <- data.frame(
  Variable = c("SIS1", "SIS2", "SIS3", "SIS4", "SIS5", "Total"),
  Moyenne = c(data_resumeSIS1$Moyenne, data_resumeSIS2$Moyenne, data_resumeSIS3$Moyenne, data_resumeSIS4$Moyenne, data_resumeSIS5$Moyenne, data_resumesistotal$Moyenne),
  Médiane = c(data_resumeSIS1$Médiane, data_resumeSIS2$Médiane, data_resumeSIS3$Médiane,data_resumeSIS4$Médiane, data_resumeSIS5$Médiane,           data_resumesistotal$Médiane),
  Ecart_type = c(data_resumeSIS1$Ecart_type, data_resumeSIS2$Ecart_type, data_resumeSIS3$Ecart_type, data_resumeSIS4$Ecart_type, data_resumeSIS5$Ecart_type,    data_resumesistotal$Ecart_type)
)

kable(table_SIS)

### Affichage statistiques graphique
vlinesSISTOTAL <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumesistotalround$q1, data_resumesistotalround$moyenne, data_resumesistotalround$median, data_resumesistotalround$q3)
)
vlinesSISTOTAL$annotation <- paste(vlinesSISTOTAL$label, ":", vlinesSISTOTAL$xintercept)

### Graphique
ggplot(data) +
  geom_histogram(aes(x = SCORE_SIS), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_SIS, na.rm = TRUE), 
                                max(data$SCORE_SIS, na.rm = TRUE), 
                                by = 5))+
  labs(title = "Répartition du score SIS au sein de l'échantillon",
       x = "Score SIS", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesSISTOTAL, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesSISTOTAL, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```

### Compléments{.tabset}

#### Fréquence de publication
```{r graphique frequence publication}

### Conversion en numérique
data$Fréquence_publication <- as.numeric(as.character(data$Fréquence_publication ))

### Statistiques tableau
data_resumefreqPubli<- data%>%
  summarise(
    Moyenne = mean(Fréquence_publication, na.rm = TRUE),
    Médiane = median(Fréquence_publication, na.rm = TRUE),
    Ecart_type= sd(Fréquence_publication, na.rm=TRUE)
  )

kable(data_resumefreqPubli)

### Statistiques pour graphique
data_resumefreqpubliround<- data%>%
  summarise(
    median = round(median(Fréquence_publication , na.rm = TRUE),0),
    moyenne = round(mean(Fréquence_publication , na.rm=TRUE), 0),
    q1 = round(quantile(Fréquence_publication , 0.25, na.rm=T),0),
    q3 = round(quantile(Fréquence_publication , 0.75, na.rm=T),0)
  )

### Affichage statistiques graphique
vlinesfreqpubli <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumefreqpubliround$q1, data_resumefreqpubliround$moyenne, data_resumefreqpubliround$median, data_resumefreqpubliround$q3)
)
vlinesfreqpubli$annotation <- paste(vlinesfreqpubli$label, ":", vlinesfreqpubli$xintercept)

### Graphique
ggplot(data) +
  geom_histogram(aes(x = Fréquence_publication), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$Fréquence_publication , na.rm = TRUE), 
                                max(data$Fréquence_publication , na.rm = TRUE), 
                                by = 2))+
  labs(title = "Répartition de la fréquence de publication au sein de l'échantillon",
       x = "Fréquence de publication (nombre de fois par semaine)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesfreqpubli, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesfreqpubli, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```

#### Fréquence de consultation
```{r graphique frequence consultation}
### Conversion en numérique
data$Fréquence_consultation <- as.numeric(as.character(data$Fréquence_consultation))

### Statistiques tableau
data_resumefreqCons<- data%>%
  summarise(
    Moyenne = mean(Fréquence_consultation, na.rm = TRUE),
    Médiane = median(Fréquence_consultation, na.rm = TRUE),
    Ecart_type= sd(Fréquence_consultation, na.rm=TRUE)
  )

kable(data_resumefreqCons)

### Statistiques graphique
data_resumefreqconsround<- data%>%
  summarise(
    median = round(median(Fréquence_consultation, na.rm = TRUE),0),
    moyenne = round(mean(Fréquence_consultation, na.rm=TRUE), 0),
    q1 = round(quantile(Fréquence_consultation, 0.25, na.rm=T),0),
    q3 = round(quantile(Fréquence_consultation, 0.75, na.rm=T),0)
  )

### Affichage statistiques graphique
vlinesfreqcons <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumefreqconsround$q1, data_resumefreqconsround$moyenne, data_resumefreqconsround$median, data_resumefreqconsround$q3)
)
vlinesfreqcons$annotation <- paste(vlinesfreqcons$label, ":", vlinesfreqcons$xintercept)

### Graphique
ggplot(data) +
  geom_histogram(aes(x = Fréquence_consultation), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$Fréquence_consultation, na.rm = TRUE), 
                                max(data$Fréquence_consultation, na.rm = TRUE), 
                                by = 2))+
  labs(title = "Répartition de la fréquence de consultation au sein de l'échantillon",
       x = "Fréquence de consultation (nombre de fois par semaine)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesfreqcons, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesfreqcons, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```


#### Nombre d'abonnés
```{r graphique nb abonnes}
### Statistiques tableau
data_resumenbAbonnés<- data%>%
  summarise(
    Médiane = median(Nb_abonnés, na.rm = TRUE),
    Moyenne = mean(Nb_abonnés, na.rm=TRUE),
    Ecart_type = sd(Nb_abonnés, na.rm=TRUE)
  )

kable(data_resumenbAbonnés)

### Statistiques graphique
data_resumenbabonnésround<- data%>%
  summarise(
    median = round(median(Nb_abonnés, na.rm = TRUE),0),
    moyenne = round(mean(Nb_abonnés, na.rm=TRUE),0),
    q1 = round(quantile(Nb_abonnés, 0.25, na.rm=T),0),
    q3 = round(quantile(Nb_abonnés, 0.75, na.rm=T),0)
  )

### Affichage statistiques graphique
vlinesnbabonnés <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumenbabonnésround$q1, data_resumenbabonnésround$moyenne, data_resumenbabonnésround$median, data_resumenbabonnésround$q3)
)
vlinesnbabonnés$annotation <- paste(vlinesnbabonnés$label, ":", vlinesnbabonnés$xintercept)

### Graphique
ggplot(data) +
  geom_histogram(aes(x = Nb_abonnés), fill = "#FC4C02", binwidth=50, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$Nb_abonnés, na.rm = TRUE), 
                                max(data$Nb_abonnés, na.rm = TRUE), 
                                by = 50))+
  labs(title = "Répartition du nombre d'abonnés au sein de l'échantillon",
       x = "Nombre d'abonnés", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesnbabonnés, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesnbabonnés, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```

#### Nombre d'abonnements
```{r graphique nb abonnements}
### Statistiques tableau
data_resumenbAbonnements<- data%>%
  summarise(
    Médiane = median(Nb_abonnements, na.rm = TRUE),
    Moyenne = mean(Nb_abonnements, na.rm=TRUE),
    Ecart_type = sd(Nb_abonnements, na.rm=TRUE)
  )

kable(data_resumenbAbonnements)

### Statistiques graphique
data_resumenbabonnementsround<- data%>%
  summarise(
    median = round(median(Nb_abonnements, na.rm = TRUE),0),
    moyenne = round(mean(Nb_abonnements, na.rm=TRUE), 0),
    q1 = round(quantile(Nb_abonnements, 0.25, na.rm=T),0),
    q3 = round(quantile(Nb_abonnements, 0.75, na.rm=T),0)
  )

### Affichage statistiques graphique
vlinesnbabonnements <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumenbabonnementsround$q1, data_resumenbabonnementsround$moyenne, data_resumenbabonnementsround$median, data_resumenbabonnementsround$q3)
)
vlinesnbabonnements$annotation <- paste(vlinesnbabonnements$label, ":", vlinesnbabonnements$xintercept)

### Graphique
ggplot(data) +
  geom_histogram(aes(x = Nb_abonnements), fill = "#FC4C02", binwidth=50, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$Nb_abonnements, na.rm = TRUE), 
                                max(data$Nb_abonnements, na.rm = TRUE), 
                                by = 50))+
  labs(title = "Répartition du nombre d'abonnements au sein de l'échantillon",
       x = "Nombre d'abonnements", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesnbabonnements, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesnbabonnements, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

### Mesure de la sociabilité en ligne{.tabset}
Les questions 39 à 42 (Echelle de Linkert) sont une traduction et adaptation du Online Sociability Functions (OSF) utilisé dans l'étude de Ross (2009)^9^ qui mesure la sociabilité en ligne. L'alpha de Cronbach dans l'étude de Ross (2009)^9^ est de 0.74.
Il y a donc **4 items** pour cette échelle de mesure adaptée pour identifier à quel point chaque utilisateur est sociable sur Strava.

On pourrait ajouter le nombre de clubs Strava dont l'utilisateur fait partie (question 38) et le nombre de kudos reçus (question 42) pour enrichir cette échelle mais cela ne modifie quasiment pas l'alpha de Cronbach. 

Un score bas au OSF indique que l'utilisateur utilise peu les fonctionnalités de sociabilité en ligne, tandis qu'un score haut indique que l'utilisateur utilise beaucoup de fonctionnalités de sociabilité en ligne.

```{r SCORE OSF alpha cronbach}
### Calcul alpha de Cronbach
data_OSF <- data[, c("Kudos_donnés", "Commentaires_donnés", "Publications", "Commentaires_reçus")]
cronbachOSF<-cronbach(data_OSF)

### Test alpha de Cronbach avec +2 items
data_OSFaugmente <- data[, c("Kudos_donnés", "Commentaires_donnés", "Publications", "Commentaires_reçus", "clubstrava_categorystat", "kudosreçus_categorystat")]
cronbachOSFaugmente<-cronbach(data_OSFaugmente)

glue ("L'alpha de Cronbach sur les {cronbachOSF$number.of.items} items est de {cronbachOSF$alpha}.")
```
L'alpha de Cronbach est un peu faible, cela peut s'expliquer par le fait qu'il s'agit d'une traduction et adaptation du questionnaire d'origine dans le cadre de cette étude.

#### Kudos donnés
```{r graphique nb kudos donnes}
### Statistiques
data_resumekudosdonnés <- data%>%
  summarise(
    Moyenne = mean(Kudos_donnés, na.rm = TRUE),
    Médiane = median(Kudos_donnés, na.rm = TRUE),
    Ecart_type = sd(Kudos_donnés, na.rm=TRUE))

kable(data_resumekudosdonnés)

### Graphique
ggplot(data, aes(x = factor(Kudos_donnés, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Envoyez-vous des kudos ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Commentaires donnés
```{r graphique commentaires donnes}
### Statistiques
data_resumecommentairesdonnés <- data%>%
  summarise(
    Moyenne = mean(Commentaires_donnés, na.rm = TRUE),
    Médiane = median(Commentaires_donnés, na.rm = TRUE),
    Ecart_type = sd(Commentaires_donnés, na.rm=TRUE))

kable(data_resumecommentairesdonnés)

### Graphique
ggplot(data, aes(x = factor(Commentaires_donnés, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Laissez-vous des commentaires ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Publications
```{r graphique publications}
### Statistiques
data_resumepublication <- data%>%
  summarise(
    Moyenne = mean(Publications, na.rm = TRUE),
    Médiane = median(Publications, na.rm = TRUE),
    Ecart_type = sd(Publications, na.rm=TRUE))

kable(data_resumepublication)

### Graphique
ggplot(data, aes(x = factor(Publications, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Faites-vous des publications (hors activités) ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Commentaires reçus
```{r graphique commentaires recus}
### Statistiques
data_resumecommentairesreçus <- data%>%
  summarise(
    Moyenne = mean(Commentaires_reçus, na.rm = TRUE),
    Médiane = median(Commentaires_reçus, na.rm = TRUE),
    Ecart_type = sd(Commentaires_reçus, na.rm=TRUE))

kable(data_resumecommentairesreçus)

### Graphique
ggplot(data, aes(x = factor(Commentaires_reçus, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Recevez-vous des commentaires ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SCORE OSF
```{r graphique SCORE OSF}
### Calcul score OSF
data <- data %>% mutate (SCORE_OSF = Kudos_donnés + Commentaires_donnés + Commentaires_reçus + Publications)

### Catégorie score OSF
data <- data %>% mutate(scoreOSF_categorystat = case_when(
    SCORE_OSF < 5 ~  "1",
    SCORE_OSF  >=5 & SCORE_OSF <9 ~  "2",
    SCORE_OSF  >=9 & SCORE_OSF <13 ~  "3",
    SCORE_OSF >=13 ~  "4"
  ))

### Statistiques pour tableau
data_resumeOSFround<- data%>%
  summarise(
    median = round(median(SCORE_OSF, na.rm = TRUE),0),
    moyenne= round(mean(SCORE_OSF, na.rm=TRUE),0),
    q1 = round(quantile(SCORE_OSF, 0.25, na.rm=T),0),
    q3 = round(quantile(SCORE_OSF, 0.75, na.rm=T),0)
  )

### Statistiques pour graphique
data_resumeOSF<- data%>%
  summarise(
    Médiane = median(SCORE_OSF, na.rm = TRUE),
    Moyenne= mean(SCORE_OSF, na.rm=TRUE),
    Ecart_type = sd(SCORE_OSF, na.rm=TRUE)
  )

### Affichage tableau récapitulatif
table_OSF <- data.frame(
  Variable = c("Kudos donnés", "Commentaires donnés", 
           "Commentaires reçus", "Publications", "Total"),
  
  Moyenne = c(data_resumekudosdonnés$Moyenne, data_resumecommentairesdonnés$Moyenne, 
              data_resumecommentairesreçus$Moyenne, data_resumepublication$Moyenne, data_resumeOSF$Moyenne),
  
  Médiane = c(data_resumekudosdonnés$Médiane, data_resumecommentairesdonnés$Médiane, 
              data_resumecommentairesreçus$Médiane, data_resumepublication$Médiane, data_resumeOSF$Médiane),
  
  Ecart_type = c(data_resumekudosdonnés$Ecart_type, data_resumecommentairesdonnés$Ecart_type, 
              data_resumecommentairesreçus$Ecart_type, data_resumepublication$Ecart_type, data_resumeOSF$Ecart_type)
)


kable(table_OSF)

### Affichage statistiques graphique
vlinesOSF <- data.frame(
  label = c("Q1", "Médiane", "Q3"),
  xintercept = c(data_resumeOSFround$q1, data_resumeOSFround$median, data_resumeOSFround$q3)
)
vlinesOSF$annotation <- paste(vlinesOSF$label, ":", vlinesOSF$xintercept)

### Graphique
ggplot(data) +
  geom_histogram(aes(x = SCORE_OSF), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_OSF, na.rm = TRUE), 
                                max(data$SCORE_OSF, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score OSF au sein de l'échantillon",
       x = "Score OSF", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesOSF, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesOSF, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```

### Compléments{.tabset}

#### Clubs Strava
```{r graphique club strava}
### Statistiques
data_resumeclubstrava<- data%>%
  summarise(
    Moyenne = mean(Club_Strava, na.rm = TRUE),
    Médiane = median(Club_Strava, na.rm = TRUE),
    Ecart_type = sd(Club_Strava, na.rm=TRUE)
  )

kable(data_resumeclubstrava)

### Statistiques pour graphique
data_resumeClubStravaround<- data%>%
  summarise(
    moyenne = round(mean(Club_Strava, na.rm = TRUE),0),
    mediane = round(median(Club_Strava, na.rm = TRUE),0),
    q1 = round(quantile(Club_Strava, 0.25, na.rm=T),0),
    q3 = round(quantile(Club_Strava, 0.75, na.rm=T),0),
    ecarttype = round(sd(Club_Strava, na.rm=TRUE),0)
  )

### Affichage statistiques graphique
vlinesclubstrava <- data.frame(
  label = c("Q1", "Médiane", "Moyenne", "Q3"),
  xintercept = c(data_resumeClubStravaround$q1, data_resumeClubStravaround$mediane, data_resumeClubStravaround$moyenne, data_resumeClubStravaround$q3)
)
vlinesclubstrava$annotation <- paste(vlinesclubstrava$label, ":", vlinesclubstrava$xintercept)

### Graphique
ggplot(data) +
  geom_histogram(aes(x = Club_Strava), fill = "#FC4C02", binwidth=5, colour="#FC4C02", alpha=0.5) +
  scale_x_continuous(breaks = seq(20, max(data$Club_Strava, na.rm = TRUE), by = 5))+
  labs(title = "Répartition de l'appartenance à des clubs Strava au sein de l'échantillon",
       x = "Nombre de clubs Strava", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesclubstrava, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesclubstrava, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```

#### Nombre de kudos reçus
```{r graphique nb kudos recus}
### Statistiques
data_resumenbkudosreçus<- data%>%
  summarise(
    Moyenne = mean(Kudos_reçus, na.rm = TRUE),
    Médiane = median(Kudos_reçus, na.rm = TRUE),
    Ecart_type = sd(Kudos_reçus, na.rm=TRUE)
  )

kable(data_resumenbkudosreçus)

### Statistiques pour graphique
data_resumenbkudosreçusround<- data%>%
  summarise(
    moyenne = round(mean(Kudos_reçus, na.rm = TRUE),0),
    mediane = round(median(Kudos_reçus, na.rm = TRUE),0),
    q1 = round(quantile(Kudos_reçus, 0.25, na.rm=T),0),
    q3 = round(quantile(Kudos_reçus, 0.75, na.rm=T),0),
    ecarttype = round(sd(Kudos_reçus, na.rm=TRUE),0)
  )

###Affichage statistiques graphique
vlinesnbkudosreçus <- data.frame(
  label = c("Q1", "Médiane", "Moyenne", "Q3"),
  xintercept = c(data_resumenbkudosreçusround$q1, data_resumenbkudosreçusround$mediane, data_resumenbkudosreçusround$moyenne, data_resumenbkudosreçusround$q3)
)
vlinesnbkudosreçus$annotation <- paste(vlinesnbkudosreçus$label, ":", vlinesnbkudosreçus$xintercept)

### Graphique
ggplot(data) +
  geom_histogram(aes(x = Kudos_reçus), fill = "#FC4C02", binwidth=10, colour="#FC4C02", alpha=0.5) +
  scale_x_continuous(breaks = seq(20, max(data$Club_Strava, na.rm = TRUE), by = 10))+
  labs(title = "Répartition du nombre de kudos reçus par activité publiée au sein de l'échantillon",
       x = "Nombre de kudos reçus sur une activité publiée (en moyenne)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesnbkudosreçus, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesnbkudosreçus, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```


### Mesure de l'exposition{.tabset}
Les questions 25 à 28 (Echelle de Linkert) sont un extrait, une traduction et adaptation du Facebook questionnaire utilisé dans l'étude de Ross (2009)^9^. Dans l'étude de Ross (2009), il n'est pas mentionné que ces items mesurent le niveau d'exposition. Dans l'étude présente, une échelle est donc créée pour mesurer le niveau d'exposition sur Strava (SCORE EXPOSITION). Il y a donc **10 items** pour cette échelle de mesure adaptée pour identifier à quel point chaque utilisateur expose des informations personnelles sur Strava.

Un score bas indique l'utilisateur partage peu d'informations personnelles avec une restriction de public tandis qu'un score indique l'utilisateur partage beaucoup d'informations personnelles sans restriction de public.

```{r score exposition}
### Conversion numérique
data$Activités <- as.numeric(as.character(data$Activités))
data$Horaires <- as.numeric(as.character(data$Horaires))
data$FC <- as.numeric(as.character(data$FC))
data$Allure <- as.numeric(as.character(data$Allure))
data$Carte <- as.numeric(as.character(data$Carte))
data$Entrainement_publié <- as.numeric(as.character(data$Entrainement_publié))
data$Compétition_publiée <- as.numeric(as.character(data$Compétition_publiée))
data$Nommage_activité <- as.numeric(as.character(data$Nommage_activité))
data$Commentaire_activité <- as.numeric(as.character(data$Commentaire_activité))
data$Photo_activité <- as.numeric(as.character(data$Photo_activité))

###Création score exposition
data_Expo <- data[, c("Activités", "Horaires", "FC", "Allure", "Carte", "Entrainement_publié", "Compétition_publiée", "Nommage_activité", "Commentaire_activité", "Photo_activité")]
### Calcul alpha de Cronbach
cronbachExpo<-cronbach(data_Expo)

glue ("L'alpha de Cronbach sur les {cronbachExpo$number.of.items} items est de {cronbachExpo$alpha}.")
```
L'alpha de Cronbach est acceptable.

#### Activités
```{r graphique activites}
### Statistiques
data_resumeactivités <- data%>%
  summarise(
    Moyenne = mean(Activités, na.rm = TRUE),
    Médiane = median(Activités, na.rm = TRUE),
    Ecart_type = sd(Activités, na.rm=TRUE))

kable(data_resumeactivités)

### Graphique
ggplot(data, aes(x = factor(Activités, levels = c(1, 2, 3), labels = c("Uniquement vous-même", "Uniquement vos abonnés", "Tout le monde")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Qui peut voir les activités ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Horaires
```{r graphique horaires}
### Statistiques
data_resumehoraires <- data%>%
  summarise(
    Moyenne = mean(Horaires, na.rm = TRUE),
    Médiane = median(Horaires, na.rm = TRUE),
    Ecart_type = sd(Horaires, na.rm=TRUE))

kable(data_resumehoraires)

### Graphique
ggplot(data, aes(x = factor(Horaires, levels = c(1, 2, 3), labels = c("Uniquement vous-même", "Uniquement vos abonnés", "Tout le monde")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Qui peut voir les horaires de départ des vos activités ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Fréquence cardiaque
```{r graphique FC}

### Statistiques
data_resumeFC<- data%>%
  summarise(
    Moyenne = mean(FC, na.rm = TRUE),
    Médiane = median(FC, na.rm = TRUE),
    Ecart_type = sd(FC, na.rm=TRUE))

kable(data_resumeFC)

###Graphique
ggplot(data, aes(x = factor(FC, levels = c(1, 2, 3), labels = c("Uniquement vous-même", "Uniquement vos abonnés", "Tout le monde")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Qui peut voir votre fréquence cardiaque ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### Allure
```{r graphique allure}
###Statistiques
data_resumeAllure<- data%>%
  summarise(
    Moyenne = mean(Allure, na.rm = TRUE),
    Médiane = median(Allure, na.rm = TRUE),
    Ecart_type = sd(Allure, na.rm=TRUE))

kable(data_resumeAllure)

### Graphique
ggplot(data, aes(x = factor(Allure, levels = c(1, 2, 3), labels = c("Uniquement vous-même", "Uniquement vos abonnés", "Tout le monde")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Qui peut voir votre allure ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Carte
```{r graphique carte}

###Statistiques
data_resumeCarte<- data%>%
  summarise(
    Moyenne = mean(Carte, na.rm = TRUE),
    Médiane = median(Carte, na.rm = TRUE),
    Ecart_type = sd(Carte, na.rm=TRUE))

kable(data_resumeCarte)

### Graphique
ggplot(data, aes(x = factor(Carte, levels = c(1, 2, 3), labels = c("Uniquement vous-même", "Uniquement vos abonnés", "Tout le monde")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Qui peut voir vos points de départ et arrivée de vos activités?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### Publication entraînement
```{r graphique publication entrainement}
###Statistique
data_resumeentrainementpublié<- data%>%
  summarise(
    Moyenne = mean(Entrainement_publié, na.rm = TRUE),
    Médiane = median(Entrainement_publié, na.rm = TRUE),
    Ecart_type = sd(Entrainement_publié, na.rm=TRUE))

kable(data_resumeentrainementpublié)

### Graphique
ggplot(data, aes(x = factor(Entrainement_publié, levels = c(1, 2, 3, 4), labels = c("Quasiment aucun entraînement", "Uniquement certain de vos entraînements", "Quasiment tous vos entraînements", "Tous vos entraînements")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  ylim(0, max(table(data$Entrainement_publié)) * 1.2)+
  labs(title = "",
       x = "Qui peut voir vos entraînements sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Publication compétition
```{r graphique publication competition}
### Statistique
data_resumecompetitionpubliée<- data%>%
  summarise(
    Moyenne = mean(Compétition_publiée, na.rm = TRUE),
    Médiane = median(Compétition_publiée, na.rm = TRUE),
    Ecart_type = sd(Compétition_publiée, na.rm=TRUE))

kable(data_resumecompetitionpubliée)

### Graphique
ggplot(data, aes(x = factor(Compétition_publiée, levels = c(1, 2, 3, 4), labels = c("Quasiement aucune compétition", "Uniquement certaines de vos compétitions", "Quasiment toutes vos compétitions", "Toutes vos compéititions")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  ylim(0, max(table(data$Compétition_publiée)) * 1.2)+
  labs(title = "",
       x = "Qui peut voir vos compétitions sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Nommage activité
```{r graphique nommage activite}
###Statistique
data_resumenommageactivité<- data%>%
  summarise(
    Moyenne = mean(Nommage_activité, na.rm = TRUE),
    Médiane = median(Nommage_activité, na.rm = TRUE),
    Ecart_type = sd(Nommage_activité, na.rm=TRUE))

kable(data_resumenommageactivité)

### Graphique
ggplot(data, aes(x = factor(Nommage_activité, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Lorsque vous publiez une activité sur Strava, nommez-vous votre activité ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### Commentaire activité
```{r graphique commentaire activite}
###Statistique
data_resumecommentaireactivité<- data%>%
  summarise(
    Moyenne = mean(Commentaire_activité, na.rm = TRUE),
    Médiane = median(Commentaire_activité, na.rm = TRUE),
    Ecart_type = sd(Commentaire_activité, na.rm=TRUE))

kable(data_resumecommentaireactivité)

### Graphique
ggplot(data, aes(x = factor(Commentaire_activité, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Lorsque vous publiez une activité sur Strava, ajoutez-vous des commentaires ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### Photo activité
```{r graphique photo activite}
###Statistique
data_resumephotoactivité<- data%>%
  summarise(
    Moyenne = mean(Photo_activité, na.rm = TRUE),
    Médiane = median(Photo_activité, na.rm = TRUE),
    Ecart_type = sd(Photo_activité, na.rm=TRUE))

kable(data_resumephotoactivité)

### Graphique
ggplot(data, aes(x = factor(Photo_activité, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Lorsque vous publiez une activité sur Strava, ajoutez-vous des photos ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```


#### SCORE EXPOSITION
```{r graphique SCORE EXPOSITION}
### Score exposition
data <- data %>% mutate (SCORE_EXPO = Activités + Horaires + FC + Allure + Carte + Entrainement_publié + Compétition_publiée + Nommage_activité + Commentaire_activité + Photo_activité)

### Transformation en variable catégorielle
data <- data %>% mutate(scoreExpo_categorystat = case_when(
    SCORE_EXPO < 12 ~  "1",
    SCORE_EXPO  >=12 & SCORE_EXPO <20 ~  "2",
    SCORE_EXPO  >=20 & SCORE_EXPO <35 ~  "3",
    SCORE_EXPO >=35 ~  "4"
  ))

###Statistiques pour graphique
data_resumeEXPOround<- data%>%
  summarise(
    median = round(median(SCORE_EXPO, na.rm = TRUE),0),
    moyenne= round(mean(SCORE_EXPO, na.rm=TRUE),0),
    q1 = round(quantile(SCORE_EXPO, 0.25, na.rm=T),0),
    q3 = round(quantile(SCORE_EXPO, 0.75, na.rm=T),0)
  )

### Statistiques pour tableau
data_resumeEXPO<- data%>%
  summarise(
    Médiane = median(SCORE_EXPO, na.rm = TRUE),
    Moyenne= mean(SCORE_EXPO, na.rm=TRUE),
    Ecart_type = sd(SCORE_EXPO, na.rm=TRUE)
  )

### Affichage tableau récapitulatif
table_EXPO <- data.frame(
  Variable = c("Activités", "Horaires", "Fréquence cardiaque", "Allure", "Départ et arrivée", "Entraînement", "Compétition", "Nommage activité", "Commentaire activité", "Photo activité", "Total"),
  
  Moyenne = c(data_resumeactivités$Moyenne, data_resumehoraires$Moyenne, data_resumeFC$Moyenne, data_resumeAllure$Moyenne, data_resumeCarte$Moyenne, data_resumeentrainementpublié$Moyenne, data_resumecompetitionpubliée$Moyenne, data_resumenommageactivité$Moyenne, data_resumecommentaireactivité$Moyenne, data_resumephotoactivité$Moyenne, data_resumeEXPO$Moyenne),
  
  Médiane = c(data_resumeactivités$Médiane, data_resumehoraires$Médiane, data_resumeFC$Médiane, data_resumeAllure$Médiane, data_resumeCarte$Médiane, data_resumeentrainementpublié$Médiane, data_resumecompetitionpubliée$Médiane, data_resumenommageactivité$Médiane, data_resumecommentaireactivité$Médiane, data_resumephotoactivité$Médiane, data_resumeEXPO$Médiane),
  
  Ecart_type = c(data_resumeactivités$Ecart_type, data_resumehoraires$Ecart_type, data_resumeFC$Ecart_type, data_resumeAllure$Ecart_type, data_resumeCarte$Ecart_type, data_resumeentrainementpublié$Ecart_type, data_resumecompetitionpubliée$Ecart_type, data_resumenommageactivité$Ecart_type, data_resumecommentaireactivité$Ecart_type, data_resumephotoactivité$Ecart_type, data_resumeEXPO$Ecart_type))

kable(table_EXPO)

### Affichage statistiques graphique
vlinesEXPO <- data.frame(
  label = c("Q1", "Médiane", "Q3"),
  xintercept = c(data_resumeEXPOround$q1, data_resumeEXPOround$median, data_resumeEXPOround$q3)
)
vlinesEXPO$annotation <- paste(vlinesEXPO$label, ":", vlinesEXPO$xintercept)

### Graphique
ggplot(data) +
  geom_histogram(aes(x = SCORE_EXPO), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_EXPO, na.rm = TRUE), 
                                max(data$SCORE_EXPO, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score d'EXPOSITION sur Strava au sein de l'échantillon",
       x = "Score EXPO", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesEXPO, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesEXPO, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```

### Autres mesures{.tabset}

#### Catégorie d'abonnement
```{r graphique categorie abonnement}
### Graphique
ggplot(data, aes(x = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")))) +
  geom_bar(aes(fill = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")), alpha=0.5)) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Répartition des catégories d'abonnement sur Strava au sein de l'échantillon",
       x = "Catégorie d'abonnement", y = "Nombre d'individus", fill="Type d'abonnement") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Ancienneté sur Strava
```{r graphique anciennete strava}
### Conversion en numérique
data$Ancienneté_Strava <- as.numeric(as.character(data$Ancienneté_Strava))

### Statistiques
data_resumeanciennetestrava<- data%>%
  summarise(
    Moyenne = mean(Ancienneté_Strava, na.rm = TRUE),
    Médiane = median(Ancienneté_Strava, na.rm = TRUE),
    Ecart_type = sd(Ancienneté_Strava, na.rm=TRUE))

kable(data_resumeanciennetestrava)

###Statistiques pour graphique
data_resumeanciennetestravaround<- data%>%
  summarise(
    moyenne = round(mean(Ancienneté_Strava, na.rm = TRUE),0),
    median = round(median(Ancienneté_Strava, na.rm = TRUE),0),
    q1 = round(quantile(Ancienneté_Strava, 0.25, na.rm=T),0),
    q3 = round(quantile(Ancienneté_Strava, 0.75, na.rm=T),0)
  )

### Affichage statistiques graphique
vlinesanciennetestrava <- data.frame(
  label = c("Q1", "Médiane", "Q3"),
  xintercept = c(data_resumeanciennetestravaround$q1, data_resumeanciennetestravaround$median, data_resumeanciennetestravaround$q3)
)
vlinesanciennetestrava$annotation <- paste(vlinesanciennetestrava$label, ":", vlinesanciennetestrava$xintercept)

### Graphique
ggplot(data) +
  geom_histogram(aes(x = Ancienneté_Strava), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$Ancienneté_Strava, na.rm = TRUE), 
                                max(data$Ancienneté_Strava, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition de l'ancienneté sur Strava au sein de l'échantillon",
       x = "Ancienneté sur Strava (en années)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesanciennetestrava, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesanciennetestrava, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```


#### Buts utilisation Strava

```{r graphique but strava}
### Affichage des labels 
labels_comptagebutstrava <- c(
  "1" = "Suivi de la performance",
  "2" = "Motivation personnelle",
  "3" = "Interaction sociale",
  "4" = "Comparaison avec d'autres coureurs",
  "5" = "Partage de vos activités",
  "6" = "Enregistrement de vos activités",
  "7" = "Suivi de progrès",
  "8" = "Idée de parcours",
  "9" = "Côté ludique (segment, classements, KOM/QOM…)",  # Espace enlevé avant "Côté"
  "10" = "Appartenance à une communauté",
  "11" = "Encouragements (kudos)",
  "12" = "Atteinte d'objectifs personnels",
  "13" = "Autre"
)

### Comptage des différentes catégories
comptage_but_strava <- data %>%
  separate_rows(But_strava, sep = ",") %>% 
  mutate(But_strava = labels_comptagebutstrava[But_strava]) %>% 
  count(But_strava) %>%
  arrange(desc(n))

### Graphique
ggplot(comptage_but_strava, aes(x = reorder(But_strava, -n), y = n)) +
  geom_col(fill = "#FC4C02", alpha = 0.5) +
  labs(
    x = "Dans quel(s) but(s) utilisez-vous Strava ? (plusieurs réponses possibles)",
    y = "Nombre d'occurrences",
    title = ""
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

```

#### Fonctionnalité la plus utile dans la pratique
```{r graphique fonctionnalite strava}
### Affichage des labels
labels_comptagefonctionnalitétrava <- c(
  "1" = "Enregistrement de vos activités",
  "2" = "Suivi GPS",
  "3" = "Analyse des performances",
  "4" = "Segments",
  "5" = "Classements",
  "6" = "Challenges",
  "7" = "Clubs",
  "8" = "Planification d'itinéraire",
  "9" = "Evènements",
  "10" = "Heatmap (endroit où vous vous êtes le plus entraîné)",
  "11" = "Interactions sociales",
  "12" = "Kudos",
  "13" = "Suivi des progrès",
  "14" = "Autre"

)

###Comptage des différentes catégories
comptage_fonctionnalite_strava <- data %>%
  separate_rows(Fonctionnalité_strava, sep = ",") %>% 
  mutate(Fonctionnalité_strava = labels_comptagefonctionnalitétrava[Fonctionnalité_strava]) %>% 
  count(Fonctionnalité_strava) %>%
  arrange(desc(n))

### Graphique
ggplot(comptage_fonctionnalite_strava, aes(x = reorder(Fonctionnalité_strava, -n), y = n)) +
  geom_col(fill = "#FC4C02", alpha = 0.5) +
  labs(
    x = "Quelle(s) fonctionnalité(s) de Strava trouvez-vous le(s) plus utile(s) dans votre pratique ?",
    y = "Nombre d'occurrences",
    title = "",
    subtitle = ""
  ) +
  theme_minimal() +
  theme(legend.text = element_text(size = 8))+
  theme(axis.text.x = element_text(angle = 55, hjust = 1))

```

#### Restriction abonnés
```{r graphique restriction abonnes}
### Graphique
ggplot(data, aes(x = factor(Restriction_abonnés, levels = c(1, 2), labels = c("Uniquement les utilisateurs que j'accepte", "Tout le monde")))) +
  geom_bar(aes(fill = factor(Restriction_abonnés, levels = c(1, 2), labels = c("Uniquement les utilisateurs que j'accepte", "Tout le monde")), alpha=0.5)) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Qui peut s’abonner à votre compte Strava ?", y = "Nombre d'individus", fill="") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Désabonnement
```{r graphique desabonnement}
### Graphique
ggplot(data, aes(x = factor(Désabonnement, levels = c(1, 2), labels = c("Oui", "Non")))) +
  geom_bar(aes(fill = factor(Désabonnement, levels = c(1, 2), labels = c("Oui", "Non")), alpha=0.5)) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Vous êtes-vous déjà désabonné d’un compte d'un autre utilisateur ?", y = "Nombre d'individus", fill="") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Blocage
```{r graphique blocage}
###Graphique
ggplot(data, aes(x = factor(Blocage, levels = c(1, 2), labels = c("Oui", "Non")))) +
  geom_bar(aes(fill = factor(Blocage, levels = c(1, 2), labels = c("Oui", "Non")), alpha=0.5)) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Avez-vous déjà bloqué l’accès à votre compte à un autre utilisateur ?", y = "Nombre d'individus", fill="") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()

### Comptage du nombre d'individus qui ont déjà bloqué 
nbblocage<-nrow(data %>% filter (data$Blocage == "1"))
glue("Le nombre d'individus considérés {nbblocage}.")

###Graphique
ggplot(subset(data, Raisons_blocage != "NA"), 
       aes(x = factor(Raisons_blocage, levels = c(1, 2, 3), 
                      labels = c("Pour éviter de communiquer avec cet utilisateur", 
                                 "Pour éviter le harcèlement", 
                                 "Autre")))) +
  geom_bar(aes(fill = factor(Raisons_blocage, levels = c(1, 2, 3), 
                             labels = c("Pour éviter de communiquer avec cet utilisateur",                                         "Pour éviter le harcèlement", 
                                        "Autre"))), alpha = 0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "", x = "Raisons du blocage", y = "Nombre d'individus", fill = "") +
  theme_minimal() +
  theme(legend.position = "none")

```

#### Type d'abonnés
```{r graphique type abonnes}
### Affichage des labels
labels_comptagetypeabonnés <- c(
  "1" = "Des amis",
  "2" = "Des connaissances",
  "3" = "Des membres de votre famille",
  "4" =" Des collègues de travail",
  "5" = "Des influenceurs",
  "6" = "Des athlètes professionnels",
  "7" = "Autre"
)

### Comptage pour chaque catégorie
comptage_typeabonnés <- data %>%
  separate_rows(Type_abonnés, sep = ",") %>% 
  mutate(Type_abonnés = labels_comptagetypeabonnés[Type_abonnés]) %>% 
  count(Type_abonnés) %>%
  arrange(desc(n))

###Graphique
ggplot(comptage_typeabonnés, aes(x = reorder(Type_abonnés, -n), y = n)) +
  geom_col(fill = "#FC4C02", alpha = 0.5) +
  labs(
    x = "Parmi vos abonnés, vous avez : (plusieurs réponses possibles) ",
    y = "Nombre d'occurrences",
    title = "Répartition des types d'abonnés au sein de l'échantillon"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


#### Type d'abonnements suivis
```{r graphique type abonnements}
###Affichage des labels
labels_comptagetypeabonnements <- c(
  "1" = "Des amis",
  "2" = "Des connaissances",
  "3" = "Des membres de votre famille",
  "4" =" Des collègues de travail",
  "5" = "Des influenceurs",
  "6" = "Des athlètes professionnels",
  "7" = "Autre"
)

###Comptage pour chaque catégorie
comptage_typeabonnements <- data %>%
  separate_rows(Type_abonnements_suivis, sep = ",") %>% 
  mutate(Type_abonnements_suivis = labels_comptagetypeabonnements[Type_abonnements_suivis]) %>% 
  count(Type_abonnements_suivis) %>%
  arrange(desc(n))

###Graphique
ggplot(comptage_typeabonnements, aes(x = reorder(Type_abonnements_suivis, -n), y = n)) +
  geom_col(fill = "#FC4C02", alpha = 0.5) +
  labs(
    x = "Parmi vos abonnements, vous avez : (plusieurs réponses possibles) ",
    y = "Nombre d'occurrences",
    title = "Répartition des types d'abonnements au sein de l'échantillon"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

### Corrélations
```{r correlations entre les variables strava}
# Liste des variables à corréler avec l'âge
variables_strava <- c("SCORE_SIS", "SCORE_OSF", "SCORE_EXPO", "Club_Strava", 
                   "Kudos_reçus", "Fréquence_publication", "Fréquence_consultation", 
                   "Nb_abonnés", "Nb_abonnements", "Ancienneté_Strava")

# Dictionnaire des labels pour chaque variable
variable_labels_strava <- c(
  "SCORE_SIS" = "Score SIS",
  "SCORE_OSF" = "Score OSF",
  "SCORE_EXPO" = "Score d'Exposition",
  "Club_Strava" = "Appartenance à un club Strava",
  "Kudos_reçus" = "Nombre de kudos reçus par activité",
  "Fréquence_publication" = "Fréquence de publication",
  "Fréquence_consultation" = "Fréquence de consultation",
  "Nb_abonnés" = "Nombre d'abonnés",
  "Nb_abonnements" = "Nombre d'abonnements",
  "Ancienneté_Strava" = "Ancienneté sur Strava (années)"
)

correlation_matrix(data=data, variables=variables_strava)
```


# Lien données socio-démographiques - utilisation de Strava

### Age - Strava{.tabset}

La question est de savoir ici s'il existe des liens entre l'âge et l'utilisation de Strava. 

On peut tester les liens entre les variables Strava suivantes et l'âge : 

- Score SIS 
- Score OSF 
- Score exposition 
- Appartenance à des clubs Strava 
- Nombre de kudos reçus en moyenne par activité 
- Nombre de publications par semaine (fréquence de publication) 
- Nombre de consultations par semaine (fréquence de consultation) 
- Nombre d’abonnés 
- Nombre d’abonnements 
- Ancienneté sur Strava 
- Catégorie d’abonnement (gratuit/payant)

Il y a une faible corrélation entre l’âge et :

- Score SIS (-0.11)
- Fréquence publication (-0.12)
- Fréquence consultation (-0.18)
- Ancienneté Strava (0.24)

Il n'est pas possible de mettre en évidence des différences d'âge entre les individus ayant un abonnement payant et un abonnement gratuit (test t de Student, p>0.05). 

#### Corrélations

```{r correlation Strava Age}
# Calcul des corrélations pour toutes les variables avec "Age"
correlations_age <- map_df(variables_strava, ~ compute_correlations(.x, "Age", data))

# Ajout des labels des variables
correlations_age <- correlations_age %>%
  mutate(Variable = variable_labels_strava[Variable])

# Mise en forme conditionnelle de la colonne "Corr_Age"
correlations_age <- correlations_age %>%
  mutate(
    Corr_Age = case_when(
      as.numeric(abs(Corr_Age)) > 0.3 ~ paste0('<span style="color:green;">', Corr_Age, '</span>'),
      as.numeric(abs(Corr_Age)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_Age, '</span>'),
      as.numeric(abs(Corr_Age)) > 0.1 ~ paste0('<span style="color:red;">', Corr_Age, '</span>'),
      TRUE ~ as.character(Corr_Age)
    )
  )

# Affichage en HTML
kable(correlations_age, format = "html", escape = FALSE)
```

#### Visualisation graphique{.tabset}


##### SCORE SIS
```{r visualisation correlation age - strava}
plot_correlation("Age", "SCORE_SIS", data, list("Age" = "Âge (en années)", "SCORE_SIS" = "SCORE SIS"))
```   

##### Fréquence consultation
```{r freq cons age}
plot_correlation("Age", "Fréquence_consultation", data, list("Age" = "Âge (en années)", "Fréquence_consultation" = "Fréquence de consultation par semaine"))
```

##### Fréquence publication
```{r freq publi age}
plot_correlation("Age", "Fréquence_publication", data, list("Age" = "Âge (en années)", "Fréquence_publication" = "Fréquence de publication par semaine"))
```

##### Ancienneté Strava
```{r ancienneté strava age}
plot_correlation("Age", "Ancienneté_Strava", data, list("Age" = "Âge (en années)", "Ancienneté_Strava" = "Ancienneté sur Strava (en années)"))
```


#### Test t de Student
```{r test t student pour strava et age}
# Mapping des valeurs de Type_abonnement vers les labels souhaités
group_names <- c("1" = "Gratuit", "2" = "Payant")

# Appel de la fonction en précisant les labels pour le titre
table_typeabonnement_age <- analyse_t_test("Age", "Catégorie_abonnement", data, title_group = "catégorie d'abonnement",                  title_score = "Age",                                          group_names = group_names)

# Affichage du résultat en HTML
kable(table_typeabonnement_age, format = "html", escape = FALSE)

```

### Sexe - Strava{.tabset}

La question est de savoir ici s'il existe des liens entre le sexe et l'utilisation de Strava. 


On peut tester les liens entre les variables Strava suivantes et le sexe : 

- Score SIS 
- Score OSF 
- Score exposition 
- Appartenance à des clubs Strava 
- Nombre de kudos reçus en moyenne par activité 
- Nombre de publications par semaine (fréquence de publication) 
- Nombre de consultations par semaine (fréquence de consultation) 
- Nombre d’abonnés 
- Nombre d’abonnements 
- Ancienneté sur Strava 
- Catégorie d’abonnement (gratuit/payant)

Les moyennes sont significativement différentes entre hommes et femmes (test t de Student, p < 0.05) pour :

- Score exposition (F : 26,3 / H: 24,9)
- Appartenance à des clubs Strava (F : 2,23 / H : 3,06)
- Kudos reçus en moyenne par activité (F : 17,8 / H: 13,9)
- Fréquence publication par semaine (F : 4,3 / H: 3,7)
- Fréquence consultation par semaine (F : 5,34 / H : 4,92 )
- Nombre abonnés (F : 82,7 / H: 52)
- Nombre abonnements (F : 81,3 / H: 53,4)
- Ancienneté Strava (F : 5,3 / H: 4,4)

Il y a un lien entre le sexe et la catégorie abonnement (Khi² indépendance p< 0.01, hautement significatif, Cramer = 0,22, lien faible) :

- Femme : plus d'abonnements payants que prévu
- Homme : plus d'abonnements gratuits que prévu


#### Test t de Student
```{r test t student pour strava et sexe}
# Définition du mapping pour la variable de regroupement "Sexe"
group_names_sexe <- c("1" = "Homme", "2" = "Femme")

# Liste des variables continues à tester
variables_strava <- c("SCORE_SIS", "SCORE_OSF", "SCORE_EXPO", "Club_Strava", "Kudos_reçus", "Fréquence_publication", "Fréquence_consultation", "Nb_abonnés", "Nb_abonnements", "Ancienneté_Strava")

# Application de la fonction générique à chaque variable
table_strava_sexe <- purrr::map_df(variables_strava, ~ analyse_t_test(.x, "Sexe", data, title_group = "Sexe", title_score = .x, group_names = group_names_sexe))

# Affichage en HTML
knitr::kable(table_strava_sexe, format = "html", escape = FALSE)
```

#### Visualisation graphique
```{r graphique sexe - strava}
### Graphique Sexe - Score Expo
(ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = SCORE_EXPO,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Sexe",
       y = "SCORE EXPO",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() | 
   
### Graphique sexe - club strava
  
  (ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Club_Strava,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Sexe",
       y = "Club Strava",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()))

### Graphique sexe - freq consultation   
(ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Fréquence_consultation,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Sexe",
       y = "Fréquence consultation",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() |

   ### Graphique sexe - kudos reçus
   ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Kudos_reçus,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Sexe",
       y = "Kudos reçus en moyenne par activité",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
   )

### Graphique sexe - freq publi
(ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Fréquence_publication,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Sexe",
       y = "Fréquence publication",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() | 
   
    ### Graphique sexe - nb abonnés
   ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Nb_abonnés,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Sexe",
       y = "Nombre abonnés",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
   )

###Graphique sexe - nb abonnements
(ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Nb_abonnements,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Sexe",
       y = "Nombre abonnements",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() | 
   
    ### Graphique sexe- ancienneté strava
   ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Ancienneté_Strava,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Sexe",
       y = "Ancienneté Strava",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
   )

```



#### Khi² et Cramer

```{r abonnement et sexe}
# Application de la fonction générique pour Type_abonnement et Sexe
resultats_typeabonnement_sexe <- compute_chi2_cramer("Catégorie_abonnement", "Sexe", data)
table_typeabonnement_sexe <- resultats_typeabonnement_sexe$stats

# Affichage en HTML
knitr::kable(table_typeabonnement_sexe, format = "html", escape = FALSE)
```

#### Visualisation graphique
```{r heatmap categorie abonnement et sexe}
table_comparaison_typeabonnement_sexe <- data.frame(
  Catégorie_abonnement = rep(rownames(resultats_typeabonnement_sexe$observed), times = ncol(resultats_typeabonnement_sexe$observed)),
  Sexe = rep(colnames(resultats_typeabonnement_sexe$observed), each = nrow(resultats_typeabonnement_sexe$observed)),
  Observé = as.vector(resultats_typeabonnement_sexe$observed),
  Attendu = as.vector(resultats_typeabonnement_sexe$expected)
)

table_comparaison_typeabonnement_sexe$Catégorie_abonnement <- factor(
  table_comparaison_typeabonnement_sexe$Catégorie_abonnement, 
  levels = c("1", "2"), 
  labels = c("Gratuit", "Payant")
)

table_comparaison_typeabonnement_sexe$Sexe <- factor(
  table_comparaison_typeabonnement_sexe$Sexe, 
  levels = c("1", "2"), 
  labels = c("Femme", "Homme")
)

kable(table_comparaison_typeabonnement_sexe)

heatmap_categorieabonnement_sexe <- data %>%
    filter(!is.na(Catégorie_abonnement), !is.na(Sexe)) %>%
    group_by(Catégorie_abonnement, Sexe) %>%
    summarise(n = n(), .groups = "drop")

heatmap_categorieabonnement_sexe <- heatmap_categorieabonnement_sexe %>%
    mutate(Sexe = recode_factor(Sexe, `1` = "Homme", `2` = "Femme"),
           Catégorie_abonnement = recode_factor(Catégorie_abonnement, `1` = "Gratuit", `2` = "Payant")) 


ggplot(heatmap_categorieabonnement_sexe, aes(x = Sexe, y = Catégorie_abonnement, fill = (n/sum(n))*100)) +
    geom_tile(color = "#eff4f9") +
    scale_fill_gradient(low = "#eff4f9", high = "#FC4C02") +
    geom_text(aes(label = sprintf("%.1f%%", (n / sum(n)) * 100)), color = "black")+
    labs(title = "",
         x = "Sexe", 
         y = "Catégorie abonnement",
         fill = "Pourcentage") +
    theme_minimal() +
  scale_y_discrete()+
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
```



### Catégorie socio-professionnelle - Strava{.tabset}

La question est de savoir ici s’il existe des liens entre la catégorie socio-professionnelle et l’utilisation de Strava.

On peut tester les liens entre les variables Strava suivantes et les catégories socio-profesionnelles : 

- Score SIS 
- Score OSF 
- Score exposition 
- Appartenance à des clubs Strava 
- Nombre de kudos reçus en moyenne par activité 
- Nombre de publications par semaine (fréquence de publication) 
- Nombre de consultations par semaine (fréquence de consultation) 
- Nombre d’abonnés 
- Nombre d’abonnements 
- Ancienneté sur Strava 
- Catégorie d’abonnement (gratuit/payant)


Les moyennes des variables suivantes sont significativement différentes entre les catégories socio-professionnelles (ANOVA, p < 0.01, hautement significatif) :

- Score SIS
- Fréquence consultation
- Ancienneté Strava

Les moyennes pour le score d'exposition sont significativement différentes entre les catégories socio-professionelles (ANOVA, p < 0.05, significatif).

Les tests posts hoc permettent de mettre en évidence que :

- les étudiants (8) ont des moyennes significativement plus élevées que les artisans (2) et professions intermédiaires (4) pour le score SIS, de même pour les ouvriers (6) par rapport aux professions intermédiaires (4).
- les étudiants (8) ont des moyennes significativement plus élevées que les artisans (2), les cadres (3), les professions intermédiaires (4), les employés (5) et les retraités (7) pour la fréquence de consultation. 
- les étudiants (8) ont des moyennes significativement plus faibles que les artisans (2), les cadres (3) et les retraités (7) pour l’ancienneté sur Strava. 


Il existe un lien entre la catégorie socio-professionelle et la catégorie d'abonnement (Khi² indépendance p<0.05, significatif, Cramer = 0,15, lien faible). Attention, il est à noter que le test de Khi² est partiellement valable étant donné que certaines sous-catégories ont des effectifs <5.

- Cadres : plus d'abonnements payants que prévu
- Employés : plus d'abonnements gratuits que prévu
- Artisans : plus d'abonnements payants que prévu
- Retraités : plus d'abonnements gratuits que prévu

#### ANOVA
```{r anova csp strava }
# Exécution des ANOVA et des moyennes
anova_results_csp <- map_dfr(variables_strava, ~ compute_anova(.x, "Catégorie", data))
mean_results_csp <- map_dfr(variables_strava, ~ compute_means(.x, "Catégorie", data))

# Recodage des noms des catégories (changer les chiffres par les labels corrects)
colnames(mean_results_csp) <- c("Variable", "Agriculteurs", "Artisans", "Cadres", "Intermédiaires", "Employés", "Ouvriers", "Retraités", "Étudiants", "Autres")

# Recodage des noms des lignes 
rownames(mean_results_csp) <- c("Score SIS",
  "SCORE_OSF" = "Score OSF",
  "SCORE_EXPO" = "Score d'Exposition",
  "Club_Strava" = "Appartenance à un club Strava",
  "Kudos_reçus" = "Nombre de kudos reçus par activité",
  "Fréquence_publication" = "Fréquence de publication",
  "Fréquence_consultation" = "Fréquence de consultation",
  "Nb_abonnés" = "Nombre d'abonnés",
  "Nb_abonnements" = "Nombre d'abonnements",
  "Ancienneté_Strava" = "Ancienneté sur Strava (années)")

# Fusion des résultats ANOVA avec les moyennes
anova_strava_csp <- left_join(anova_results_csp, mean_results_csp, by = "Variable")

# Affichage du tableau formaté
knitr::kable(anova_strava_csp, format = "html", escape = FALSE)
```

#### Tests post hoc
```{r test post hoc strava et categorie socio}
# Application de la fonction sur toutes les variables de Strava
tukey_results_csp <- map_dfr(variables_strava, ~ compute_tukey(.x, "Catégorie", data))
tukey_signif_csp <- tukey_results_csp %>% filter(`p adj` < 0.05)

# Affichage des résultats sous forme de tableau HTML
knitr::kable(tukey_signif_csp, format = "html", escape = FALSE)
```


#### Visualisation graphique
```{r visualisation test post hoc}
ggplot(tukey_signif_csp, aes(x = Comparison, y = diff, fill = Variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_errorbar(aes(ymin = lwr, ymax = upr), width = 0.2, position = position_dodge(0.9)) +
  theme_minimal() +
  labs(title = "Comparaisons post-hoc (Tukey HSD)", 
       x = "Comparaison entre groupes", 
       y = "Différence de moyenne") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


#### Khi² et Cramer
```{r abonnement et categorie khi2}
# Application de la fonction générique pour Catégorie_abonnement et CSP
resultats_typeabonnement_categorie <- compute_chi2_cramer("Catégorie_abonnement", "Catégorie", data)
table_typeabonnement_categorie <- resultats_typeabonnement_categorie$stats  # Résumé Khi²

# Affichage en HTML
knitr::kable(table_typeabonnement_categorie, format = "html", escape = FALSE)

```

#### Visualisation graphique
```{r heatmap categorie abonnement et categorie}
table_comparaison_typeabonnement_categorie <- data.frame(
  Catégorie_abonnement = rep(rownames(resultats_typeabonnement_categorie$observed), times = ncol(resultats_typeabonnement_categorie$observed)),
  Catégorie = rep(colnames(resultats_typeabonnement_categorie$observed), each = nrow(resultats_typeabonnement_categorie$observed)),
  Observé = as.vector(resultats_typeabonnement_categorie$observed),
  Attendu = as.vector(resultats_typeabonnement_categorie$expected)
)

table_comparaison_typeabonnement_categorie$Catégorie <- factor(
  table_comparaison_typeabonnement_categorie$Catégorie, 
  levels = c("1", "2", "3", "4", "5", "6", "7", "8", "9"), 
  labels = c("Agriculteurs", "Artisans", "Cadres", "Intermédiaires", "Employés", "Ouvriers", "Retraités", "Etudiants", "Autres")

)

table_comparaison_typeabonnement_categorie$Catégorie_abonnement <- factor(
  table_comparaison_typeabonnement_categorie$Catégorie_abonnement, 
  levels = c("1", "2"), 
  labels = c("Gratuit", "Payant"))

kable(table_comparaison_typeabonnement_categorie)

heatmap_categorieabonnement_categorie <- data %>%
    filter(!is.na(Catégorie_abonnement), !is.na(Catégorie)) %>%
    group_by(Catégorie_abonnement, Catégorie) %>%
    summarise(n = n(), .groups = "drop")

heatmap_categorieabonnement_categorie <- heatmap_categorieabonnement_categorie %>%
    mutate(Catégorie = recode_factor(Catégorie, `1`= "Agriculteurs", `2`= "Artisans", `3`="Cadres", `4`= "Intermédiaires", `5`="Employés", `6`="Ouvriers", `7`= "Retraités", `8`="Etudiants", `9`="Autres"),
           Catégorie_abonnement = recode_factor(Catégorie_abonnement, `1` = "Gratuit", `2` = "Payant") ) 


ggplot(heatmap_categorieabonnement_categorie, aes(x = Catégorie, y = Catégorie_abonnement, fill = (n/sum(n))*100)) +
    geom_tile(color = "#eff4f9") +
    scale_fill_gradient(low = "#eff4f9", high = "#FC4C02") +
    geom_text(aes(label = sprintf("%.1f%%", (n / sum(n)) * 100)), color = "black")+
    labs(title = "",
         x = "CSP", 
         y = "Catégorie abonnement",
         fill = "Pourcentage") +
    theme_minimal() +
  scale_y_discrete()+
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

# Caractéristiques sportives

### Ancienneté et niveau{.tabset}

#### Répartition de l'ancienneté
```{r graphique anciennete}
### Statistiques
data_resumeAnciennete<- data%>%
    summarise(
    Moyenne = mean(Ancienneté_pratique, na.rm = TRUE),
    Médiane = median(Ancienneté_pratique, na.rm = TRUE),
    Ecart_type= sd(Ancienneté_pratique, na.rm=TRUE)
  )

kable(data_resumeAnciennete)

###Statistiques pour graphique
data_resumeancienneteround<- data%>%
  summarise(
    moyenne = round(mean(Ancienneté_pratique, na.rm = TRUE),0),
    median = round(median(Ancienneté_pratique, na.rm = TRUE),0),
    q1 = round(quantile(Ancienneté_pratique, 0.25, na.rm=T),0),
    q3 = round(quantile(Ancienneté_pratique, 0.75, na.rm=T),0)
  )

###Affichage statistiques graphique
vlinesanciennete <- data.frame(
  label = c("Q1", "Médiane", "Moyenne", "Q3"),
  xintercept = c(data_resumeancienneteround$q1, data_resumeancienneteround$median, data_resumeancienneteround$moyenne, data_resumeancienneteround$q3)
)
vlinesanciennete$annotation <- paste(vlinesanciennete$label, ":", vlinesanciennete$xintercept)

### Graphique
ggplot(data) +
  geom_histogram(aes(x = Ancienneté_pratique), fill = "#FC4C02", binwidth=5, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$Ancienneté_pratique, na.rm = TRUE), 
                                max(data$Ancienneté_pratique, na.rm = TRUE), 
                                by = 5))+
  labs(title = "Répartition de l'ancienneté dans la pratique au sein de l'échantillon",
       x = "Ancienneté dans la pratique (en années)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesanciennete, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesanciennete, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

#### Répartition de l'ancienneté par sexe
```{r graphique anciennete en fonction du sexe}
### Statistiques
data_resumeAncienneteSexe<- data%>%
  mutate(Sexe = ifelse(Sexe == 1, "Homme", "Femme")) %>%
  group_by(Sexe)%>%
    summarise(
    Moyenne = mean(Ancienneté_pratique, na.rm = TRUE),
    Médiane = median(Ancienneté_pratique, na.rm = TRUE),
    Ecart_type= sd(Ancienneté_pratique, na.rm=TRUE)
  )

kable(data_resumeAncienneteSexe)

### Graphique
ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Ancienneté_pratique,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "Répartition de l'ancienneté dans la pratique par sexe au sein de l'échantillon",
       x = "Sexe",
       y = "Ancienneté dans la pratique (en années)",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Niveau de course à pied
```{r graphique niveau de cap}
### Statistiques
data_resumeniveau<- data%>%
  summarise(
    Moyenne = mean(Niveau, na.rm = TRUE),
    Médiane = median(Niveau, na.rm = TRUE),
    Ecart_type= sd(Niveau, na.rm=TRUE)
  )

kable(data_resumeniveau)

### Graphique
ggplot(data, aes(x = factor(Niveau, 
                            levels = c(1, 2, 3, 4),
                            labels = c("Débutant(e)", "Intermédiaire", "Confirmé(e)", "Expert(e)")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(aes(label = ..count..), 
            stat = "count",
            vjust = -0.5,
            size = 2) +
  labs(title = "Répartition des niveaux de course à pied au sein de l'échantillon",
       x = "Niveau dans la course à pied",
       y = "Nombre d'individus", fill="Niveau dans la course à pied") +
  theme_minimal() +
  theme(legend.position = "none")
```

#### Niveau de course à pied par sexe
```{r graphique niveau cap par sexe}
### Statistiques
data_resumeniveauSexe<- data%>%
  mutate(Sexe = ifelse(Sexe == 1, "Homme", "Femme")) %>%
  group_by(Sexe)%>%
  summarise(
    Moyenne = mean(Niveau, na.rm = TRUE),
    Médiane = median(Niveau, na.rm = TRUE),
    Ecart_type= sd(Niveau, na.rm=TRUE)
  )

kable(data_resumeniveauSexe)

### Graphique
ggplot(data) +  
  geom_bar(aes(x = factor(data$Niveau, levels = c(1, 2, 3, 4), labels = c("Débutant(e)", "Intermédiaire", "Confirmé(e)", "Expert(e)")), fill = factor(data$Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), position = "fill", alpha=0.5) +
  geom_text(aes(x = factor(data$Niveau, levels = c(1, 2, 3, 4), labels = c("Débutant(e)", "Intermédiaire", "Confirmé(e)", "Expert(e)")), label = ..count.., group = factor(data$Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
                stat = "count", 
                position = position_fill(vjust = 0.5)) +
  labs(title = "Répartition des niveaux de course à pied par sexe au sein de l'échantillon",
       x = "Niveau dans la course à pied par sexe",
       y = "Nombre d'individus",
       fill = "Sexe") + 
  theme_minimal()+
  default_fill_colors()
```

### Entraînement{.tabset}

#### Fréquence d'entraînement
```{r graphique frequence entrainement}
### Conversion en numérique
data$Frequence_pratique <- as.numeric(as.character(data$Frequence_pratique))

### Statistiques
data_resumefreqentrainement<- data%>%
  summarise(
    Moyenne = mean(Frequence_pratique, na.rm = TRUE),
    Médiane = median(Frequence_pratique, na.rm = TRUE),
    Ecart_type= sd(Frequence_pratique, na.rm=TRUE)
  )

kable(data_resumefreqentrainement)

### Statistiques graphique
data_resumefrequenceround<- data %>%
  summarise(
    moyenne = round(mean(Frequence_pratique, na.rm = TRUE),0),
    median = round(median(Frequence_pratique, na.rm = TRUE),0),
    q1 = round(quantile(Frequence_pratique, 0.25, na.rm=TRUE),0),
    q3 = round(quantile(Frequence_pratique, 0.75, na.rm=TRUE),0)
  )

### Affichage statistiques graphique
vlinesfrequence <- data.frame(
  label = c("Moyenne", "Médiane", "q1", "q2"),
  xintercept = c(data_resumefrequenceround$moyenne,data_resumefrequenceround$median, data_resumefrequenceround$q1, data_resumefrequenceround$q3 )
)
vlinesfrequence$annotation <- paste(vlinesfrequence$label, ":", vlinesfrequence$xintercept)

### Graphique
ggplot(data) +
  geom_histogram(aes(x = Frequence_pratique), fill = "#FC4C02", alpha=0.5, color="#FC4C02", binwidth = 1) +
  scale_x_continuous(breaks = seq(min(data$Frequence_pratique, na.rm = TRUE), 
                                max(data$Frequence_pratique, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition de la fréquence d'entraînement au sein de l'échantillon",
       x = "Nombre d'entraînement en course à pied par semaine", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesfrequence, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", linewidth = 0.5) +
  geom_text(data = vlinesfrequence, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

#### Fréquence d'entraînement par sexe
```{r graphique frequence entrainement par sexe}

data_resumefreqentrainementSexe<- data%>%
  mutate(Sexe = ifelse(Sexe == 1, "Homme", "Femme")) %>%
  group_by(Sexe)%>%
  summarise(
    Moyenne = mean(Frequence_pratique, na.rm = TRUE),
    Médiane = median(Frequence_pratique, na.rm = TRUE),
    Ecart_type= sd(Frequence_pratique, na.rm=TRUE)
  )

kable(data_resumefreqentrainementSexe)


ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Frequence_pratique,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "Répartition de la fréquence d'entraînement par sexe au sein de l'échantillon",
       x = "Sexe",
       y = "Nombre d'entraînement en course à pied par semaine",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Volume d'entraînement
```{r graphique volume entrainement}
###Conversion
data$Kilomètres <- as.numeric(as.character(data$Kilomètres))

###Statistiques
data_resumevolume<- data%>%
  summarise(
    Moyenne = mean(Kilomètres, na.rm = TRUE),
    Médiane = median(Kilomètres, na.rm = TRUE),
    Ecart_type= sd(Kilomètres, na.rm=TRUE)
  )

kable(data_resumevolume)

###Statistiques pour graphique
data_resumekmround<- data %>%
  summarise(
    moyenne = round(mean(Kilomètres, na.rm = TRUE),0),
    median = round(median(Kilomètres, na.rm = TRUE),0),
    q1 = round(quantile(Kilomètres, 0.25, na.rm=TRUE),0),
    q3 = round(quantile(Kilomètres, 0.75, na.rm=TRUE),0)
  )

### Affichage statistiques graphique
vlineskm <- data.frame(
  label = c("Q1", "Médiane", "Moyenne", "Q3"),
  xintercept = c(data_resumekmround$q1, data_resumekmround$median, data_resumekmround$moyenne, data_resumekmround$q3)
)
vlineskm$annotation <- paste(vlineskm$label, ":", vlineskm$xintercept)

### Graphique
ggplot(data) +
  geom_histogram(aes(x = Kilomètres), fill = "#FC4C02", alpha=0.5, color="#FC4C02", binwidth = 10) +
  scale_x_continuous(breaks = seq(min(data$Kilomètres, na.rm = TRUE), 
                                max(data$Kilomètres, na.rm = TRUE), 
                                by = 10))+
  labs(title = "Répartition du volume d'entraînement au sein de l'échantillon",
       x = "Nombre de kilomètres par semaine", 
       y = "Nombre d'individus") +
  geom_vline(data = vlineskm, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", linewidth = 0.5) +
  geom_text(data = vlineskm, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

#### Volume d'entraînement par sexe
```{r graphique volume entrainement par sexe}

data_resumevolumeSexe<- data%>%
  mutate(Sexe = ifelse(Sexe == 1, "Homme", "Femme")) %>%
  group_by(Sexe)%>%
  summarise(
    Moyenne = mean(Kilomètres, na.rm = TRUE),
    Médiane = median(Kilomètres, na.rm = TRUE),
    Ecart_type= sd(Kilomètres, na.rm=TRUE)
  )

kable(data_resumevolumeSexe)


ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Kilomètres,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "Répartition du volume d'entraînement par sexe au sein de l'échantillon",
       x = "Sexe",
       y = "Nombre de kilomètres par semaine",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Volume et fréquence
```{r heatmap volume et frequence}
### Création variable
heatmap_volume_frequence <- data %>%
    filter(!is.na(freqentrainement_category), !is.na(kmentrainement_category)) %>%
    group_by(freqentrainement_category, kmentrainement_category) %>%
    summarise(n = n(), .groups = "drop")

### Graphique
ggplot(heatmap_volume_frequence, aes(x = freqentrainement_category, y = kmentrainement_category, fill = (n/sum(n))*100)) +
    geom_tile(color = "#eff4f9") +
    scale_fill_gradient(low = "#eff4f9", high = "#FC4C02") +
    geom_text(aes(label = sprintf("%.1f%%", (n / sum(heatmap_volume_frequence$n)) * 100)), color = "black")+
    labs(title = "Répartition des coureurs selon fréquence et volume d'entraînement au sein de l'échantillon",
         x = "Nombre de séances par semaine", 
         y = "Nombre de kilomètres par semaine",
         fill = "Pourcentage") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


### Compétitions{.tabset}

#### Nombre de compétitions par an
```{r graphique nb competitions}
### Conversion en numérique
data$Compétitions <- as.numeric(as.character(data$Compétitions))

### Statistiques
data_resumeCompetition<- data%>%
  summarise(
    Moyenne = mean(Compétitions, na.rm = TRUE),
    Médiane = median(Compétitions, na.rm = TRUE),
    Ecart_type= sd(Compétitions, na.rm=TRUE)
  )

kable(data_resumeCompetition)

### Statistiques graphique
data_resumecompetitionround<- data %>%
  summarise(
    moyenne = round(mean(Compétitions, na.rm = TRUE),0),
    median = round(median(Compétitions, na.rm = TRUE),0),
    q1 = round(quantile(Compétitions, 0.25, na.rm=TRUE),0),
    q3 = round(quantile(Compétitions, 0.75, na.rm=TRUE),0)
  )


### Affichage statistiques graphique
vlinescompetition <- data.frame(
  label = c("Q1", "Médiane", "Moyenne", "Q3"),
  xintercept = c(data_resumecompetitionround$q1, data_resumecompetitionround$median, data_resumecompetitionround$moyenne, data_resumecompetitionround$q3)
)
vlinescompetition$annotation <- paste(vlinescompetition$label, ":", vlinescompetition$xintercept)

### Graphique
ggplot(data) +
  geom_histogram(aes(x = Compétitions), fill = "#FC4C02", alpha=0.5, color="#FC4C02", binwidth = 1) +
  scale_x_continuous(breaks = seq(min(data$Compétitions, na.rm = TRUE), 
                                max(data$Compétitions, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du nombre de compétitions par an au sein de l'échantillon",
       x = "Nombre de compétitions par an (objectifs principaux)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinescompetition, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", linewidth = 0.5) +
  geom_text(data = vlinescompetition, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

#### Nombre de compétitions par an par sexe
```{r graphique nb competition par sexe}

### Statistiques
data_resumecompetitionSexe<- data%>%
  mutate(Sexe = ifelse(Sexe == 1, "Homme", "Femme")) %>%
  group_by(Sexe)%>%
  summarise(
    Moyenne = mean(Compétitions, na.rm = TRUE),
    Médiane = median(Compétitions, na.rm = TRUE),
    Ecart_type= sd(Compétitions, na.rm=TRUE)
  )

kable(data_resumecompetitionSexe)

### Graphique
ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Compétitions,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "Répartition du nombre de compétitions par sexe par an au sein de l'échantillon",
       x = "Sexe",
       y = "Nombre de compétitions par an (objectifs principaux)",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Objectif 2025
```{r graphique objectif 2025}

### Graphique
ggplot(data, aes(x = factor(Objectif, levels = c(1, 2), labels = c("Oui", "Non")))) +
  geom_bar(aes(fill = factor(Objectif, levels = c(1, 2), labels = c("Oui", "Non")), alpha=0.5)) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Objectif de course 2025", y = "Nombre d'individus", fill="Pratique en club") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Type objectif 2025

```{r graphique type objectif 2025}
nbobjectif<-nrow(data %>% filter (data$Objectif == "1"))
glue("Le nombre d'individus considérés {nbobjectif}.")

### Graphique
ggplot(data, aes(x = factor(Niveau, 
                            levels = c(1, 2, 3, 4),
                            labels = c("20 K", "50 K", "100 K", "100 M")), 
                 fill = factor(Sexe, 
                              levels = c(1,2), 
                              labels = c("Homme","Femme"))
                 ))+ 
  geom_bar(position = "stack", alpha = 0.7) + 
geom_text(stat = "count", aes(label = ..count.., group = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
            position = position_stack(vjust = 0.5), size = 4)+ 
  labs(title = "Répartition des types d'objectifs au sein de l'échantillon",
       x = "Objectif principal 2025",
       y = "Nombre d'individus",
       fill = "Sexe") + 
  theme_minimal() +
  theme(legend.position = "top")+
  default_fill_colors()
```

### Caractéristiques de la pratique{.tabset}

#### Lieu de pratique
```{r graphique trail ou route}


### Graphique
ggplot(data, aes(x = factor(Lieu, levels = c(1, 2), labels = c("Sur route", "Trail")))) +
  geom_bar(aes(fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), position = "stack", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count.., group = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
            position = position_stack(vjust = 0.5), size = 4) +
  labs(title = "Répartition des lieux de pratique au sein de l'échantillon",
       x = "Lieu de pratique", y = "Nombre d'individus", fill="Sexe") +
  theme_minimal()+
  default_fill_colors()

```

#### Club
```{r graphique club pratique}


###Graphique
ggplot(data, aes(x = factor(Club, levels = c(1, 2), labels = c("Oui", "Non")))) +
  geom_bar(aes(fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), position = "stack", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count.., group = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
            position = position_stack(vjust = 0.5), size = 4) +
  labs(title = "Répartition de l'appartenance à un club au sein de l'échantillon",
       x = "Pratique en club", y = "Nombre d'individus", fill="Sexe") +
  theme_minimal()+
  default_fill_colors()

```

#### Mode
```{r graphique seul ou groupe}



### Graphique
ggplot(data, aes(x = factor(Mode, levels = c(1, 2), labels = c("Seul(e)", "En groupe")))) +
  geom_bar(aes(fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), position = "stack", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count.., group = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
            position = position_stack(vjust = 0.5), size = 4) +
  labs(title = "Répartition du mode de pratique au sein de l'échantillon",
       x = "Pratique seul(e) ou en groupe", y = "Nombre d'individus", fill="Sexe") +
  theme_minimal()+
  default_fill_colors()

```

#### Type coureur
```{r graphique type de coureur}
### Changement en catégorie
data <- data %>%
  mutate(Type_coureur_label = case_when(
    Type_coureur == "1 1 1" ~ "Route, Club, Seul(e)",
    Type_coureur == "1 2 1" ~ "Route, Pas de club, Seul(e)",
    Type_coureur == "1 1 2" ~ "Route, Club, En groupe",
    Type_coureur == "1 2 2" ~ "Route, Pas de club, En groupe",
    Type_coureur == "2 1 1" ~ "Trail, Club, Seul(e)",
    Type_coureur == "2 2 1" ~ "Trail, Pas de club, Seul(e)",
    Type_coureur == "2 1 2" ~ "Trail, Club, En groupe",
    Type_coureur == "2 2 2" ~ "Trail, Pas de club, En groupe",
    TRUE ~ "Autre"
  ))

table_type_coureur <- table(data$Type_coureur)  

###Graphique
ggplot(data, aes(y = reorder(Type_coureur_label, table(Type_coureur_label)[Type_coureur_label]))) +
  geom_bar(fill = "#FC4C02", alpha = 0.5) +
  geom_text(stat = "count", aes(label = ..count..), hjust = -0.3, size = 3) +
  labs(title = "Répartition des type de coureurs au sein de l'échantillon",
       y = "Lieu de pratique, Club ou non, Mode de pratique",
       x = "Nombre d'individus") +
  theme_minimal()
```

#### Coach
```{r graphique coach}

### Graphique
ggplot(data, aes(x = factor(Coach, levels = c(1, 2), labels = c("Oui", "Non")))) +
  geom_bar(aes(fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), position = "stack", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count.., group = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
            position = position_stack(vjust = 0.5), size = 4) +
  labs(title = "Répartition des pratiquants avec coach au sein de l'échantillon",
       x = "Pratique avec un coach", y = "Nombre d'individus", fill="Sexe") +
  theme_minimal()+
  default_fill_colors()


```

#### Programme d'entraînement
```{r graphique pgrm entrainement}

### Graphique
ggplot(data, aes(x = factor(Programme, levels = c(1, 2), labels = c("Oui", "Non")))) +
  geom_bar(aes(fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), position = "stack", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count.., group = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
            position = position_stack(vjust = 0.5), size = 4) +
  labs(title = "Répartition des pratiquants avec un programme au sein de l'échantillon",
       x = "Pratique avec un programme d'entraînement", y = "Nombre d'individus", fill="Sexe") +
  theme_minimal()+
  default_fill_colors()


```


### Blessure{.tabset}

#### Blessure
```{r graphique blessure}

### Graphique
ggplot(data, aes(x = factor(Blessure, levels = c(1, 2), labels = c("Oui", "Non")))) +
  geom_bar(aes(fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), position = "stack", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count.., group = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
            position = position_stack(vjust = 0.5), size = 4) +
  labs(title = "Répartition des pratiquants blessés au sein de l'échantillon",
       x = "Dans les 6 mois précédents, avez-vous eu une blessure liée à votre pratique ?", y = "Nombre d'individus", fill="Sexe") +
  theme_minimal()+
  default_fill_colors()

```

#### Pause
```{r graphique pause}
pauseblessure<-nrow(data %>% filter (data$Blessure == "1"))
glue("Le nombre d'individus considérés {pauseblessure}.")

### Graphique
ggplot(subset(data, Pause_blessure != "NA"), 
       aes(x = factor(Pause_blessure, 
                      levels = c(1, 2, 3, 4),
                      labels = c("Oui quelques jours", 
                                 "Oui quelques semaines", 
                                 "Oui quelques mois", 
                                 "Non")))) +
  geom_bar(fill = "#FC4C02", alpha = 0.5) +
  geom_text(stat = "count", aes(label = ..count..), 
            vjust = -0.5, size = 2) +
  labs(title = "Répartition des durées de pause à cause d'une blessure au sein de l'échantillon",
       x = "Durée de la pause imposée par une blessure due à la course à pied",
       y = "Nombre d'individus", 
       fill = "Durée de la pause") +
  theme_minimal() +
  theme(legend.position = "none")

```

# Lien utilisation de Strava - caractéristiques sportives (hypothèse 1)

Il s'agit de savoir s'il y a un lien entre l'utilisation de Strava et les caractéristiques sportives.

**Rappel de l'hypothèse 1 : plus les coureurs amateurs utilisent Strava, plus le nombre de kilomètres et d’entraînements par semaine, et le nombre de compétitions par an sont élevés.**

On peut tester les liens entre les variables Strava suivantes :

- Score SIS
- Score OSF
- Score exposition
- Appartenance à des clubs Strava
- Nombre de kudos reçus en moyenne par activité
- Nombre de publications par semaine (fréquence de publication)
- Nombre de consultations par semaine (fréquence de consultation)
- Nombre d'abonnés
- Nombre d'abonnements
- Ancienneté sur Strava
- Catégorie d'abonnement (gratuit/payant)

Avec les variables sportives suivantes :

- nombre de kilomètres par semaine (volume par semaine)
- nombre d'entraînements par semaine (fréquence entraînement)
- nombre de compétitions par an
- niveau
- type de coureur (trail/route, club/pas club, seul/en groupe)
- suivi d'un programme d'entraînement
- accompagnement par un coach
- type d'objectif 2025 s'il y en a un
- blessure ou non liée à la course à pied dans les 6 derniers mois
- durée de la pause d'une blessure liée à la course à pied

### Une première approche{.tabset}

#### Influence de Strava
```{r influence de strava}
### Statistiques
data_resumeStrava_influence <- data%>%
  summarise(
    Moyenne = mean(Strava_influence, na.rm = TRUE),
    Médiane = median(Strava_influence, na.rm = TRUE),
    Ecart_type = sd(Strava_influence, na.rm=TRUE))

kable(data_resumeStrava_influence)

###Graphique
ggplot(data, aes(x = factor(Strava_influence, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Strava influence mon expérience en tant que coureur(se).", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Performance
```{r performance}
###Statistiques
data_resumeStrava_perf <- data%>%
  summarise(
    Moyenne = mean(Strava_performance, na.rm = TRUE),
    Médiane = median(Strava_performance, na.rm = TRUE),
    Ecart_type = sd(Strava_performance, na.rm=TRUE))

kable(data_resumeStrava_influence)

### Graphique
ggplot(data, aes(x = factor(Strava_performance, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Depuis que j'utilise Strava, j'ai amélioré mes performances.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Fréquence
```{r frequence}
### Statistiques
data_resumeStrava_freq <- data%>%
  summarise(
    Moyenne = mean(Strava_fréquence, na.rm = TRUE),
    Médiane = median(Strava_fréquence, na.rm = TRUE),
    Ecart_type = sd(Strava_fréquence, na.rm=TRUE))

kable(data_resumeStrava_freq)

### Graphique
ggplot(data, aes(x = factor(Strava_fréquence, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Depuis que j'utilise Strava, je cours plus souvent.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Kilomètres
```{r km strava}
### Statistiques
data_resumeStrava_km <- data%>%
  summarise(
    Moyenne = mean(Strava_km, na.rm = TRUE),
    Médiane = median(Strava_km, na.rm = TRUE),
    Ecart_type = sd(Strava_km, na.rm=TRUE))

kable(data_resumeStrava_km)

### Graphique
ggplot(data, aes(x = factor(Strava_km, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Depuis que j'utilise Strava, je cours plus de kilomètres par semaine.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Compétitions
```{r compétitions strava}
### Statistiques
data_resumeStrava_compétitions <- data%>%
  summarise(
    Moyenne = mean(Strava_compétition, na.rm = TRUE),
    Médiane = median(Strava_compétition, na.rm = TRUE),
    Ecart_type = sd(Strava_compétition, na.rm=TRUE))

kable(data_resumeStrava_compétitions)

### Graphique
ggplot(data, aes(x = factor(Strava_compétition, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Depuis que j'utilise Strava, je cours plus de kilomètres par semaine.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Ignorance blessure

```{r graph blessure Strava}
###Statistiques
data_resumeStrava_blessure <- data%>%
  summarise(
    Moyenne = mean(Strava_blessure, na.rm = TRUE),
    Médiane = median(Strava_blessure, na.rm = TRUE),
    Ecart_type = sd(Strava_blessure, na.rm=TRUE))

kable(data_resumeStrava_blessure)

### Graphique
ggplot(data, aes(x = factor(Strava_blessure, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Utiliser Strava me pousse à ignorer des signaux de fatigue ou blessure.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### Ajout entraînement

```{r graph ajout entrainement Strava}
###Statistiques
data_resumeStrava_change <- data%>%
  summarise(
    Moyenne = mean(Strava_change, na.rm = TRUE),
    Médiane = median(Strava_change, na.rm = TRUE),
    Ecart_type = sd(Strava_change, na.rm=TRUE))

kable(data_resumeStrava_change)

### Graphique
ggplot(data, aes(x = factor(Strava_change, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Si je n’ai pas prévu de faire un entraînement, le fait de regarder Strava peut me faire changer d’avis.") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### Changement entraînement

```{r graph change entrainement Strava}

nbcoach<-nrow(data %>% filter (data$Strava_entraînement != "NA"))
glue("Le nombre d'individus considérés {nbcoach}.")

### Statistiques
data_resumeStrava_entrainement <- data%>%
  filter(data$Strava_entraînement != "NA") %>%
  mutate(Strava_entraînement = as.numeric(Strava_entraînement))%>%
  summarise(
    Moyenne = mean(Strava_entraînement, na.rm = TRUE),
    Médiane = median(Strava_entraînement, na.rm = TRUE),
    Ecart_type = sd(Strava_entraînement, na.rm=TRUE))

kable(data_resumeStrava_entrainement)

### Graphique
ggplot(data %>% filter(Strava_entraînement!="NA"), aes(x = factor(Strava_entraînement, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "J'ai déjà modifié un entraînement prévu par mon entraîneur/plan d'entraînement à cause de Strava.") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### Changement programme

```{r graph change programme Strava}

nbpgrm<-nrow(data %>% filter (data$Strava_programme != "NA"))
glue("Le nombre d'individus considérés {nbcoach}.")

### Statistiques
data_resumeStrava_programme <- data%>%
  filter(data$Strava_entraînement != "NA") %>%
  mutate(Strava_programme = as.numeric(Strava_programme))%>%
  summarise(
    Moyenne = mean(Strava_programme, na.rm = TRUE),
    Médiane = median(Strava_programme, na.rm = TRUE),
    Ecart_type = sd(Strava_programme, na.rm=TRUE))

kable(data_resumeStrava_programme)

### Graphique
ggplot(data %>% filter(Strava_programme!="NA"), aes(x = factor(Strava_programme, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "J'ai déjà modifié mon programme d'entraînement à cause de Strava.") +
  theme_minimal()+
  theme(legend.position = "none")

```



### Statistiques{.tabset}


```{r alpha cronbach sis osf expo}
glue ("Rappel : l'alpha de Cronbach sur le SIS est {cronbachSIS$alpha}, sur le score OSF est {cronbachOSF$alpha} et sur le score EXPO {cronbachExpo$alpha}.")
```

#### Corrélations{.tabset}
##### Nombre d'entraînement par semaine
```{r correlation strava fréquence pratique}
# Calcul des corrélations pour toutes les variables avec "Frequence_pratique"
correlations_freqpratique <- map_df(variables_strava, ~ compute_correlations(.x, "Frequence_pratique", data))

# Ajout des labels des variables
correlations_freqpratique <- correlations_freqpratique %>%
  mutate(Variable = variable_labels_strava[Variable])

# Mise en forme conditionnelle de la colonne "Corr_freqpratique"
correlations_freqpratique <- correlations_freqpratique %>%
  mutate(
    Corr_Frequence_pratique = case_when(
      as.numeric(abs(Corr_Frequence_pratique)) > 0.3 ~ paste0('<span style="color:green;">', Corr_Frequence_pratique, '</span>'),
      as.numeric(abs(Corr_Frequence_pratique)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_Frequence_pratique, '</span>'),
      as.numeric(abs(Corr_Frequence_pratique)) > 0.1 ~ paste0('<span style="color:red;">', Corr_Frequence_pratique, '</span>'),
      TRUE ~ as.character(Corr_Frequence_pratique)
    )
  )

# Affichage en HTML
kable(correlations_freqpratique, format = "html", escape = FALSE)
```


```{r correlations strava et pratique cap}
variables_sportives <- c("Kilomètres", "Frequence_pratique", "Compétitions")

# Dictionnaire des labels pour chaque variable
variables_labels_sportives <- c(
  "Kilomètres" = "Nombre de kilomètres par semaine",
  "Frequence_pratique" = "Nombre d'entraînements par semaine", 
  "Compétitions" = "Compétitions")
```

##### Nombre de kilomètres par semaine

```{r nb kms par semaine correlation variables strava}

# Calcul des corrélations pour toutes les variables avec "Kilomètres"
correlations_Kilomètres <- map_df(variables_strava, ~ compute_correlations(.x, "Kilomètres", data))

# Ajout des labels des variables
correlations_Kilomètres <- correlations_Kilomètres%>%
  mutate(Variable = variable_labels_strava[Variable])

# Mise en forme conditionnelle de la colonne "Corr_km"
correlations_Kilomètres <- correlations_Kilomètres %>%
  mutate(
    Corr_Kilomètres = case_when(
      as.numeric(abs(Corr_Kilomètres)) > 0.3 ~ paste0('<span style="color:green;">', Corr_Kilomètres, '</span>'),
      as.numeric(abs(Corr_Kilomètres)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_Kilomètres, '</span>'),
      as.numeric(abs(Corr_Kilomètres)) > 0.1 ~ paste0('<span style="color:red;">', Corr_Kilomètres, '</span>'),
      TRUE ~ as.character(Corr_Kilomètres)
    )
  )

# Affichage en HTML
kable(correlations_Kilomètres, format = "html", escape = FALSE)
```
##### Compétitions

```{r nb compétitions correlation variables strava}

# Calcul des corrélations pour toutes les variables avec "Compétitions"
correlations_Compétitions <- map_df(variables_strava, ~ compute_correlations(.x, "Compétitions", data))

# Ajout des labels des variables
correlations_Compétitions <- correlations_Compétitions%>%
  mutate(Variable = variable_labels_strava[Variable])

# Mise en forme conditionnelle de la colonne "Corr_km"
correlations_Compétitions <- correlations_Compétitions %>%
  mutate(
    Corr_Compétitions = case_when(
      as.numeric(abs(Corr_Compétitions)) > 0.3 ~ paste0('<span style="color:green;">', Corr_Compétitions, '</span>'),
      as.numeric(abs(Corr_Compétitions)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_Compétitions, '</span>'),
      as.numeric(abs(Corr_Compétitions)) > 0.1 ~ paste0('<span style="color:red;">', Corr_Compétitions, '</span>'),
      TRUE ~ as.character(Corr_Compétitions)
    )
  )

# Affichage en HTML
kable(correlations_Compétitions, format = "html", escape = FALSE)
```


#### Visualisation graphique{.tabset}

##### Kudos reçus - Kilomètres par semaine
```{r graphique kudos reçus kms par semaine}
plot_correlation("Kudos_reçus", "Kilomètres", data, list("Kudos_reçus" = "Kudos reçus par activité", "Kilomètres" = "Kilomètres"))
```


##### Fréquence de publication - Kilomètres par semaine
```{r graphique freq publi kms par semaine}
plot_correlation("Fréquence_publication", "Kilomètres", data, list("Fréquence_publication" = "Fréquence de publication par semaine", "Kilomètres" = "Kilomètres"))
```

##### Fréquence de publication - Fréquence d'entraînement
```{r graphique freq publi freq entrainement par semaine}
plot_correlation("Fréquence_publication", "Frequence_pratique", data, list("Fréquence_publication" = "Fréquence de publication par semaine", "Frequence_pratique" = "Nombre d'entraînement par semaine"))
```

##### Nombre d'abonnés - Fréquence d'entraînement
```{r graphique nb abonnés freq entrainement par semaine}
plot_correlation("Nb_abonnés", "Frequence_pratique", data, list("Nb_abonnés" = "Nombre d'abonnés", "Frequence_pratique" = "Nombre d'entraînement par semaine"))
```

##### Nombres d'abonnés - Kilomètres par semaine
```{r graphique nb abonnés kms par semaine}
plot_correlation("Nb_abonnés", "Kilomètres", data, list("Nb_abonnés" = "Nombre d'abonnés", "Kilomètres" = "Nombre de kilomètres par semaine"))
```

##### Nombre d'abonnements - Fréquence d'entraînement
```{r graphique nb abonnements freq entrainement par semaine}
plot_correlation("Nb_abonnements", "Frequence_pratique", data, list("Nb_abonnements" = "Nombre d'abonnements", "Frequence_pratique" = "Nombre d'entraînement par semaine"))
```

##### Nombres d'abonnements - Kilomètres par semaine
```{r graphique nb abonnements kms par semaine}
plot_correlation("Nb_abonnements", "Kilomètres", data, list("Nb_abonnements" = "Nombre d'abonnements", "Kilomètres" = "Nombre de kilomètres par semaine"))
```

#### Khi² et Cramer
```{r khi2 cramer pour lien caractéristiques sportive et type abonnement}
### Lien Niveau et variables strava
chi2_typeabonnement_niveau <-chisq.test (table(data$Catégorie_abonnement, data$Niveau))
cramer_typeabonnement_niveau <- assocstats(table(data$Catégorie_abonnement, data$Niveau))

### Lien Type de coureur et variable strava
chi2_typeabonnement_Type_coureur <-chisq.test (table(data$Catégorie_abonnement, data$Type_coureur))
cramer_typeabonnement_Type_coureur <- assocstats(table(data$Catégorie_abonnement, data$Type_coureur))
### Lien Coach et variable strava

chi2_typeabonnement_Coach <-chisq.test (table(data$Catégorie_abonnement, data$Coach))
cramer_typeabonnement_Coach <- assocstats(table(data$Catégorie_abonnement, data$Coach))


### Lien programme et variable strava

chi2_typeabonnement_Programme <-chisq.test (table(data$Catégorie_abonnement, data$Programme))
cramer_typeabonnement_Programme <- assocstats(table(data$Catégorie_abonnement, data$Programme))


### Lien objectif et variable strava

chi2_typeabonnement_Objectif_KM <-chisq.test (table(data$Catégorie_abonnement, data$Objectif_KM))
cramer_typeabonnement_Objectif_KM <- assocstats(table(data$Catégorie_abonnement, data$Objectif_KM))


### Lien blessure et variable strava

chi2_typeabonnement_Blessure <-chisq.test (table(data$Catégorie_abonnement, data$Blessure))
cramer_typeabonnement_Blessure <- assocstats(table(data$Catégorie_abonnement, data$Blessure))


### Lien pause blessure et variable strava

chi2_typeabonnement_Pause_blessure <-chisq.test (table(data$Catégorie_abonnement, data$Pause_blessure))
cramer_typeabonnement_Pause_blessure <- assocstats(table(data$Catégorie_abonnement, data$Pause_blessure))

```



```{r}
table_Pratique_Independance <- data.frame(
  Variable = c("Lien catégorie abonnement et niveau", "Lien catégorie abonnement et type coureur", "Lien catégorie abonnement et coach", "Lien catégorie abonnement et programme", "Lien catégorie abonnement et objectif", "Lien catégorie abonnement et blessure", "Lien catégorie abonnement et pause"),
  Khi2_indépendance = round(c(chi2_typeabonnement_niveau$statistic, chi2_typeabonnement_Type_coureur$statistic, chi2_typeabonnement_Coach$statistic,  chi2_typeabonnement_Programme$statistic, chi2_typeabonnement_Objectif_KM$statistic,  chi2_typeabonnement_Blessure$statistic, chi2_typeabonnement_Pause_blessure$statistic),2),
  P.value = c(chi2_typeabonnement_niveau$p.value,  chi2_typeabonnement_Type_coureur$p.value, chi2_typeabonnement_Coach$p.value,  chi2_typeabonnement_Programme$p.value,  chi2_typeabonnement_Objectif_KM$p.value,  chi2_typeabonnement_Blessure$p.value, chi2_typeabonnement_Pause_blessure$p.value),
  Significatif = ifelse(c(chi2_typeabonnement_niveau$p.value,  chi2_typeabonnement_Type_coureur$p.value, chi2_typeabonnement_Coach$p.value,  chi2_typeabonnement_Programme$p.value,  chi2_typeabonnement_Objectif_KM$p.value,  chi2_typeabonnement_Blessure$p.value, chi2_typeabonnement_Pause_blessure$p.value) < 0.05, "< 0.05", " ≥ 0.05"),
  Coefficient_Cramer = round(c(cramer_typeabonnement_niveau$cramer,  cramer_typeabonnement_Type_coureur$cramer, cramer_typeabonnement_Coach$cramer,  cramer_typeabonnement_Programme$cramer, cramer_typeabonnement_Objectif_KM$cramer,  cramer_typeabonnement_Blessure$cramer, cramer_typeabonnement_Pause_blessure$cramer),2)
)

kable(table_Pratique_Independance, format = "html", escape = FALSE)

```

#### Visualisation graphique{.tabset}

##### Niveau et catégorie d'abonnement
```{r heatmap niveau et categorie abonnement}
table_comparaison_typeabonnement_niveau <- data.frame(
  Catégorie_abonnement = rep(rownames(chi2_typeabonnement_niveau$observed), times = ncol(chi2_typeabonnement_niveau$observed)),
  Niveau = rep(colnames(chi2_typeabonnement_niveau$observed), each = nrow(chi2_typeabonnement_niveau$observed)),
  Observé = as.vector(chi2_typeabonnement_niveau$observed),
  Attendu = as.vector(chi2_typeabonnement_niveau$expected)
)

table_comparaison_typeabonnement_niveau$Catégorie_abonnement <- factor(
  table_comparaison_typeabonnement_niveau$Catégorie_abonnement, 
  levels = c("1", "2"), 
  labels = c("Gratuit", "Payant")
)

table_comparaison_typeabonnement_niveau$Niveau <- factor(
  table_comparaison_typeabonnement_niveau$Niveau, 
  levels = c("1", "2", "3", "4"),  
  labels = c("Débutant", "Intermédiaire", "Confirmé", "Expert")
)

kable(table_comparaison_typeabonnement_niveau, format = "html", escape = FALSE)

heatmap_categorieabonnement_niveau <- data %>%
    filter(!is.na(Catégorie_abonnement), !is.na(Niveau)) %>%
    group_by(Catégorie_abonnement, Niveau) %>%
    summarise(n = n(), .groups = "drop")

heatmap_categorieabonnement_niveau <- heatmap_categorieabonnement_niveau %>%
    mutate(Niveau = recode_factor(Niveau, `1` = "Débutant", `2` = "Intermédiaire", `3` = "Confirmé" , `4` = "Expert"),
           Catégorie_abonnement = recode_factor(Catégorie_abonnement, `1` = "Gratuit", `2` = "Payant"))

ggplot(heatmap_categorieabonnement_niveau, aes(x = Niveau, y = Catégorie_abonnement, fill = (n/sum(n))*100)) +
    geom_tile(color = "#eff4f9") +
    scale_fill_gradient(low = "#eff4f9", high = "#FC4C02") +
    geom_text(aes(label = sprintf("%.1f%%", (n / sum(heatmap_categorieabonnement_niveau$n)) * 100)), color = "black")+
    labs(title = "",
         x = "Niveau", 
         y = "Catégorie abonnement",
         fill = "Pourcentage") +
    theme_minimal() +
  scale_y_discrete()+
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


##### Type de coureur et catégorie d'abonnement
```{r type abonnement type coureur}

table_comparaison_typeabonnement_typecoureur <- data.frame(
  Catégorie_abonnement = rep(rownames(chi2_typeabonnement_Type_coureur$observed), times = ncol(chi2_typeabonnement_Type_coureur$observed)),
  Type_coureur = rep(colnames(chi2_typeabonnement_Type_coureur$observed), each = nrow(chi2_typeabonnement_Type_coureur$observed)),
  Observé = as.vector(chi2_typeabonnement_Type_coureur$observed),
  Attendu = as.vector(chi2_typeabonnement_Type_coureur$expected)
)

table_comparaison_typeabonnement_typecoureur$Catégorie_abonnement <- factor(
  table_comparaison_typeabonnement_typecoureur$Catégorie_abonnement, 
  levels = c("1", "2"), 
  labels = c("Gratuit", "Payant")
)

table_comparaison_typeabonnement_typecoureur$Type_coureur <- factor(
  table_comparaison_typeabonnement_typecoureur$Type_coureur, 
  levels = c("1 1 1", "1 2 1", "1 1 2", "1 2 2", "2 1 1", "2 2 1", "2 1 2", "2 2 2"),  
  labels = c("Route, club, seul", "Route, pas de club, seul", "Route, club, en groupe", "Route, pas de club, en groupe", "Trail, club, seul", "Tail, pas de club, seul", "Trail, club, en groupe", "Trail, pas de club, en groupe")
)



kable(table_comparaison_typeabonnement_typecoureur, format = "html", escape = FALSE)

heatmap_categorieabonnement_typecoureur <- data %>%
    filter(!is.na(Catégorie_abonnement), !is.na(Type_coureur)) %>%
    group_by(Catégorie_abonnement, Type_coureur) %>%
    summarise(n = n(), .groups = "drop")

heatmap_categorieabonnement_typecoureur <- heatmap_categorieabonnement_typecoureur %>%
    mutate(Type_coureur = recode_factor(Type_coureur, `1 1 1` = "Route, club, seul", `1 2 1` = "Route, pas de club, seul", `1 1 2` = "Route, club, en groupe" , `1 2 2` = "Route, pas de club, en groupe", `2 1 1` = "Trail, club, seul", `2 2 1` = "Tail, pas de club, seul", `2 1 2` = "Trail, club, en groupe" , `2 2 2` = "Trail, pas de club, en groupe"),
           Catégorie_abonnement = recode_factor(Catégorie_abonnement, `1` = "Gratuit", `2` = "Payant"))


ggplot(heatmap_categorieabonnement_typecoureur, aes(x = Type_coureur, y = Catégorie_abonnement, fill = (n/sum(n))*100)) +
    geom_tile(color = "#eff4f9") +
    scale_fill_gradient(low = "#eff4f9", high = "#FC4C02") +
    geom_text(aes(label = sprintf("%.1f%%", (n / sum(heatmap_categorieabonnement_typecoureur$n)) * 100)), color = "black")+
    labs(title = "",
         x = "Type de coureur (Lieu/Club/Mode)", 
         y = "Catégorie abonnement",
         fill = "Pourcentage") +
    theme_minimal() +
  scale_y_discrete()+
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
```



##### Objectif et catégorie d'abonnement
```{r heatmap objectif et catégorie abonnement}
table_comparaison_typeabonnement_objectif <- data.frame(
  Catégorie_abonnement = rep(rownames(chi2_typeabonnement_Objectif_KM$observed), times = ncol(chi2_typeabonnement_Objectif_KM$observed)),
  Objectif_KM = rep(colnames(chi2_typeabonnement_Objectif_KM$observed), each = nrow(chi2_typeabonnement_Objectif_KM$observed)),
  Observé = as.vector(chi2_typeabonnement_Objectif_KM$observed),
  Attendu = as.vector(chi2_typeabonnement_Objectif_KM$expected)
)


table_comparaison_typeabonnement_objectif$Catégorie_abonnement <- factor(
  table_comparaison_typeabonnement_objectif$Catégorie_abonnement, 
  levels = c("1", "2"), 
  labels = c("Gratuit", "Payant")
)

table_comparaison_typeabonnement_objectif$Objectif_KM<- factor(
  table_comparaison_typeabonnement_objectif$Objectif_KM, 
  levels = c("0", "1", "2", "3", "4"),  
  labels = c("Pas d'objectif", "20 K", "50 K", "100 K", "100 M")
)

kable(table_comparaison_typeabonnement_objectif, format = "html", escape = FALSE)

heatmap_categorieabonnement_objectif <- data %>%
    filter(!is.na(Catégorie_abonnement), !is.na(Objectif_KM)) %>%
    group_by(Catégorie_abonnement, Objectif_KM) %>%
    summarise(n = n(), .groups = "drop")

heatmap_categorieabonnement_objectif <- heatmap_categorieabonnement_objectif %>%
    mutate(Objectif_KM = recode_factor(Objectif_KM, `0` = "Pas d'objectif", `1` = "20 K", `2` = "50 K", `3` = "100 K" , `4` = "100 M"),
           Catégorie_abonnement = recode_factor(Catégorie_abonnement, `1` = "Gratuit", `2` = "Payant"))

ggplot(heatmap_categorieabonnement_objectif, aes(x = Objectif_KM, y = Catégorie_abonnement, fill = (n/sum(n))*100)) +
    geom_tile(color = "#eff4f9") +
    scale_fill_gradient(low = "#eff4f9", high = "#FC4C02") +
    geom_text(aes(label = sprintf("%.1f%%", (n / sum(heatmap_categorieabonnement_objectif$n)) * 100)), color = "black")+
    labs(title = "",
         x = "Objectif 2025", 
         y = "Catégorie abonnement",
         fill = "Pourcentage") +
    theme_minimal() +
  scale_y_discrete()+
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


#### Test t de Student
```{r test t student pour type abonnement et freq pratique}
t_typeabonnement_freqpratique <- t.test(as.numeric(Frequence_pratique) ~ as.factor(Catégorie_abonnement), data = data, var.equal = TRUE)

moyennesfreqpratique_typeabonnement <- data %>%
    group_by(Catégorie_abonnement) %>%
    summarise(Moyenne = mean(Frequence_pratique, na.rm = TRUE))

t_typeabonnement_km <- t.test(as.numeric(Kilomètres) ~ as.factor(Catégorie_abonnement), data = data, var.equal = TRUE)

moyenneskm_typeabonnement <- data %>%
    group_by(Catégorie_abonnement) %>%
    summarise(Moyenne = mean(Kilomètres, na.rm = TRUE))

t_typeabonnement_competitions <- t.test(as.numeric(Compétitions) ~ as.factor(Catégorie_abonnement), data = data, var.equal = TRUE)

moyennescompetitions_typeabonnement <- data %>%
    group_by(Catégorie_abonnement) %>%
    summarise(Moyenne = mean(Compétitions, na.rm = TRUE))

table_typeabonnement_pratique <- data.frame(
    Variable = c(
        "Catégorie d'abonnement et entrainement par semaine", 
        "Catégorie d'abonnement et kilomètres par semaine", 
        "Catégorie d'abonnement et nombre de compétitions"
    ),
    Student = c(
        as.numeric(t_typeabonnement_freqpratique$statistic), 
        as.numeric(t_typeabonnement_km$statistic), 
        as.numeric(t_typeabonnement_competitions$statistic)
    ),
    P_value = c(t_typeabonnement_freqpratique$p.value, t_typeabonnement_km$p.value, t_typeabonnement_competitions$p.value),
    
    Significatif = c(
        ifelse(t_typeabonnement_freqpratique$p.value < 0.05, "<0.05", "≥ 0.05"),
        ifelse(t_typeabonnement_km$p.value < 0.05, "<0.05", "≥ 0.05"),
        ifelse(t_typeabonnement_competitions$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Gratuit = c(
        moyennesfreqpratique_typeabonnement$Moyenne[1], 
        moyenneskm_typeabonnement$Moyenne[1], 
        moyennescompetitions_typeabonnement$Moyenne[1]
    ),
    Payant = c(
        moyennesfreqpratique_typeabonnement$Moyenne[2], 
        moyenneskm_typeabonnement$Moyenne[2], 
        moyennescompetitions_typeabonnement$Moyenne[2]
    )
)

kable(table_typeabonnement_pratique, format = "html", escape = FALSE)

```

#### Visualisation graphique
```{r type abonnement freq pratique}
(ggplot(data, aes(x = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")),
                 y = Frequence_pratique,
                 fill = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Catégorie d'abonnement",
       y = "Fréquence d'entraînement",
       fill = "Type d'abonnement") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() |
   
   ggplot(data, aes(x = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")),
                 y = Kilomètres,
                 fill = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Type d'abonnement",
       y = "Kilomètres par semaine",
       fill = "Type d'abonnement") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
  
  )
```

### Conclusion hypothèse 1

**Rappel de l'hypothèse 1 : plus les coureurs amateurs utilisent Strava, plus le nombre de kilomètres par semaine, d’entraînements par semaine, et de compétitions par an sont élevés.**

Le nombre de kilomètres par semaine est :

- faiblement corrélé au score d'exposition (0.13), à l'appartenance d'un club strava (0.20), à la fréquence de consultation (0.17) et l'ancienneté sur Strava (0.16)
- moyennenement corrélé au nombre de kudos reçus par activité (0.32), au nombre d'abonnés (0.38) et au nombre d'abonnements (0.35)
- corrélé de manière élévée avec la fréquence de publication (0.56)

Le nombre d'entraînement par semaine est : 

- faiblement corrélé au score d'exposition (0.12), à l'appartenance d'un club strava (0.20), au nombre de kudos reçus par activité (0.28) et à la fréquence de consultation (0.24).
- moyennement corrélé au nombre d'abonnés (0.36) et au nombre d'abonnements (0.31)
- corrélé de manière élévée avec la fréquence de publication (0.61)

C'est cohérent avec la réponse à la question "Depuis que j'utilise Strava, je cours plus de kilomètres par semaine" où 36% ont répondu "Plutôt d'accord"/"Totalement d'accord" et la réponse à la question "Depuis que j'utilise Strava, je cours plus souvent" où 34% ont répondu "Plutôt d'accord"/"Totalement d'accord".

*Pour rappel, l'un des buts principaux d'utilisation de Strava et l'une des fonctionnalités les plus appréciées est l'enregistrement d'une activité, ce qui déclenche automatiquement sur Strava la publication de l'activité.*

Le nombre de compétitions par an est faiblement corrélé à l'ensemble des variables sauf l'ancienneté sur Strava où il n'y a pas de corrélation : l'utilisation de Strava influence peu la participation aux compétitions.

C'est cohérent avec la réponse à la question "Depuis que j'utilise Strava, je cours plus de kilomètres par semaine" où 15% ont répondu "Totalement d'accord"/"Plutôt d'accord".

Il y a un lien entre la catégorie d'abonnement et :

- le niveau (Khi² indépendance, p<0.01, hautement significatif, Cramer = 0.15, lien faible). Les niveaux débutants et niveau intermédiaires prennent plus d'abonnements gratuits que prévus, les niveaux confirmés et experts prennent plus d'abonnements payants que prévus.
- le type de coureur (Khi² indépendance, p<0.01, Cramer = 0.18, lien faible). Les traileurs qui courent le plus souvent seul, appartenant à un club ou non prennent plus l'abonnement payant. Les autres types de coureurs prennent plus l'abonnement gratuit.
- le type d'objectif principal en 2025 (Khi² indépendance, p<0.01, Cramer = 0.22, lien faible). Les coureurs sans objectif ou avec un objectif de 20 kilomètres prennent plus l'abonnement gratuit. Les coureurs avec un objectif de 50 kilomètres ou plus prennent plus l'abonnement payant.

Les moyennes du nombre d'entraînements par semaine, du nombre de kilomètres par semaine et du nombre de compétitions par an sont significativement plus élévées chez les utilisateurs ayant un compte payant (test t de Student, p<0.01, hautement significatif).

# Mesure de l'auto-présentation

La présentation de soi est la tentative d’un individu de contrôler la façon dont les autres le perçoivent ^3^. Dans l'article de Russell (2023), il y a des témoignanges sur le contrôle : « Si c'est une course très lente, je ne la mettrais peut-être pas sur Strava.», « Je n'aime pas poster des courses qui ne font pas au moins 3 miles, parce que c'est un peu comme une course de mauviette, comme si vous ne terminiez pas au moins un 5K, pour moi, ce n'est pas une bonne journée. Vous devriez au moins être capable de faire un 5 km. Parce que je ne veux pas que mes followers se demandent pourquoi elle est si lente », « Parfois, je cours un ou deux kilomètres de plus, juste parce que ça a l'air mieux sur Strava. ». ^3^

Mais il y a également des témoignages qui se rapproche plus d'une présentation authentique : « Et donc je suppose que je me sens comme... plus capable d'être honnête et moi-même sur Strava et c'est moins une question de photos et d'image et plus une question de ma propre course », « Même si la course n'a pas été géniale, je dirai à l'avance que j'ai eu des difficultés mentales aujourd'hui... J'ai l'impression d'être très ouvert sur Strava en ce qui concerne les bons et les mauvais jours.» ^3^

Le Self-presentation and Upward Social Comparison Inclination Scale mesure l'auto-présentation sur les réseaux sociaux. ^10^ ^17^ L'échelle comporte initialement 7 items qui ont été traduits et adaptés à l'étude. Le SPAUSCIS mesure le degré de focalisation sur l'auto-présentation et la comparaison sociale ascendante sur les réseaux sociaux. Il évalue plusieurs aspects du comportement des adolescents sur les réseaux sociaux, notamment la recherche de feedback, l'auto-présentation "améliorée" et la comparaison sociale avec des personnes perçues commet "meilleures". Il est à noter que cette échelle a été utilisée auprès d'adolescent. Dans l'étude de Hjetland (2022) ^17^, l'alpha est de 0.87.

Suite au pré-test, un item a été enlevé dans l'étude sur Strava ("It is important to me that my posts receive many likes and/or comments"). L'échelle traduite et adaptée comporte donc **6 items**.

Un score bas au SPAUSCIS indique que l'utilisateur accord peu d'importance à leur image sur Strava (ne recherche pas activement du feedback, pas de stratégie d'auto-présentation, pas de comparaison aux utilisateurs perçus comme "meilleurs", pas de contrôle d'image) tandis qu'un score haut indique que l'utilisateur accorde beaucoup d'importance à son image sur Srava (recherche active de feedback, stratégie d'auto-présentation, comparaison aux autres, contrôle de l'image).

Les scores obtenus sur l'échantillon sont bas, ce qui signifie que les individus n'ont pas de stratégie d'auto-présentation pour paraître "meilleurs".

### SPAUSCIS{.tabset}

```{r SCORE SPAUSCIS alpha cronbach}
data_SPAUSCIS <- data[, c("SPAUSCIS_1", "SPAUSCIS_2", "SPAUSCIS_3", "SPAUSCIS_4", "SPAUSCIS_5", "SPAUSCIS_6")]
cronbachSPAUSCIS<-cronbach(data_SPAUSCIS)

glue ("L'alpha de Cronbach sur les {cronbachSPAUSCIS$number.of.items} items est de {cronbachSPAUSCIS$alpha}")
```

L'alpha de Cronbach est assez faible, cela peut s'expliquer par le fait que c'est une traduction et adaptation dans le cadre de cette étude du questionnaire d'origine mais également par le fait que ce questionnaire était destiné plutôt à des publics adolescents.

#### SPAUSCIS 1
```{r SPAUSCIS 1}
data_resumeSPAUSCIS1 <- data%>%
  summarise(
    Moyenne = mean(SPAUSCIS_1, na.rm = TRUE),
    Médiane = median(SPAUSCIS_1, na.rm = TRUE),
    Ecart_type = sd(SPAUSCIS_1, na.rm=TRUE))

kable(data_resumeSPAUSCIS1)


ggplot(data, aes(x = factor(SPAUSCIS_1, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je consacre beaucoup de temps et d'énergie à publier mes activités sur Strava.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SPAUSCIS 2
```{r SPAUSCIS 2}
data_resumeSPAUSCIS2 <- data%>%
  summarise(
    Moyenne = mean(SPAUSCIS_2, na.rm = TRUE),
    Médiane = median(SPAUSCIS_2, na.rm = TRUE),
    Ecart_type = sd(SPAUSCIS_2, na.rm=TRUE))

kable(data_resumeSPAUSCIS2)

ggplot(data, aes(x = factor(SPAUSCIS_2, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Il est important pour moi d’avoir beaucoup d’abonnés sur Strava.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SPAUSCIS 3
```{r SPAUSCIS 3}

data_resumeSPAUSCIS3 <- data%>%
  summarise(
    Moyenne = mean(SPAUSCIS_3, na.rm = TRUE),
    Médiane = median(SPAUSCIS_3, na.rm = TRUE),
    Ecart_type = sd(SPAUSCIS_3, na.rm=TRUE))

kable(data_resumeSPAUSCIS3)


ggplot(data, aes(x = factor(SPAUSCIS_3, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je supprime mes activités sur Strava qui ne reçoivent pas assez de kudos et/ou de commentaires.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SPAUSCIS 4
```{r SPAUSCIS 4}

data_resumeSPAUSCIS4 <- data%>%
  summarise(
    Moyenne = mean(SPAUSCIS_4, na.rm = TRUE),
    Médiane = median(SPAUSCIS_4, na.rm = TRUE),
    Ecart_type = sd(SPAUSCIS_4, na.rm=TRUE))

kable(data_resumeSPAUSCIS4)


ggplot(data, aes(x = factor(SPAUSCIS_4, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je retouche mes activités avant de les publier sur Strava pour qu’elles paraissent meilleures.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SPAUSCIS 5
```{r SPAUSCIS 5}

data_resumeSPAUSCIS5 <- data%>%
  summarise(
    Moyenne = mean(SPAUSCIS_5, na.rm = TRUE),
    Médiane = median(SPAUSCIS_5, na.rm = TRUE),
    Ecart_type = sd(SPAUSCIS_5, na.rm=TRUE))

kable(data_resumeSPAUSCIS5)


ggplot(data, aes(x = factor(SPAUSCIS_5, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Ce que d’autres coureurs publient sur Strava me rend moins satisfait(e) de mes propres performances.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SPAUSCIS 6
```{r SPAUSCIS 6}

data_resumeSPAUSCIS6 <- data%>%
  summarise(
    Moyenne = mean(SPAUSCIS_6, na.rm = TRUE),
    Médiane = median(SPAUSCIS_6, na.rm = TRUE),
    Ecart_type = sd(SPAUSCIS_6, na.rm=TRUE))

kable(data_resumeSPAUSCIS6)


ggplot(data, aes(x = factor(SPAUSCIS_6, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Les commentaires et les kudos que je reçois à propos des mes activités sur Strava influence mon humeur.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SCORE SPAUSCIS
```{r graphique score SPAUSCIS}
data <- data %>% mutate (SCORE_SPAUSCIS = (SPAUSCIS_1+ SPAUSCIS_2 + SPAUSCIS_3 + SPAUSCIS_4 + SPAUSCIS_5 + SPAUSCIS_6)/6)

data <- data %>% mutate(scoreSPAUSCIS_categorystat = case_when(
    SCORE_SPAUSCIS < 2 ~  "1",
    SCORE_SPAUSCIS  >=2 & SCORE_SPAUSCIS <3 ~  "2",
    SCORE_SPAUSCIS  >=3 & SCORE_SPAUSCIS <4 ~  "3",
    SCORE_SPAUSCIS  >=4 & SCORE_SPAUSCIS <5 ~  "4",
    SCORE_SPAUSCIS  >=5 & SCORE_SPAUSCIS <6 ~  "5",
    SCORE_SPAUSCIS >=6 ~  "6"
  ))

data_resumeSPAUSCISround<- data%>%
  summarise(
    median = round(median(SCORE_SPAUSCIS, na.rm = TRUE),0),
    moyenne= round(mean(SCORE_SPAUSCIS, na.rm=TRUE),0),
    q1 = round(quantile(SCORE_SPAUSCIS, 0.25, na.rm=T),0),
    q3 = round(quantile(SCORE_SPAUSCIS, 0.75, na.rm=T),0)
  )

data_resumeSPAUSCIS<- data%>%
  summarise(
    Médiane = median(SCORE_SPAUSCIS, na.rm = TRUE),
    Moyenne= mean(SCORE_SPAUSCIS, na.rm=TRUE),
    Ecart_type = sd(SCORE_SPAUSCIS, na.rm=TRUE)
  )

table_SPAUSCIS <- data.frame(
Item = c("SPAUSCIS1", "SPAUSCIS2", "SPAUSCIS3", "SPAUSCIS4", "SPAUSCIS5", "SPAUSCIS6", "SCORE_SPAUSCIS"),
  Moyenne = c(data_resumeSPAUSCIS1$Moyenne, data_resumeSPAUSCIS2$Moyenne, 
              data_resumeSPAUSCIS3$Moyenne, data_resumeSPAUSCIS4$Moyenne, data_resumeSPAUSCIS5$Moyenne, data_resumeSPAUSCIS6$Moyenne, data_resumeSPAUSCIS$Moyenne),
  Médiane = c(data_resumeSPAUSCIS1$Médiane, data_resumeSPAUSCIS2$Médiane, 
              data_resumeSPAUSCIS3$Médiane, data_resumeSPAUSCIS4$Médiane, data_resumeSPAUSCIS5$Médiane, data_resumeSPAUSCIS6$Médiane, data_resumeSPAUSCIS$Médiane),
  Ecart_type = c(data_resumeSPAUSCIS1$Ecart_type, data_resumeSPAUSCIS2$Ecart_type, 
              data_resumeSPAUSCIS3$Ecart_type, data_resumeSPAUSCIS4$Ecart_type, data_resumeSPAUSCIS5$Ecart_type, data_resumeSPAUSCIS6$Ecart_type, data_resumeSPAUSCIS$Ecart_type)
)

kable(table_SPAUSCIS)

vlinesSPAUSCIS <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeSPAUSCISround$q1, data_resumeSPAUSCISround$moyenne, data_resumeSPAUSCISround$median, data_resumeSPAUSCISround$q3)
)
vlinesSPAUSCIS$annotation <- paste(vlinesSPAUSCIS$label, ":", vlinesSPAUSCIS$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_SPAUSCIS), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_SPAUSCIS, na.rm = TRUE), 
                                max(data$SCORE_SPAUSCIS, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score SPAUSCIS",
       x = "Score SPAUSCIS", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesSPAUSCIS, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesSPAUSCIS, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

# Lien utilisation de Strava - présentation de soi (hypothèse 2)

Il s'agit de savoir s'il y a un lien entre l'utilisation de Strava et le score SPAUSCIS.

**Rappel de l'hypothèse 2 : plus les coureurs amateurs utilisent Strava, plus ils sont susceptibles de filtrer ou modifier ce qu’ils partagent pour contrôler leur image.**

On peut tester les liens entre les variables Strava suivantes avec le score SPAUSCIS : 

- Score SIS 
- Score OSF 
- Score exposition 
- Appartenance à des clubs Strava 
- Nombre de kudos reçus en moyenne par activité 
- Nombre de publications par semaine (fréquence de publication) 
- Nombre de consultations par semaine (fréquence de consultation) 
- Nombre d’abonnés 
- Nombre d’abonnements 
- Ancienneté sur Strava 
- Catégorie d’abonnement (gratuit/payant)


### Statistiques{.tabset}

#### Corrélations

```{r correlation Strava SPAUSCIS}
# Calcul des corrélations pour toutes les variables avec "SCORE_SPAUSCIS"
correlations_spauscis <- map_df(variables_strava, ~ compute_correlations(.x, "SCORE_SPAUSCIS", data))

# Ajout des labels des variables
correlations_spauscis <- correlations_spauscis %>%
  mutate(Variable = variable_labels_strava[Variable])

# Mise en forme conditionnelle de la colonne "Corr_freqpratique"
correlations_spauscis <- correlations_spauscis %>%
  mutate(
    Corr_SCORE_SPAUSCIS = case_when(
      as.numeric(abs(Corr_SCORE_SPAUSCIS)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_SPAUSCIS, '</span>'),
      as.numeric(abs(Corr_SCORE_SPAUSCIS)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_SPAUSCIS, '</span>'),
      as.numeric(abs(Corr_SCORE_SPAUSCIS)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_SPAUSCIS, '</span>'),
      TRUE ~ as.character(Corr_SCORE_SPAUSCIS)
    )
  )

# Affichage en HTML
kable(correlations_spauscis, format = "html", escape = FALSE)

```

#### Visualisation graphique{.tabset}

##### SIS
```{r sis et spauscis}
plot_correlation("SCORE_SIS", "SCORE_SPAUSCIS", data, list("SCORE_SIS" = "Score Strava Intensity Scale", "SCORE_SPAUSCIS" = "Score SPAUSCIS"))
```

##### OSF
```{r osf et spauscis}
plot_correlation("SCORE_OSF", "SCORE_SPAUSCIS", data, list("SCORE_OSF" = "Score Online Sociability Function", "SCORE_SPAUSCIS" = "Score SPAUSCIS"))

```


#### Test t de Student

```{r test t student pour type abonnement et spauscis}
t_typeabonnement_spauscis <- t.test(as.numeric(SCORE_SPAUSCIS) ~ as.factor(Catégorie_abonnement), data = data, var.equal = TRUE)

moyennesspauscis_typeabonnement <- data %>%
    group_by(Catégorie_abonnement) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

table_typeabonnement_spauscis <- data.frame(
    Variable = c(
        "Catégorie d'abonnement et SPAUSCIS"),
    Student = c(
        as.numeric(t_typeabonnement_spauscis$statistic)
    ),
    p_value = c(t_typeabonnement_spauscis$p.value),
    Significatif = c(
        ifelse(t_typeabonnement_spauscis$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Gratuit = c(
        moyennesspauscis_typeabonnement$Moyenne[1]
    ),
    Payant = c(
        moyennesspauscis_typeabonnement$Moyenne[2]
    )
)

kable(table_typeabonnement_spauscis, format = "html", escape = FALSE)

```

#### Visualisation graphique
```{r type abonnement spauscis catégorie abonnement}
ggplot(data, aes(x = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")),
                 y = SCORE_SPAUSCIS,
                 fill = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Catégorie d'abonnement",
       y = "SCORE SPAUSCIS",
       fill = "Type d'abonnement") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

### Conclusion hypothèse 2

**Rappel de l'hypothèse 2 : plus les coureurs amateurs utilisent Strava, plus ils sont susceptibles de filtrer ou modifier ce qu’ils partagent pour contrôler leur image.**

Les scores au SPAUSCIS restent relativement bas (Q3 = 2).
Attention, l'alpha de Cronbach est assez faible pour le score SPAUCIS donc les conclusions ne sont pas très fiables.

Le score SIS (0.43) et le score OSF (0.3) sont modérément corrélés au score SPAUSCIS.

Le score EXPO (0.23), le nombre de clubs Strava (0.15), les kudos reçus en moyenne par activité (0.19), la fréquence de consultation (0.21), le nombre d’abonnés (0.16) et le nombre d’abonnements (0.15) sont faiblement corrélés au score SPAUSCIS.

La moyenne du score SPAUSCIS est significativement plus élévée chez les utilisateurs ayant un compte payant (test t de Student, p<0.05, significatif).


# Lien présentation de soi - caractéristiques sportives (hypothèse 2)

Pour aller plus loin dans l'hypothèse 2, il s'agit de savoir s'il y a un lien entre le score SPAUSCIS et les caractéristiques sportives.

On peut tester le score SPAUCIS avec les variables sportives suivantes :

- nombre de kilomètres par semaine (volume par semaine)
- nombre d'entraînements par semaine (fréquence entraînement)
- nombre de compétitions par an
- niveau
- type de coureur (trail/route, club/pas club, seul/en groupe)
- suivi d'un programme d'entraînement
- accompagnement par un coach
- type d'objectif 2025 s'il y en a un
- blessure ou non liée à la course à pied dans les 6 derniers mois
- durée de la pause d'une blessure liée à la course à pied

### Statistiques {.tabset}

#### Corrélations

```{r correlation pratique SPAUSCIS}

# Calcul des corrélations pour toutes les variables sport avec SPAUSCIS
correlations_spauscis_sport <- map_df(variables_sportives, ~ compute_correlations(.x, "SCORE_SPAUSCIS", data))

# Ajout des labels des variables
correlations_spauscis_sport <- correlations_spauscis_sport %>%
  mutate(Variable = variables_labels_sportives[Variable])

# Mise en forme conditionnelle de la colonne "Corr_Spauscis"
correlations_spauscis_sport <- correlations_spauscis_sport %>%
  mutate(
    Corr_SCORE_SPAUSCIS = case_when(
      as.numeric(abs(Corr_SCORE_SPAUSCIS)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_SPAUSCIS, '</span>'),
      as.numeric(abs(Corr_SCORE_SPAUSCIS)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_SPAUSCIS, '</span>'),
      as.numeric(abs(Corr_SCORE_SPAUSCIS)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_SPAUSCIS, '</span>'),
      TRUE ~ as.character(Corr_SCORE_SPAUSCIS)
    )
  )

# Affichage en HTML
kable(correlations_spauscis_sport, format = "html", escape = FALSE)

```

#### Test t de Student
```{r test student spauscis}
t_coach_spauscis <- t.test(as.numeric(SCORE_SPAUSCIS) ~ as.factor(Coach), data = data, var.equal = TRUE)

moyennesspauscis_coach <- data %>%
    group_by(Coach) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

table_coach_spauscis <- data.frame(
    Variable = c(
        "Coach et SPAUSCIS"),
    Student = c(
        as.numeric(t_coach_spauscis$statistic)
    ),
    P_value = c(t_coach_spauscis$p.value),
    Significatif= c(
        ifelse(t_coach_spauscis$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_coach = c(
        moyennesspauscis_coach$Moyenne[1]
    ),
    Sans_coach = c(
        moyennesspauscis_coach$Moyenne[2]
    )
)

kable(table_coach_spauscis, format = "html", escape = FALSE)

t_pgrm_spauscis <- t.test(as.numeric(SCORE_SPAUSCIS) ~ as.factor(Programme), data = data, var.equal = TRUE)

moyennesspauscis_pgrm <- data %>%
    group_by(Programme) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

table_pgrm_spauscis <- data.frame(
    Variable = c(
        "Programme et SPAUSCIS"),
    Student = c(
        as.numeric(t_pgrm_spauscis$statistic)
    ),
    P.value = t_pgrm_spauscis$p.value,
    Signficatif = c(
        ifelse(t_pgrm_spauscis$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_programme = c(
        moyennesspauscis_pgrm$Moyenne[1]
    ),
    Sans_programme = c(
        moyennesspauscis_pgrm$Moyenne[2]
    )
)

kable(table_pgrm_spauscis, format = "html", escape = FALSE)


t_blessure_spauscis <- t.test(as.numeric(SCORE_SPAUSCIS) ~ as.factor(Blessure), data = data, var.equal = TRUE)

moyennesspauscis_blessure <- data %>%
    group_by(Blessure) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

table_blessure_spauscis <- data.frame(
    Variable = c(
        "Blessure et SPAUSCIS"),
    Student = c(
        as.numeric(t_blessure_spauscis$statistic)
    ),
    P.value = t_blessure_spauscis$p.value,
    Significatif = c(
        ifelse(t_blessure_spauscis$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Blessure = c(
        moyennesspauscis_blessure$Moyenne[1]
    ),
    Pas_de_blessure = c(
        moyennesspauscis_blessure$Moyenne[2]
    )
)

kable(table_blessure_spauscis, format = "html", escape = FALSE)

```

#### ANOVA

```{r anova spauscis pratique}
### Niveau, type coureur, objectif, pause blessure

anova_spauscis_niveau <- summary(aov(SCORE_SPAUSCIS ~ as.factor(Niveau), data = data))
anova_spauscis_type_coureur <- summary(aov(SCORE_SPAUSCIS ~ as.factor(Type_coureur), data = data))
anova_spauscis_objectif <- summary(aov(SCORE_SPAUSCIS ~ as.factor(Objectif_KM), data = data))
anova_spauscis_pause <- summary(aov(SCORE_SPAUSCIS ~ as.factor(Pause_blessure), data = data))

moyenne_spauscis_niveau <- data %>%
    group_by(Niveau) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

moyenne_spauscis_type_coureur <- data %>%
    group_by(Type_coureur) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

moyenne_spauscis_objectif <- data %>%
    group_by(Objectif_KM) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

moyenne_spauscis_pause <- data %>%
    group_by(Pause_blessure) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

anova_spauscis_niveau <- data.frame(
  Variable = c("Lien score SPAUSCIS et niveau"),
  F_value = c(anova_spauscis_niveau[[1]]["F value"][1,1]),
  P_value = c(anova_spauscis_niveau[[1]]["Pr(>F)"][1,1]),
 Significatif = ifelse(c(anova_spauscis_niveau[[1]]["Pr(>F)"][1,1]) <0.05, "< 0.05", "≥ 0.05"),
 Débutant = c(moyenne_spauscis_niveau$Moyenne[1]),
 Intermédiaire = c(moyenne_spauscis_niveau$Moyenne[2]),
 Confirmé = c(moyenne_spauscis_niveau$Moyenne[3]),
 Expert = c(moyenne_spauscis_niveau$Moyenne[4]))
 
kable(anova_spauscis_niveau, format = "html", escape = FALSE)

anova_spauscis_type_coureur <- data.frame(
  Variable = c("Lien score SPAUSCIS et type coureur"),
  F_value = c(anova_spauscis_type_coureur[[1]]["F value"][1,1]),
  P_value = c(anova_spauscis_type_coureur[[1]]["Pr(>F)"][1,1]),
 Significatif = ifelse(c(anova_spauscis_type_coureur[[1]]["Pr(>F)"][1,1]) <0.05, "< 0.05", "≥ 0.05"))

anova_moyenne_type_coureur <- data.frame (
 Type_coureur = c("Route/Club/Seul", "Route/Pas club/Seul", "Route/Club/En groupe", "Route/Pas club/En groupe", "Trail/Club/Seul", "Trail/Pas club/Seul", "Trail/Club/En groupe", "Trail/Pas club/En groupe"),
 Moyenne = c(moyenne_spauscis_type_coureur$Moyenne[1], moyenne_spauscis_type_coureur$Moyenne[2], moyenne_spauscis_type_coureur$Moyenne[3], moyenne_spauscis_type_coureur$Moyenne[4],moyenne_spauscis_type_coureur$Moyenne[5], moyenne_spauscis_type_coureur$Moyenne[6], moyenne_spauscis_type_coureur$Moyenne[7], moyenne_spauscis_niveau$Moyenne[8]))

kable(anova_spauscis_type_coureur, format = "html", escape = FALSE)
kable(anova_moyenne_type_coureur)

anova_spauscis_objectif <- data.frame(
  Variable = c("Lien score SPAUSCIS et objectif 2025"),
  F_value = c(anova_spauscis_objectif[[1]]["F value"][1,1]),
  P_value = c(anova_spauscis_objectif[[1]]["Pr(>F)"][1,1]),
 Significatif= ifelse(c(anova_spauscis_objectif[[1]]["Pr(>F)"][1,1]) < 0.05, "< 0.05", "≥ 0.05"),
 Vingt_km = c(moyenne_spauscis_objectif$Moyenne[1]),
 Cinquante_km = c(moyenne_spauscis_objectif$Moyenne[2]),
 Cent_km = c(moyenne_spauscis_objectif$Moyenne[3]),
 Cent_miles = c(moyenne_spauscis_objectif$Moyenne[4]))
 
kable(anova_spauscis_objectif, format = "html", escape = FALSE)

anova_spauscis_pause <- data.frame(
  Variable = c("Lien score SPAUSCIS et pause blessure"),
  F_value = c(anova_spauscis_pause[[1]]["F value"][1,1]),
  P_value = c(anova_spauscis_pause[[1]]["Pr(>F)"][1,1]),
 Significatif = ifelse(c(anova_spauscis_pause[[1]]["Pr(>F)"][1,1]) < 0.05, "< 0.05", "≥ 0.05"),
 Jours = c(moyenne_spauscis_pause$Moyenne[1]),
 Semaines = c(moyenne_spauscis_pause$Moyenne[2]),
 Mois = c(moyenne_spauscis_pause$Moyenne[3]),
 Pas_de_pause = c(moyenne_spauscis_pause$Moyenne[4]))
 
kable(anova_spauscis_pause, format = "html", escape = FALSE)



```


```{r test post hoc spauscis et niveau}

tukey_spauscis_niveau <- TukeyHSD(aov(SCORE_SPAUSCIS ~ as.factor(Niveau), data = data))
tukey_spauscis_type_coureur <- TukeyHSD(aov(SCORE_SPAUSCIS ~ as.factor(Type_coureur), data = data))
tukey_spauscis_objectif <- TukeyHSD(aov(SCORE_SPAUSCIS ~ as.factor(Objectif_KM), data = data))
tukey_spauscis_blessure <- TukeyHSD(aov(SCORE_SPAUSCIS ~ as.factor(Pause_blessure), data = data))

tukey_spauscis_niveau_df <- as.data.frame(tukey_spauscis_niveau[[1]]) 
tukey_spauscis_niveau_df$Comparison <- rownames(tukey_spauscis_niveau_df)
tukey_spauscis_niveau_df$Variable <- "Lien score SPAUSCIS et niveau"
rownames(tukey_spauscis_niveau_df) <- NULL

tukey_spauscis_type_coureur_df <- as.data.frame(tukey_spauscis_type_coureur[[1]]) 
tukey_spauscis_type_coureur_df$Comparison <- rownames(tukey_spauscis_type_coureur_df)
tukey_spauscis_type_coureur_df$Variable <- "Lien score SPAUSCIS et type coureur"
rownames(tukey_spauscis_type_coureur_df) <- NULL

tukey_spauscis_objectif_df <- as.data.frame(tukey_spauscis_objectif[[1]]) 
tukey_spauscis_objectif_df$Comparison <- rownames(tukey_spauscis_objectif_df)
tukey_spauscis_objectif_df$Variable <- "Lien score SPAUSCIS et objectif 2025"
rownames(tukey_spauscis_objectif_df) <- NULL

tukey_spauscis_blessure_df <- as.data.frame(tukey_spauscis_blessure[[1]]) 
tukey_spauscis_blessure_df$Comparison <- rownames(tukey_spauscis_blessure_df)
tukey_spauscis_blessure_df$Variable <- "Lien score SPAUSCIS  et blessure"
rownames(tukey_spauscis_blessure_df) <- NULL

tukey_results_spauscis <- bind_rows(tukey_spauscis_niveau_df, tukey_spauscis_type_coureur_df, tukey_spauscis_objectif_df, tukey_spauscis_blessure_df)

tukey_signif_spauscis <- tukey_results_spauscis %>% filter(`p adj` < 0.05)

```


### Conclusion hypothèse 2

**Rappel de l'hypothèse 2 : plus les coureurs amateurs utilisent Strava, plus ils sont susceptibles de filtrer ou modifier ce qu’ils partagent pour contrôler leur image.**

Pour compléter la première conclusion sur l'hypothèse 2, il est possible de se demander si le score SPAUSCIS a un lien avec la pratique (est-ce que par exemple le fait d'avoir une stratégie d'auto-présentation élevée est en lien avec le nombre de kilomètres parcourus par semaine ?)


Il y a une faible corrélation entre le score SPAUSCIS et le nombre de compétitions par an (0.11). Il n'y a pas de corrélation entre le score SPAUSCIS et le nombre de kilomètres et d'entraînements par semaine.

Les conclusions sont peu fiables étant donné l'alpha de Cronbach du SPAUSCIS qui est assez faible.

Il n'est pas possible de mettre en  évidence des différences significatives pour le score SPAUSCIS et les personnes suivies par un coach ou non. De même avec les personnes suivant un programme d'entraînement ou non. Et de même avec les personnes ayant eu une blessure liée à la pratique de la course à pied dans les 6 derniers mois ou non. (test de Student, p > 0.05)

Il n'est pas possible de mettre en évidence des différences significatives entre le score SPAUSCIS et les différents niveaux de pratique, de même pour les types de coureurs, les types d'objectifs 2025 (distance) et les différentes durées de pause liées à des blesssures à cause de la course à pied pour les coureurs qui ont été blessés (ANOVA, p > 0.05).


# Mesure du stress perçu

Dans l'article de Rusell^3^, il y a des témoignages concernant la pression perçue "I think it makes you feel like there’s pressure to do as much as other people are doing or as well as other people are doing… I had a really bad run or workout oneday, and I see others having better runs, then that can make me feel worse. 

Le Perceived Stress Scale mesure le stress perçu et la capacité d'adaptation. Les items ont étés traduits et adaptés à partir de l'étude de Sischka (2024) ^11^. L'étude de Chiu (2016) ^13^ recommande d'utiliser cette échelle mais en version 2 facteurs : stress perçu et capacité d'adaptation.

Les items 1, 2, 3, 6, 9, 10 de l'échelle mesure le stress perçu et 4, 5, 7, 8 mesurent la capacité à gérer son stress.

L'article de Chiu (2016) ^13^ indique un alpha de Cronbach de 0.81 pour le stress perçu et 0.71 pour la capacité d'adaptation.

Suite au pré-test, un item a été enlevé dans l'étude sur Strava ("In the last week, how often have you felt that you were on top of things? "). L'échelle traduite et adaptée comporte donc **9 items**.

Un score élevé sur le PSS (facteur stress perçu) indique un stress perçu élévé tandis qu'un score faible indique un stress perçu faible. Un score élevé sur le PSS (facteur capacité d'adaptation) montre que la personne arrive à gérer son stress correctement tandis qu'un score faible indique qu'elle a plus de mal. Ainsi, un individu peut avoir un haut niveau de stress mais aussi une forte capacité d’adaptation et inversement.

Dans l'échantillon, le stress perçu par l'utilisation de Strava est plutôt faible et l'adaptation au stress perçu par l'utilisation de Strava est plutôt élevée. 

L'alpha de Cronbach pour le score de l'adaptation au stress est faible du fait de la traduction, adaptation et suppression d'un item suite au pré-test. Les conclusions sont donc peu fiables.

### PSS Facteurs stress perçu{.tabset}

```{r SCORE PSS alpha cronbach}
data_PSS_Stress <- data[, c("PSS_1", "PSS_2", "PSS_3", "PSS_6", "PSS_8", "PSS_9")]
cronbachPSS_Stress<-cronbach(data_PSS_Stress)

glue ("L'alpha de Cronbach sur les {cronbachPSS_Stress$number.of.items} items est de {cronbachPSS_Stress$alpha}")
```


#### PSS 1
```{r graphique PSS 1}
data_resumePSS1 <- data%>%
  summarise(
    Moyenne = mean(PSS_1, na.rm = TRUE),
    Médiane = median(PSS_1, na.rm = TRUE),
    Ecart_type = sd(PSS_1, na.rm=TRUE))

kable(data_resumePSS1)

ggplot(data, aes(x = factor(PSS_1, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Avez-vous été perturbé(e) par des réactions inattendues à vos publications sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### PSS 2
```{r graphique PSS 2}
data_resumePSS2 <- data%>%
  summarise(
    Moyenne = mean(PSS_2, na.rm = TRUE),
    Médiane = median(PSS_2, na.rm = TRUE),
    Ecart_type = sd(PSS_2, na.rm=TRUE))

kable(data_resumePSS2)

ggplot(data, aes(x = factor(PSS_2, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Avez-vous eu l’impression d’être obligé(e) de publier vos activités sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### PSS 3
```{r graphique PSS 3}
data_resumePSS3 <- data%>%
  summarise(
    Moyenne = mean(PSS_3, na.rm = TRUE),
    Médiane = median(PSS_3, na.rm = TRUE),
    Ecart_type = sd(PSS_3, na.rm=TRUE))

kable(data_resumePSS3)

ggplot(data, aes(x = factor(PSS_3, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Vous êtes-vous senti(e) nerveus(e) ou stressé(e) à l’idée de publier vos activités sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### PSS 6
```{r graphique PSS 6}
data_resumePSS6 <- data%>%
  summarise(
    Moyenne = mean(PSS_6, na.rm = TRUE),
    Médiane = median(PSS_6, na.rm = TRUE),
    Ecart_type = sd(PSS_6, na.rm=TRUE))

kable(data_resumePSS6)

ggplot(data, aes(x = factor(PSS_6, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Avez-vous constaté que vous n’étiez pas assez actif(ve) sur Strava (pas assez de publications d’activités) ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### PSS 8
```{r graphique PSS 8}
data_resumePSS8 <- data%>%
  summarise(
    Moyenne = mean(PSS_8, na.rm = TRUE),
    Médiane = median(PSS_8, na.rm = TRUE),
    Ecart_type = sd(PSS_8, na.rm=TRUE))

kable(data_resumePSS8)

ggplot(data, aes(x = factor(PSS_8, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Avez-vous été irrité(e) à cause de la performance des autres sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### PSS 9
```{r graphique PSS 9}
data_resumePSS9 <- data%>%
  summarise(
    Moyenne = mean(PSS_9, na.rm = TRUE),
    Médiane = median(PSS_9, na.rm = TRUE),
    Ecart_type = sd(PSS_9, na.rm=TRUE))

kable(data_resumePSS9)

ggplot(data, aes(x = factor(PSS_9, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Vous-êtes-vous senti(e) dépassé(e) par la pression d’atteindre vos objectifs sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### SCORE PSS Stress perçu
```{r graphique score pss stress}
data <- data %>% mutate (SCORE_PSS_Stress = PSS_1+ PSS_2 + PSS_3 + PSS_6 + PSS_8 + PSS_9)

data <- data %>% mutate(scorePSS_Stress_categorystat = case_when(
    SCORE_PSS_Stress < 5 ~  "1",
    SCORE_PSS_Stress  >=5 & SCORE_PSS_Stress <9 ~  "2",
    SCORE_PSS_Stress  >=9 & SCORE_PSS_Stress <13 ~  "3",
    SCORE_PSS_Stress  >=13 & SCORE_PSS_Stress <17 ~  "4",
    SCORE_PSS_Stress  >=17 & SCORE_PSS_Stress <21 ~  "5",
    SCORE_PSS_Stress >=21 ~  "6"
  ))


data_resumePSS_Stress_round<- data%>%
  summarise(
    median = round(median(SCORE_PSS_Stress, na.rm = TRUE),0),
    moyenne= round(mean(SCORE_PSS_Stress, na.rm=TRUE),0),
    q1 = round(quantile(SCORE_PSS_Stress, 0.25, na.rm=T),0),
    q3 = round(quantile(SCORE_PSS_Stress, 0.75, na.rm=T),0)
  )

data_resumePSS_Stress<- data%>%
  summarise(
    Médiane = median(SCORE_PSS_Stress, na.rm = TRUE),
    Moyenne= mean(SCORE_PSS_Stress, na.rm=TRUE),
    Ecart_type = sd(SCORE_PSS_Stress, na.rm=TRUE)
  )

table_PSS_Stress<- data.frame(
Item = c("PSS1", "PSS2", "PSS3", "PSS6", "PSS8", "PSS9", "SCORE_PSS_Stress"),
  Moyenne = c(data_resumePSS1$Moyenne, data_resumePSS2$Moyenne, 
              data_resumePSS3$Moyenne, data_resumePSS6$Moyenne, data_resumePSS8$Moyenne, data_resumePSS9$Moyenne, data_resumePSS_Stress$Moyenne),
  Médiane = c(data_resumePSS1$Médiane, data_resumePSS2$Médiane, 
              data_resumePSS3$Médiane, data_resumePSS6$Médiane, data_resumePSS8$Médiane, data_resumePSS9$Médiane, data_resumePSS_Stress$Médiane),
  Ecart_type = c(data_resumePSS1$Ecart_type, data_resumePSS2$Ecart_type, 
              data_resumePSS3$Ecart_type, data_resumePSS6$Ecart_type, data_resumePSS8$Ecart_type, data_resumePSS9$Ecart_type, data_resumePSS_Stress$Ecart_type)
)

kable(table_PSS_Stress)

vlinesPSS_Stress <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumePSS_Stress_round$q1, data_resumePSS_Stress_round$moyenne, data_resumePSS_Stress_round$median, data_resumePSS_Stress_round$q3)
)
vlinesPSS_Stress$annotation <- paste(vlinesPSS_Stress$label, ":", vlinesPSS_Stress$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_PSS_Stress), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_PSS_Stress, na.rm = TRUE), 
                                max(data$SCORE_PSS_Stress, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score PSS (facteur stress perçu)",
       x = "Score PSS stress perçu", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesPSS_Stress, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesPSS_Stress, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```



### PSS Facteurs adaptation au stress{.tabset}

```{r score PSS adaptation alpha cronbach}
data_PSS_Adaptation<- data[, c("PSS_4", "PSS_5", "PSS_7")]
cronbachPSS_Adaptation<-cronbach(data_PSS_Adaptation)

glue ("L'alpha de Cronbach sur les {cronbachPSS_Adaptation$number.of.items} items est de {cronbachPSS_Adaptation$alpha}")
```

#### PSS 4
```{r graphique PSS 4}
data_resumePSS4 <- data%>%
  summarise(
    Moyenne = mean(PSS_4, na.rm = TRUE),
    Médiane = median(PSS_4, na.rm = TRUE),
    Ecart_type = sd(PSS_4, na.rm=TRUE))

kable(data_resumePSS4)

ggplot(data, aes(x = factor(PSS_4, levels = c(1, 2, 3, 4), labels = c("Toujours", "Souvent", "Parfois", "Jamais")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Vous êtes-vous senti(e) confiant(e) par rapport à ce que vous publiez sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### PSS 5
```{r graphique PSS 5}
data_resumePSS5 <- data%>%
  summarise(
    Moyenne = mean(PSS_5, na.rm = TRUE),
    Médiane = median(PSS_5, na.rm = TRUE),
    Ecart_type = sd(PSS_5, na.rm=TRUE))

kable(data_resumePSS5)

ggplot(data, aes(x = factor(PSS_5, levels = c(1, 2, 3, 4), labels = c("Toujours", "Souvent", "Parfois", "Jamais")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Avez-vous eu l'impression que vos activités sur Strava vous mettaient en valeur ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### PSS 7
```{r graphique PSS 7}
data_resumePSS7 <- data%>%
  summarise(
    Moyenne = mean(PSS_7, na.rm = TRUE),
    Médiane = median(PSS_7, na.rm = TRUE),
    Ecart_type = sd(PSS_7, na.rm=TRUE))

kable(data_resumePSS7)

ggplot(data, aes(x = factor(PSS_7, levels = c(1, 2, 3, 4), labels = c("Toujours", "Souvent", "Parfois", "Jamais")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "A quelle fréquence avez-vous eu l'impression de contrôler la manière dont vous présentez vos activités sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### SCORE PSS Adapation au stress
```{r graphique score pss adaptation}
data <- data %>% mutate (SCORE_PSS_Adaptation = PSS_4+ PSS_5 + PSS_7)

data <- data %>% mutate(scorePSS_Adaptation_categorystat = case_when(
    SCORE_PSS_Adaptation < 5 ~  "1",
    SCORE_PSS_Adaptation  >=5 & SCORE_PSS_Adaptation <9 ~  "2",
    SCORE_PSS_Adaptation  >=9 ~  "3",
  ))


data_resumePSS_Adaptation_round<- data%>%
  summarise(
    median = round(median(SCORE_PSS_Adaptation, na.rm = TRUE),0),
    moyenne= round(mean(SCORE_PSS_Adaptation, na.rm=TRUE),0),
    q1 = round(quantile(SCORE_PSS_Adaptation, 0.25, na.rm=T),0),
    q3 = round(quantile(SCORE_PSS_Adaptation, 0.75, na.rm=T),0)
  )

data_resumePSS_Adaptation<- data%>%
  summarise(
    Médiane = median(SCORE_PSS_Adaptation, na.rm = TRUE),
    Moyenne= mean(SCORE_PSS_Adaptation, na.rm=TRUE),
    Ecart_type = sd(SCORE_PSS_Adaptation, na.rm=TRUE)
  )

table_PSS_Adaptation<- data.frame(
Item = c("PSS4", "PSS5", "PSS7","SCORE_PSS_Adaptation"),
  Moyenne = c(data_resumePSS4$Moyenne, data_resumePSS5$Moyenne, 
              data_resumePSS7$Moyenne, data_resumePSS_Adaptation$Moyenne),
  Médiane = c(data_resumePSS4$Médiane, data_resumePSS5$Médiane, 
              data_resumePSS7$Médiane, data_resumePSS_Adaptation$Médiane),
  Ecart_type = c(data_resumePSS4$Ecart_type, data_resumePSS5$Ecart_type, 
              data_resumePSS7$Ecart_type, data_resumePSS_Adaptation$Ecart_type)
)

kable(table_PSS_Adaptation)

vlinesPSS_Adaptation <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumePSS_Adaptation_round$q1, data_resumePSS_Adaptation_round$moyenne, data_resumePSS_Adaptation_round$median, data_resumePSS_Adaptation_round$q3)
)
vlinesPSS_Adaptation$annotation <- paste(vlinesPSS_Adaptation$label, ":", vlinesPSS_Adaptation$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_PSS_Adaptation), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_PSS_Adaptation, na.rm = TRUE), 
                                max(data$SCORE_PSS_Adaptation, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score PSS (facteur adapatation)",
       x = "Score PSS adaptation au stress perçu", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesPSS_Adaptation, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesPSS_Adaptation, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```

# Lien utilisation de Strava - stress perçu (hypothèse 3)

La question ici est de savoir si l'utilisation de Strava (intensité et fréquence d'utilisation, utilisation des fonctionnalités de sociabilisation en ligne et exposition d'informations personnelles...) engendre un stress perçu ou non.

**Rappel de l'hypothèse 3 : plus les coureurs amateurs utilisent Strava, plus ils sont susceptibles de ressentir du stress.**

On peut tester les liens entre les variables Strava suivantes avec le score PSS "stress perçu" et le score "adaptation au stress": 

- Score SIS 
- Score OSF 
- Score exposition 
- Appartenance à des clubs Strava 
- Nombre de kudos reçus en moyenne par activité 
- Nombre de publications par semaine (fréquence de publication) 
- Nombre de consultations par semaine (fréquence de consultation) 
- Nombre d’abonnés 
- Nombre d’abonnements 
- Ancienneté sur Strava 
- Catégorie d’abonnement (gratuit/payant)


### Une première approche{.tabset}

```{r graph stress Strava}
data_resumeStrava_stress <- data%>%
  summarise(
    Moyenne = mean(Strava_stress, na.rm = TRUE),
    Médiane = median(Strava_stress, na.rm = TRUE),
    Ecart_type = sd(Strava_stress, na.rm=TRUE))

kable(data_resumeStrava_stress)

ggplot(data, aes(x = factor(Strava_stress, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je me sens plus stressé(e) depuis que j'ai Strava.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

### Statistiques{.tabset}

####  Corrélations{.tabset}

##### PSS_Stress
```{r correlations calculs PSS stress}

# Calcul des corrélations pour toutes les variables avec PSS Stress
correlations_pss_stress <- map_df(variables_strava, ~ compute_correlations(.x, "SCORE_PSS_Stress", data))

# Ajout des labels des variables
correlations_pss_stress <- correlations_pss_stress %>%
  mutate(Variable = variable_labels_strava[Variable])

# Mise en forme conditionnelle de la colonne "Corr_PSS_Stress"
correlations_pss_stress <- correlations_pss_stress %>%
  mutate(
    Corr_SCORE_PSS_Stress = case_when(
      as.numeric(abs(Corr_SCORE_PSS_Stress)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_PSS_Stress, '</span>'),
      as.numeric(abs(Corr_SCORE_PSS_Stress)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_PSS_Stress, '</span>'),
      as.numeric(abs(Corr_SCORE_PSS_Stress)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_PSS_Stress, '</span>'),
      TRUE ~ as.character(Corr_SCORE_PSS_Stress)
    )
  )

# Affichage en HTML
kable(correlations_pss_stress, format = "html", escape = FALSE)
```

##### PSS_Adaptation
```{r correlations calculs PSS adaptation}

# Calcul des corrélations pour toutes les variables avec PSS Stress
correlations_pss_adapation <- map_df(variables_strava, ~ compute_correlations(.x, "SCORE_PSS_Adaptation", data))

# Ajout des labels des variables
correlations_pss_adapation <- correlations_pss_adapation %>%
  mutate(Variable = variable_labels_strava[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_PSS_Adaptation"
correlations_pss_adapation <- correlations_pss_adapation %>%
  mutate(
    Corr_SCORE_PSS_Adaptation = case_when(
      as.numeric(abs(Corr_SCORE_PSS_Adaptation)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_PSS_Adaptation, '</span>'),
      as.numeric(abs(Corr_SCORE_PSS_Adaptation)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_PSS_Adaptation, '</span>'),
      as.numeric(abs(Corr_SCORE_PSS_Adaptation)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_PSS_Adaptation, '</span>'),
      TRUE ~ as.character(Corr_SCORE_PSS_Adaptation)
    )
  )

# Affichage en HTML
kable(correlations_pss_adapation, format = "html", escape = FALSE)
```



#### Visualisation graphique{.tabset}

##### SIS- PSS Adaptation
```{r graphique pss adaptation et score sis}
plot_correlation("SCORE_PSS_Adaptation", "SCORE_SIS", data, list("SCORE_PSS_Adaptation" = "Score Adaptation au stress", "SCORE_SIS" = "Score Strava Intensity Scale"))
```

##### OSF - PSS Adaptation
```{r graphique pss adaptation et score osf}
plot_correlation("SCORE_PSS_Adaptation", "SCORE_OSF", data, list("SCORE_PSS_Adaptation" = "Score Adaptation au stress", "SCORE_OSF" = "Score Online Sociability Function"))
```

##### EXPO- PSS Adaptation
```{r graphique pss adaptation et score expo}
plot_correlation("SCORE_PSS_Adaptation", "SCORE_EXPO", data, list("SCORE_PSS_Adaptation" = "Score Adaptation au stress", "SCORE_EXPO" = "Score d'exposition"))
```


##### Fréquence consultation - PSS Adaptation
```{r graphique pss adaptation et freq consultation}
plot_correlation("SCORE_PSS_Adaptation", "Fréquence_consultation", data, list("SCORE_PSS_Adaptation" = "Score Adaptation au stress", "Fréquence_consultation" = "Fréquence de consultation"))
```

#### Test t de Student

```{r test t student pour type abonnement et pss}
t_typeabonnement_pss_stress <- t.test(as.numeric(SCORE_PSS_Stress) ~ as.factor(Catégorie_abonnement), data = data, var.equal = TRUE)

moyennes_pss_stress_typeabonnement <- data %>%
    group_by(Catégorie_abonnement) %>%
    summarise(Moyenne = mean(SCORE_PSS_Stress, na.rm = TRUE))

table_typeabonnement_pss_stress <- data.frame(
    Variable = c(
        "Catégorie d'abonnement et score PSS Stress"),
    Student = c(
        as.numeric(t_typeabonnement_pss_stress$statistic)
    ),
    p_value = t_typeabonnement_pss_stress$p.value,
    Significatif = c(
        ifelse(t_typeabonnement_pss_stress$p.value < 0.01, "<0.05", "≥ 0.05")
    ),
    Gratuit = c(
        moyennes_pss_stress_typeabonnement$Moyenne[1]
    ),
    Payant = c(
        moyennes_pss_stress_typeabonnement$Moyenne[2]
    )
)

kable(table_typeabonnement_pss_stress, format = "html", escape = FALSE)

t_typeabonnement_pss_adaptation <- t.test(as.numeric(SCORE_PSS_Adaptation) ~ as.factor(Catégorie_abonnement), data = data, var.equal = TRUE)

moyennes_pss_adaptation_typeabonnement <- data %>%
    group_by(Catégorie_abonnement) %>%
    summarise(Moyenne = mean(SCORE_PSS_Adaptation, na.rm = TRUE))

table_typeabonnement_pss_adaptation <- data.frame(
    Variable = c(
        "Catégorie d'abonnement et score PSS Adaptation"),
    Student = c(
        as.numeric(t_typeabonnement_pss_adaptation$statistic)
    ),
    p_value = t_typeabonnement_pss_adaptation$p.value,
    Significatif = c(
        ifelse(t_typeabonnement_pss_adaptation$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Gratuit = c(
        moyennes_pss_adaptation_typeabonnement$Moyenne[1]
    ),
    Payant = c(
        moyennes_pss_adaptation_typeabonnement$Moyenne[2]
    )
)

kable(table_typeabonnement_pss_adaptation, format = "html", escape = FALSE)

```

#### Visualisation graphique
```{r type abonnement score pss adaptation}
ggplot(data, aes(x = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")),
                 y = SCORE_PSS_Adaptation,
                 fill = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Catégorie d'abonnement",
       y = "Score PSS Adaptation",
       fill = "Type d'abonnement") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
```

### Conclusion hypothèse 3

**Rappel de l'hypothèse 3 : plus les coureurs amateurs utilisent Strava, plus ils sont susceptibles de ressentir du stress.**

Il y a une faible corrélation positive entre le score PSS "stress perçu" et le score SIS (0.18). Les autres variables Strava n'ont pas de corrélation avec le score PSS "stress perçu".

Il y a une corrélation moyenne négative entre le score PSS "adaptation au stress" et le score SIS (-0.36).

Il y a des faibles corrélations négatives entre le score PSS "adaptation au stress" et le score OSF (-0.23), le score d'exposition (-0.21), le nombre de clubs strava (-0.15), la fréquence de publication (-0.12), la fréquence de consultation (-0.21), le nombre d'abonnés (-0.12) et le nombre d'abonnements (-0.11).

Il n'y a pas de corrélation entre le score PSS "adaptation au stress" et le nombre de kudos reçus et l'ancienneté sur Strava.

Il n'est pas possible de mettre en évidence de différence pour le score PSS "stress perçu" pour les différentes catégories d'abonnement (payant/gratuit) (test t de Student, p>0.05). En revanche, il est possible de mettre en évidence des différences pour le score PSS "adaptation au stress" pour les différentes catégories d'abonnement : les personnes ayant un compte avec un abonnement gratuit ont un score PSS "adaptation au stress" plus élevé. (test de Student, p< 0.01, hautement significatif)

# Lien stress perçu - caractéristiques sportives (hypothèse 3)

Pour aller plus loin dans l'hypothèse 3, il s'agit de savoir s'il y a un lien entre les 2 scores PSS et les caractéristiques sportives.

On peut tester les 2 scores PSS avec les variables sportives suivantes :

- nombre de kilomètres par semaine (volume par semaine)
- nombre d'entraînements par semaine (fréquence entraînement)
- nombre de compétitions par an
- niveau
- type de coureur (trail/route, club/pas club, seul/en groupe)
- suivi d'un programme d'entraînement
- accompagnement par un coach
- type d'objectif 2025 s'il y en a un
- blessure ou non liée à la course à pied dans les 6 derniers mois
- durée de la pause d'une blessure liée à la course à pied

### Statistiques {.tabset}

#### Corrélations

##### PSS_Stress
```{r correlations calculs PSS stress variables sportives}

# Calcul des corrélations pour toutes les variables sportives avec PSS Stress
correlations_pss_stress_sport <- map_df(variables_sportives, ~ compute_correlations(.x, "SCORE_PSS_Stress", data))

# Ajout des labels des variables
correlations_pss_stress_sport <- correlations_pss_stress_sport %>%
  mutate(Variable = variables_labels_sportives[Variable])

# Mise en forme conditionnelle de la colonne "Corr_PSS_Stress"
correlations_pss_stress_sport <- correlations_pss_stress_sport %>%
  mutate(
    Corr_SCORE_PSS_Stress = case_when(
      as.numeric(abs(Corr_SCORE_PSS_Stress)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_PSS_Stress, '</span>'),
      as.numeric(abs(Corr_SCORE_PSS_Stress)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_PSS_Stress, '</span>'),
      as.numeric(abs(Corr_SCORE_PSS_Stress)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_PSS_Stress, '</span>'),
      TRUE ~ as.character(Corr_SCORE_PSS_Stress)
    )
  )

# Affichage en HTML
kable(correlations_pss_stress_sport, format = "html", escape = FALSE)
```

##### PSS_Adaptation
```{r correlations calculs PSS adaptation variables sportives}

# Calcul des corrélations pour toutes les variables sportives avec PSS Stress
correlations_pss_adaptation_sport <- map_df(variables_sportives, ~ compute_correlations(.x, "SCORE_PSS_Adaptation", data))

# Ajout des labels des variables
correlations_pss_adaptation_sport <- correlations_pss_adaptation_sport %>%
  mutate(Variable = variables_labels_sportives[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_PSS_Adaptation"
correlations_pss_adaptation_sport <- correlations_pss_adaptation_sport %>%
  mutate(
    Corr_SCORE_PSS_Adaptation = case_when(
      as.numeric(abs(Corr_SCORE_PSS_Adaptation)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_PSS_Adaptation, '</span>'),
      as.numeric(abs(Corr_SCORE_PSS_Adaptation)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_PSS_Adaptation, '</span>'),
      as.numeric(abs(Corr_SCORE_PSS_Adaptation)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_PSS_Adaptation, '</span>'),
      TRUE ~ as.character(Corr_SCORE_PSS_Adaptation)
    )
  )

# Affichage en HTML
kable(correlations_pss_adaptation_sport, format = "html", escape = FALSE)
```

#### Test t de Student
```{r test student pss}
t_coach_pss_stress <- t.test(as.numeric(SCORE_PSS_Stress) ~ as.factor(Coach), data = data, var.equal = TRUE)

moyennes_pss_stress_coach <- data %>%
    group_by(Coach) %>%
    summarise(Moyenne = mean(SCORE_PSS_Stress, na.rm = TRUE))

table_coach_pss_stress <- data.frame(
    Variable = c(
        "Coach et PSS Stress"),
    Student = c(
        as.numeric(t_coach_pss_stress$statistic)
    ),
    p_value = t_coach_pss_stress$p.value,
    Significatif = c(
        ifelse(t_coach_pss_stress$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_coach = c(
        moyennes_pss_stress_coach$Moyenne[1]
    ),
    Sans_coach = c(
        moyennes_pss_stress_coach$Moyenne[2]
    )
)

kable(table_coach_pss_stress, format = "html", escape = FALSE)



t_coach_pss_adaptation <- t.test(as.numeric(SCORE_PSS_Adaptation) ~ as.factor(Coach), data = data, var.equal = TRUE)

moyennes_pss_adaptation_coach <- data %>%
    group_by(Coach) %>%
    summarise(Moyenne = mean(SCORE_PSS_Adaptation, na.rm = TRUE))

table_coach_pss_adaptation <- data.frame(
    Variable = c(
        "Coach et PSS Adaptation"),
    Student = c(
        as.numeric(t_coach_pss_adaptation$statistic)
    ),
    p_value = t_coach_pss_adaptation$p.value,
    Significatif = c(
        ifelse(t_coach_pss_adaptation$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_coach = c(
        moyennes_pss_adaptation_coach$Moyenne[1]
    ),
    Sans_coach = c(
        moyennes_pss_adaptation_coach$Moyenne[2]
    )
)

kable(table_coach_pss_adaptation, format = "html", escape = FALSE)


t_pgrm_pss_stress <- t.test(as.numeric(SCORE_PSS_Stress) ~ as.factor(Programme), data = data, var.equal = TRUE)

moyennes_pss_stress_pgrm <- data %>%
    group_by(Programme) %>%
    summarise(Moyenne = mean(SCORE_PSS_Stress, na.rm = TRUE))

table_pgrm_pss_stress <- data.frame(
    Variable = c(
        "Programme et PSS Stress"),
    Student = c(
        as.numeric(t_pgrm_pss_stress$statistic)
    ),
     p_value = t_pgrm_pss_stress$p.value,
   Significatif = c(
        ifelse(t_pgrm_pss_stress$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_programme = c(
        moyennes_pss_stress_pgrm$Moyenne[1]
    ),
    Sans_programme = c(
        moyennes_pss_stress_pgrm$Moyenne[2]
    )
)

kable(table_pgrm_pss_stress, format = "html", escape = FALSE)


t_pgrm_pss_adaptation <- t.test(as.numeric(SCORE_PSS_Adaptation) ~ as.factor(Programme), data = data, var.equal = TRUE)

moyennes_pss_adaptation_pgrm <- data %>%
    group_by(Programme) %>%
    summarise(Moyenne = mean(SCORE_PSS_Adaptation, na.rm = TRUE))

table_pgrm_pss_adaptation <- data.frame(
    Variable = c(
        "Programme et PSS Adaptation"),
    Student = c(
        as.numeric(t_pgrm_pss_adaptation$statistic)
    ),
    p_value = t_pgrm_pss_adaptation$p.value,
    Significatif = c(
        ifelse(t_pgrm_pss_adaptation$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_programme = c(
        moyennes_pss_adaptation_pgrm$Moyenne[1]
    ),
    Sans_programme = c(
        moyennes_pss_adaptation_pgrm$Moyenne[2]
    )
)

kable(table_pgrm_pss_adaptation, format = "html", escape = FALSE)


t_blessure_pss_stress <- t.test(as.numeric(SCORE_PSS_Stress) ~ as.factor(Blessure), data = data, var.equal = TRUE)

moyennes_pss_stress_blessure <- data %>%
    group_by(Blessure) %>%
    summarise(Moyenne = mean(SCORE_PSS_Stress, na.rm = TRUE))

table_blessure_pss_stress <- data.frame(
    Variable = c(
        "Blessure et score PSS Stress"),
    Student = c(
        as.numeric(t_blessure_pss_stress$statistic)
    ),
    p_value = t_blessure_pss_stress$p.value,
    Significatif = c(
        ifelse(t_blessure_pss_stress$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Blessure = c(
        moyennes_pss_stress_blessure$Moyenne[1]
    ),
    Pas_de_blessure = c(
        moyennes_pss_stress_blessure$Moyenne[2]
    )
)

kable(table_blessure_pss_stress, format = "html", escape = FALSE)



t_blessure_pss_adaptation <- t.test(as.numeric(SCORE_PSS_Adaptation) ~ as.factor(Blessure), data = data, var.equal = TRUE)

moyennes_pss_adaptation_blessure <- data %>%
    group_by(Blessure) %>%
    summarise(Moyenne = mean(SCORE_PSS_Adaptation, na.rm = TRUE))

table_blessure_pss_adaptation <- data.frame(
    Variable = c(
        "Blessure et score PSS Adaptation"),
    Student = c(
        as.numeric(t_blessure_pss_adaptation$statistic)
    ),
    p_value = t_blessure_pss_adaptation$p.value,
    Significatif = c(
        ifelse(t_blessure_pss_adaptation$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Blessure = c(
        moyennes_pss_adaptation_blessure$Moyenne[1]
    ),
    Pas_de_blessure = c(
        moyennes_pss_adaptation_blessure$Moyenne[2]
    )
)

kable(table_blessure_pss_adaptation, format = "html", escape = FALSE)

```

#### Visualisation graphique
```{r type abonnement score pss stress et blessure}
ggplot(data, aes(x = factor(Blessure, levels = c(1, 2), labels = c("Oui", "Non")),
                 y = SCORE_PSS_Stress,
                 fill = factor(Blessure, levels = c(1, 2), labels = c("Oui", "Non")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Blessure ou non",
       y = "Score PSS Stress",
       fill = "Blessure ou non") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
```


#### ANOVA

```{r anova pss pratique}
### Niveau, type coureur, objectif, pause blessure

anova_pss_stress_niveau <- summary(aov(SCORE_PSS_Stress ~ as.factor(Niveau), data = data))
anova_pss_stress_type_coureur <- summary(aov(SCORE_PSS_Stress ~ as.factor(Type_coureur), data = data))
anova_pss_stress_objectif <- summary(aov(SCORE_PSS_Stress ~ as.factor(Objectif_KM), data = data))
anova_pss_stress_pause <- summary(aov(SCORE_PSS_Stress ~ as.factor(Pause_blessure), data = data))

anova_pss_adaptation_niveau <- summary(aov(SCORE_PSS_Adaptation ~ as.factor(Niveau), data = data))
anova_pss_adaptation_type_coureur <- summary(aov(SCORE_PSS_Adaptation ~ as.factor(Type_coureur), data = data))
anova_pss_adaptation_objectif <- summary(aov(SCORE_PSS_Adaptation ~ as.factor(Objectif_KM), data = data))
anova_pss_adaptation_pause <- summary(aov(SCORE_PSS_Adaptation ~ as.factor(Pause_blessure), data = data))

moyenne_pss_stress_niveau <- data %>%
    group_by(Niveau) %>%
    summarise(Moyenne = mean(SCORE_PSS_Stress, na.rm = TRUE))

moyenne_pss_adaptation_niveau <- data %>%
    group_by(Niveau) %>%
    summarise(Moyenne = mean(SCORE_PSS_Adaptation, na.rm = TRUE))

moyenne_pss_stress_type_coureur <- data %>%
    group_by(Type_coureur) %>%
    summarise(Moyenne = mean(SCORE_PSS_Stress, na.rm = TRUE))

moyenne_pss_adaptation_type_coureur <- data %>%
    group_by(Type_coureur) %>%
    summarise(Moyenne = mean(SCORE_PSS_Adaptation, na.rm = TRUE))

moyenne_pss_stress_objectif <- data %>%
    group_by(Objectif_KM) %>%
    summarise(Moyenne = mean(SCORE_PSS_Stress, na.rm = TRUE))

moyenne_pss_adaptation_objectif <- data %>%
    group_by(Objectif_KM) %>%
    summarise(Moyenne = mean(SCORE_PSS_Adaptation, na.rm = TRUE))

moyenne_pss_stress_pause <- data %>%
    group_by(Pause_blessure) %>%
    summarise(Moyenne = mean(SCORE_PSS_Stress, na.rm = TRUE))

moyenne_pss_adaptation_pause <- data %>%
    group_by(Pause_blessure) %>%
    summarise(Moyenne = mean(SCORE_PSS_Adaptation, na.rm = TRUE))

anova_pss_niveau <- data.frame(
  Variable = c("Lien score PSS Stress et niveau", "Lien score PPS Adaptation et niveau"),
  F_value = c(anova_pss_stress_niveau[[1]]["F value"][1,1],anova_pss_adaptation_niveau[[1]]["F value"][1,1]), 
  P_value = c(anova_pss_stress_niveau[[1]]["Pr(>F)"][1,1],anova_pss_adaptation_niveau[[1]]["Pr(>F)"][1,1]),
 Significatif = ifelse(c(anova_pss_stress_niveau[[1]]["Pr(>F)"][1,1],anova_pss_adaptation_niveau[[1]]["Pr(>F)"][1,1] ) <0.05, "< 0.05", "≥ 0.05"),
 Débutant = c(moyenne_pss_stress_niveau$Moyenne[1], moyenne_pss_adaptation_niveau$Moyenne[1]),
 Intermédiaire = c(moyenne_pss_stress_niveau$Moyenne[2], moyenne_pss_adaptation_niveau$Moyenne[2]),
 Confirmé = c(moyenne_pss_stress_niveau$Moyenne[3], moyenne_pss_adaptation_niveau$Moyenne[3]),
 Expert = c(moyenne_pss_stress_niveau$Moyenne[4], moyenne_pss_adaptation_niveau$Moyenne[4]))
 
kable(anova_pss_niveau, format = "html", escape = FALSE)

anova_pss_type_coureur <- data.frame(
  Variable = c("Lien score PSS Stress et type coureur", "Lien score PSS Adaptation et type coureur"),
  F_value = c(anova_pss_stress_type_coureur[[1]]["F value"][1,1], anova_pss_adaptation_type_coureur[[1]]["F value"][1,1]),
  P_value = c(anova_pss_stress_type_coureur[[1]]["Pr(>F)"][1,1], anova_pss_adaptation_type_coureur[[1]]["Pr(>F)"][1,1]),
 Significatif = ifelse(c(anova_pss_stress_type_coureur[[1]]["Pr(>F)"][1,1], anova_pss_adaptation_type_coureur[[1]]["Pr(>F)"][1,1]) < 0.05, "< 0.05", "≥ 0.05"))

anova_moyenne_type_coureur_pss <- data.frame (
 Type_coureur = c("Route/Club/Seul", "Route/Pas club/Seul", "Route/Club/En groupe", "Route/Pas club/En groupe", "Trail/Club/Seul", "Trail/Pas club/Seul", "Trail/Club/En groupe", "Trail/Pas club/En groupe"),
 Moyenne_Stress = c(moyenne_pss_stress_type_coureur$Moyenne[1], moyenne_pss_stress_type_coureur$Moyenne[2], moyenne_pss_stress_type_coureur$Moyenne[3], moyenne_pss_stress_type_coureur$Moyenne[4],moyenne_pss_stress_type_coureur$Moyenne[5], moyenne_pss_stress_type_coureur$Moyenne[6], moyenne_pss_stress_type_coureur$Moyenne[7], moyenne_pss_stress_type_coureur$Moyenne[8]),
 Moyenne_Adaptation = c(moyenne_pss_adaptation_type_coureur$Moyenne[1], moyenne_pss_adaptation_type_coureur$Moyenne[2], moyenne_pss_adaptation_type_coureur$Moyenne[3], moyenne_pss_adaptation_type_coureur$Moyenne[4],moyenne_pss_adaptation_type_coureur$Moyenne[5], moyenne_pss_adaptation_type_coureur$Moyenne[6], moyenne_pss_adaptation_type_coureur$Moyenne[7], moyenne_pss_adaptation_type_coureur$Moyenne[8]))

kable(anova_pss_type_coureur, format = "html", escape = FALSE)
kable(anova_moyenne_type_coureur_pss)

anova_pss_objectif <- data.frame(
  Variable = c("Lien score PSS Stress et objectif 2025", "Lien score PSS Adaptation et objectif 2025"),
  F_value = c(anova_pss_stress_objectif[[1]]["F value"][1,1], anova_pss_adaptation_objectif[[1]]["F value"][1,1]),
  P_value = c(anova_pss_stress_objectif[[1]]["Pr(>F)"][1,1], anova_pss_adaptation_objectif[[1]]["Pr(>F)"][1,1]),
 Significatif = ifelse(c(anova_pss_stress_objectif[[1]]["Pr(>F)"][1,1], anova_pss_adaptation_objectif[[1]]["Pr(>F)"][1,1]) < 0.05, "< 0.05", "≥ 0.05"),
 Vingt_km = c(moyenne_pss_stress_objectif$Moyenne[1], moyenne_pss_adaptation_objectif$Moyenne[1]),
 Cinquante_km = c(moyenne_pss_stress_objectif$Moyenne[2], moyenne_pss_adaptation_objectif$Moyenne[2]),
 Cent_km = c(moyenne_pss_stress_objectif$Moyenne[3], moyenne_pss_adaptation_objectif$Moyenne[3]),
 Cent_miles = c(moyenne_pss_stress_objectif$Moyenne[4], moyenne_pss_adaptation_objectif$Moyenne[4]))
 
kable(anova_pss_objectif, format = "html", escape = FALSE)

anova_pss_pause <- data.frame(
  Variable = c("Lien score PSS Stress et pause blessure", "Lien score PSS Adaptation et pause blessure"),
  F_value = c(anova_pss_stress_pause[[1]]["F value"][1,1], anova_pss_adaptation_pause[[1]]["F value"][1,1]),
  P_value = c(anova_pss_stress_pause[[1]]["Pr(>F)"][1,1], anova_pss_adaptation_pause[[1]]["Pr(>F)"][1,1]),
 Significatif = ifelse(c(anova_pss_stress_pause[[1]]["Pr(>F)"][1,1], anova_pss_adaptation_pause[[1]]["Pr(>F)"][1,1]) <0.05, "< 0.05", "≥ 0.05"),
 Jours = c(moyenne_pss_stress_pause$Moyenne[1], moyenne_pss_adaptation_pause$Moyenne[1]),
 Semaines = c(moyenne_pss_stress_pause$Moyenne[2], moyenne_pss_adaptation_pause$Moyenne[2]),
 Mois = c(moyenne_pss_stress_pause$Moyenne[3], moyenne_pss_adaptation_pause$Moyenne[3]),
 Pas_de_pause = c(moyenne_pss_stress_pause$Moyenne[4], moyenne_pss_adaptation_pause$Moyenne[4]))
 
kable(anova_pss_pause, format = "html", escape = FALSE)
```


#### Tests post hoc
```{r test post hoc pss et niveau}

tukey_pss_stress_niveau <- TukeyHSD(aov(SCORE_PSS_Stress ~ as.factor(Niveau), data = data))
tukey_pss_adaptation_niveau <- TukeyHSD(aov(SCORE_PSS_Adaptation ~ as.factor(Niveau), data = data))
tukey_pss_stress_type_coureur <- TukeyHSD(aov(SCORE_PSS_Stress ~ as.factor(Type_coureur), data = data))
tukey_pss_adaptation_type_coureur <- TukeyHSD(aov(SCORE_PSS_Adaptation ~ as.factor(Type_coureur), data = data))
tukey_pss_stress_objectif <- TukeyHSD(aov(SCORE_PSS_Stress ~ as.factor(Objectif_KM), data = data))
tukey_pss_adaptation_objectif <- TukeyHSD(aov(SCORE_PSS_Adaptation ~ as.factor(Objectif_KM), data = data))
tukey_pss_stress_blessure <- TukeyHSD(aov(SCORE_PSS_Stress ~ as.factor(Pause_blessure), data = data))
tukey_pss_adaptation_blessure <- TukeyHSD(aov(SCORE_PSS_Adaptation ~ as.factor(Pause_blessure), data = data))

tukey_pss_stress_niveau_df <- as.data.frame(tukey_pss_stress_niveau[[1]]) 
tukey_pss_stress_niveau_df$Comparison <- rownames(tukey_pss_stress_niveau_df)
tukey_pss_stress_niveau_df$Variable <- "Lien score PSS Stress et niveau"
rownames(tukey_pss_stress_niveau_df) <- NULL

tukey_pss_adaptation_niveau_df <- as.data.frame(tukey_pss_adaptation_niveau[[1]]) 
tukey_pss_adaptation_niveau_df$Comparison <- rownames(tukey_pss_adaptation_niveau_df)
tukey_pss_adaptation_niveau_df$Variable <- "Lien score PSS Adaptation et niveau"
rownames(tukey_pss_adaptation_niveau_df) <- NULL

tukey_pss_stress_type_coureur_df <- as.data.frame(tukey_pss_stress_type_coureur[[1]]) 
tukey_pss_stress_type_coureur_df$Comparison <- rownames(tukey_pss_stress_type_coureur_df)
tukey_pss_stress_type_coureur_df$Variable <- "Lien score PSS Stress et type coureur"
rownames(tukey_pss_stress_type_coureur_df) <- NULL

tukey_pss_adaptation_type_coureur_df <- as.data.frame(tukey_pss_adaptation_type_coureur[[1]]) 
tukey_pss_adaptation_type_coureur_df$Comparison <- rownames(tukey_pss_adaptation_type_coureur_df)
tukey_pss_adaptation_type_coureur_df$Variable <- "Lien score PSS Adaptation et type coureur"
rownames(tukey_pss_adaptation_type_coureur_df) <- NULL

tukey_pss_stress_objectif_df <- as.data.frame(tukey_pss_stress_objectif[[1]]) 
tukey_pss_stress_objectif_df$Comparison <- rownames(tukey_pss_stress_objectif_df)
tukey_pss_stress_objectif_df$Variable <- "Lien score PSS Stress et objectif 2025"
rownames(tukey_pss_stress_objectif_df) <- NULL

tukey_pss_adaptation_objectif_df <- as.data.frame(tukey_pss_adaptation_objectif[[1]]) 
tukey_pss_adaptation_objectif_df$Comparison <- rownames(tukey_pss_adaptation_objectif_df)
tukey_pss_adaptation_objectif_df$Variable <- "Lien score PSS Adaptation et objectif 2025"
rownames(tukey_pss_adaptation_objectif_df) <- NULL

tukey_pss_stress_blessure_df <- as.data.frame(tukey_pss_stress_blessure[[1]]) 
tukey_pss_stress_blessure_df$Comparison <- rownames(tukey_pss_stress_blessure_df)
tukey_pss_stress_blessure_df$Variable <- "Lien score PSS Stress et blessure"
rownames(tukey_pss_stress_blessure_df) <- NULL

tukey_pss_adaptation_blessure_df <- as.data.frame(tukey_pss_adaptation_blessure[[1]]) 
tukey_pss_adaptation_blessure_df$Comparison <- rownames(tukey_pss_adaptation_blessure_df)
tukey_pss_adaptation_blessure_df$Variable <- "Lien score PSS Adaptation et blessure"
rownames(tukey_pss_adaptation_blessure_df) <- NULL

tukey_results_pss <- bind_rows(tukey_pss_stress_niveau_df, tukey_pss_adaptation_niveau_df, tukey_pss_stress_type_coureur_df, tukey_pss_adaptation_type_coureur_df, tukey_pss_stress_objectif_df, tukey_pss_adaptation_objectif_df, tukey_pss_stress_blessure_df,tukey_pss_adaptation_blessure_df )

tukey_signif_pss <- tukey_results_pss %>% filter(`p adj` < 0.05)

# Affichage des résultats sous forme de tableau HTML
knitr::kable(tukey_signif_pss, format = "html", escape = FALSE)
```

#### Visualisation graphique
```{r visualisation test post hoc pss}
ggplot(tukey_signif_pss, aes(x = Comparison, y = diff, fill = Variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_errorbar(aes(ymin = lwr, ymax = upr), width = 0.2, position = position_dodge(0.9)) +
  theme_minimal() +
  labs(title = "Comparaisons post-hoc (Tukey HSD)", 
       x = "Comparaison entre groupes", 
       y = "Différence de moyenne") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


### Conclusion hypothèse 3

**Rappel de l’hypothèse 3 : plus les coureurs amateurs utilisent Strava, plus ils sont susceptibles de ressentir du stress.**

Il est possible de se demander si les 2 scores PSS ont un lien avec la pratique (est-ce que par exemple le fait d’avoir une score PSS "stress perçu" est en lien avec le nombre de kilomètres parcourus par semaine ?)


Il n'y a pas de corrélations entre le score PSS "adaptation au stress" et le nombre de kilomètres et d'entraînements par semaine et le nombre de compétitions par an.

Il y a une corrélation négative entre le score PSS "stress perçu" et le nombre de kilomètres par semaine (-0.14) et le nombre d'entraînement par semaine (-0.12). Ce sont des corrélations faibles (<0.3). 

Il n'y a pas de corrélations entre le score PSS "stress perçu" et le nombre de compétitions par an.

Il n'est pas possible de mettre en évidence des différences de score PSS "stress perçu" ou PSS "adaptation au stress" avec le fait d'avoir un coach ou non ou le fait de suivre ou non un programme d'entraînement (test t de Student, p > 0.05). Il n'est pas possible de mettre en évidence des différences de score PSS "adaptation au stress" avec le fait d'avoir été blessé ou non ces 6 derniers mois (test t de Student, p>0.05).

Par contre, il est possible de mettre en évidence une différence de moyenne pour le score PSS "stress perçu" entre les personnes blessées ces 6 derniers mois ou non : les personnes blessées ces 6 derniers mois ont un score plus élevé.

Il n’est pas possible de mettre en évidence des différences significatives entre les 2 scores PSS et les différents niveaux de pratique, de même pour les types de coureurs, et les différentes durées de pause liées à des blesssures à cause de la course à pied pour les coureurs qui ont été blessés (ANOVA, p > 0.05).

Par contre, il y a des différences significatives pour les 2 scores PSS entre les différents types d'objectif 2025 : les coureurs qui ont pour objectif un 100 K ont un score PSS "stress perçu" plus élévé que ceux qui ont pour objectif un 50K. Les coureurs qui ont pour objectif un 100K on un score PSS "adpatation au stress" plus faible que ceux qui font un 50K. 

Le stress perçu par l'utilisation de Strava semble être peu lié aux différentes caractéristiques de la pratique, sauf pour le fait d'être blessé et le fait d'avoir un objectif en 2025.

# Mesure de la motivation

Dans l'étude de Russell (2023) ^3^, Strava est une source de motivation. Par exemple, il y a ce témoignagne concernant le fait de pouvoir interagir et se comparer "Pour ce marathon, je pense que nous essayons tous les cinq de suivre le même plan, donc je sais ce que chaque personne est censée faire chaque jour, donc j’ai l’impression que cela donne plus de responsabilité pour réaliser ce que je me suis fixé. Je ne sais pas si j’aurais suivi le programme d’entraînement autant que je l’ai fait si je n’avais pas eu Strava ou si je ne l’utilisais pas autant." Il y a également ce témoignagne concernant le fait de voir ses progrès "Honnêtement, c’est une grande source de motivation de voir visuellement tous ces chiffres changer au fur et à mesure que je continue à courir." et "c’est vraiment cool de voir jusqu’où j’ai progressé".

Dans cette étude, une traduction et adaptation du BREQ-3 (Behavioural Regulation In Exercise Questionnaire) en 12 items est utilisée. Cette échelle mesure la motivation intrinsèque, intégrée et identifiée (motivations autodéterminées) et la motivation introjectée et externe (motivations non-autodéterminées) et l'amotivation ^12^. Les alphas de Cronbach dans l'étude de Rocchi (2023)^12^ ne sont pas mentionnés. L'Oméga de McDonald est utilisé à la place et les valeurs sont de :

- Motivation intrinsèque	0.72 - 0.82
- Régulation intégrée	0.56 - 0.79
- Régulation identifiée	0.44 - 0.76
- Régulation introjectée	0.60 - 0.77
- Régulation externe	0.54 - 0.70
- Amotivation	0.59 - 0.63

Le score RAI dans l'échantillon est assez haut, ce qui suggère que les coureurs ont un haut niveau de motivation autonome (motivation intrinsèque, intégrée et identifiée).

### Motivation intrinsèque{.tabset}

```{r score bres intrinseque alpha cronbach}
data_BREQIntrinseque<- data[, c("BREQ_1", "BREQ_2")]
cronbachBREQIntrinseque<-cronbach(data_BREQIntrinseque)

glue ("L'alpha de Cronbach sur les {cronbachBREQIntrinseque$number.of.items} items est de {cronbachBREQIntrinseque$alpha}")
```
#### BREQ 1
```{r graphique breq 1}
data_resumeBREQ1 <- data%>%
  summarise(
    Moyenne = mean(BREQ_1, na.rm = TRUE),
    Médiane = median(BREQ_1, na.rm = TRUE),
    Ecart_type = sd(BREQ_1, na.rm=TRUE))

kable(data_resumeBREQ1)

ggplot(data, aes(x = factor(BREQ_1, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je trouve que courir est une activité agréable.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### BREQ 2
```{r graphique breq 2}
data_resumeBREQ2 <- data%>%
  summarise(
    Moyenne = mean(BREQ_2, na.rm = TRUE),
    Médiane = median(BREQ_2, na.rm = TRUE),
    Ecart_type = sd(BREQ_2, na.rm=TRUE))

kable(data_resumeBREQ2)

ggplot(data, aes(x = factor(BREQ_2, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je cours parce que c’est amusant.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Score motivation intrinsèque
```{r  graphique score intrinseque}
data <- data %>% mutate (SCORE_BREQ_Intrinseque = (BREQ_1+BREQ_2)/2)

data <- data %>% mutate(score_breq_intrinseque_categorystat = case_when(
    SCORE_BREQ_Intrinseque <2 ~  "1",
    SCORE_BREQ_Intrinseque >= 2 & SCORE_BREQ_Intrinseque < 3 ~"2",
    SCORE_BREQ_Intrinseque >= 3 & SCORE_BREQ_Intrinseque < 4 ~"3",
    SCORE_BREQ_Intrinseque ==4 ~  "4"
  ))


data_resumeBREQIntrinseque_round<- data%>%
  summarise(
    median = round(median(SCORE_BREQ_Intrinseque, na.rm = TRUE),1),
    moyenne= round(mean(SCORE_BREQ_Intrinseque, na.rm=TRUE),1),
    q1 = round(quantile(SCORE_BREQ_Intrinseque, 0.25, na.rm=T),1),
    q3 = round(quantile(SCORE_BREQ_Intrinseque, 0.75, na.rm=T),1)
  )

data_resumeBREQIntrinseque<- data%>%
  summarise(
    Médiane = median(SCORE_BREQ_Intrinseque, na.rm = TRUE),
    Moyenne= mean(SCORE_BREQ_Intrinseque, na.rm=TRUE),
    Ecart_type = sd(SCORE_BREQ_Intrinseque, na.rm=TRUE)
  )

table_BREQIntrinseque<- data.frame(
Item = c("BREQ 1", "BREQ 2", "SCORE_BREQ_Intrinseque"),
  Moyenne = c(data_resumeBREQ1$Moyenne, data_resumeBREQ2$Moyenne, 
              data_resumeBREQIntrinseque$Moyenne),
  Médiane = c(data_resumeBREQ1$Médiane, data_resumeBREQ2$Médiane, 
              data_resumeBREQIntrinseque$Médiane),
  Ecart_type = c(data_resumeBREQ1$Ecart_type, data_resumeBREQ2$Ecart_type, 
              data_resumeBREQIntrinseque$Ecart_type))
kable(table_BREQIntrinseque)

vlinesBREQ_Intrinseque <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeBREQIntrinseque_round$q1, data_resumeBREQIntrinseque_round$moyenne, data_resumeBREQIntrinseque_round$median, data_resumeBREQIntrinseque_round$q3)
)
vlinesBREQ_Intrinseque$annotation <- paste(vlinesBREQ_Intrinseque$label, ":", vlinesBREQ_Intrinseque$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_BREQ_Intrinseque), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_BREQ_Intrinseque, na.rm = TRUE), 
                                max(data$SCORE_BREQ_Intrinseque, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score BREQ (motivation intrinsèque)",
       x = "Score BREQ (motivation intrinsèque)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesBREQ_Intrinseque, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesBREQ_Intrinseque, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()


```

### Motivation intégrée{.tabset}

```{r score breq integree alpha cronbach}
data_BREQIntegree <- data[, c("BREQ_3", "BREQ_4")]
cronbachBREQIntegree<-cronbach(data_BREQIntegree)

glue ("L'alpha de Cronbach sur les {cronbachBREQIntegree$number.of.items} items est de {cronbachBREQIntegree$alpha}")
```

#### BREQ 3
```{r graphique breq3}
data_resumeBREQ3 <- data%>%
  summarise(
    Moyenne = mean(BREQ_3, na.rm = TRUE),
    Médiane = median(BREQ_3, na.rm = TRUE),
    Ecart_type = sd(BREQ_3, na.rm=TRUE))

kable(data_resumeBREQ3)

ggplot(data, aes(x = factor(BREQ_3, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je cours parce que c’est une part fondamentale de qui je suis.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### BREQ 4
```{r graphique breq4}
data_resumeBREQ4 <- data%>%
  summarise(
    Moyenne = mean(BREQ_4, na.rm = TRUE),
    Médiane = median(BREQ_4, na.rm = TRUE),
    Ecart_type = sd(BREQ_4, na.rm=TRUE))

kable(data_resumeBREQ4)

ggplot(data, aes(x = factor(BREQ_4, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je cours parce que c’est en accord avec mes objectifs de vie.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Score motivation intégrée
```{r graphique score integree}
data <- data %>% mutate (SCORE_BREQ_Integree = (BREQ_3+BREQ_4)/2)

data <- data %>% mutate(score_breq_integree_categorystat = case_when(
    SCORE_BREQ_Integree <2 ~  "1",
    SCORE_BREQ_Integree >= 2 & SCORE_BREQ_Integree < 3 ~"2",
    SCORE_BREQ_Integree >= 3 & SCORE_BREQ_Integree < 4 ~"3",
    SCORE_BREQ_Integree ==4 ~  "4"
  ))


data_resumeBREQIntegree_round<- data%>%
  summarise(
    median = round(median(SCORE_BREQ_Integree, na.rm = TRUE),1),
    moyenne= round(mean(SCORE_BREQ_Integree, na.rm=TRUE),1),
    q1 = round(quantile(SCORE_BREQ_Integree, 0.25, na.rm=T),1),
    q3 = round(quantile(SCORE_BREQ_Integree, 0.75, na.rm=T),1)
  )

data_resumeBREQIntegree<- data%>%
  summarise(
    Médiane = median(SCORE_BREQ_Integree, na.rm = TRUE),
    Moyenne= mean(SCORE_BREQ_Integree, na.rm=TRUE),
    Ecart_type = sd(SCORE_BREQ_Integree, na.rm=TRUE)
  )

table_BREQIntegree<- data.frame(
Item = c("BREQ 3", "BREQ 4", "SCORE_BREQ_Integree"),
  Moyenne = c(data_resumeBREQ3$Moyenne, data_resumeBREQ4$Moyenne, 
              data_resumeBREQIntegree$Moyenne),
  Médiane = c(data_resumeBREQ3$Médiane, data_resumeBREQ4$Médiane, 
              data_resumeBREQIntegree$Médiane),
  Ecart_type = c(data_resumeBREQ3$Ecart_type, data_resumeBREQ4$Ecart_type, 
              data_resumeBREQIntegree$Ecart_type))
kable(table_BREQIntegree)

vlinesBREQ_Integree <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeBREQIntegree_round$q1, data_resumeBREQIntegree_round$moyenne, data_resumeBREQIntegree_round$median, data_resumeBREQIntegree_round$q3)
)
vlinesBREQ_Integree$annotation <- paste(vlinesBREQ_Integree$label, ":", vlinesBREQ_Integree$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_BREQ_Integree), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_BREQ_Integree, na.rm = TRUE), 
                                max(data$SCORE_BREQ_Integree, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score BREQ (motivation intégrée)",
       x = "Score BREQ (motivation intégrée)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesBREQ_Integree, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesBREQ_Integree, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```


### Motivation identifiée{.tabset}

```{r score breq identifee alpha cronbach}
data_BREQIdentifiee <- data[, c("BREQ_5", "BREQ_6")]
cronbachBREQIdentifiee<-cronbach(data_BREQIdentifiee)

glue ("L'alpha de Cronbach sur les {cronbachBREQIdentifiee$number.of.items} items est de {cronbachBREQIdentifiee$alpha}")
```

#### BREQ 5
```{r graphique breq5}
data_resumeBREQ5 <- data%>%
  summarise(
    Moyenne = mean(BREQ_5, na.rm = TRUE),
    Médiane = median(BREQ_5, na.rm = TRUE),
    Ecart_type = sd(BREQ_5, na.rm=TRUE))

kable(data_resumeBREQ5)

ggplot(data, aes(x = factor(BREQ_5, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Il est important pour moi de courir.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### BREQ 6
```{r graphique breq6}
data_resumeBREQ6 <- data%>%
  summarise(
    Moyenne = mean(BREQ_6, na.rm = TRUE),
    Médiane = median(BREQ_6, na.rm = TRUE),
    Ecart_type = sd(BREQ_6, na.rm=TRUE))

kable(data_resumeBREQ6)

ggplot(data, aes(x = factor(BREQ_6, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "J'apprécie les bénéfices de la course à pied.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Score motivation identifiée
```{r graphique score identifiee}
data <- data %>% mutate (SCORE_BREQ_Identifiee = (BREQ_5+BREQ_6)/2)

data <- data %>% mutate(score_breq_identifiee_categorystat = case_when(
    SCORE_BREQ_Identifiee <2 ~  "1",
    SCORE_BREQ_Identifiee >= 2 & SCORE_BREQ_Identifiee < 3 ~"2",
    SCORE_BREQ_Identifiee >= 3 & SCORE_BREQ_Identifiee < 4 ~"3",
    SCORE_BREQ_Identifiee ==4 ~  "4"
  ))


data_resumeBREQIdentifiee_round<- data%>%
  summarise(
    median = round(median(SCORE_BREQ_Identifiee, na.rm = TRUE),1),
    moyenne= round(mean(SCORE_BREQ_Identifiee, na.rm=TRUE),1),
    q1 = round(quantile(SCORE_BREQ_Identifiee, 0.25, na.rm=T),1),
    q3 = round(quantile(SCORE_BREQ_Identifiee, 0.75, na.rm=T),1)
  )

data_resumeBREQIdentifiee<- data%>%
  summarise(
    Médiane = median(SCORE_BREQ_Identifiee, na.rm = TRUE),
    Moyenne= mean(SCORE_BREQ_Identifiee, na.rm=TRUE),
    Ecart_type = sd(SCORE_BREQ_Identifiee, na.rm=TRUE)
  )

table_BREQIdentifiee<- data.frame(
Item = c("BREQ 5", "BREQ 6", "SCORE_BREQ_Identifiee"),
  Moyenne = c(data_resumeBREQ5$Moyenne, data_resumeBREQ6$Moyenne, 
              data_resumeBREQIdentifiee$Moyenne),
  Médiane = c(data_resumeBREQ5$Médiane, data_resumeBREQ6$Médiane, 
              data_resumeBREQIdentifiee$Médiane),
  Ecart_type = c(data_resumeBREQ5$Ecart_type, data_resumeBREQ6$Ecart_type, 
              data_resumeBREQIdentifiee$Ecart_type))
kable(table_BREQIdentifiee)

vlinesBREQ_Identifiee <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeBREQIdentifiee_round$q1, data_resumeBREQIdentifiee_round$moyenne, data_resumeBREQIdentifiee_round$median, data_resumeBREQIdentifiee_round$q3)
)
vlinesBREQ_Identifiee$annotation <- paste(vlinesBREQ_Identifiee$label, ":", vlinesBREQ_Identifiee$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_BREQ_Identifiee), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_BREQ_Identifiee, na.rm = TRUE), 
                                max(data$SCORE_BREQ_Identifiee, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score BREQ (motivation identifiée)",
       x = "Score BREQ (motivation identifiée)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesBREQ_Identifiee, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesBREQ_Identifiee, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

### Motivation introjectéee{.tabset}

```{r breq score introjectee alpha cronbach }
data_BREQIntrojectee <- data[, c("BREQ_7", "BREQ_8")]
cronbachBREQIntrojectee<-cronbach(data_BREQIntrojectee)

glue ("L'alpha de Cronbach sur les {cronbachBREQIntrojectee$number.of.items} items est de {cronbachBREQIntrojectee$alpha}")
```

#### BREQ 7
```{r graphique breq7}
data_resumeBREQ7 <- data%>%
  summarise(
    Moyenne = mean(BREQ_7, na.rm = TRUE),
    Médiane = median(BREQ_7, na.rm = TRUE),
    Ecart_type = sd(BREQ_7, na.rm=TRUE))

kable(data_resumeBREQ7)

ggplot(data, aes(x = factor(BREQ_7, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je me sens honteux(se) si je manque un entraînement de course à pied.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### BREQ 8
```{r graphique breq8}
data_resumeBREQ8 <- data%>%
  summarise(
    Moyenne = mean(BREQ_8, na.rm = TRUE),
    Médiane = median(BREQ_8, na.rm = TRUE),
    Ecart_type = sd(BREQ_8, na.rm=TRUE))

kable(data_resumeBREQ8)

ggplot(data, aes(x = factor(BREQ_8, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je me sens en échec si je n’ai pas couru.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Score motivation introjectée
```{r graphique score introjectee}
data <- data %>% mutate (SCORE_BREQ_Introjectee = (BREQ_7+BREQ_8)/2)

data <- data %>% mutate(score_breq_Introjectee_categorystat = case_when(
    SCORE_BREQ_Introjectee <2 ~  "1",
    SCORE_BREQ_Introjectee >= 2 & SCORE_BREQ_Introjectee < 3 ~"2",
    SCORE_BREQ_Introjectee >= 3 & SCORE_BREQ_Introjectee < 4 ~"3",
    SCORE_BREQ_Introjectee ==4 ~  "4"
  ))

data_resumeBREQIntrojectee_round<- data%>%
  summarise(
    median = round(median(SCORE_BREQ_Introjectee, na.rm = TRUE),1),
    moyenne= round(mean(SCORE_BREQ_Introjectee, na.rm=TRUE),1),
    q1 = round(quantile(SCORE_BREQ_Introjectee, 0.25, na.rm=T),1),
    q3 = round(quantile(SCORE_BREQ_Introjectee, 0.75, na.rm=T),1)
  )

data_resumeBREQIntrojectee<- data%>%
  summarise(
    Médiane = median(SCORE_BREQ_Introjectee, na.rm = TRUE),
    Moyenne= mean(SCORE_BREQ_Introjectee, na.rm=TRUE),
    Ecart_type = sd(SCORE_BREQ_Introjectee, na.rm=TRUE)
  )

table_BREQIntrojectee<- data.frame(
Item = c("BREQ 7", "BREQ 8", "SCORE_BREQ_Introjectee"),
  Moyenne = c(data_resumeBREQ7$Moyenne, data_resumeBREQ8$Moyenne, 
              data_resumeBREQIntrojectee$Moyenne),
  Médiane = c(data_resumeBREQ7$Médiane, data_resumeBREQ8$Médiane, 
              data_resumeBREQIntrojectee$Médiane),
  Ecart_type = c(data_resumeBREQ7$Ecart_type, data_resumeBREQ8$Ecart_type, 
              data_resumeBREQIntrojectee$Ecart_type))
kable(table_BREQIntrojectee)

vlinesBREQ_Introjectee <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeBREQIntrojectee_round$q1, data_resumeBREQIntrojectee_round$moyenne, data_resumeBREQIntrojectee_round$median, data_resumeBREQIntrojectee_round$q3)
)
vlinesBREQ_Introjectee$annotation <- paste(vlinesBREQ_Introjectee$label, ":", vlinesBREQ_Introjectee$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_BREQ_Introjectee), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_BREQ_Introjectee, na.rm = TRUE), 
                                max(data$SCORE_BREQ_Introjectee, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score BREQ (motivation introjectée)",
       x = "Score BREQ (motivation introjectée)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesBREQ_Introjectee, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesBREQ_Introjectee, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```


### Motivation externe{.tabset}

```{r score externe breq alpha cronbach}
data_BREQExterne <- data[, c("BREQ_9", "BREQ_10")]
cronbachBREQExterne<-cronbach(data_BREQExterne)

glue ("L'alpha de Cronbach sur les {cronbachBREQExterne$number.of.items} items est de {cronbachBREQExterne$alpha}")
```

#### BREQ 9
```{r graphique breq9}
data_resumeBREQ9 <- data%>%
  summarise(
    Moyenne = mean(BREQ_9, na.rm = TRUE),
    Médiane = median(BREQ_9, na.rm = TRUE),
    Ecart_type = sd(BREQ_9, na.rm=TRUE))

kable(data_resumeBREQ9)

ggplot(data, aes(x = factor(BREQ_9, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je ressens de la pression de mes amis pour courir.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### BREQ 10
```{r graphique breq10}
data_resumeBREQ10 <- data%>%
  summarise(
    Moyenne = mean(BREQ_10, na.rm = TRUE),
    Médiane = median(BREQ_10, na.rm = TRUE),
    Ecart_type = sd(BREQ_10, na.rm=TRUE))

kable(data_resumeBREQ10)

ggplot(data, aes(x = factor(BREQ_10, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je cours parce que les autres disent qu’il faut que je le fasse.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Score motivation externe
```{r graphique score externe breq}
data <- data %>% mutate (SCORE_BREQ_Externe = (BREQ_9+BREQ_10)/2)

data <- data %>% mutate(score_breq_Externe_categorystat = case_when(
    SCORE_BREQ_Externe <2 ~  "1",
    SCORE_BREQ_Externe >= 2 & SCORE_BREQ_Externe < 3 ~"2",
    SCORE_BREQ_Externe >= 3 & SCORE_BREQ_Externe < 4 ~"3",
    SCORE_BREQ_Externe ==4 ~  "4"
  ))


data_resumeBREQExterne_round<- data%>%
  summarise(
    median = round(median(SCORE_BREQ_Externe, na.rm = TRUE),1),
    moyenne= round(mean(SCORE_BREQ_Externe, na.rm=TRUE),1),
    q1 = round(quantile(SCORE_BREQ_Externe, 0.25, na.rm=T),1),
    q3 = round(quantile(SCORE_BREQ_Externe, 0.75, na.rm=T),1)
  )

data_resumeBREQExterne<- data%>%
  summarise(
    Médiane = median(SCORE_BREQ_Externe, na.rm = TRUE),
    Moyenne= mean(SCORE_BREQ_Externe, na.rm=TRUE),
    Ecart_type = sd(SCORE_BREQ_Externe, na.rm=TRUE)
  )

table_BREQExterne<- data.frame(
Item = c("BREQ 9", "BREQ 10", "SCORE_BREQ_Externe"),
  Moyenne = c(data_resumeBREQ9$Moyenne, data_resumeBREQ10$Moyenne, 
              data_resumeBREQExterne$Moyenne),
  Médiane = c(data_resumeBREQ9$Médiane, data_resumeBREQ10$Médiane, 
              data_resumeBREQExterne$Médiane),
  Ecart_type = c(data_resumeBREQ9$Ecart_type, data_resumeBREQ10$Ecart_type, 
              data_resumeBREQExterne$Ecart_type))
kable(table_BREQExterne)

vlinesBREQ_Externe <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeBREQExterne_round$q1, data_resumeBREQExterne_round$moyenne, data_resumeBREQExterne_round$median, data_resumeBREQExterne_round$q3)
)
vlinesBREQ_Externe$annotation <- paste(vlinesBREQ_Externe$label, ":", vlinesBREQ_Externe$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_BREQ_Externe), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_BREQ_Externe, na.rm = TRUE), 
                                max(data$SCORE_BREQ_Externe, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score BREQ (motivation externe)",
       x = "Score BREQ (motivation externe)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesBREQ_Externe, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesBREQ_Externe, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```


### Amotivation{.tabset}

```{r score amotivation breq alpha cronbach}
data_BREQA <- data[, c("BREQ_11", "BREQ_12")]
cronbachBREQA<-cronbach(data_BREQA)

glue ("L'alpha de Cronbach sur les {cronbachBREQA$number.of.items} items est de {cronbachBREQA$alpha}")
```

#### BREQ 11
```{r graphique breq11}
data_resumeBREQ11 <- data%>%
  summarise(
    Moyenne = mean(BREQ_11, na.rm = TRUE),
    Médiane = median(BREQ_11, na.rm = TRUE),
    Ecart_type = sd(BREQ_11, na.rm=TRUE))

kable(data_resumeBREQ11)

ggplot(data, aes(x = factor(BREQ_11, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je ne vois pas pourquoi je devrais courir.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### BREQ 12
```{r graphique breq12}
data_resumeBREQ12 <- data%>%
  summarise(
    Moyenne = mean(BREQ_12, na.rm = TRUE),
    Médiane = median(BREQ_12, na.rm = TRUE),
    Ecart_type = sd(BREQ_12, na.rm=TRUE))

kable(data_resumeBREQ12)

ggplot(data, aes(x = factor(BREQ_12, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je pense que courir est une perte de temps.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Score amotivation
```{r graphique score amotivation breq}
data <- data %>% mutate (SCORE_BREQA = (BREQ_11+BREQ_12)/2)

data <- data %>% mutate(score_breqa_categorystat = case_when(
    SCORE_BREQA <2 ~  "1",
    SCORE_BREQA >= 2 & SCORE_BREQA < 3 ~"2",
    SCORE_BREQA >= 3 & SCORE_BREQA < 4 ~"3",
    SCORE_BREQA ==4 ~  "4"
  ))


data_resumeBREQA_round<- data%>%
  summarise(
    median = round(median(SCORE_BREQA, na.rm = TRUE),1),
    moyenne= round(mean(SCORE_BREQA, na.rm=TRUE),1),
    q1 = round(quantile(SCORE_BREQA, 0.25, na.rm=T),1),
    q3 = round(quantile(SCORE_BREQA, 0.75, na.rm=T),1)
  )

data_resumeBREQA<- data%>%
  summarise(
    Médiane = median(SCORE_BREQA, na.rm = TRUE),
    Moyenne= mean(SCORE_BREQA, na.rm=TRUE),
    Ecart_type = sd(SCORE_BREQA, na.rm=TRUE)
  )

table_BREQA<- data.frame(
Item = c("BREQ 11", "BREQ 12", "SCORE_BREQ_Amotivation"),
  Moyenne = c(data_resumeBREQ11$Moyenne, data_resumeBREQ12$Moyenne, 
              data_resumeBREQA$Moyenne),
  Médiane = c(data_resumeBREQ11$Médiane, data_resumeBREQ12$Médiane, 
              data_resumeBREQA$Médiane),
  Ecart_type = c(data_resumeBREQ11$Ecart_type, data_resumeBREQ12$Ecart_type, 
              data_resumeBREQA$Ecart_type))
kable(table_BREQA)

vlinesBREQA <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeBREQA_round$q1, data_resumeBREQA_round$moyenne, data_resumeBREQA_round$median, data_resumeBREQA_round$q3)
)
vlinesBREQA$annotation <- paste(vlinesBREQA$label, ":", vlinesBREQA$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_BREQA), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_BREQA, na.rm = TRUE), 
                                max(data$SCORE_BREQA, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score BREQ (amotivation)",
       x = "Score BREQ (amotivation)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesBREQA, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesBREQA, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

### Relative Autonomy Index{.tabset}
Le Relative Autonomy Index est un indice qui mesure l'autonomie motivationnelle en pondérant les types de motivation selon leur degré d'autodétermination^12^. Il se calcule en faisant la somme suivante :

(-3)xScore_amotivation + (-2)xScore_motivation_externe + (-1)xScore_motivation_introjectée + Score_motivitation identifiée + 2x Score_motivation_intégrée + 3x Score_motivationè_intrinsèque.

Un haut score signifie que que l'individu est motivé de manière autonome (raisons intrinsèques ou identifiées) tandis qu'un score bas indique que l'individu est amotivé ou a une motivation contrôlée.

```{r score rai breq}
data <- data %>% mutate (SCORE_RAI = (-3)*SCORE_BREQA+ (-2)*SCORE_BREQ_Externe + (-1)*SCORE_BREQ_Introjectee + SCORE_BREQ_Identifiee + 2*SCORE_BREQ_Integree + 3*SCORE_BREQ_Intrinseque)

data_resumeRAI_round<- data%>%
  summarise(
  median = round(median(SCORE_RAI, na.rm = TRUE),1),
    moyenne= round(mean(SCORE_RAI, na.rm=TRUE),1),
    q1 = round(quantile(SCORE_RAI, 0.25, na.rm=T),1),
    q3 = round(quantile(SCORE_RAI, 0.75, na.rm=T),1)
  )

data_resumeRAI<- data%>%
  summarise(
    Médiane = median(SCORE_RAI, na.rm = TRUE),
    Moyenne= mean(SCORE_RAI, na.rm=TRUE),
    Ecart_type = sd(SCORE_RAI, na.rm=TRUE)
  )

table_RAI<- data.frame(
Item = c("RAI"),
  Moyenne = c(data_resumeRAI$Moyenne),
  Médiane = c(data_resumeRAI$Médiane),
  Ecart_type = c(data_resumeRAI$Ecart_type))

kable(table_RAI)

vlinesRAI <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeRAI_round$q1, data_resumeRAI_round$moyenne, data_resumeRAI_round$median, data_resumeRAI_round$q3)
)
vlinesRAI$annotation <- paste(vlinesRAI$label, ":", vlinesRAI$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_RAI), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_RAI, na.rm = TRUE), 
                                max(data$SCORE_RAI, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition de l'indice RAI",
       x = "Score RAI", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesRAI, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesRAI, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()


```

# Lien utilisation de Strava - motivation (hypothèse 4)

La question ici est de savoir si l'utilisation de Strava (intensité et fréquence d'utilisation, utilisation des fonctionnalités de sociabilisation en ligne et exposition d'informations personnelles...) ont un lien avec la motivation à courir (scores BREQ).

**Rappel de l’hypothèse 4 : plus les coureurs amateurs utilisent Strava, plus ils sont motivés dans leur pratique.**

On peut tester les liens entre les variables Strava suivantes avec les scores BREQ :

- Score SIS
- Score OSF
- Score exposition
- Appartenance à des clubs Strava
- Nombre de kudos reçus en moyenne par activité
- Nombre de publications par semaine (fréquence de publication)
- Nombre de consultations par semaine (fréquence de consultation)
- Nombre d’abonnés
- Nombre d’abonnements
- Ancienneté sur Strava
- Catégorie d’abonnement (gratuit/payant)

### Une première approche{.tabset}

```{r graph motivation Strava}
data_resumeStrava_motivation <- data%>%
  summarise(
    Moyenne = mean(Strava_motivation, na.rm = TRUE),
    Médiane = median(Strava_motivation, na.rm = TRUE),
    Ecart_type = sd(Strava_motivation, na.rm=TRUE))

kable(data_resumeStrava_motivation)

ggplot(data, aes(x = factor(Strava_motivation, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je me sens plus motivé(e) depuis que j'ai Strava.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

### Statistiques{.tabset}

#### Corrélations{.tabset}
##### Intrinsèque
```{r correlations calculs BREQ intrinsque}
# Calcul des corrélations pour toutes les variables avec motivation intrinsèque
correlations_intrinseque <- map_df(variables_strava, ~ compute_correlations(.x, "SCORE_BREQ_Intrinseque", data))

# Ajout des labels des variables
correlations_intrinseque <- correlations_intrinseque %>%
  mutate(Variable = variable_labels_strava[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_BREQ_Intrinseque"
correlations_intrinseque <- correlations_intrinseque %>%
  mutate(
    Corr_SCORE_BREQ_Intrinseque = case_when(
      as.numeric(abs(Corr_SCORE_BREQ_Intrinseque)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_BREQ_Intrinseque, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Intrinseque)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_BREQ_Intrinseque, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Intrinseque)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_BREQ_Intrinseque, '</span>'),
      TRUE ~ as.character(Corr_SCORE_BREQ_Intrinseque)
    )
  )

# Affichage en HTML
kable(correlations_intrinseque, format = "html", escape = FALSE)

```
##### Intégrée
```{r correlations calculs BREQ integree}
# Calcul des corrélations pour toutes les variables avec motivation intégrée
correlations_integree <- map_df(variables_strava, ~ compute_correlations(.x, "SCORE_BREQ_Integree", data))

# Ajout des labels des variables
correlations_integree <- correlations_integree %>%
  mutate(Variable = variable_labels_strava[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_BREQ_Integree"
correlations_integree <- correlations_integree %>%
  mutate(
    Corr_SCORE_BREQ_Integree = case_when(
      as.numeric(abs(Corr_SCORE_BREQ_Integree)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_BREQ_Integree, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Integree)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_BREQ_Integree, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Integree)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_BREQ_Integree, '</span>'),
      TRUE ~ as.character(Corr_SCORE_BREQ_Integree)
    )
  )

# Affichage en HTML
kable(correlations_integree, format = "html", escape = FALSE)

```

##### Identifiee
```{r correlations calculs BREQ identifiee}
# Calcul des corrélations pour toutes les variables avec motivation identifiee
correlations_identifiee <- map_df(variables_strava, ~ compute_correlations(.x, "SCORE_BREQ_Identifiee", data))

# Ajout des labels des variables
correlations_identifiee <- correlations_identifiee %>%
  mutate(Variable = variable_labels_strava[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_BREQ_Integree"
correlations_identifiee <- correlations_identifiee %>%
  mutate(
    Corr_SCORE_BREQ_Identifiee = case_when(
      as.numeric(abs(Corr_SCORE_BREQ_Identifiee)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_BREQ_Identifiee, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Identifiee)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_BREQ_Identifiee, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Identifiee)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_BREQ_Identifiee, '</span>'),
      TRUE ~ as.character(Corr_SCORE_BREQ_Identifiee)
    )
  )

# Affichage en HTML
kable(correlations_identifiee, format = "html", escape = FALSE)

```

##### Introjectée
```{r correlations calculs BREQ introjectee}
# Calcul des corrélations pour toutes les variables avec motivation identifiee
correlations_introjectee <- map_df(variables_strava, ~ compute_correlations(.x, "SCORE_BREQ_Introjectee", data))

# Ajout des labels des variables
correlations_introjectee <- correlations_introjectee %>%
  mutate(Variable = variable_labels_strava[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_BREQ_Introjectee"
correlations_introjectee <- correlations_introjectee %>%
  mutate(
    Corr_SCORE_BREQ_Introjectee = case_when(
      as.numeric(abs(Corr_SCORE_BREQ_Introjectee)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_BREQ_Introjectee, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Introjectee)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_BREQ_Introjectee, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Introjectee)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_BREQ_Introjectee, '</span>'),
      TRUE ~ as.character(Corr_SCORE_BREQ_Introjectee)
    )
  )

# Affichage en HTML
kable(correlations_introjectee, format = "html", escape = FALSE)

```

##### Externe
```{r correlations calculs BREQ externe}
# Calcul des corrélations pour toutes les variables avec motivation externe
correlations_externe <- map_df(variables_strava, ~ compute_correlations(.x, "SCORE_BREQ_Externe", data))

# Ajout des labels des variables
correlations_externe <- correlations_externe %>%
  mutate(Variable = variable_labels_strava[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_BREQ_Externe"
correlations_externe <- correlations_externe %>%
  mutate(
    Corr_SCORE_BREQ_Externe = case_when(
      as.numeric(abs(Corr_SCORE_BREQ_Externe)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_BREQ_Externe, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Externe)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_BREQ_Externe, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Externe)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_BREQ_Externe, '</span>'),
      TRUE ~ as.character(Corr_SCORE_BREQ_Externe)
    )
  )

# Affichage en HTML
kable(correlations_externe, format = "html", escape = FALSE)

```


##### Amotivation
```{r correlations calculs BREQ amotivation}
# Calcul des corrélations pour toutes les variables avec amotivation
correlations_amotivation <- map_df(variables_strava, ~ compute_correlations(.x, "SCORE_BREQA", data))

# Ajout des labels des variables
correlations_amotivation <- correlations_amotivation %>%
  mutate(Variable = variable_labels_strava[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_BREQ_Amotivation"
correlations_amotivation <- correlations_amotivation %>%
  mutate(
    Corr_SCORE_BREQA = case_when(
      as.numeric(abs(Corr_SCORE_BREQA)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_BREQA, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQA)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_BREQA, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQA)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_BREQA, '</span>'),
      TRUE ~ as.character(Corr_SCORE_BREQA)
    )
  )

# Affichage en HTML
kable(correlations_amotivation, format = "html", escape = FALSE)

```

##### RAI
```{r correlations calculs BREQ rai}
# Calcul des corrélations pour toutes les variables avec rai
correlations_rai <- map_df(variables_strava, ~ compute_correlations(.x, "SCORE_RAI", data))

# Ajout des labels des variables
correlations_rai <- correlations_rai %>%
  mutate(Variable = variable_labels_strava[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_BREQ_Amotivation"
correlations_rai <- correlations_rai %>%
  mutate(
    Corr_SCORE_RAI = case_when(
      as.numeric(abs(Corr_SCORE_RAI)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_RAI, '</span>'),
      as.numeric(abs(Corr_SCORE_RAI)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_RAI, '</span>'),
      as.numeric(abs(Corr_SCORE_RAI)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_RAI, '</span>'),
      TRUE ~ as.character(Corr_SCORE_RAI)
    )
  )

# Affichage en HTML
kable(correlations_rai, format = "html", escape = FALSE)

```


#### Visualisation graphique {.tabset}

##### SIS- Introjectée
```{r graphique score sis en fonction introjectee}
plot_correlation("SCORE_SIS","SCORE_BREQ_Introjectee", data, list("SCORE_BREQ_Introjectee" = "Motivation introjectée", "SCORE_SIS" = "Score Strava Intensity Scale"))
```

##### Kudos- Intégrée
```{r graphique nb kudos recus intégrée}
plot_correlation( "Kudos_reçus","SCORE_BREQ_Integree", data, list("SCORE_BREQ_Integree" = "Motivation intégrée", "Kudos_reçus" = "Kudos reçus par activité"))
```

##### Fréquence de publication - Intrinsèque
```{r graphique freq publi recus intrinseque}
plot_correlation("Fréquence_publication", "SCORE_BREQ_Intrinseque", data, list("SCORE_BREQ_Intrinseque" = "Motivation intrinsèque", "Fréquence_publication" = "Nombre de publications par semaine"))
```

##### Fréquence de publication - Intégrée
```{r graphique freq publi recus intégrée}
plot_correlation("Fréquence_publication", "SCORE_BREQ_Integree", data, list("SCORE_BREQ_Integree" = "Motivation intégrée", "Fréquence_publication" = "Nombre de publications par semaine"))
```

##### Fréquence de publication - Identifiée
```{r graphique freq publi recus identifiée}
plot_correlation("Fréquence_publication","SCORE_BREQ_Identifiee", data, list("SCORE_BREQ_Identifiee" = "Motivation identifiée", "Fréquence_publication" = "Nombre de publications par semaine"))
```

##### Nombre abonnements - Intégrée
```{r graphique nb abonnements intégrée}
plot_correlation("Nb_abonnements","SCORE_BREQ_Integree", data, list("SCORE_BREQ_Integree" = "Motivation intégrée", "Nb_abonnements" = "Nombre d'abonnements"))
```

#### Test t de Student
```{r test t student pour type abonnement et breq}
t_typeabonnement_intrinseque <- t.test(as.numeric(SCORE_BREQ_Intrinseque) ~ as.factor(Catégorie_abonnement), data = data, var.equal = TRUE)

t_typeabonnement_introjectee <- t.test(as.numeric(SCORE_BREQ_Introjectee) ~ as.factor(Catégorie_abonnement), data = data, var.equal = TRUE)

t_typeabonnement_identifiee <- t.test(as.numeric(SCORE_BREQ_Identifiee) ~ as.factor(Catégorie_abonnement), data = data, var.equal = TRUE)

t_typeabonnement_integree <- t.test(as.numeric(SCORE_BREQ_Integree) ~ as.factor(Catégorie_abonnement), data = data, var.equal = TRUE)

t_typeabonnement_externe <- t.test(as.numeric(SCORE_BREQ_Externe) ~ as.factor(Catégorie_abonnement), data = data, var.equal = TRUE)

t_typeabonnement_amotivation <- t.test(as.numeric(SCORE_BREQA) ~ as.factor(Catégorie_abonnement), data = data, var.equal = TRUE)

t_typeabonnement_rai <- t.test(as.numeric(SCORE_RAI) ~ as.factor(Catégorie_abonnement), data = data, var.equal = TRUE)

moyennes_introjectee_typeabonnement <- data %>%
    group_by(Catégorie_abonnement) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Introjectee, na.rm = TRUE))

moyennes_identifiee_typeabonnement <- data %>%
    group_by(Catégorie_abonnement) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Identifiee, na.rm = TRUE))

moyennes_integree_typeabonnement <- data %>%
    group_by(Catégorie_abonnement) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Integree, na.rm = TRUE))

moyennes_intrinseque_typeabonnement <- data %>%
    group_by(Catégorie_abonnement) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Intrinseque, na.rm = TRUE))

moyennes_externe_typeabonnement <- data %>%
    group_by(Catégorie_abonnement) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Externe, na.rm = TRUE))

moyennes_amotivation_typeabonnement <- data %>%
    group_by(Catégorie_abonnement) %>%
    summarise(Moyenne = mean(SCORE_BREQA, na.rm = TRUE))

moyennes_rai_typeabonnement <- data %>%
    group_by(Catégorie_abonnement) %>%
    summarise(Moyenne = mean(SCORE_RAI, na.rm = TRUE))


table_typeabonnement_intrinseque <- data.frame(
    Variable = c(
        "Catégorie d'abonnement et score BREQ Intrinseque"),
    Student = c(
        as.numeric(t_typeabonnement_intrinseque$statistic)
    ),
    P_Value = t_typeabonnement_intrinseque$p.value,
    Significatif = c(
        ifelse(t_typeabonnement_intrinseque$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Gratuit = c(
        moyennes_intrinseque_typeabonnement$Moyenne[1]
    ),
    Payant = c(
        moyennes_intrinseque_typeabonnement$Moyenne[2]
    )
)


table_typeabonnement_identifiee <- data.frame(
    Variable = c(
        "Catégorie d'abonnement et score BREQ Identifiee"),
    Student = c(
        as.numeric(t_typeabonnement_identifiee$statistic)
    ),
    P_Value= t_typeabonnement_identifiee$p.value,
    Significatif = c(
        ifelse(t_typeabonnement_identifiee$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Gratuit = c(
        moyennes_identifiee_typeabonnement$Moyenne[1]
    ),
    Payant = c(
        moyennes_identifiee_typeabonnement$Moyenne[2]
    )
)

table_typeabonnement_introjectee <- data.frame(
    Variable = c(
        "Catégorie d'abonnement et score BREQ Introjectee"),
    Student = c(
        as.numeric(t_typeabonnement_introjectee$statistic)
    ),
    P_Value = t_typeabonnement_introjectee$p.value,
    Significatif = c(
        ifelse(t_typeabonnement_introjectee$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Gratuit = c(
        moyennes_introjectee_typeabonnement$Moyenne[1]
    ),
    Payant = c(
        moyennes_introjectee_typeabonnement$Moyenne[2]
    )
)


table_typeabonnement_integree <- data.frame(
    Variable = c(
        "Catégorie d'abonnement et score BREQ Integree"),
    Student = c(
        as.numeric(t_typeabonnement_integree$statistic)
    ),
    P_Value= t_typeabonnement_integree$p.value,
    Significatif = c(
        ifelse(t_typeabonnement_integree$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Gratuit = c(
        moyennes_integree_typeabonnement$Moyenne[1]
    ),
    Payant = c(
        moyennes_integree_typeabonnement$Moyenne[2]
    )
)


table_typeabonnement_externe <- data.frame(
    Variable = c(
        "Catégorie d'abonnement et score BREQ Externe"),
    Student = c(
        as.numeric(t_typeabonnement_externe$statistic)
    ),
    P_Value=t_typeabonnement_externe$p.value,
    Significatif = c(
        ifelse(t_typeabonnement_externe$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Gratuit = c(
        moyennes_externe_typeabonnement$Moyenne[1]
    ),
    Payant = c(
        moyennes_externe_typeabonnement$Moyenne[2]
    )
)


table_typeabonnement_amotivation <- data.frame(
    Variable = c(
        "Catégorie d'abonnement et score BREQ Amotivation"),
    Student = c(
        as.numeric(t_typeabonnement_amotivation$statistic)
    ),
    P_Value= t_typeabonnement_amotivation$p.value,
    Significatif = c(
        ifelse(t_typeabonnement_amotivation$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Gratuit = c(
        moyennes_amotivation_typeabonnement$Moyenne[1]
    ),
    Payant = c(
        moyennes_amotivation_typeabonnement$Moyenne[2]
    )
)


table_typeabonnement_rai <- data.frame(
    Variable = c(
        "Catégorie d'abonnement et score BREQ Rai"),
    Student = c(
        as.numeric(t_typeabonnement_rai$statistic)
    ),
    P_Value=t_typeabonnement_rai$p.value,
    Significatif = c(
        ifelse(t_typeabonnement_rai$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Gratuit = c(
        moyennes_rai_typeabonnement$Moyenne[1]
    ),
    Payant = c(
        moyennes_rai_typeabonnement$Moyenne[2]
    )
)


# Fusionner toutes les analyses en un seul tableau
table_typeabonnement_breq <- rbind(
    table_typeabonnement_intrinseque,
    table_typeabonnement_introjectee,
    table_typeabonnement_identifiee,
    table_typeabonnement_integree,
    table_typeabonnement_externe,
    table_typeabonnement_amotivation,
    table_typeabonnement_rai
)

# Afficher le tableau sous format HTML
kable(table_typeabonnement_breq, format = "html", escape = FALSE)



```

#### Visualisation graphique
```{r type abonnement breq}

(ggplot(data, aes(x = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")),
                 y = SCORE_BREQ_Intrinseque,
                 fill = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Catégorie d'abonnement",
       y = "SCORE BREQ Intrinsèque",
       fill = "Catégorie d'abonnement") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() |
   
   ggplot(data, aes(x = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")),
                 y = SCORE_BREQ_Identifiee,
                 fill = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Catégorie d'abonnement",
       y = "SCORE BREQ Identifiée",
       fill = "Catégorie d'abonnement") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
  
  )

(ggplot(data, aes(x = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")),
                 y = SCORE_BREQ_Integree,
                 fill = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Catégorie d'abonnement",
       y = "SCORE BREQ Intégrée",
       fill = "Catégorie d'abonnement") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() |
   
   ggplot(data, aes(x = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")),
                 y = SCORE_RAI,
                 fill = factor(Catégorie_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Catégorie d'abonnement",
       y = "SCORE RAI",
       fill = "Catégorie d'abonnement") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
  
  )
```

### Conclusion hypothèse 4

Il y a des corrélations positives faibles entre le score RAI et le nombre de clubs Strava (0.11), le nombre de kudos reçus par activité (0.17), la fréquence de consultation (0.14), le nombre d'abonnés (0.15) et le nombre d'abonnements (0.18).

Il y a une corrélation moyenne positive entre le score RAI et le fréquence de publication (0.3). 


Il y a des corrélations positives faibles entre le score BREQ Intrinsèque et les kudos reçus (0.14), la fréquence de publication (0.23), la fréquence de consultation (0.12), le nombre d'abonnés (0.12), et le nombre d'abonnements (0.16).

Il y a des corrélations positives faibles entre le score BREQ Intégrée et le score SIS (0.19), le score OSF (0.14), le score d'exposition (0.11), le nombre de clubs Strava (0.14), le nombre de kudos reçus par activité (0.23), la fréquence de consultation (0.2), le nombre d'abonnés (0.2), et le nombre d'abonnements (0.23). Il est à noter qu'il y une corrélation positive moyenne entre le score BREQ intégrée et la fréquence de publication (0.34).

Il y a des corrélations positives faibles entre le score BREQ Identifiée et le score SIS (0.15), le nombre de kudos reçus par activité (0.13), la fréquence de publication (0.24), et la fréquence de consultation (0.13).

Il y a des corrélations positives faibles entre le score BREQ Introjectée et le score SIS (0.21), et la fréquence de consultation (0.13).

Il n'y a pas de corrélations entre la motivation externe et les variables Strava. Il n'y a pas de corrélation entre l'amotivation et les variables Strava.

La moyenne du score RAI est significativement plus élévée chez les utilisateurs ayant un compte payant (test t de Student, p<0.01, hautement significatif), de même pour le score de motivation intrinsèque et intégrée. La moyenne du score de motivation identifiée est significativement plus haute pour les utilisateur avec un compte payant (test t de Student, p<0.05, significatif).


# Lien motivation - caractéristiques sportives (hypothèse 4)

Pour aller plus loin dans l’hypothèse 4, il s’agit de savoir s’il y a un lien entre les différents scores BREQ et les caractéristiques sportives.

On peut tester les scores BREQ avec les variables sportives suivantes :

- nombre de kilomètres par semaine (volume par semaine)
- nombre d’entraînements par semaine (fréquence entraînement)
- nombre de compétitions par an
- niveau
- type de coureur (trail/route, club/pas club, seul/en groupe)
- suivi d’un programme d’entraînement
- accompagnement par un coach
- type d’objectif 2025 s’il y en a un
- blessure ou non liée à la course à pied dans les 6 derniers mois
- durée de la pause d’une blessure liée à la course à pied

### Statistiques {.tabset}

#### Corrélations{.tabset}
##### Intrinsèque
```{r correlations calculs BREQ intrinsque sport}
# Calcul des corrélations pour toutes les variables avec motivation intrinsèque
correlations_intrinseque_sport <- map_df(variables_sportives, ~ compute_correlations(.x, "SCORE_BREQ_Intrinseque", data))

# Ajout des labels des variables
correlations_intrinseque_sport <- correlations_intrinseque_sport %>%
  mutate(Variable = variables_labels_sportives[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_BREQ_Intrinseque"
correlations_intrinseque_sport <- correlations_intrinseque_sport %>%
  mutate(
    Corr_SCORE_BREQ_Intrinseque = case_when(
      as.numeric(abs(Corr_SCORE_BREQ_Intrinseque)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_BREQ_Intrinseque, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Intrinseque)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_BREQ_Intrinseque, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Intrinseque)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_BREQ_Intrinseque, '</span>'),
      TRUE ~ as.character(Corr_SCORE_BREQ_Intrinseque)
    )
  )

# Affichage en HTML
kable(correlations_intrinseque_sport, format = "html", escape = FALSE)

```
##### Intégrée
```{r correlations calculs BREQ integree sport}
# Calcul des corrélations pour toutes les variables avec motivation intégrée
correlations_integree_sport <- map_df(variables_sportives, ~ compute_correlations(.x, "SCORE_BREQ_Integree", data))

# Ajout des labels des variables
correlations_integree_sport <- correlations_integree_sport %>%
  mutate(Variable = variables_labels_sportives[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_BREQ_Integree"
correlations_integree_sport <- correlations_integree_sport %>%
  mutate(
    Corr_SCORE_BREQ_Integree = case_when(
      as.numeric(abs(Corr_SCORE_BREQ_Integree)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_BREQ_Integree, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Integree)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_BREQ_Integree, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Integree)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_BREQ_Integree, '</span>'),
      TRUE ~ as.character(Corr_SCORE_BREQ_Integree)
    )
  )

# Affichage en HTML
kable(correlations_integree_sport, format = "html", escape = FALSE)

```

##### Identifiee
```{r correlations calculs BREQ identifiee sport}
# Calcul des corrélations pour toutes les variables avec motivation identifiee
correlations_identifiee_sport <- map_df(variables_sportives, ~ compute_correlations(.x, "SCORE_BREQ_Identifiee", data))

# Ajout des labels des variables
correlations_identifiee_sport <- correlations_identifiee_sport %>%
  mutate(Variable = variables_labels_sportives[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_BREQ_Integree"
correlations_identifiee_sport <- correlations_identifiee_sport %>%
  mutate(
    Corr_SCORE_BREQ_Identifiee = case_when(
      as.numeric(abs(Corr_SCORE_BREQ_Identifiee)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_BREQ_Identifiee, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Identifiee)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_BREQ_Identifiee, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Identifiee)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_BREQ_Identifiee, '</span>'),
      TRUE ~ as.character(Corr_SCORE_BREQ_Identifiee)
    )
  )

# Affichage en HTML
kable(correlations_identifiee_sport, format = "html", escape = FALSE)

```

##### Introjectée
```{r correlations calculs BREQ introjectee sport}
# Calcul des corrélations pour toutes les variables avec motivation identifiee
correlations_introjectee_sport <- map_df(variables_sportives, ~ compute_correlations(.x, "SCORE_BREQ_Introjectee", data))

# Ajout des labels des variables
correlations_introjectee_sport <- correlations_introjectee_sport %>%
  mutate(Variable = variables_labels_sportives[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_BREQ_Introjectee"
correlations_introjectee_sport <- correlations_introjectee_sport %>%
  mutate(
    Corr_SCORE_BREQ_Introjectee = case_when(
      as.numeric(abs(Corr_SCORE_BREQ_Introjectee)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_BREQ_Introjectee, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Introjectee)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_BREQ_Introjectee, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Introjectee)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_BREQ_Introjectee, '</span>'),
      TRUE ~ as.character(Corr_SCORE_BREQ_Introjectee)
    )
  )

# Affichage en HTML
kable(correlations_introjectee_sport, format = "html", escape = FALSE)

```

##### Externe
```{r correlations calculs BREQ externe sport}
# Calcul des corrélations pour toutes les variables avec motivation externe
correlations_externe_sport <- map_df(variables_sportives, ~ compute_correlations(.x, "SCORE_BREQ_Externe", data))

# Ajout des labels des variables
correlations_externe_sport <- correlations_externe_sport %>%
  mutate(Variable = variables_labels_sportives[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_BREQ_Externe"
correlations_externe_sport <- correlations_externe_sport %>%
  mutate(
    Corr_SCORE_BREQ_Externe = case_when(
      as.numeric(abs(Corr_SCORE_BREQ_Externe)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_BREQ_Externe, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Externe)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_BREQ_Externe, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQ_Externe)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_BREQ_Externe, '</span>'),
      TRUE ~ as.character(Corr_SCORE_BREQ_Externe)
    )
  )

# Affichage en HTML
kable(correlations_externe_sport, format = "html", escape = FALSE)

```


##### Amotivation
```{r correlations calculs BREQ amotivation sport}
# Calcul des corrélations pour toutes les variables avec amotivation
correlations_amotivation_sport <- map_df(variables_sportives, ~ compute_correlations(.x, "SCORE_BREQA", data))

# Ajout des labels des variables
correlations_amotivation_sport <- correlations_amotivation_sport %>%
  mutate(Variable = variables_labels_sportives[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_BREQ_Amotivation"
correlations_amotivation_sport <- correlations_amotivation_sport %>%
  mutate(
    Corr_SCORE_BREQA = case_when(
      as.numeric(abs(Corr_SCORE_BREQA)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_BREQA, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQA)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_BREQA, '</span>'),
      as.numeric(abs(Corr_SCORE_BREQA)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_BREQA, '</span>'),
      TRUE ~ as.character(Corr_SCORE_BREQA)
    )
  )

# Affichage en HTML
kable(correlations_amotivation_sport, format = "html", escape = FALSE)

```

##### RAI
```{r correlations calculs BREQ rai sport}
# Calcul des corrélations pour toutes les variables avec rai
correlations_rai_sport <- map_df(variables_sportives, ~ compute_correlations(.x, "SCORE_RAI", data))

# Ajout des labels des variables
correlations_rai_sport <- correlations_rai_sport %>%
  mutate(Variable = variables_labels_sportives[Variable])

# Mise en forme conditionnelle de la colonne "Corr_SCORE_BREQ_Amotivation"
correlations_rai_sport <- correlations_rai_sport %>%
  mutate(
    Corr_SCORE_RAI = case_when(
      as.numeric(abs(Corr_SCORE_RAI)) > 0.3 ~ paste0('<span style="color:green;">', Corr_SCORE_RAI, '</span>'),
      as.numeric(abs(Corr_SCORE_RAI)) > 0.2 ~ paste0('<span style="color:#FC4C02;">', Corr_SCORE_RAI, '</span>'),
      as.numeric(abs(Corr_SCORE_RAI)) > 0.1 ~ paste0('<span style="color:red;">', Corr_SCORE_RAI, '</span>'),
      TRUE ~ as.character(Corr_SCORE_RAI)
    )
  )

# Affichage en HTML
kable(correlations_rai_sport, format = "html", escape = FALSE)

```


#### Test t de Student
```{r test student breq}
t_coach_intrinseque <- t.test(as.numeric(SCORE_BREQ_Intrinseque) ~ as.factor(Coach), data = data, var.equal = TRUE)

moyennes_intrinseque_coach <- data %>%
    group_by(Coach) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Intrinseque, na.rm = TRUE))

table_coach_intrinseque <- data.frame(
    Variable = c(
        "Coach et BREQ Intrinsèque"),
    Student = c(
        as.numeric(t_coach_intrinseque$statistic)
    ),
    P_Value=t_coach_intrinseque$p.value,
    Significatif = c(
        ifelse(t_coach_intrinseque$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_coach = c(
        moyennes_intrinseque_coach$Moyenne[1]
    ),
    Sans_coach = c(
        moyennes_intrinseque_coach$Moyenne[2]
    )
)


t_coach_introjectee <- t.test(as.numeric(SCORE_BREQ_Introjectee) ~ as.factor(Coach), data = data, var.equal = TRUE)

moyennes_introjectee_coach <- data %>%
    group_by(Coach) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Introjectee, na.rm = TRUE))

table_coach_introjectee <- data.frame(
    Variable = c(
        "Coach et BREQ Introjectée"),
    Student = c(
        as.numeric(t_coach_introjectee$statistic)
    ),
    P_Value = t_coach_introjectee$p.value,
    Significatif = c(
        ifelse(t_coach_introjectee$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_coach = c(
        moyennes_introjectee_coach$Moyenne[1]
    ),
    Sans_coach = c(
        moyennes_introjectee_coach$Moyenne[2]
    )
)


t_coach_identifiee <- t.test(as.numeric(SCORE_BREQ_Identifiee) ~ as.factor(Coach), data = data, var.equal = TRUE)

moyennes_identifiee_coach <- data %>%
    group_by(Coach) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Identifiee, na.rm = TRUE))

table_coach_identifiee <- data.frame(
    Variable = c(
        "Coach et BREQ Identifiée"),
    Student = c(
        as.numeric(t_coach_identifiee$statistic)
    ),
     P_Value = t_coach_identifiee$p.value,
       Significatif = c(
        ifelse(t_coach_identifiee$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_coach = c(
        moyennes_identifiee_coach$Moyenne[1]
    ),
    Sans_coach = c(
        moyennes_identifiee_coach$Moyenne[2]
    )
)


t_coach_integree <- t.test(as.numeric(SCORE_BREQ_Integree) ~ as.factor(Coach), data = data, var.equal = TRUE)

moyennes_integree_coach <- data %>%
    group_by(Coach) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Integree, na.rm = TRUE))

table_coach_integree <- data.frame(
    Variable = c(
        "Coach et BREQ Intégrée "),
    Student = c(
        as.numeric(t_coach_integree$statistic)
    ),
    P_Value = t_coach_integree$p.value,
    Significatif = c(
        ifelse(t_coach_integree$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_coach = c(
        moyennes_integree_coach$Moyenne[1]
    ),
    Sans_coach = c(
        moyennes_integree_coach$Moyenne[2]
    )
)


t_coach_externe <- t.test(as.numeric(SCORE_BREQ_Externe) ~ as.factor(Coach), data = data, var.equal = TRUE)

moyennes_externe_coach <- data %>%
    group_by(Coach) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Externe, na.rm = TRUE))

table_coach_externe <- data.frame(
    Variable = c(
        "Coach et BREQ Externe"),
    Student = c(
        as.numeric(t_coach_externe$statistic)
    ),
    P_Value= t_coach_externe$p.value,
    Significatif = c(
        ifelse(t_coach_externe$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_coach = c(
        moyennes_externe_coach$Moyenne[1]
    ),
    Sans_coach = c(
        moyennes_externe_coach$Moyenne[2]
    )
)


t_coach_amotivation <- t.test(as.numeric(SCORE_BREQA) ~ as.factor(Coach), data = data, var.equal = TRUE)

moyennes_amotivation_coach <- data %>%
    group_by(Coach) %>%
    summarise(Moyenne = mean(SCORE_BREQA, na.rm = TRUE))

table_coach_amotivation <- data.frame(
    Variable = c(
        "Coach et BREQ Amotivation"),
    Student = c(
        as.numeric(t_coach_amotivation$statistic)
    ),
    P_Value = t_coach_amotivation$p.value,
    Significatif = c(
        ifelse(t_coach_amotivation$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_coach = c(
        moyennes_amotivation_coach$Moyenne[1]
    ),
    Sans_coach = c(
        moyennes_amotivation_coach$Moyenne[2]
    )
)


t_coach_rai <- t.test(as.numeric(SCORE_RAI) ~ as.factor(Coach), data = data, var.equal = TRUE)

moyennes_rai_coach <- data %>%
    group_by(Coach) %>%
    summarise(Moyenne = mean(SCORE_RAI, na.rm = TRUE))

table_coach_rai <- data.frame(
    Variable = c(
        "Coach et Rai"),
    Student = c(
        as.numeric(t_coach_rai$statistic)
    ),
    P_Value = t_coach_rai$p.value,
    Significatif = c(
        ifelse(t_coach_rai$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_coach = c(
        moyennes_rai_coach$Moyenne[1]
    ),
    Sans_coach = c(
        moyennes_rai_coach$Moyenne[2]
    )
)

# Fusionner toutes les analyses en un seul tableau
table_coach_breq <- rbind(
    table_coach_intrinseque,
    table_coach_introjectee,
    table_coach_identifiee,
    table_coach_integree,
    table_coach_externe,
    table_coach_amotivation,
    table_coach_rai
)

# Afficher le tableau sous format HTML
kable(table_coach_breq, format = "html", escape = FALSE)



t_programme_intrinseque <- t.test(as.numeric(SCORE_BREQ_Intrinseque) ~ as.factor(Programme), data = data, var.equal = TRUE)

moyennes_intrinseque_programme <- data %>%
    group_by(Programme) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Intrinseque, na.rm = TRUE))

table_programme_intrinseque <- data.frame(
    Variable = c(
        "Programme et BREQ Intrinsèque"),
    Student = c(
        as.numeric(t_programme_intrinseque$statistic)
    ),
    P_Value = t_programme_intrinseque$p.value,
    Significatif = c(
        ifelse(t_programme_intrinseque$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_programme = c(
        moyennes_intrinseque_programme$Moyenne[1]
    ),
    Sans_programme = c(
        moyennes_intrinseque_programme$Moyenne[2]
    )
)

t_programme_introjectee <- t.test(as.numeric(SCORE_BREQ_Introjectee) ~ as.factor(Programme), data = data, var.equal = TRUE)

moyennes_introjectee_programme <- data %>%
    group_by(Programme) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Introjectee, na.rm = TRUE))

table_programme_introjectee <- data.frame(
    Variable = c(
        "Programme et BREQ Introjectée"),
    Student = c(
        as.numeric(t_programme_introjectee$statistic)
    ),
    P_Value = t_programme_introjectee$p.value,
    Significatif = c(
        ifelse(t_programme_introjectee$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_programme = c(
        moyennes_introjectee_programme$Moyenne[1]
    ),
    Sans_programme = c(
        moyennes_introjectee_programme$Moyenne[2]
    )
)

t_programme_identifiee <- t.test(as.numeric(SCORE_BREQ_Identifiee) ~ as.factor(Programme), data = data, var.equal = TRUE)

moyennes_identifiee_programme <- data %>%
    group_by(Programme) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Identifiee, na.rm = TRUE))

table_programme_identifiee <- data.frame(
    Variable = c(
        "Programme et BREQ Identifiée"),
    Student = c(
        as.numeric(t_programme_identifiee$statistic)
    ),
    P_Value = t_programme_identifiee$p.value,
    Significatif= c(
        ifelse(t_programme_identifiee$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_programme = c(
        moyennes_identifiee_programme$Moyenne[1]
    ),
    Sans_programme = c(
        moyennes_identifiee_programme$Moyenne[2]
    )
)


t_programme_integree <- t.test(as.numeric(SCORE_BREQ_Integree) ~ as.factor(Programme), data = data, var.equal = TRUE)

moyennes_integree_programme <- data %>%
    group_by(Programme) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Integree, na.rm = TRUE))

table_programme_integree <- data.frame(
    Variable = c(
        "Programme et BREQ Intégrée "),
    Student = c(
        as.numeric(t_programme_integree$statistic)
    ),
    P_Value = t_programme_integree$p.value,
    Significatif = c(
        ifelse(t_programme_integree$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_programme = c(
        moyennes_integree_programme$Moyenne[1]
    ),
    Sans_programme = c(
        moyennes_integree_programme$Moyenne[2]
    )
)


t_programme_externe <- t.test(as.numeric(SCORE_BREQ_Externe) ~ as.factor(Programme), data = data, var.equal = TRUE)

moyennes_externe_programme <- data %>%
    group_by(Programme) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Externe, na.rm = TRUE))

table_programme_externe <- data.frame(
    Variable = c(
        "Programme et BREQ Externe"),
    Student = c(
        as.numeric(t_programme_externe$statistic)
    ),
    P_Value = t_programme_externe$p.value,
    Significatif = c(
        ifelse(t_programme_externe$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_programme = c(
        moyennes_externe_programme$Moyenne[1]
    ),
    Sans_programme = c(
        moyennes_externe_programme$Moyenne[2]
    )
)

t_programme_amotivation <- t.test(as.numeric(SCORE_BREQA) ~ as.factor(Programme), data = data, var.equal = TRUE)

moyennes_amotivation_programme <- data %>%
    group_by(Programme) %>%
    summarise(Moyenne = mean(SCORE_BREQA, na.rm = TRUE))

table_programme_amotivation <- data.frame(
    Variable = c(
        "Programme et BREQ Amotivation"),
    Student = c(
        as.numeric(t_programme_amotivation$statistic)
    ),
    P_Value = t_programme_amotivation$p.value,
    Significatif = c(
        ifelse(t_programme_amotivation$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_programme = c(
        moyennes_amotivation_programme$Moyenne[1]
    ),
    Sans_programme = c(
        moyennes_amotivation_programme$Moyenne[2]
    )
)


t_programme_rai <- t.test(as.numeric(SCORE_RAI) ~ as.factor(Programme), data = data, var.equal = TRUE)

moyennes_rai_programme <- data %>%
    group_by(Programme) %>%
    summarise(Moyenne = mean(SCORE_RAI, na.rm = TRUE))

table_programme_rai <- data.frame(
    Variable = c(
        "Programme et Rai"),
    Student = c(
        as.numeric(t_programme_rai$statistic)
    ),
    P_Value = t_programme_rai$p.value,
    Significatif = c(
        ifelse(t_programme_rai$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_programme = c(
        moyennes_rai_programme$Moyenne[1]
    ),
    Sans_programme = c(
        moyennes_rai_programme$Moyenne[2]
    )
)


# Fusionner toutes les analyses en un seul tableau
table_programme_breq <- rbind(
    table_programme_intrinseque,
    table_programme_introjectee,
    table_programme_identifiee,
    table_programme_integree,
    table_programme_externe,
    table_programme_amotivation,
    table_programme_rai
)

# Afficher le tableau sous format HTML
kable(table_programme_breq, format = "html", escape = FALSE)


t_Blessure_intrinseque <- t.test(as.numeric(SCORE_BREQ_Intrinseque) ~ as.factor(Blessure), data = data, var.equal = TRUE)

moyennes_intrinseque_Blessure <- data %>%
    group_by(Blessure) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Intrinseque, na.rm = TRUE))

table_Blessure_intrinseque <- data.frame(
    Variable = c(
        "Blessure et BREQ Intrinsèque"),
    Student = c(
        as.numeric(t_Blessure_intrinseque$statistic)
    ),
    P_Value = t_Blessure_intrinseque$p.value,
    Significatif = c(
        ifelse(t_Blessure_intrinseque$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_Blessure = c(
        moyennes_intrinseque_Blessure$Moyenne[1]
    ),
    Sans_Blessure = c(
        moyennes_intrinseque_Blessure$Moyenne[2]
    )
)


t_Blessure_introjectee <- t.test(as.numeric(SCORE_BREQ_Introjectee) ~ as.factor(Blessure), data = data, var.equal = TRUE)

moyennes_introjectee_Blessure <- data %>%
    group_by(Blessure) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Introjectee, na.rm = TRUE))

table_Blessure_introjectee <- data.frame(
    Variable = c(
        "Blessure et BREQ Introjectée"),
    Student = c(
        as.numeric(t_Blessure_introjectee$statistic)
    ),
    P_Value = t_Blessure_introjectee$p.value,
    Significatif = c(
        ifelse(t_Blessure_introjectee$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_Blessure = c(
        moyennes_introjectee_Blessure$Moyenne[1]
    ),
    Sans_Blessure = c(
        moyennes_introjectee_Blessure$Moyenne[2]
    )
)


t_Blessure_identifiee <- t.test(as.numeric(SCORE_BREQ_Identifiee) ~ as.factor(Blessure), data = data, var.equal = TRUE)

moyennes_identifiee_Blessure <- data %>%
    group_by(Blessure) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Identifiee, na.rm = TRUE))

table_Blessure_identifiee <- data.frame(
    Variable = c(
        "Blessure et BREQ Identifiée"),
    Student = c(
        as.numeric(t_Blessure_identifiee$statistic)
    ),
    P_Value = t_Blessure_identifiee$p.value,
    Significatif = c(
        ifelse(t_Blessure_identifiee$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_Blessure = c(
        moyennes_identifiee_Blessure$Moyenne[1]
    ),
    Sans_Blessure = c(
        moyennes_identifiee_Blessure$Moyenne[2]
    )
)


t_Blessure_integree <- t.test(as.numeric(SCORE_BREQ_Integree) ~ as.factor(Blessure), data = data, var.equal = TRUE)

moyennes_integree_Blessure <- data %>%
    group_by(Blessure) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Integree, na.rm = TRUE))

table_Blessure_integree <- data.frame(
    Variable = c(
        "Blessure et BREQ Intégrée "),
    Student = c(
        as.numeric(t_Blessure_integree$statistic)
    ),
    P_Value = t_Blessure_integree$p.value,
    Significatif = c(
        ifelse(t_Blessure_integree$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_Blessure = c(
        moyennes_integree_Blessure$Moyenne[1]
    ),
    Sans_Blessure = c(
        moyennes_integree_Blessure$Moyenne[2]
    )
)


t_Blessure_externe <- t.test(as.numeric(SCORE_BREQ_Externe) ~ as.factor(Blessure), data = data, var.equal = TRUE)

moyennes_externe_Blessure <- data %>%
    group_by(Blessure) %>%
    summarise(Moyenne = mean(SCORE_BREQ_Externe, na.rm = TRUE))

table_Blessure_externe <- data.frame(
    Variable = c(
        "Blessure et BREQ Externe"),
    Student = c(
        as.numeric(t_Blessure_externe$statistic)
    ),
    P_Value = t_Blessure_externe$p.value,
    Significatif = c(
        ifelse(t_Blessure_externe$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_Blessure = c(
        moyennes_externe_Blessure$Moyenne[1]
    ),
    Sans_Blessure = c(
        moyennes_externe_Blessure$Moyenne[2]
    )
)


t_Blessure_amotivation <- t.test(as.numeric(SCORE_BREQA) ~ as.factor(Blessure), data = data, var.equal = TRUE)

moyennes_amotivation_Blessure <- data %>%
    group_by(Blessure) %>%
    summarise(Moyenne = mean(SCORE_BREQA, na.rm = TRUE))

table_Blessure_amotivation <- data.frame(
    Variable = c(
        "Blessure et BREQ Amotivation"),
    Student = c(
        as.numeric(t_Blessure_amotivation$statistic)
    ),
    P_Value = t_Blessure_amotivation$p.value,
    Significatif = c(
        ifelse(t_Blessure_amotivation$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_Blessure = c(
        moyennes_amotivation_Blessure$Moyenne[1]
    ),
    Sans_Blessure = c(
        moyennes_amotivation_Blessure$Moyenne[2]
    )
)


t_Blessure_rai <- t.test(as.numeric(SCORE_RAI) ~ as.factor(Blessure), data = data, var.equal = TRUE)

moyennes_rai_Blessure <- data %>%
    group_by(Blessure) %>%
    summarise(Moyenne = mean(SCORE_RAI, na.rm = TRUE))

table_Blessure_rai <- data.frame(
    Variable = c(
        "Blessure et Rai"),
    Student = c(
        as.numeric(t_Blessure_rai$statistic)
    ),
    P_Value = t_Blessure_rai$p.value,
   Significatif = c(
        ifelse(t_Blessure_rai$p.value < 0.05, "<0.05", "≥ 0.05")
    ),
    Avec_Blessure = c(
        moyennes_rai_Blessure$Moyenne[1]
    ),
    Sans_Blessure = c(
        moyennes_rai_Blessure$Moyenne[2]
    )
)

# Fusionner toutes les analyses en un seul tableau
table_Blessure_breq <- rbind(
    table_Blessure_intrinseque,
    table_Blessure_introjectee,
    table_Blessure_identifiee,
    table_Blessure_integree,
    table_Blessure_externe,
    table_Blessure_amotivation,
    table_Blessure_rai
)

# Afficher le tableau sous format HTML
kable(table_Blessure_breq, format = "html", escape = FALSE)




```

#### Visualisation graphique
```{r breq et var categorielles}
(ggplot(data, aes(x = factor(Coach, levels = c(1, 2), labels = c("Oui", "Non")),
                 y = SCORE_BREQ_Intrinseque,
                 fill = factor(Coach, levels = c(1, 2), labels = c("Oui", "Non")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Coach",
       y = "Score BREQ Intrinseque",
       fill = "Coach") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() |
   
   ggplot(data, aes(x = factor(Coach, levels = c(1, 2), labels = c("Oui", "Non")),
                 y = SCORE_BREQ_Integree,
                 fill = factor(Coach, levels = c(1, 2), labels = c("Oui", "Non")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Coach",
       y = "SCORE BREQ Intégrée",
       fill = "Coach") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
  
  )


(ggplot(data, aes(x = factor(Coach, levels = c(1, 2), labels = c("Oui", "Non")),
                 y = SCORE_RAI,
                 fill = factor(Coach, levels = c(1, 2), labels = c("Oui", "Non")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Coach",
       y = "Score RAI",
       fill = "Coach") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() |
   
   ggplot(data, aes(x = factor(Blessure, levels = c(1, 2), labels = c("Oui", "Non")),
                 y = SCORE_BREQ_Introjectee,
                 fill = factor(Blessure, levels = c(1, 2), labels = c("Oui", "Non")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Blessure",
       y = "SCORE BREQ Introjectée",
       fill = "Blessure") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
  
  )



(ggplot(data, aes(x = factor(Blessure, levels = c(1, 2), labels = c("Oui", "Non")),
                 y = SCORE_BREQ_Intrinseque,
                 fill = factor(Blessure, levels = c(1, 2), labels = c("Oui", "Non")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Blessure",
       y = "SCORE BREQ Intrinsèque ",
       fill = "Blessure") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() |
   
   ggplot(data, aes(x = factor(Blessure, levels = c(1, 2), labels = c("Oui", "Non")),
                 y = SCORE_BREQ_Identifiee,
                 fill = factor(Blessure, levels = c(1, 2), labels = c("Oui", "Non")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Blessure",
       y = "SCORE BREQ Identifiée",
       fill = "Blessure") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
  
  )

```



#### ANOVA

```{r anova breq pratique}
### Niveau, type coureur, objectif, pause blessure

### Variables motivation
variables_motivation <- c("SCORE_BREQ_Identifiee", "SCORE_BREQ_Introjectee", "SCORE_BREQ_Intrinseque", "SCORE_BREQ_Integree", "SCORE_BREQ_Externe", "SCORE_BREQA", "SCORE_RAI")

# Exécution des ANOVA et des moyennes
data$Niveau<-as.factor(data$Niveau)
anova_results_niveau <- map_dfr(variables_motivation, ~ compute_anova(.x, "Niveau", data))
mean_results_niveau <- map_dfr(variables_motivation, ~ compute_means(.x, "Niveau", data))


anova_results_typecoureur <- map_dfr(variables_motivation, ~ compute_anova(.x, "Type_coureur", data))
mean_results_typecoureur <- map_dfr(variables_motivation, ~ compute_means(.x, "Type_coureur", data))

anova_results_objectif <- map_dfr(variables_motivation, ~ compute_anova(.x, "Objectif_KM", data))
mean_results_objectif <- map_dfr(variables_motivation, ~ compute_means(.x, "Objectif_KM", data))

anova_results_pause <- map_dfr(variables_motivation, ~ compute_anova(.x, "Pause_blessure", data))
mean_results_pause <- map_dfr(variables_motivation, ~ compute_means(.x, "Pause_blessure", data))


# Fusion des résultats ANOVA avec les moyennes
anova_motivation_niveau <- left_join(anova_results_niveau, mean_results_niveau, by = "Variable")
anova_motivation_typecoureur <- left_join(anova_results_typecoureur, mean_results_typecoureur, by = "Variable")
anova_motivation_objectif <- left_join(anova_results_objectif, mean_results_objectif, by = "Variable")
anova_motivation_pause <- left_join(anova_results_pause, mean_results_pause, by = "Variable")

# Affichage du tableau formaté
knitr::kable(anova_motivation_niveau, format = "html", escape = FALSE)
knitr::kable(anova_motivation_typecoureur, format = "html", escape = FALSE)
knitr::kable(anova_motivation_objectif, format = "html", escape = FALSE)
knitr::kable(anova_motivation_pause, format = "html", escape = FALSE)

```


#### Test post hoc

```{r test post hoc breq et niveau}

### Identifiée - Niveau
tukey_breq_identifiee_niveau <- TukeyHSD(aov(SCORE_BREQ_Identifiee~ as.factor(Niveau), data = data))

tukey_breq_identifiee_niveau_df <- as.data.frame(tukey_breq_identifiee_niveau[[1]]) 
tukey_breq_identifiee_niveau_df$Comparison <- rownames(tukey_breq_identifiee_niveau_df)
tukey_breq_identifiee_niveau_df$Variable <- "Lien score motivation identifiée et niveau"
rownames(tukey_breq_identifiee_niveau_df) <- NULL

### Intrinsèque - Niveau
tukey_breq_intrinseque_niveau <- TukeyHSD(aov(SCORE_BREQ_Intrinseque ~ as.factor(Niveau), data = data))

tukey_breq_intrinseque_niveau_df <- as.data.frame(tukey_breq_intrinseque_niveau[[1]]) 
tukey_breq_intrinseque_niveau_df$Comparison <- rownames(tukey_breq_intrinseque_niveau_df)
tukey_breq_intrinseque_niveau_df$Variable <- "Lien score motivation intrinsèque et niveau"
rownames(tukey_breq_intrinseque_niveau_df) <- NULL

### Intégrée - Niveau
tukey_breq_integree_niveau <- TukeyHSD(aov(SCORE_BREQ_Integree ~ as.factor(Niveau), data = data))

tukey_breq_integree_niveau_df <- as.data.frame(tukey_breq_integree_niveau[[1]]) 
tukey_breq_integree_niveau_df$Comparison <- rownames(tukey_breq_integree_niveau_df)
tukey_breq_integree_niveau_df$Variable <- "Lien score motivation intégrée et niveau"
rownames(tukey_breq_integree_niveau_df) <- NULL

### RAI - Niveau
tukey_breq_rai_niveau <- TukeyHSD(aov(SCORE_RAI ~ as.factor(Niveau), data = data))

tukey_breq_rai_niveau_df <- as.data.frame(tukey_breq_rai_niveau[[1]]) 
tukey_breq_rai_niveau_df$Comparison <- rownames(tukey_breq_rai_niveau_df)
tukey_breq_rai_niveau_df$Variable <- "Lien score RAI et niveau"
rownames(tukey_breq_rai_niveau_df) <- NULL

### Intégrée - type coureur
tukey_breq_integree_type_coureur <- TukeyHSD(aov(SCORE_BREQ_Integree ~ as.factor(Type_coureur), data = data))

tukey_breq_integree_type_coureur_df <- as.data.frame(tukey_breq_integree_type_coureur[[1]]) 
tukey_breq_integree_type_coureur_df$Comparison <- rownames(tukey_breq_integree_type_coureur_df)
tukey_breq_integree_type_coureur_df$Variable <- "Lien score motivation intégrée et type de coureur"
rownames(tukey_breq_integree_type_coureur_df) <- NULL

### Identifiée - Objectif
tukey_breq_identifiee_objectif <- TukeyHSD(aov(SCORE_BREQ_Identifiee ~ as.factor(Objectif_KM), data = data))

tukey_breq_identifiee_objectif_df <- as.data.frame(tukey_breq_identifiee_objectif[[1]]) 
tukey_breq_identifiee_objectif_df$Comparison <- rownames(tukey_breq_identifiee_objectif_df)
tukey_breq_identifiee_objectif_df$Variable <- "Lien score motivation identifiée et objectif 2025"
rownames(tukey_breq_identifiee_objectif_df) <- NULL

### Intrinsèque - objectif
tukey_breq_intrinseque_objectif <- TukeyHSD(aov(SCORE_BREQ_Intrinseque~ as.factor(Objectif_KM), data = data))

tukey_breq_intrinseque_objectif_df <- as.data.frame(tukey_breq_intrinseque_objectif[[1]]) 
tukey_breq_intrinseque_objectif_df$Comparison <- rownames(tukey_breq_intrinseque_objectif_df)
tukey_breq_intrinseque_objectif_df$Variable <- "Lien score motivation intrinsèque et objectif 2025"
rownames(tukey_breq_intrinseque_objectif_df) <- NULL

###Intégrée - objectif
tukey_breq_integree_objectif <- TukeyHSD(aov(SCORE_BREQ_Integree ~ as.factor(Objectif_KM), data = data))

tukey_breq_integree_objectif_df <- as.data.frame(tukey_breq_integree_objectif[[1]]) 
tukey_breq_integree_objectif_df$Comparison <- rownames(tukey_breq_integree_objectif_df)
tukey_breq_integree_objectif_df$Variable <- "Lien score motivation intégrée et objectif 2025"
rownames(tukey_breq_integree_objectif_df) <- NULL

### Externe - Objectif
tukey_breq_externe_objectif <- TukeyHSD(aov(SCORE_BREQ_Externe~ as.factor(Objectif_KM), data = data))

tukey_breq_externe_objectif_df <- as.data.frame(tukey_breq_externe_objectif[[1]]) 
tukey_breq_externe_objectif_df$Comparison <- rownames(tukey_breq_externe_objectif_df)
tukey_breq_externe_objectif_df$Variable <- "Lien score motivation externe et objectif 2025"
rownames(tukey_breq_externe_objectif_df) <- NULL

### Amotivation - Objectif
tukey_breq_a_objectif <- TukeyHSD(aov(SCORE_BREQA ~ as.factor(Objectif_KM), data = data))

tukey_breq_a_objectif_df <- as.data.frame(tukey_breq_a_objectif[[1]]) 
tukey_breq_a_objectif_df$Comparison <- rownames(tukey_breq_a_objectif_df)
tukey_breq_a_objectif_df$Variable <- "Lien score amotivation et objectif 2025"
rownames(tukey_breq_a_objectif_df) <- NULL

### RAI - Objectif
tukey_breq_rai_objectif <- TukeyHSD(aov(SCORE_RAI~ as.factor(Objectif_KM), data = data))

tukey_breq_rai_objectif_df <- as.data.frame(tukey_breq_rai_objectif[[1]]) 
tukey_breq_rai_objectif_df$Comparison <- rownames(tukey_breq_rai_objectif_df)
tukey_breq_rai_objectif_df$Variable <- "Lien score RAI et objectif 2025"
rownames(tukey_breq_rai_objectif_df) <- NULL

### Identifiée - Pause
tukey_breq_identifiee_pause <- TukeyHSD(aov(SCORE_BREQ_Identifiee ~ as.factor(Pause_blessure), data = data))

tukey_breq_identifiee_pause_df <- as.data.frame(tukey_breq_identifiee_pause[[1]]) 
tukey_breq_identifiee_pause_df$Comparison <- rownames(tukey_breq_identifiee_pause_df)
tukey_breq_identifiee_pause_df$Variable <- "Lien score motivation identifiée et pause liée à une blessure"
rownames(tukey_breq_identifiee_pause_df) <- NULL

### Introjectée -Pause
tukey_breq_introjectee_pause <- TukeyHSD(aov(SCORE_BREQ_Introjectee ~ as.factor(Pause_blessure), data = data))

tukey_breq_introjectee_pause_df <- as.data.frame(tukey_breq_introjectee_pause[[1]]) 
tukey_breq_introjectee_pause_df$Comparison <- rownames(tukey_breq_introjectee_pause_df)
tukey_breq_introjectee_pause_df$Variable <- "Lien score motivation introjectée et pause liée à une blessure"
rownames(tukey_breq_introjectee_pause_df) <- NULL

### Intégrée -Pause
tukey_breq_integree_pause <- TukeyHSD(aov(SCORE_BREQ_Integree ~ as.factor(Pause_blessure), data = data))

tukey_breq_integree_pause_df <- as.data.frame(tukey_breq_integree_pause[[1]]) 
tukey_breq_integree_pause_df$Comparison <- rownames(tukey_breq_integree_pause_df)
tukey_breq_integree_pause_df$Variable <- "Lien score motivation intégréeet pause liée à une blessure"
rownames(tukey_breq_integree_pause_df) <- NULL

tukey_results_breq_niveau <- bind_rows(tukey_breq_identifiee_niveau_df, tukey_breq_intrinseque_niveau_df, tukey_breq_integree_niveau_df, tukey_breq_rai_niveau_df)

tukey_signif_breq_niveau <- tukey_results_breq_niveau%>% filter(`p adj` < 0.05)


tukey_results_breq_type_coureur <- bind_rows(tukey_breq_integree_type_coureur_df)

tukey_signif_breq_type_coureur <- tukey_results_breq_type_coureur %>% filter(`p adj` < 0.05)


tukey_results_breq_objectif <- bind_rows(tukey_breq_identifiee_objectif_df, tukey_breq_intrinseque_objectif_df, tukey_breq_integree_objectif_df, tukey_breq_externe_objectif_df, tukey_breq_a_objectif_df, tukey_breq_rai_objectif_df)

tukey_signif_breq_objectif <- tukey_results_breq_objectif %>% filter(`p adj` < 0.05)

tukey_results_breq_pause <- bind_rows(tukey_breq_identifiee_pause_df, tukey_breq_introjectee_pause_df, tukey_breq_integree_pause_df)

tukey_signif_breq_pause <- tukey_results_breq_pause %>% filter(`p adj` < 0.05)

# Affichage des résultats sous forme de tableau HTML
knitr::kable(tukey_signif_breq_niveau, format = "html", escape = FALSE)
knitr::kable(tukey_signif_breq_type_coureur, format = "html", escape = FALSE)
knitr::kable(tukey_signif_breq_objectif, format = "html", escape = FALSE)
knitr::kable(tukey_signif_breq_pause, format = "html", escape = FALSE)

```

#### Visualisation graphique{.tabset}
##### Niveau
```{r visualisation test post hoc breq niveau}
ggplot(tukey_signif_breq_niveau, aes(x = Comparison, y = diff, fill = Variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_errorbar(aes(ymin = lwr, ymax = upr), width = 0.2, position = position_dodge(0.9)) +
  theme_minimal() +
  labs(title = "Comparaisons post-hoc (Tukey HSD)", 
       x = "Comparaison entre groupes", 
       y = "Différence de moyenne") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

##### Type coureur
```{r visualisation test post hoc breq type coureur}
ggplot(tukey_signif_breq_type_coureur, aes(x = Comparison, y = diff, fill = Variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_errorbar(aes(ymin = lwr, ymax = upr), width = 0.2, position = position_dodge(0.9)) +
  theme_minimal() +
  labs(title = "Comparaisons post-hoc (Tukey HSD)", 
       x = "Comparaison entre groupes", 
       y = "Différence de moyenne") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

##### Objectif
```{r visualisation test post hoc breq objectif}
ggplot(tukey_signif_breq_objectif, aes(x = Comparison, y = diff, fill = Variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_errorbar(aes(ymin = lwr, ymax = upr), width = 0.2, position = position_dodge(0.9)) +
  theme_minimal() +
  labs(title = "Comparaisons post-hoc (Tukey HSD)", 
       x = "Comparaison entre groupes", 
       y = "Différence de moyenne") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

### Conclusion hypothèse 4

Il y a des corrélations positives faibles entre la fréquence d'entraînement et la motivation intrinsèque (0.25) et la motivation identifiée (0.27). Il y a des corrélations positives moyennes avec la motivation intégrée (0.38) et le score RAI (0.33) avec la fréquence d'entraînement.

Il y a des corraltaions positives faibles entre le nombre de kilomètres par semaine et la motivation intrinsèque (0.28) et la motivation identifiée (0.26). Il y a des corrélations positives moyennes avec la motivation intégrée (0.38) et le score RAI (0.36) avec le nombre de kilomètres par semaine.

Il y a une corrélation positive faible entre la motivation intégrée et le nombre de compétitions par an (0.14).

La moyenne du score de motivation intrinsèque, introjectée, intégrée et le score RAI sont significativement plus élévées chez les utilisateurs suivis par un coach (test t de Student, p< 0.05, signficatif).

Il n'est pas possible de mettre en évidence de différence entre les scores de motivation chez les coureurs qui suivent un programme d'entraînement ou non (test t de Student, p>0.05).

La moyenne de score de motivation introjectée et intégrée sont significativement plus élevées chez les coureurs ayant eu une blessure dans les 6 derniers mois (test t de Student, p<0.01, hautement significatif). La moyenne du score de motivation intrinsèque est plus élevée chez les coureurs ayant eu une blessure dans les 6 derniers mois (test t de Student, p<0.05, significatif).

# Limites 

- Il s'agit d'un questionnaire en ligne diffusé sur les réseaux sociaux donc il est difficile de maîtriser la véracité des réponses. 
- De plus, il s'agit d'auto-évalution pour chaque réponse donc il peut y avoir un biais de désirabilité sociale, un biais de confirmation, un effet de halo, et un biais d'auto-complaisance. Il n'y a pas de mesures objectives. 
- Par ailleurs, il s'agit uniquement de personnes volontaires qui ont répondus. Mon étude ne tient pas compte des coureurs amateurs qui ont utilisé Strava et ont choisi de l'arrêter ou qui n'ont jamais utilisé Strava.
- Certaines échelles de mesures sont discutables, liée à la traduction et l'adaptation dans le contexte de l'étude, certains alphas de Cronbach ne sont pas très bons.
- Il aurait également pu être intéressant de mesurer la tendance à la comparaison sociale en utilisant le questionnaire INCOM de Gibbons ^14^ ou le bien-être psychologique avec le Well-Being Scale ^15^ ou encore l'estime de soi ^16^ mais le questionnaire ne devait pas être trop long afin de ne pas décourager les répondants.

# Bibliographie
[1] : Strava. (2024). Year in sport: The trend report. Strava. https://downloads.ctfassets.net/wad4jonn1ykp/1sJg4OiBKFoGYDtw9NV9v4/69d6c0b71cfebb350f27b8f8abcf42f9/Strava_Year_in_Sport_-The_Trend_Report-_fr-FR.pdf

[2] : Strava. (2023). Rapport global Strava 2023. Strava. https://downloads.ctfassets.net/9olkiac82a1q/iU421iiO6Hky1MVvYThmz/618d11560020aaf123d5e1670fd50514/Strava-Global-Report-2023-fr-FR.pdf

[3] : Russell, H. C., Potts, C., & Nelson, E. (2023). “If it’s not on strava it didn’t happen”: Perceived psychosocial implications of strava use in collegiate club runners. Recreational Sports Journal, 47(1), 15‑25. https://doi.org/10.1177/15588661221148170

[4] : Evans, B. (2019). Why we run. An exploration of what and who motivates us to run. URL: https://whywerun. strava. com/assets/whitepaper/Whitepaper_Strava_WhyWeRun_012320. pdf(дата звернення: 10.12. 2020).

[5] : Chapman, L. G. (2024). Social Comparison Predicts Well-Being in Non-Elite Young Adult Runners Who Use Strava (Master's thesis, Miami University).

[6] : Petersen, J. M., Kemps, E., Lewis, L. K., & Prichard, I. (2020). Associations between commercial app use and physical activity: cross-sectional study. Journal of medical Internet research, 22(6), e17152.

[7] : Stragier, J., Vanden Abeele, M., & De Marez, L. (2018). Recreational athletes’ running motivations as predictors of their use of online fitness community features. Behaviour & Information Technology, 37(8), 815-827.

[8] : Ellison, N. B., Steinfield, C., & Lampe, C. (2007). The benefits of facebook “friends:” social capital and college students’ use of online social network sites. Journal of Computer-Mediated Communication, 12(4), 1143‑1168. https://doi.org/10.1111/j.1083-6101.2007.00367.

[9] : Ross, C., Orr, E. S., Sisic, M., Arseneault, J. M., Simmering, M. G., & Orr, R. R. (2009). Personality and motivations associated with Facebook use. Computers in Human Behavior, 25(2), 578‑586. https://doi.org/10.1016/j.chb.2008.12.024

[10] : Hjetland, G. J., Finserås, T. R., Sivertsen, B., Colman, I., Hella, R. T., & Skogen, J. C. (2022). Focus on self-presentation on social media across sociodemographic variables, lifestyles, and personalities: A cross-sectional study. International journal of environmental research and public health, 19(17), 11133.

[11] : Sischka, P. E., Grübbel, L., Reisinger, C., Neufang, K. M., & Schmidt, A. F. (2024). On the dimensionality, suitability of sum/mean scores, and cross-country measurement invariance of the Perceived Stress Scale 10 (PSS-10)–Evidence from 41 countries. Management, 18, 04.

[12] : Rocchi, M. A., Wilson, P. M., Sylvester, B. D., Guerin, E., Shi, Z., & Sweet, S. N. (2023). Toward brief tools assessing motivation for exercise: Rationale and development of a six-and 12-item version of the Behavioral Regulation in Exercise 3 (BREQ3) Questionnaire. Sport, Exercise, and Performance Psychology, 12(3), 205.

[13] : Chiu, Y. H., Lu, F. J. H., Lin, J. H., Nien, C. L., Hsu, Y. W., & Liu, H. Y. (2016). Psychometric properties of the Perceived Stress Scale (PSS): measurement invariance between athletes and non-athletes and construct validity. PeerJ, 4, e2790.

[14] : Gibbons, F. X., & Buunk, B. P. (1999). Individual differences in social comparison: development of a scale of social comparison orientation. Journal of personality and social psychology, 76(1), 129.

[15] : Trousselard, M., Steiler, D., Dutheil, F., Claverie, D., Canini, F., Fenouillet, F., ... & Franck, N. (2016). Validation of the Warwick-Edinburgh mental well-being scale (WEMWBS) in French psychiatric and general populations. Psychiatry research, 245, 282-290.

[16] : Repišti, S., & Kerla, M. (2016). Social self-esteem scale(Sses). Unpublished. https://doi.org/10.13140/RG.2.1.3118.3128

[17] : Hjetland, G. J., Finserås, T. R., Sivertsen, B., Colman, I., Hella, R. T., Andersen, A. I. O., & Skogen, J. C. (2024). Digital self-presentation and adolescent mental health: Cross-sectional and longitudinal insights from the “LifeOnSoMe”-study. BMC Public Health, 24(1), 2635.

# Annexes

Questionnaire utilisé dans le cadre de l'étude :

##### Questions générales
1. Âge : *de 18 à 86 ans et plus*
2. Sexe : *Homme / Femme*
3. Catégorie socio-professionnelle : *Agriculteurs exploitants / Artisans, commerçants et chefs d'entreprise / Cadres et professions intellectuelles supérieures / Professions intermédiaires / Employés / Ouvriers / Retraités / Etudiants / Autres personnes sans activité professionelle*

##### Quantification de la pratique de la course à pied
4. Depuis combien de temps pratiquez-vous la course à pied (en années) ? *Réponse libre chiffrée*
5. Êtes-vous un(e) coureur (se) : *Débutant(e) / Intermédiaire / Confirmé(e) /	Expert(e)*
6. Combien de fois courez-vous par semaine en moyenne ? *Réponse libre chiffrée*
7. Combien de kilomètres parcourez-vous par semaine en moyenne ? *Réponse libre chiffrée*
8. A combien de compétitions (objectifs principaux) participez-vous par an en moyenne ? *Réponse libre chiffrée*
9. Vous pratiquez le plus souvent la course à pied : *Sur route / En montagne ou sentiers de pleine nature (trail)*
10. Êtes-vous dans un club de course à pied ? *Oui / Non*
11. Etes-vous accompagné(e) par un coach ou un entraîneur personnel ? *Oui / Non*
12. Suivez-vous un programme d'entraînement (type RunMotionCoach, Decathlon, Nolio, ...) ? *Oui / Non*
13. Vous vous entraînez le plus souvent : *Seul / En groupe*
14. Avez-vous un objectif de compétition en 2025 ? *Oui / Non*
15. Si oui, précisez le nombre de kilomètres de votre objectif principal (le plus long en distance si plusieurs objectifs) : *20K / 50 K / 100 K / 100M* (Non obligatoire)
16. Au cours des 6 mois précédents, avez-vous été blessé(e) à cause de la course à pied ? *Oui / Non*
17. Si oui, cette blessure a-t-elle imposée une pause dans votre pratique ? *Oui, quelques jours / Oui, quelques semaines / Oui, quelques mois	/ Non* (Non obligatoire)

##### Quantitifaction de l'utilisation de Strava
18. A quelle fréquence publiez-vous vos activités sur Strava ? (nombre de jours par semaine) : *Réponse libre chiffrée*[a]
19. A quelle fréquence consultez-vous votre fil Strava ? (nombre de jours par semaine) : *Réponse libre chiffrée* [a] 
20. Strava fait partie de mon activité quotidienne : *Pas du tout d'accord /	Plutôt pas d'accord / Plutôt d'accord /	Totalement d'accord* [a]
21. Je suis fier(fière) de dire aux gens que j’utilise Strava : *Pas du tout d'accord /	Plutôt pas d'accord / Plutôt d'accord /	Totalement d'accord* [a]
22. Je me sens déconnecté(e) lorsque je n’ai pas utilisé Strava depuis un certain temps : *Pas du tout d'accord /	Plutôt pas d'accord / Plutôt d'accord /	Totalement d'accord* [a]
23. J’ai l’impression de faire partie de la communauté Strava : *Pas du tout d'accord /	Plutôt pas d'accord / Plutôt d'accord /	Totalement d'accord* [a]
24. Je ne pourrais pas arrêter d'utiliser Strava : *Pas du tout d'accord /	Plutôt pas d'accord / Plutôt d'accord /	Totalement d'accord* [a]
25. Qui peut voir les éléments suivants sur votre compte Strava ? [c]
- Vos activités : *Uniquement vous-même / Uniquement vos abonnés / Tout le monde*
- Horaire de départ de vos activités : *Uniquement vous-même / Uniquement vos abonnés / Tout le monde*
- Fréquence cardiaque : *Uniquement vous-même / Uniquement vos abonnés / Tout le monde*
- Allure : *Uniquement vous-même / Uniquement vos abonnés / Tout le monde*
- Points de départ et arrivée de vos activités : *Uniquement vous-même / Uniquement vos abonnés / Tout le monde*
26. Vous publiez sur Strava : *Quasiment aucun entraînement / Uniquement certain de vos entraînements / Quasiment tous vos entraînements	/ Tous vos entraînements* [c]
27. Vous publiez sur Strava : *Quasiement aucune compétition	/ Uniquement certaines de vos compétitions / Quasiment toutes vos compétitions / Toutes vos compéititions* [c]
28. Lorsque vous publiez une activité sur Strava : [c]
- Nommez-vous votre activité ? *Jamais /	Parfois	/ Souvent /	Toujours*
- Ajoutez-vous des commentaires ?  *Jamais /	Parfois	/ Souvent /	Toujours*
- Ajoutez-vous des photos ? *Jamais /	Parfois	/ Souvent /	Toujours*
29. Le plus important pour vous lors de la publication d'une activité est : *Le temps total écoulé	La durée totale de déplacement*
30. Qui peut s’abonner à votre compte Strava ? *Uniquement les utilisateurs que j'accepte	Tout le monde*
31. Vous êtes-vous déjà désabonné d’un compte d'un autre utilisateur ? *Oui / Non*
32. Avez-vous déjà bloqué l’accès à votre compte à un autre utilisateur ?  *Oui / Non*
33. Si oui, pour quelle(s) raison(s) ? *Pour éviter de communiquer avec cet utilisateur	/ Pour éviter le harcèlement / Autre* (Non obligatoire)
34. A combien de personnes êtes-vous abonné(e) ? (estimation) *Réponse libre chiffrée* [a]
35. Parmi les personnes auxquelles vous êtes abonnés, vous avez : (plusieurs réponses possibles) *Des amis /	Des connaissances /	Des membres de votre famille /	Des collègues de travail /	Des influenceurs /	Des athlètes professionnels	/ Autre*
36. Combien d’abonnés avez-vous sur Strava ? (estimation) *Réponse libre chiffrée* [a]
37. Parmi vos abonnés, vous avez : (plusieurs réponses possibles) *Des amis /	Des connaissances /	Des membres de votre famille /	Des collègues de travail /	Des influenceurs /	Des athlètes professionnels	/ Autre*
38. De combien de clubs Strava faites-vous partie ? *Réponse libre chiffrée*
39. Envoyez-vous des kudos ? *Jamais /	Parfois	/ Souvent /	Toujours* [b]
40. Laissez-vous des commentaires ? *Jamais /	Parfois	/ Souvent /	Toujours* [b]
41. Faites-vous des publications (hors activités) ? *Jamais /	Parfois	/ Souvent /	Toujours* [b]
42. Recevez-vous des commentaires ? *Jamais /	Parfois	/ Souvent /	Toujours* [b]
43. Combien de kudos recevez-vous en moyenne sur une activité de type entraînement standard ? *Réponse libre chiffrée*
44. Dans quel(s) but(s) utilisez-vous Strava ? (plusieurs réponses possibles) *Suivi de la performance	/ Motivation personnelle	/ Interaction sociale /	Comparaison avec d'autres coureurs /	Partage de vos activités / Enregistrement de vos activités	/ Suivi de progrès /	Idée de parcours /	Côté ludique (segment, classements, KOM/QOM…)	/ Appartenance à une communauté /	Encouragements (kudos) /	Atteinte d'objectifs personnels	/ Autre*
45. Quelle(s) fonctionnalité(s) de Strava trouvez-vous le(s) plus utile(s) dans votre pratique ? (Plusieurs réponses possibles) :*Enregistrement de vos activités / Suivi GPS .	Analyse des performances /	Segments /	Classements /	Challenges  /	Clubs /	Planification d'itinéraire /	Evènements /	Heatmap (endroit où vous vous êtes le plus entraîné) / Interactions sociales /	Kudos	/ Suivi des progrès /	Autre*

##### Self-Presentation and Upward Social Comparison Inclination Scale

46. Je consacre beaucoup de temps et d'énergie à publier mes activités sur Strava.  *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [e]
47. Il est important pour moi d’avoir beaucoup d’abonnés sur Strava. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [e]
48. Je supprime mes activités sur Strava qui ne reçoivent pas assez de kudos et/ou de commentaires. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [e]
49. Je retouche mes activités avant de les publier sur Strava pour qu’elles paraissent meilleures. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [e]
50. Ce que d’autres coureurs publient sur Strava me rend moins satisfait(e) de mes propres performances. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [e]
51. Les commentaires et les kudos que je reçois à propos des mes activités sur Strava influence mon humeur.*Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [e]
52. Le plus important pour vous lors de la publication d'une activité est : *Le temps total écoulé / La durée totale de déplacement*

##### Perceived Stress Scale
53. Au cours du dernier mois, à quelle fréquence avez-vous été perturbé(e) par des réactions inattendues à vos publications sur Strava ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 
54. Au cours du dernier mois, à quelle fréquence avez-vous eu l’impression d’être obligé(e) de publier vos activités sur Strava ?*Jamais /	Parfois	/ Souvent /	Toujours* [f] 
55. Au cours du dernier mois, à quelle fréquence vous êtes-vous senti(e) nerveus(e) ou stressé(e) à l’idée de publier vos activités sur Strava ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 
56. Au cours du dernier mois, à quelle fréquence vous êtes-vous senti(e) confiant(e) par rapport à ce que vous publiez sur Strava ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 
57. Au cours du dernier mois, à quelle fréquence avez-vous eu l'impression que vos activités sur Strava vous mettaient en valeur ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 
58. Au cours du dernier mois, à quelle fréquence avez-vous constaté que vous n’étiez pas assez actif(ve) sur Strava (pas assez de publications d’activités) ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 
59. Au cours du dernier mois, à quelle fréquence avez-vous eu l'impression de contrôler la manière dont vous présentez vos activités sur Strava ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 
60. Au cours du dernier mois, à quelle fréquence avez-vous été irrité(e) à cause de la performance des autres sur Strava ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 
61. Au cours du dernier mois, à quelle fréquence vous-êtes-vous senti(e) dépassé(e) par la pression d’atteindre vos objectifs sur Strava ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 

##### Mesure de la motivation à courir :  Behavioral Regulation in Exercise 3 (BREQ3) Questionnaire
62. Je trouve que courir est une activité agréable. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
63. Je cours parce que c’est amusant. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
64. Je cours parce que c’est une part fondamentale de qui je suis. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
65. Je cours parce que c’est en accord avec mes objectifs de vie. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
66. Il est important pour moi de courir. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
67. J'apprécie les bénéfices de la course à pied. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
68. Je me sens honteux(se) si je manque un entraînement de course à pied. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
69. Je me sens en échec si je n’ai pas couru. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
70. Je ressens de la pression de mes amis pour courir. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
71. Je cours parce que les autres disent qu’il faut que je le fasse. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
72. Je ne vois pas pourquoi je devrais courir. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
73. Je pense que courir est une perte de temps. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f] 

##### Questions annexes
74. Strava influence mon expérience en tant que coureur(se). *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
75. Je me sens plus motivé(e) depuis que j'ai Strava. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
76. Je me sens plus stressé(e) depuis que j'ai Strava. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
77. Utiliser Strava me pousse à ignorer des signaux de fatigue ou blessure. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
78. Depuis que j'utilise Strava, j'ai amélioré mes performances. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
79. Depuis que j'utilise Strava, je cours plus souvent. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
80. Depuis que j'utilise Strava, je cours plus de kilomètres par semaine. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
81. Je participe à plus de compétitions depuis que j’ai Strava. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
82. Si je n’ai pas prévu de faire un entraînement, le fait de regarder Strava peut me faire changer d’avis. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
83. J'ai déjà modifié un entraînement prévu par mon entraîneur ou mon plan d'entraînement à cause de Strava. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
84. J'ai déjà modifié mon programme d'entraînement à cause de Strava. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*



[a] : traduction et adaptation du questionnaire "Facebook Intensity Scale" utilisé dans l'étude d'Ellison^8^ et de Ross^9^
[b] : traduction et adaptation du questionne "Online Sociability Functions" utilisé dans l'étude de Ross^9^
[c] : extrait, traduction et adaptation du questionnaire "Facebook questionnaire" utilisé dans l'étude de Ross^9^
[d] : traduction et adaptattion du questionnaire "Self-Presentation and Upward Social Comparison Inclination Scale " dans l'étude de Hjetland^10^
[e] : traduction et adapatation du questionnaire "Perceived Stress Scale" dans l'étude de Sischka ^11^
[f] : traduction et adaptation du questionnaire "12 items BREQ 3" dans l'étude de Rocchi ^12^



---
title: "Utilisation de Strava chez les coureurs amateurs"
subtitle: "*Quels impacts psychosociaux et quels impacts sur la pratique ?*"
author: "*Laura Costa - MASTER M1 STAPS UGA (ATDM)*"
date: "*Mars 2025*"
output:
  html_document:
    css: styles.css
    toc: TRUE #table des matières activée
    toc_depth: 4
    toc_float: TRUE
    highlight: "tango"
    code_download: FALSE
---

<style>
table {
  border-collapse: separate;
  border-spacing: 20px;
}
</style>



```{r library setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(readxl)
library(glue)
library(psy)
library(vcd)
library(knitr)
library(ggpubr)
library(patchwork)
default_fill_colors <- function() {
  scale_fill_manual(values = c("#FC4C02", "#4F4F4F"))
}
```

[![](UFRAPS.png){width=100}](https://staps.univ-grenoble-alpes.fr/)

# Présentation de l'étude

### Thématique
Strava est un réseau social créé en **2009** qui permet d'enregistrer et de partager ses activités sportives à un réseau d'abonnés. Strava regroupe plus de **135 millions d'utilisateurs en 2024** dans plus de 190 pays ^1^. 40 millions d'activités sont téléchargées chaque semaine. En 2023, la course à pied est le sport où le plus d'activités sont téléchargées. ^2^ Le réseau social propose différentes fonctionnalités : enregistrement des activités, suivi des progrès, encouragements(kudos), partage des activités, clubs... Le réseau social a également un important aspect de gamification avec les segments, les KOM/QOM, les Local Legends... En tant que réseau social dédié aux sportifs, et notamment aux coureurs amateurs, Strava permet aux utilisateurs d'entrer en interaction et de se comparer aux autres utilisateurs. Dans la communauté des utilisateurs se développe alors cette phrase, reprise par Strava ^1^ ("Strava or it didn't happen) : 

> *" Si ce n'est pas sur Strava, ça n'existe pas."*

Le but de l'étude est de savoir si **l'utilisation de Strava a des impacts psychosociaux chez les coureurs amateurs et si elle a une influence sur la pratique (volume d'entraînement, fréquence d'entraînement, nombre de compétitions, courir malgré une blessure).**

### Problématique
L'étude de Russell ^3^ met en avant les implications psychosociales de l'utilisation de Strava auprès de coureurs de clubs universitaires à travers les Etats-Unis. Des entretiens semi-structurés ont permis de mettre en avant trois thèmes principaux : **la présentation de soi, la pression sociale et la motivation**. 

Inspirée de l'étude de Russell, cette étude dans le cadre de mon master STAPS s'intéresse à l'impact de l'utilisation de Strava sur **l'auto-présentation, le stress perçu et la motivation **. Cette étude s'adresse cependant à un public plus large (coureurs amateurs utilisateurs de Strava) et se fonde sur un questionnaire en ligne d'environ 80 questions. Cette étude s'intéresse également à des **modifications de comportements dans la pratique** (fréquence et volume d'entraînement, nombre de compétitions par an). Ainsi, la problématique de mon étude est la suivante : 

**Quels sont les impacts psychosociaux de l'utilisation de Strava chez les coureurs amateurs et dans quelle mesure l'utilisation de ce réseau social a des impacts sur la pratique de la course à pied ? **

Cette étude porte sur plusieurs questions de recherche :

1. L'utilisation de Strava (fréquence d'utilisation, nombre d'abonnés...) est-elle en lien avec la manière de pratiquer ? (fréquence et volume d'entraînement, nombre de compétitions par an) ?
2. Comment les coureurs amateurs se présentent-ils sur Strava ? Filtrent-ils ou modifient-ils ce qu'ils partagent pour contrôler leur image ?
3. Est-ce que l'utilisation de Strava peut être une source de stress ?
4. Est-ce que l'utilisation de Strava peut être une source de motivation ?

### Hypothèses
**Hypothèse 1**
Plus les coureurs amateurs utilisent Strava, plus ils ont une fréquence et un volume d’entraînement élevé.


**Hypothèse 2 : **
Plus les coureurs amateurs utilisent Strava, plus ils sont susceptibles de filtrer ou modifier ce qu’ils partagent pour contrôler leur image.

**Hypothèse 3 :**
Plus les coureurs amateurs utilisent Strava, plus ils sont susceptibles de ressentir du stress.

**Hypothèse 4 : **
Plus les coureurs amateurs utilisent Strava, plus ils sont motivés dans leur pratique.

### Méthode
Le questionnaire a été construit suite à la lecture de différents articles, notamment l'étude de Russell ^3^ qui s'intéresse aux implications psychosociales de l'utilisation de Strava chez des coureurs universitaires aux Etats-Unis, l'étude d'Evans ^4^ qui s'intéressent aux sources de motivation chez les coureurs et la thèse de Chapman qui examine l'impact de l'utilisation de Strava et de la comparaison sociale sur le bien-être, l'épuisement sportif et le plaisir du sport chez de jeunes coureurs non-élites ^5^. L'étude d'Evans se base sur un questionnaire en ligne auprès de 25 000 coureurs de 7 pays, l'étude de Chapman se base sur un questionnaire en ligne également diffusé auprès de 200 coureurs et l'étude de Russell se base sur des entretiens semi-structurés auprès de 18 coureurs.

En partant de ces 3 articles, d'autres articles sont venus compléter la création du questionnaire afin d'avoir des échelles psychométriques pour mesurer la présentation de soi, la pression sociale et la motivation.

Le questionnaire a été construit de sorte d'avoir moins de 100 questions et une durée de passation de moins de 10 minutes afin de ne pas décourager les répondants et d'éviter que les réponses aux dernières questions soient faussées car les répondants répondent sans réfléchir pour terminer au plus vite.

Le questionnaire a été validée par notre enseignante à l'UGA avant diffusion. Le questionnaire comportait 84 questions : toutes les questions étaient obligatoires, sauf les questions comportant la mention "si oui". La durée de passation était estimée à 10 minutes. Les critères d'inclusion étaient d'être un **coureur amateur utilisateur de Strava et avoir plus de 18 ans**. Le questionnaire était totalement **anonyme**. 

Le questionnaire a été diffusé sur les réseaux sociaux : mon compte personnel LinkedIn, mon compte personnel Strava et dans les groupes Facebook "Bref, je fais du trail", "Coeur de runneuses", et "Courir après 50 ans". Le questionnaire a également été diffusé auprès de 2 clubs de course à pied : Les Amis de la Course à Pied à Crolles et l'ALE Echirolles. Le questionnaire a été ouvert du **28 janvier au 12 février 2025**.

Les données ont été récupérées sous Excel, pour faire un premier traitement (suppression des valeurs non exploitables et formatage de certaines valeurs (exemple : ancienneté pratique : "10 ans" > "10")). Les analyses ont été réalisées avec R (avec les librairies tidyverse, vcd et psy) Dans la base de données, chaque ligne représente un coureur et chaque colonne une variable.


```{r import donnees}
data<- read_excel("C:/Users/laura/Documents/UGA M1 STAPS ATDM/SHS/Résultats Strava/Utilisation de Strava chez les coureurs amateurs (réponses).xlsx", sheet="Traitement")
```


```{r manipulation donnees}
data$Age<- as.numeric(as.character(data$Age))
data <- data %>% mutate(age_category = case_when(
    Age < 20 ~  "Moins de 20 ans",
    Age >=20 & Age <25 ~  "20-24 ans",
    Age >=25 & Age <30 ~  "25-29 ans",
    Age >=30 & Age <35 ~  "30-34 ans",
    Age >=35 & Age <40 ~  "35-39 ans",
    Age >=40 & Age <45 ~  "40-44 ans",
    Age >=45 & Age <50 ~  "45-49 ans",
    Age >=50 & Age <55 ~  "50-54 ans",
    Age >=55 & Age <60 ~  "55-59 ans",
    Age >=60 & Age <65 ~  "60-64 ans",
    Age >=65 & Age <70 ~  "65-69 ans",
    Age >=70 & Age <75 ~  "70-74 ans",
    Age >=75 ~  "75 ans et plus"
  ))

data$Ancienneté_pratique<- as.numeric(as.character(data$Ancienneté_pratique))
data <- data %>% mutate(anciennetecap_category = case_when(
    Ancienneté_pratique < 5 ~  " Moins de 5 ans",
    Ancienneté_pratique >=5 & Ancienneté_pratique <10 ~  "5-9 ans",
    Ancienneté_pratique >=10 & Ancienneté_pratique <15 ~  "10-14 ans",
    Ancienneté_pratique >=15 & Ancienneté_pratique <20 ~  "15-19 ans",
    Ancienneté_pratique >=20 & Ancienneté_pratique <25 ~  "20-24 ans",
    Ancienneté_pratique >=25 & Ancienneté_pratique <30 ~  "25-29 ans",
    Ancienneté_pratique >=30 & Ancienneté_pratique <35 ~  "30-34 ans",
    Ancienneté_pratique >=35 & Ancienneté_pratique <40 ~  "35-39 ans",
    Ancienneté_pratique >=40 & Ancienneté_pratique <45 ~  "40-44 ans",
    Ancienneté_pratique>=45 ~  "45 ans et plus"
  ))

data$Frequence_pratique<- as.numeric(as.character(data$Frequence_pratique))
data <- data %>% mutate(freqentrainement_category = case_when(
    Frequence_pratique < 2 ~  "1/semaine",
    Frequence_pratique >=2 & Frequence_pratique <3 ~  "2/semaine",
    Frequence_pratique >=3 & Frequence_pratique <4 ~  "3/semaine",
    Frequence_pratique >=4 & Frequence_pratique <5 ~  "4/semaine",
    Frequence_pratique >=5 & Frequence_pratique <6 ~  "5/semaine",
    Frequence_pratique >=6 & Frequence_pratique <7 ~  "6/semaine",
    Frequence_pratique >=7 & Frequence_pratique <8 ~  "7/semaine",
    Frequence_pratique >=8 & Frequence_pratique <9 ~  "8/semaine",
    Frequence_pratique >=9 ~  "9/semaine et plus"
  ))

data$Kilomètres<- as.numeric(as.character(data$Kilomètres))
data <- data %>% mutate(kmentrainement_category = case_when(
    Kilomètres < 15 ~  "Moins de 15 km /semaine",
    Kilomètres >=15 & Kilomètres <30 ~  "15 à 29 km/semaine",
    Kilomètres >=30 & Kilomètres <45 ~  "30 à 44 km/semaine",
    Kilomètres >=45 & Kilomètres <60 ~  "45 à 59 km/semaine",
    Kilomètres >=60 & Kilomètres <75 ~  "60 à 74 km/semaine",
    Kilomètres >=75 & Kilomètres <90 ~  "75 à 89 km/semaine",
    Kilomètres >=90 & Kilomètres <105 ~  "90 à 104 km/semaine",
    Kilomètres >=105 & Kilomètres <120 ~  "105 à 119 km/semaine",
    Kilomètres >=120 & Kilomètres <135 ~  "120 à 134 km/semaine",
    Kilomètres >=135 & Kilomètres <150 ~  "135 à 149 km/semaine",
    Kilomètres >=150 ~  "150 km/semaine et plus"
  ))

data <- data %>%
  mutate(
    kmentrainement_category = factor(kmentrainement_category, levels = c(
      "Moins de 15 km /semaine",
      "15 à 29 km/semaine",
      "30 à 44 km/semaine",
      "45 à 59 km/semaine",
      "60 à 74 km/semaine",
      "75 à 89 km/semaine",
      "90 à 104 km/semaine",
      "105 à 119 km/semaine",
      "120 à 134 km/semaine",
      "135 à 149 km/semaine",
      "150 km/semaine et plus"
    ))
  )


data$Compétitions<- as.numeric(as.character(data$Compétitions))
data <- data %>% mutate(competitionnb_category = case_when(
    Compétitions < 3 ~  "Moins de 3 / an",
    Compétitions  >=3 & Compétitions <6 ~  "Entre 3 et 5 / an",
    Compétitions >=6 & Compétitions <9 ~  "Entre 6 et 8 / an",
    Compétitions >=9 & Compétitions <12 ~  "Entre 9 et 11 / an",
    Compétitions >=12 & Compétitions <15 ~  "Entre 12 et 14 / an",
    Compétitions >=15 & Compétitions <18 ~  "Entre 15 et 17 / an",
    Compétitions >=18 & Compétitions <21 ~  "Entre 18 et 20 / an",
    Compétitions >=21 & Compétitions <24 ~  "Entre 21 et 23 / an",
    Compétitions >=24 & Compétitions <27 ~  "Entre 24 et 26 / an",
    Compétitions >=27 & Compétitions <30 ~  "Entre 27 et 29 / an",
    Compétitions >=30 ~  "15 / an et plus"
  ))

data$Fréquence_publication<- as.numeric(as.character(data$Fréquence_publication))
data <- data %>% mutate(freqpubli_category = case_when(
    Fréquence_publication < 1 ~  "Moins de 1 / semaine",
    Fréquence_publication  >=1 & Fréquence_publication <2 ~  "1 / semaine",
    Fréquence_publication  >=2 & Fréquence_publication <3 ~  "2 / semaine",
    Fréquence_publication  >=3 & Fréquence_publication <4 ~  "3 / semaine",
    Fréquence_publication  >=4 & Fréquence_publication <5 ~  "4 / semaine",
    Fréquence_publication  >=5 & Fréquence_publication <6 ~  "5 / semaine",
    Fréquence_publication  >=6 & Fréquence_publication <7 ~  "6 / semaine",
    Fréquence_publication  >=7 & Fréquence_publication <8 ~  "7 / semaine",
    Fréquence_publication >=8 ~  "8 / semaine et plus"
  ))

data <- data %>% mutate(freqpubli_categorystat = case_when(
    Fréquence_publication < 1 ~  "1",
    Fréquence_publication  >=1 & Fréquence_publication <2 ~  "2",
    Fréquence_publication  >=2 & Fréquence_publication <3 ~  "3",
    Fréquence_publication  >=3 & Fréquence_publication <4 ~  "4",
    Fréquence_publication  >=4 & Fréquence_publication <5 ~  "5",
    Fréquence_publication  >=5 & Fréquence_publication <6 ~  "6",
    Fréquence_publication  >=6 & Fréquence_publication <7 ~  "7",
    Fréquence_publication  >=7 & Fréquence_publication <8 ~  "8",
    Fréquence_publication >=8 ~  "8"
  ))

data$Fréquence_consultation<- as.numeric(as.character(data$Fréquence_consultation))
data <- data %>% mutate(freqcons_category = case_when(
    Fréquence_consultation < 2 ~  "Moins de 2 / semaine",
    Fréquence_consultation  >=2 & Fréquence_consultation <4 ~  "Entre 2 et 3 / semaine",
    Fréquence_consultation  >=4 & Fréquence_consultation <6 ~  "Entre 4 et 5 / semaine",
    Fréquence_consultation  >=6 & Fréquence_consultation <8 ~  "Entre 6 et 7 / semaine",
    Fréquence_consultation  >=8 & Fréquence_consultation <10 ~  "Entre 8 et 9 / semaine",
    Fréquence_consultation  >=10 & Fréquence_consultation <12 ~  "Entre 10 et 11 / semaine",
    Fréquence_consultation >=12 ~  "12 / semaine et plus"
  ))

data <- data %>% mutate(freqcons_categorystat = case_when(
    Fréquence_consultation < 2 ~  "1",
    Fréquence_consultation  >=2 & Fréquence_consultation <4 ~  "2",
    Fréquence_consultation  >=4 & Fréquence_consultation <6 ~  "3",
    Fréquence_consultation  >=6 & Fréquence_consultation <8 ~  "4",
    Fréquence_consultation  >=8 & Fréquence_consultation <10 ~  "5",
    Fréquence_consultation  >=10 & Fréquence_consultation <12 ~  "6",
    Fréquence_consultation >=6 ~  "7"
  ))

data$Ancienneté_Strava<- as.numeric(as.character(data$Ancienneté_Strava))
data <- data %>% mutate(anciennetestrava_category = case_when(
    Ancienneté_Strava < 2 ~  "Moins de 2 ans",
    Ancienneté_Strava >=2 & Ancienneté_Strava <4 ~  "2-3 ans",
    Ancienneté_Strava >=4 & Ancienneté_Strava <6 ~  "4-5 ans",
    Ancienneté_Strava >=6 & Ancienneté_Strava <8 ~  "6-7 ans",
    Ancienneté_Strava >=8 & Ancienneté_Strava <10 ~  "8-9 ans",
    Ancienneté_Strava >=10 & Ancienneté_Strava <12 ~  "10-11 ans",
    Ancienneté_Strava >=12 & Ancienneté_Strava <14 ~  "12-13 ans",
    Ancienneté_Strava >=14 & Ancienneté_Strava <16 ~  "14-15 ans",
    Ancienneté_Strava>=16 ~  "16 ans et plus"
  ))

data$Nb_abonnés<- as.numeric(as.character(data$Nb_abonnés))
data<- data %>% mutate(nbabonnés_category = case_when(
    Nb_abonnés < 50 ~  "49 ou moins",
    Nb_abonnés >=50 & Nb_abonnés <100 ~  "Entre 50 et 99",
    Nb_abonnés >=100 & Nb_abonnés <150 ~  "Entre 100 et 149",
    Nb_abonnés >=150 & Nb_abonnés <200 ~  "Entre 150 et 199",
    Nb_abonnés >=200 & Nb_abonnés <250 ~  "Entre 200 et 249",
    Nb_abonnés >=250 & Nb_abonnés <300 ~  "Entre 250 et 299",
    Nb_abonnés >=300 & Nb_abonnés <350 ~  "Entre 300 et 349",
    Nb_abonnés >=350 & Nb_abonnés <400 ~  "Entre 350 et 399",
    Nb_abonnés >=400 & Nb_abonnés <450 ~  "Entre 400 et 449",
    Nb_abonnés >=450 & Nb_abonnés <500 ~  "Entre 450 et 499",
    Nb_abonnés >=500 & Nb_abonnés <550 ~  "Entre 500 et 549",
    Nb_abonnés >=550 & Nb_abonnés <600 ~  "Entre 550 et 599",
    Nb_abonnés >=600 & Nb_abonnés <650 ~  "Entre 600 et 649",
    Nb_abonnés >=650 & Nb_abonnés <700 ~  "Entre 650 et 699",
    Nb_abonnés >=700 & Nb_abonnés <750 ~  "Entre 700 et 749",
    Nb_abonnés >=750 & Nb_abonnés <800 ~  "Entre 749 et 799",
    Nb_abonnés >=800 & Nb_abonnés <850 ~  "Entre 800 et 849",
    Nb_abonnés >=850 ~  "850 et plus"
))
data<- data %>% mutate(nbabonnés_categorystat = case_when(
    Nb_abonnés < 50 ~  "49 ou moins",
    Nb_abonnés >=50 & Nb_abonnés <100 ~  "1",
    Nb_abonnés >=100 & Nb_abonnés <150 ~  "2",
    Nb_abonnés >=150 & Nb_abonnés <200 ~  "3",
    Nb_abonnés >=200 & Nb_abonnés <250 ~  "4",
    Nb_abonnés >=250 & Nb_abonnés <300 ~  "5",
    Nb_abonnés >=300 & Nb_abonnés <350 ~  "6",
    Nb_abonnés >=350 & Nb_abonnés <400 ~  "7",
    Nb_abonnés >=400 & Nb_abonnés <450 ~  "8",
    Nb_abonnés >=450 & Nb_abonnés <500 ~  "9",
    Nb_abonnés >=500 & Nb_abonnés <550 ~  "10",
    Nb_abonnés >=550 & Nb_abonnés <600 ~  "11",
    Nb_abonnés >=600 & Nb_abonnés <650 ~  "12",
    Nb_abonnés >=650 & Nb_abonnés <700 ~  "13",
    Nb_abonnés >=700 & Nb_abonnés <750 ~  "14",
    Nb_abonnés >=750 & Nb_abonnés <800 ~  "15",
    Nb_abonnés >=800 & Nb_abonnés <850 ~  "16",
    Nb_abonnés >=850 ~  "17"
))

data$Nb_abonnements<- as.numeric(as.character(data$Nb_abonnements))
data<- data %>% mutate(nbabonnement_category = case_when(
    Nb_abonnements < 50 ~  "49 ou moins ",
    Nb_abonnements >=50 & Nb_abonnements <100 ~  "Entre 50 et 99",
    Nb_abonnements >=100 & Nb_abonnements <150 ~  "Entre 100 et 149",
    Nb_abonnements >=150 & Nb_abonnements <200 ~  "Entre 150 et 199",
    Nb_abonnements >=200 & Nb_abonnements <250 ~  "Entre 200 et 249",
    Nb_abonnements >=250 & Nb_abonnements <300 ~  "Entre 250 et 299",
    Nb_abonnements >=300 & Nb_abonnements <350 ~  "Entre 300 et 349",
    Nb_abonnements >=350 & Nb_abonnements <400 ~  "Entre 450 et 299",
    Nb_abonnements >=400 & Nb_abonnements <450 ~  "Entre 400 et 449",
    Nb_abonnements >=450 & Nb_abonnements <500 ~  "Entre 450 et 499",
    Nb_abonnements >=500 & Nb_abonnements <550 ~  "Entre 500 et 549",
    Nb_abonnements >=550 & Nb_abonnements <600 ~  "Entre 550 et 599",
    Nb_abonnements >=600 & Nb_abonnements <650 ~  "Entre 600 et 649",
    Nb_abonnements >=650 & Nb_abonnements <700 ~  "Entre 650 et 699",
    Nb_abonnements >=700 ~ "700 et plus"
))

data<- data %>% mutate(nbabonnement_categorystat = case_when(
    Nb_abonnements < 50 ~  "1 ",
    Nb_abonnements >=50 & Nb_abonnements <100 ~  "2",
    Nb_abonnements >=100 & Nb_abonnements <150 ~  "3",
    Nb_abonnements >=150 & Nb_abonnements <200 ~  "4",
    Nb_abonnements >=200 & Nb_abonnements <250 ~  "5",
    Nb_abonnements >=250 & Nb_abonnements <300 ~  "6",
    Nb_abonnements >=300 & Nb_abonnements <350 ~  "7",
    Nb_abonnements >=350 & Nb_abonnements <400 ~  "8",
    Nb_abonnements >=400 & Nb_abonnements <450 ~  "9",
    Nb_abonnements >=450 & Nb_abonnements <500 ~  "10",
    Nb_abonnements >=500 & Nb_abonnements <550 ~  "11",
    Nb_abonnements >=550 & Nb_abonnements <600 ~  "12",
    Nb_abonnements >=600 & Nb_abonnements <650 ~  "13",
    Nb_abonnements >=650 & Nb_abonnements <700 ~  "14",
    Nb_abonnements >=700 ~ "15"
))

data$Club_Strava<- as.numeric(as.character(data$Club_Strava))
data <- data %>% mutate(clubstrava_category = case_when(
    Club_Strava < 5 ~  "Moins de 5",
    Club_Strava  >=5 & Club_Strava <9 ~  "Entre 5 et 9",
    Club_Strava  >=10 & Club_Strava <15 ~  "Entre 10 et 14",
    Club_Strava  >=15 & Club_Strava <20 ~  "Entre 15 et 19",
    Club_Strava  >=20 & Club_Strava <25 ~  "Entre 20 et 24",
    Club_Strava  >=25 & Club_Strava <30 ~  "Entre 25 et 29",
    Club_Strava  >=30 & Club_Strava <35 ~  "Entre 30 et 34",
    Club_Strava  >=35 & Club_Strava <40 ~  "Entre 35 et 39",
    Club_Strava  >=40 & Club_Strava <45 ~  "Entre 40 et 44",
    Club_Strava  >=45 & Club_Strava <50 ~  "Entre 45 et 49",
    Club_Strava  >=50 & Club_Strava <55 ~  "Entre 50 et 54",
    Club_Strava  >=55 & Club_Strava <60 ~  "Entre 55 et 59",
    Club_Strava >=60 ~  "60 ou plus"
  ))

data <- data %>% mutate(clubstrava_categorystat = case_when(
    Club_Strava < 5 ~  "1",
    Club_Strava  >=5 & Club_Strava <9 ~  "2",
    Club_Strava  >=10 & Club_Strava <15 ~  "3",
    Club_Strava  >=15 & Club_Strava <20 ~  "4",
    Club_Strava  >=20 & Club_Strava <25 ~  "5",
    Club_Strava  >=25 & Club_Strava <30 ~  "6",
    Club_Strava  >=30 & Club_Strava <35 ~  "7",
    Club_Strava  >=35 & Club_Strava <40 ~  "8",
    Club_Strava  >=40 & Club_Strava <45 ~  "9",
    Club_Strava  >=45 & Club_Strava <50 ~  "10",
    Club_Strava  >=50 & Club_Strava <55 ~  "11",
    Club_Strava  >=55 & Club_Strava <60 ~  "12",
    Club_Strava >=60 ~  "13"
  ))

data$Kudos_reçus<- as.numeric(as.character(data$Kudos_reçus))
data <- data %>% mutate(kudosreçus_category = case_when(
    Kudos_reçus < 10 ~  "Moins de 10",
    Kudos_reçus  >=10 & Kudos_reçus <20 ~  "Entre 10 et 19",
    Kudos_reçus  >=20 & Kudos_reçus <30 ~  "Entre 20 et 29",
    Kudos_reçus  >=30 & Kudos_reçus <40 ~  "Entre 30 et 39",
    Kudos_reçus  >=40 & Kudos_reçus <50 ~  "Entre 40 et 49",
    Kudos_reçus  >=50 & Kudos_reçus <60 ~  "Entre 50 et 59",
    Kudos_reçus  >=60 & Kudos_reçus <70 ~  "Entre 60 et 69",
    Kudos_reçus  >=70 & Kudos_reçus <80 ~  "Entre 70 et 79",
    Kudos_reçus  >=80 & Kudos_reçus <90 ~  "Entre 80 et 89",
    Kudos_reçus  >=90 & Kudos_reçus <100 ~  "Entre 90 et 99",
    Kudos_reçus >=100 ~  "100 ou plus"
  ))

data <- data %>% mutate(kudosreçus_categorystat = case_when(
 Kudos_reçus < 10 ~  "1",
    Kudos_reçus  >=10 & Kudos_reçus <20 ~  "2",
    Kudos_reçus  >=20 & Kudos_reçus <30 ~  "3",
    Kudos_reçus  >=30 & Kudos_reçus <40 ~  "4",
    Kudos_reçus  >=40 & Kudos_reçus <50 ~  "5",
    Kudos_reçus  >=50 & Kudos_reçus <60 ~  "6",
    Kudos_reçus  >=60 & Kudos_reçus <70 ~  "7",
    Kudos_reçus  >=70 & Kudos_reçus <80 ~  "8",
    Kudos_reçus  >=80 & Kudos_reçus <90 ~  "9",
    Kudos_reçus  >=90 & Kudos_reçus <100 ~  "10",
    Kudos_reçus >=100 ~  "11"
  ))


data$nbabonnement_categorystat <- as.numeric(as.character(data$nbabonnement_categorystat))
data$nbabonnés_categorystat <- as.numeric(as.character(data$nbabonnés_categorystat))
data$freqcons_categorystat <-as.numeric(as.character(data$freqcons_categorystat))
data$freqpubli_categorystat<- as.numeric(as.character(data$freqpubli_categorystat))
data$clubstrava_categorystat<- as.numeric(as.character(data$clubstrava_categorystat))
data$kudosreçus_categorystat<- as.numeric(as.character(data$kudosreçus_categorystat))

```
# Données socio-démographiques

```{r donnees generales}
taille_echantillon <- nrow(data)
nbfemmes <- sum(data$Sexe == 1, na.rm = TRUE)
nbhommes <- sum(data$Sexe == 2, na.rm = TRUE)

glue("La taille de l'échantillon est de {taille_echantillon} individus, avec {nbfemmes} femmes et {nbhommes} hommes.")
```



```{r caracteristiques individuelles}
moyenneage <- mean(data$Age, na.rm = TRUE)
ecarttypeage <- sd(data$Age, na.rm = TRUE)

if (is.factor(data$Sexe)) {
  data$Sexe <- as.numeric(levels(data$Sexe))[data$Sexe]
} else {
  data$Sexe <- as.numeric(as.character(data$Sexe))
}

if (is.factor(data$Catégorie)) {
  data$Catégorie <- as.numeric(levels(data$Catégorie))[data$Catégorie]
} else {
  data$Catégorie <- as.numeric(as.character(data$Catégorie))
}

catsociocadre <- (sum(data$Catégorie == 3, na.rm = TRUE) / nrow(data)) * 100
catsocioemployes <-  (sum(data$Catégorie == 5, na.rm = TRUE) / nrow(data)) * 100

```

```{r affichage caracteristiques individuelles}
glue("La moyenne d'âge est de {moyenneage} ans, avec un écart-type de {ecarttypeage} ans.")
glue ("La catégorie socio-professionelle la plus représentée est Cadres et professions intellectulles, qui représente {catsociocadre} % de l'échantillon, puis les employés avec {catsocioemployes} %. ")
```
### Âge et sexe{.tabset}

#### Répartition de l'âge
```{r graphique age}
data_resumeAge<- data%>%
  summarise(
    Moyenne = mean(Age, na.rm = TRUE),
    Médiane = median(Age, na.rm = TRUE),
    Ecart_type = sd(Age, na.rm=TRUE)
  )

kable(data_resumeAge)

data_resumeageround<- data%>%
  summarise(
    moyenne = round(mean(Age, na.rm = TRUE),0),
    mediane = round(median(Age, na.rm = TRUE),0),
    q1 = round(quantile(Age, 0.25, na.rm=T),0),
    q3 = round(quantile(Age, 0.75, na.rm=T),0),
    ecarttype = round(sd(Age, na.rm=TRUE),0)
  )

vlinesage <- data.frame(
  label = c("Q1", "Médiane", "Moyenne", "Q3"),
  xintercept = c(data_resumeageround$q1, data_resumeageround$mediane, data_resumeageround$moyenne, data_resumeageround$q3)
)
vlinesage$annotation <- paste(vlinesage$label, ":", vlinesage$xintercept)

ggplot(data) +
  geom_histogram(aes(x = Age), fill = "#FC4C02", binwidth=5, colour="#FC4C02", alpha=0.5) +
  scale_x_continuous(breaks = seq(20, max(data$Age, na.rm = TRUE), by = 5))+
  labs(title = "Répartition des âges au sein de l'échantillon",
       x = "Âge (en années)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesage, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesage, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

#### Répartition des sexes
```{r graphique sexe}
chi2conformitesexe <- chisq.test(data$Age, p=rep(1/length(data$Age),length(data$Age)))
table_sexe <- data.frame(
  Variable = c("Sexe"),
  Khi2_ajustement = as.numeric(chi2conformitesexe$statistic), 
  p.value = ifelse(chi2conformitesexe$p.value < 0.001, "<0.001", ">0.001")
)

kable(table_sexe)



ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
  geom_bar(aes(fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Répartition des sexes au sein de l'échantillon",
       x = "Sexe", y = "Nombre d'individus", fill="Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Répartition de l'âge en fonction des sexes
```{r graphique age en fonction des sexe}
ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Age,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "Répartition des âges en fonction des sexes au sein de l'échantillon",
       x = "Sexe",
       y = "Âge (en années)",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

### Catégories socio-professionnelles{.tabset}
```{r graphique categorie socio pro}

chi2conformitecat <- chisq.test(data$Catégorie, p=rep(1/length(data$Catégorie),length(data$Catégorie)))
table_cat <- data.frame(
  Variable = c("Catégorie"),
  Khi2_ajustement = as.numeric(chi2conformitecat$statistic),
  p.value = ifelse(chi2conformitecat$p.value < 0.001, "<0.001", ">0.001")
)

kable(table_cat)


ggplot(data, aes(x = factor(Catégorie, 
                            levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                            labels = c("Agriculteurs exploitants",
                                       "Artisans, commerçants et chefs d'entreprise",
                                       "Cadres et professions intellectuelles supérieures",
                                       "Professions intermédiaires",
                                       "Employés",
                                       "Ouvriers",
                                       "Retraités",
                                       "Etudiants",
                                       "Autres personnes sans activité professionelle")))) +
  geom_bar(aes(fill = factor(Catégorie, 
                             levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                             labels = c("Agriculteurs exploitants",
                                        "Artisans, commerçants et chefs d'entreprise",
                                        "Cadres et professions intellectuelles supérieures",
                                        "Professions intermédiaires",
                                        "Employés",
                                        "Ouvriers",
                                        "Retraités",
                                        "Etudiants",
                                        "Autres personnes sans activité professionelle")), alpha=0.5)) +
  geom_text(aes(label = ..count..), 
            stat = "count",
            vjust = -0.5,
            size = 2) +
  labs(title = "Répartition des catégories socio-professionnelles au sein l'échantillon",
       x = "Catégorie socio-professionnelles",
       y = "Nombre d'individus", fill="Catégorie socio-professionelle") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
  theme(legend.position = "none")
```

# Utilisation de Strava

### Mesure de l'intensité d'utilisation{.tabset}
Les questions 20 à 24 (Echelle de Linkert) sont issues d'une traduction et adaptation du Facebook Intensity Scale, utilisé dans l'étude d'Ellison ^8^ et repris dans l'étude de Ross ^9^, en remplaçant "Facebook" par "Strava". Il y a donc **5 items** pour cette échelle de mesure adaptée pour identifier à quel point l'utilisation de Strava fait partie du quotidien de l'utilisateur. Cette échelle est renommée pour l'étude en Strava Intensity Scale (SIS).

L'alpha de Cronbach dans l'étude d'Ellison est de 0.83 ^8^ et de 0.85 dans l'étude de Ross ^9^.

Un score bas au SIS indique que Strava fait peu partie du quotidien de l'utilisateur et qu'il y est peu attaché tandis qu'un score haut au SIS indique que l'utilisateur utilise Strava très fréquemment et est affecté négativement s'il ne peut pas l'utiliser.

```{r score SIS alpha cronbach}
data_SIS <- data[, c("SIS_1", "SIS_2", "SIS_3", "SIS_4", "SIS_5")]
cronbachSIS<-cronbach(data_SIS)

glue ("L'alpha de Cronbach sur les {cronbachSIS$number.of.items} items est de {cronbachSIS$alpha}.")
```
L'alpha de Cronbach est acceptable.

#### SIS 1
```{r graphique SIS 1}
data_resumeSIS1 <- data%>%
  summarise(
    Moyenne = mean(SIS_1, na.rm = TRUE),
    Médiane = median(SIS_1, na.rm = TRUE),
    Ecart_type = sd(SIS_1, na.rm=TRUE))

kable(data_resumeSIS1)

ggplot(data, aes(x = factor(SIS_1, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Strava fait partie de mon activité quotidienne. ", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SIS 2
```{r graphique SIS 2}

data_resumeSIS2 <- data%>%
  summarise(
    Moyenne = mean(SIS_2, na.rm = TRUE),
    Médiane = median(SIS_2, na.rm = TRUE),
    Ecart_type = sd(SIS_2, na.rm=TRUE))

kable(data_resumeSIS2)

ggplot(data, aes(x = factor(SIS_2, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je suis fier(fière) de dire aux gens que j’utilise Strava.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SIS 3
```{r graphique SIS 3}

data_resumeSIS3 <- data%>%
  summarise(
    Moyenne = mean(SIS_3, na.rm = TRUE),
    Médiane = median(SIS_3, na.rm = TRUE),
    Ecart_type = sd(SIS_3, na.rm=TRUE))

kable(data_resumeSIS3)

ggplot(data, aes(x = factor(SIS_3, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je me sens déconnecté(e) lorsque je n’ai pas utilisé Strava depuis un certain temps.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SIS 4
```{r graphique SIS 4}
data_resumeSIS4 <- data%>%
  summarise(
    Moyenne = mean(SIS_4, na.rm = TRUE),
    Médiane = median(SIS_4, na.rm = TRUE),
    Ecart_type = sd(SIS_4, na.rm=TRUE))

kable(data_resumeSIS4)


ggplot(data, aes(x = factor(SIS_4, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02",alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "J’ai l’impression de faire partie de la communauté Strava.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SIS 5
```{r graphique SIS 5}
data_resumeSIS5 <- data%>%
  summarise(
    Moyenne = mean(SIS_5, na.rm = TRUE),
    Médiane = median(SIS_5, na.rm = TRUE),
    Ecart_type = sd(SIS_5, na.rm=TRUE))

kable(data_resumeSIS2)


ggplot(data, aes(x = factor(SIS_5, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je ne pourrais pas arrêter d'utiliser Strava.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SCORE SIS 
```{r graphique SCORE SIS}
data <- data %>% mutate (SCORE_SIS_TOTAL = SIS_1 + SIS_2 + SIS_3 + SIS_4 + SIS_5)

data <- data %>% mutate(scoreSIS_categorystat = case_when(
    SCORE_SIS_TOTAL < 5 ~  "1",
    SCORE_SIS_TOTAL  >=5 & SCORE_SIS_TOTAL <9 ~  "2",
    SCORE_SIS_TOTAL  >=9 & SCORE_SIS_TOTAL <13 ~  "3",
    SCORE_SIS_TOTAL  >=13 & SCORE_SIS_TOTAL <17 ~  "4",
    SCORE_SIS_TOTAL >=17 ~  "5"
  ))


chi2conformiteSIS1 <- chisq.test(table(data$SIS_1), 
p = rep(1/length(unique(data$SIS_1)), length(unique(data$SIS_1))))


chi2conformiteSIS2<-chisq.test(table(data$SIS_2),
p=rep(1/length(unique(data$SIS_2)),length(unique(data$SIS_2))))

chi2conformiteSIS3<-chisq.test(table(data$SIS_3), p=rep(1/length(unique(data$SIS_3)),length(unique(data$SIS_3))))

chi2conformiteSIS4<-chisq.test(table(data$SIS_4), p=rep(1/length(unique(data$SIS_4)),length(unique(data$SIS_4))))
chi2conformiteSIS5<-chisq.test(table(data$SIS_5), p=rep(1/length(unique(data$SIS_5)),length(unique(data$SIS_5))))

chi2conformiteSISTotal <- chisq.test(table(data$scoreSIS_categorystat, useNA="no"),
  p = rep(1 / length(unique(data$scoreSIS_categorystat)), length(unique(data$scoreSIS_categorystat))))

data_resumesistotalround<- data%>%
  summarise(
    median = round(median(SCORE_SIS_TOTAL, na.rm = TRUE),0),
    moyenne= round(mean(SCORE_SIS_TOTAL, na.rm=TRUE),0),
    q1 = round(quantile(SCORE_SIS_TOTAL, 0.25, na.rm=T),0),
    q3 = round(quantile(SCORE_SIS_TOTAL, 0.75, na.rm=T),0)
  )

data_resumesistotal<- data%>%
  summarise(
    Médiane = median(SCORE_SIS_TOTAL, na.rm = TRUE),
    Moyenne= mean(SCORE_SIS_TOTAL, na.rm=TRUE),
    Ecart_type = sd(SCORE_SIS_TOTAL, na.rm=TRUE)
  )

table_SIS <- data.frame(
  Variable = c("SIS1", "SIS2", "SIS3", "SIS4", "SIS5", "Total"),
  Moyenne = c(data_resumeSIS1$Moyenne, data_resumeSIS2$Moyenne, data_resumeSIS3$Moyenne, data_resumeSIS4$Moyenne, data_resumeSIS5$Moyenne, data_resumesistotal$Moyenne),
  Médiane = c(data_resumeSIS1$Médiane, data_resumeSIS2$Médiane, data_resumeSIS3$Médiane,data_resumeSIS4$Médiane, data_resumeSIS5$Médiane,           data_resumesistotal$Médiane),
  Ecart_type = c(data_resumeSIS1$Ecart_type, data_resumeSIS2$Ecart_type, data_resumeSIS3$Ecart_type, data_resumeSIS4$Ecart_type, data_resumeSIS5$Ecart_type,    data_resumesistotal$Ecart_type),
  Khi2_ajustement = c(chi2conformiteSIS1$statistic, chi2conformiteSIS2$statistic, chi2conformiteSIS3$statistic, chi2conformiteSIS4$statistic, chi2conformiteSIS5$statistic, chi2conformiteSISTotal$statistic),
  P.value= ifelse(
    c(chi2conformiteSIS1$p.value, chi2conformiteSIS2$p.value, chi2conformiteSIS3$p.value, chi2conformiteSIS4$p.value, chi2conformiteSIS5$p.value, 
chi2conformiteSISTotal$p.value) < 0.001, "<0.001", ">0.001")
)

kable(table_SIS)

vlinesSISTOTAL <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumesistotalround$q1, data_resumesistotalround$moyenne, data_resumesistotalround$median, data_resumesistotalround$q3)
)
vlinesSISTOTAL$annotation <- paste(vlinesSISTOTAL$label, ":", vlinesSISTOTAL$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_SIS_TOTAL), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_SIS_TOTAL, na.rm = TRUE), 
                                max(data$SCORE_SIS_TOTAL, na.rm = TRUE), 
                                by = 5))+
  labs(title = "Répartition du score SIS au sein de l'échantillon",
       x = "Score SIS", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesSISTOTAL, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesSISTOTAL, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```

### Compléments{.tabset}

#### Fréquence de publication
```{r graphique frequence publication}
data$Fréquence_publication <- as.numeric(as.character(data$Fréquence_publication ))

data_resumefreqPubli<- data%>%
  summarise(
    Moyenne = mean(Fréquence_publication, na.rm = TRUE),
    Médiane = median(Fréquence_publication, na.rm = TRUE),
    Ecart_type= sd(Fréquence_publication, na.rm=TRUE)
  )

kable(data_resumefreqPubli)


data_resumefreqpubliround<- data%>%
  summarise(
    median = round(median(Fréquence_publication , na.rm = TRUE),0),
    moyenne = round(mean(Fréquence_publication , na.rm=TRUE), 0),
    q1 = round(quantile(Fréquence_publication , 0.25, na.rm=T),0),
    q3 = round(quantile(Fréquence_publication , 0.75, na.rm=T),0)
  )

vlinesfreqpubli <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumefreqpubliround$q1, data_resumefreqpubliround$moyenne, data_resumefreqpubliround$median, data_resumefreqpubliround$q3)
)
vlinesfreqpubli$annotation <- paste(vlinesfreqpubli$label, ":", vlinesfreqpubli$xintercept)

ggplot(data) +
  geom_histogram(aes(x = Fréquence_publication), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$Fréquence_publication , na.rm = TRUE), 
                                max(data$Fréquence_publication , na.rm = TRUE), 
                                by = 2))+
  labs(title = "Répartition de la fréquence de publication au sein de l'échantillon",
       x = "Fréquence de publication (nombre de fois par semaine)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesfreqpubli, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesfreqpubli, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```

#### Fréquence de consultation
```{r graphique frequence consultation}
data$Fréquence_consultation <- as.numeric(as.character(data$Fréquence_consultation))

data_resumefreqCons<- data%>%
  summarise(
    Moyenne = mean(Fréquence_consultation, na.rm = TRUE),
    Médiane = median(Fréquence_consultation, na.rm = TRUE),
    Ecart_type= sd(Fréquence_consultation, na.rm=TRUE)
  )

kable(data_resumefreqCons)

data_resumefreqconsround<- data%>%
  summarise(
    median = round(median(Fréquence_consultation, na.rm = TRUE),0),
    moyenne = round(mean(Fréquence_consultation, na.rm=TRUE), 0),
    q1 = round(quantile(Fréquence_consultation, 0.25, na.rm=T),0),
    q3 = round(quantile(Fréquence_consultation, 0.75, na.rm=T),0)
  )

vlinesfreqcons <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumefreqconsround$q1, data_resumefreqconsround$moyenne, data_resumefreqconsround$median, data_resumefreqconsround$q3)
)
vlinesfreqcons$annotation <- paste(vlinesfreqcons$label, ":", vlinesfreqcons$xintercept)

ggplot(data) +
  geom_histogram(aes(x = Fréquence_consultation), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$Fréquence_consultation, na.rm = TRUE), 
                                max(data$Fréquence_consultation, na.rm = TRUE), 
                                by = 2))+
  labs(title = "Répartition de la fréquence de consultation au sein de l'échantillon",
       x = "Fréquence de consultation (nombre de fois par semaine)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesfreqcons, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesfreqcons, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```


#### Nombre d'abonnés
```{r graphique nb abonnes}
data_resumenbAbonnés<- data%>%
  summarise(
    Médiane = median(Nb_abonnés, na.rm = TRUE),
    Moyenne = mean(Nb_abonnés, na.rm=TRUE),
    Ecart_type = sd(Nb_abonnés, na.rm=TRUE)
  )

kable(data_resumenbAbonnés)

data_resumenbabonnésround<- data%>%
  summarise(
    median = round(median(Nb_abonnés, na.rm = TRUE),0),
    moyenne = round(mean(Nb_abonnés, na.rm=TRUE),0),
    q1 = round(quantile(Nb_abonnés, 0.25, na.rm=T),0),
    q3 = round(quantile(Nb_abonnés, 0.75, na.rm=T),0)
  )

vlinesnbabonnés <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumenbabonnésround$q1, data_resumenbabonnésround$moyenne, data_resumenbabonnésround$median, data_resumenbabonnésround$q3)
)
vlinesnbabonnés$annotation <- paste(vlinesnbabonnés$label, ":", vlinesnbabonnés$xintercept)

ggplot(data) +
  geom_histogram(aes(x = Nb_abonnés), fill = "#FC4C02", binwidth=50, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$Nb_abonnés, na.rm = TRUE), 
                                max(data$Nb_abonnés, na.rm = TRUE), 
                                by = 50))+
  labs(title = "Répartition du nombre d'abonnés au sein de l'échantillon",
       x = "Nombre d'abonnés", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesnbabonnés, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesnbabonnés, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```

#### Nombre d'abonnements
```{r graphique nb abonnements}
data_resumenbAbonnements<- data%>%
  summarise(
    Médiane = median(Nb_abonnements, na.rm = TRUE),
    Moyenne = mean(Nb_abonnements, na.rm=TRUE),
    Ecart_type = sd(Nb_abonnements, na.rm=TRUE)
  )

kable(data_resumenbAbonnements)

data_resumenbabonnementsround<- data%>%
  summarise(
    median = round(median(Nb_abonnements, na.rm = TRUE),0),
    moyenne = round(mean(Nb_abonnements, na.rm=TRUE), 0),
    q1 = round(quantile(Nb_abonnements, 0.25, na.rm=T),0),
    q3 = round(quantile(Nb_abonnements, 0.75, na.rm=T),0)
  )

vlinesnbabonnements <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumenbabonnementsround$q1, data_resumenbabonnementsround$moyenne, data_resumenbabonnementsround$median, data_resumenbabonnementsround$q3)
)
vlinesnbabonnements$annotation <- paste(vlinesnbabonnements$label, ":", vlinesnbabonnements$xintercept)

ggplot(data) +
  geom_histogram(aes(x = Nb_abonnements), fill = "#FC4C02", binwidth=50, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$Nb_abonnements, na.rm = TRUE), 
                                max(data$Nb_abonnements, na.rm = TRUE), 
                                by = 50))+
  labs(title = "Répartition du nombre d'abonnements au sein de l'échantillon",
       x = "Nombre d'abonnements", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesnbabonnements, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesnbabonnements, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

### Mesure de la sociabilité en ligne{.tabset}
Les questions 39 à 42 (Echelle de Linkert) sont une traduction et adaptation du Online Sociability Functions (OSF) utilisé dans l'étude de Ross^9^ qui mesure la sociabilité en ligne. L'alpha de Cronbach dans l'étude de Ross^9^ est de 0.74.
Il y a donc **4 items** pour cette échelle de mesure adaptée pour identifier à quel point chaque utilisateur est sociable sur Strava.

On pourrait ajouter le nombre de clubs Strava dont l'utilisateur fait partie (question 38) et le nombre de kudos reçus (question 42) pour enrichir cette échelle mais cela ne modifie quasiment pas l'alpha de Cronbach. 

Un score bas au OSF indique que l'utilisateur utilise peu les fonctionnalités de sociabilité en ligne, tandis qu'un score haut indique que l'utilisateur utilise beaucoup de fonctionnalités de sociabilité en ligne.

```{r SCORE OSF alpha cronbach}
data_OSF <- data[, c("Kudos_donnés", "Commentaires_donnés", "Publications", "Commentaires_reçus")]
cronbachOSF<-cronbach(data_OSF)

data_OSFaugmente <- data[, c("Kudos_donnés", "Commentaires_donnés", "Publications", "Commentaires_reçus", "clubstrava_categorystat", "kudosreçus_categorystat")]
cronbachOSFaugmente<-cronbach(data_OSFaugmente)

glue ("L'alpha de Cronbach sur les {cronbachOSF$number.of.items} items est de {cronbachOSF$alpha}.")
```
L'alpha de Cronbach est un peu faible, cela peut s'expliquer par le fait qu'il s'agit d'une traduction et adaptation du questionnaire d'origine dans le cadre de cette étude.

#### Kudos donnés
```{r graphique nb kudos donnes}
data_resumekudosdonnés <- data%>%
  summarise(
    Moyenne = mean(Kudos_donnés, na.rm = TRUE),
    Médiane = median(Kudos_donnés, na.rm = TRUE),
    Ecart_type = sd(Kudos_donnés, na.rm=TRUE))

kable(data_resumekudosdonnés)

ggplot(data, aes(x = factor(Kudos_donnés, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Envoyez-vous des kudos ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Commentaires donnés
```{r graphique commentaires donnes}
data_resumecommentairesdonnés <- data%>%
  summarise(
    Moyenne = mean(Commentaires_donnés, na.rm = TRUE),
    Médiane = median(Commentaires_donnés, na.rm = TRUE),
    Ecart_type = sd(Commentaires_donnés, na.rm=TRUE))

kable(data_resumecommentairesdonnés)

ggplot(data, aes(x = factor(Commentaires_donnés, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Laissez-vous des commentaires ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Publications
```{r graphique publications}
data_resumepublication <- data%>%
  summarise(
    Moyenne = mean(Publications, na.rm = TRUE),
    Médiane = median(Publications, na.rm = TRUE),
    Ecart_type = sd(Publications, na.rm=TRUE))

kable(data_resumepublication)

ggplot(data, aes(x = factor(Publications, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Faites-vous des publications (hors activités) ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Commentaires reçus
```{r graphique commentaires recus}
data_resumecommentairesreçus <- data%>%
  summarise(
    Moyenne = mean(Commentaires_reçus, na.rm = TRUE),
    Médiane = median(Commentaires_reçus, na.rm = TRUE),
    Ecart_type = sd(Commentaires_reçus, na.rm=TRUE))

kable(data_resumecommentairesreçus)

ggplot(data, aes(x = factor(Commentaires_reçus, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Recevez-vous des commentaires ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SCORE OSF
```{r graphique SCORE OSF}
data <- data %>% mutate (SCORE_OSF = Kudos_donnés + Commentaires_donnés + Commentaires_reçus + Publications)

data <- data %>% mutate(scoreOSF_categorystat = case_when(
    SCORE_OSF < 5 ~  "1",
    SCORE_OSF  >=5 & SCORE_OSF <9 ~  "2",
    SCORE_OSF  >=9 & SCORE_OSF <13 ~  "3",
    SCORE_OSF >=13 ~  "4"
  ))

chi2conformitekudosdonnés<-chisq.test(table(data$Kudos_donnés),p=rep(1/length(unique(data$Kudos_donnés)),length(unique(data$Kudos_donnés))))
chi2conformitecommentairesdonnés<-chisq.test(table(data$Commentaires_donnés), p=rep(1/length(unique(data$Commentaires_donnés)),length(unique(data$Commentaires_donnés))))
chi2conformitecommentairesreçus<-chisq.test(table(data$Commentaires_reçus), p=rep(1/length(unique(data$Commentaires_reçus)),length(unique(data$Commentaires_reçus))))
chi2conformitepublications<-chisq.test(table(data$Publications),p=rep(1/length(unique(data$Publications)),length(unique(data$Publications))))

chi2conformitescoreOSF<-chisq.test(table(data$scoreOSF_categorystat), p=rep(1/length(unique(data$scoreOSF_categorystat)),length(unique(data$scoreOSF_categorystat))))


data_resumeOSFround<- data%>%
  summarise(
    median = round(median(SCORE_OSF, na.rm = TRUE),0),
    moyenne= round(mean(SCORE_OSF, na.rm=TRUE),0),
    q1 = round(quantile(SCORE_OSF, 0.25, na.rm=T),0),
    q3 = round(quantile(SCORE_OSF, 0.75, na.rm=T),0)
  )

data_resumeOSF<- data%>%
  summarise(
    Médiane = median(SCORE_OSF, na.rm = TRUE),
    Moyenne= mean(SCORE_OSF, na.rm=TRUE),
    Ecart_type = sd(SCORE_OSF, na.rm=TRUE)
  )

table_OSF <- data.frame(
  Variable = c("Kudos donnés", "Commentaires donnés", 
           "Commentaires reçus", "Publications", "Total"),
  
  Moyenne = c(data_resumekudosdonnés$Moyenne, data_resumecommentairesdonnés$Moyenne, 
              data_resumecommentairesreçus$Moyenne, data_resumepublication$Moyenne, data_resumeOSF$Moyenne),
  
  Médiane = c(data_resumekudosdonnés$Médiane, data_resumecommentairesdonnés$Médiane, 
              data_resumecommentairesreçus$Médiane, data_resumepublication$Médiane, data_resumeOSF$Médiane),
  
  Ecart_type = c(data_resumekudosdonnés$Ecart_type, data_resumecommentairesdonnés$Ecart_type, 
              data_resumecommentairesreçus$Ecart_type, data_resumepublication$Ecart_type, data_resumeOSF$Ecart_type),
    Khi2_ajustement = c(chi2conformitekudosdonnés$statistic, chi2conformitecommentairesdonnés$statistic, 
      chi2conformitecommentairesreçus$statistic, chi2conformitepublications$statistic, chi2conformitescoreOSF$statistic),
  P.value = ifelse(
    c(chi2conformitekudosdonnés$p.value, chi2conformitecommentairesdonnés$p.value, 
      chi2conformitecommentairesreçus$p.value, chi2conformitepublications$p.value, chi2conformitescoreOSF$p.value) < 0.001, "<0.001", ">0.001"
  )
)


kable(table_OSF)

vlinesOSF <- data.frame(
  label = c("Q1", "Médiane", "Q3"),
  xintercept = c(data_resumeOSFround$q1, data_resumeOSFround$median, data_resumeOSFround$q3)
)
vlinesOSF$annotation <- paste(vlinesOSF$label, ":", vlinesOSF$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_OSF), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_OSF, na.rm = TRUE), 
                                max(data$SCORE_OSF, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score OSF au sein de l'échantillon",
       x = "Score OSF", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesOSF, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesOSF, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```

### Compléments{.tabset}

#### Clubs Strava
```{r graphique club strava}
data_resumeclubstrava<- data%>%
  summarise(
    Moyenne = mean(Club_Strava, na.rm = TRUE),
    Médiane = median(Club_Strava, na.rm = TRUE),
    Ecart_type = sd(Club_Strava, na.rm=TRUE)
  )

kable(data_resumeclubstrava)

data_resumeClubStravaround<- data%>%
  summarise(
    moyenne = round(mean(Club_Strava, na.rm = TRUE),0),
    mediane = round(median(Club_Strava, na.rm = TRUE),0),
    q1 = round(quantile(Club_Strava, 0.25, na.rm=T),0),
    q3 = round(quantile(Club_Strava, 0.75, na.rm=T),0),
    ecarttype = round(sd(Club_Strava, na.rm=TRUE),0)
  )

vlinesclubstrava <- data.frame(
  label = c("Q1", "Médiane", "Moyenne", "Q3"),
  xintercept = c(data_resumeClubStravaround$q1, data_resumeClubStravaround$mediane, data_resumeClubStravaround$moyenne, data_resumeClubStravaround$q3)
)
vlinesclubstrava$annotation <- paste(vlinesclubstrava$label, ":", vlinesclubstrava$xintercept)

ggplot(data) +
  geom_histogram(aes(x = Club_Strava), fill = "#FC4C02", binwidth=5, colour="#FC4C02", alpha=0.5) +
  scale_x_continuous(breaks = seq(20, max(data$Club_Strava, na.rm = TRUE), by = 5))+
  labs(title = "Répartition de l'appartenance à des clubs Strava au sein de l'échantillon",
       x = "Nombre de clubs Strava", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesclubstrava, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesclubstrava, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```

#### Nombre de kudos reçus
```{r graphique nb kudos recus}
data_resumenbkudosreçus<- data%>%
  summarise(
    Moyenne = mean(Kudos_reçus, na.rm = TRUE),
    Médiane = median(Kudos_reçus, na.rm = TRUE),
    Ecart_type = sd(Kudos_reçus, na.rm=TRUE)
  )

kable(data_resumenbkudosreçus)

data_resumenbkudosreçusround<- data%>%
  summarise(
    moyenne = round(mean(Kudos_reçus, na.rm = TRUE),0),
    mediane = round(median(Kudos_reçus, na.rm = TRUE),0),
    q1 = round(quantile(Kudos_reçus, 0.25, na.rm=T),0),
    q3 = round(quantile(Kudos_reçus, 0.75, na.rm=T),0),
    ecarttype = round(sd(Kudos_reçus, na.rm=TRUE),0)
  )

vlinesnbkudosreçus <- data.frame(
  label = c("Q1", "Médiane", "Moyenne", "Q3"),
  xintercept = c(data_resumenbkudosreçusround$q1, data_resumenbkudosreçusround$mediane, data_resumenbkudosreçusround$moyenne, data_resumenbkudosreçusround$q3)
)
vlinesnbkudosreçus$annotation <- paste(vlinesnbkudosreçus$label, ":", vlinesnbkudosreçus$xintercept)

ggplot(data) +
  geom_histogram(aes(x = Kudos_reçus), fill = "#FC4C02", binwidth=10, colour="#FC4C02", alpha=0.5) +
  scale_x_continuous(breaks = seq(20, max(data$Club_Strava, na.rm = TRUE), by = 10))+
  labs(title = "Répartition du nombre de kudos reçus par activité publiée au sein de l'échantillon",
       x = "Nombre de kudos reçus sur une activité publiée (en moyenne)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesnbkudosreçus, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesnbkudosreçus, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```


### Mesure de l'exposition{.tabset}
Les questions 25 à 28 (Echelle de Linkert) sont un extrait, une traduction et adaptation du Facebook questionnaire utilisé dans l'étude de Ross^9^. Dans l'étude de Ross, il n'est pas mentionné que ces items mesurent le niveau d'exposition. Dans l'étude présente, une échelle est donc créée pour mesurer le niveau d'exposition sur Strava (EXPOSITION). Il y a donc **10 items** pour cette échelle de mesure adaptée pour identifier à quel point chaque utilisateur expose des informations personnelles sur Strava.

Un score bas indique l'utilisateur partage peu d'informations personnelles avec une restriction de public tandis qu'un score indique l'utilisateur partage beaucoup d'informations personnelles sans restriction de public.

```{r score exposition}
data$Activités <- as.numeric(as.character(data$Activités))
data$Horaires <- as.numeric(as.character(data$Horaires))
data$FC <- as.numeric(as.character(data$FC))
data$Allure <- as.numeric(as.character(data$Allure))
data$Carte <- as.numeric(as.character(data$Carte))
data$Entrainement_publié <- as.numeric(as.character(data$Entrainement_publié))
data$Compétition_publiée <- as.numeric(as.character(data$Compétition_publiée))
data$Nommage_activité <- as.numeric(as.character(data$Nommage_activité))
data$Commentaire_activité <- as.numeric(as.character(data$Commentaire_activité))
data$Photo_activité <- as.numeric(as.character(data$Photo_activité))

data_Expo <- data[, c("Activités", "Horaires", "FC", "Allure", "Carte", "Entrainement_publié", "Compétition_publiée", "Nommage_activité", "Commentaire_activité", "Photo_activité")]
cronbachExpo<-cronbach(data_Expo)

glue ("L'alpha de Cronbach sur les {cronbachExpo$number.of.items} items est de {cronbachExpo$alpha}.")
```
L'alpha de Cronbach est acceptable.

#### Activités
```{r graphique activites}
data_resumeactivités <- data%>%
  summarise(
    Moyenne = mean(Activités, na.rm = TRUE),
    Médiane = median(Activités, na.rm = TRUE),
    Ecart_type = sd(Activités, na.rm=TRUE))

kable(data_resumeactivités)

ggplot(data, aes(x = factor(Activités, levels = c(1, 2, 3), labels = c("Uniquement vous-même", "Uniquement vos abonnés", "Tout le monde")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Qui peut voir les activités ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Horaires
```{r graphique horaires}
data_resumehoraires <- data%>%
  summarise(
    Moyenne = mean(Horaires, na.rm = TRUE),
    Médiane = median(Horaires, na.rm = TRUE),
    Ecart_type = sd(Horaires, na.rm=TRUE))

kable(data_resumehoraires)

ggplot(data, aes(x = factor(Horaires, levels = c(1, 2, 3), labels = c("Uniquement vous-même", "Uniquement vos abonnés", "Tout le monde")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Qui peut voir les horaires de départ des vos activités ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Fréquence cardiaque
```{r graphique FC}
data_resumeFC<- data%>%
  summarise(
    Moyenne = mean(FC, na.rm = TRUE),
    Médiane = median(FC, na.rm = TRUE),
    Ecart_type = sd(FC, na.rm=TRUE))

kable(data_resumeFC)

ggplot(data, aes(x = factor(FC, levels = c(1, 2, 3), labels = c("Uniquement vous-même", "Uniquement vos abonnés", "Tout le monde")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Qui peut voir votre fréquence cardiaque ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### Allure
```{r graphique allure}

data_resumeAllure<- data%>%
  summarise(
    Moyenne = mean(Allure, na.rm = TRUE),
    Médiane = median(Allure, na.rm = TRUE),
    Ecart_type = sd(Allure, na.rm=TRUE))

kable(data_resumeAllure)

ggplot(data, aes(x = factor(Allure, levels = c(1, 2, 3), labels = c("Uniquement vous-même", "Uniquement vos abonnés", "Tout le monde")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Qui peut voir votre allure ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Carte
```{r graphique carte}

data_resumeCarte<- data%>%
  summarise(
    Moyenne = mean(Carte, na.rm = TRUE),
    Médiane = median(Carte, na.rm = TRUE),
    Ecart_type = sd(Carte, na.rm=TRUE))

kable(data_resumeCarte)

ggplot(data, aes(x = factor(Carte, levels = c(1, 2, 3), labels = c("Uniquement vous-même", "Uniquement vos abonnés", "Tout le monde")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Qui peut voir vos points de départ et arrivée de vos activités?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### Publication entraînement
```{r graphique publication entrainement}
data_resumeentrainementpublié<- data%>%
  summarise(
    Moyenne = mean(Entrainement_publié, na.rm = TRUE),
    Médiane = median(Entrainement_publié, na.rm = TRUE),
    Ecart_type = sd(Entrainement_publié, na.rm=TRUE))

kable(data_resumeentrainementpublié)


ggplot(data, aes(x = factor(Entrainement_publié, levels = c(1, 2, 3, 4), labels = c("Quasiment aucun entraînement", "Uniquement certain de vos entraînements", "Quasiment tous vos entraînements", "Tous vos entraînements")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Qui peut voir vos entraînements sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Publication compétition
```{r graphique publication competition}
data_resumecompetitionpubliée<- data%>%
  summarise(
    Moyenne = mean(Compétition_publiée, na.rm = TRUE),
    Médiane = median(Compétition_publiée, na.rm = TRUE),
    Ecart_type = sd(Compétition_publiée, na.rm=TRUE))

kable(data_resumecompetitionpubliée)


ggplot(data, aes(x = factor(Compétition_publiée, levels = c(1, 2, 3, 4), labels = c("Quasiement aucune compétition", "Uniquement certaines de vos compétitions", "Quasiment toutes vos compétitions", "Toutes vos compéititions")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Qui peut voir vos compétitions sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Nommage activité
```{r graphique nommage activite}
data_resumenommageactivité<- data%>%
  summarise(
    Moyenne = mean(Nommage_activité, na.rm = TRUE),
    Médiane = median(Nommage_activité, na.rm = TRUE),
    Ecart_type = sd(Nommage_activité, na.rm=TRUE))

kable(data_resumenommageactivité)


ggplot(data, aes(x = factor(Nommage_activité, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Lorsque vous publiez une activité sur Strava, nommez-vous votre activité ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### Commentaire activité
```{r graphique commentaire activite}
data_resumecommentaireactivité<- data%>%
  summarise(
    Moyenne = mean(Commentaire_activité, na.rm = TRUE),
    Médiane = median(Commentaire_activité, na.rm = TRUE),
    Ecart_type = sd(Commentaire_activité, na.rm=TRUE))

kable(data_resumecommentaireactivité)


ggplot(data, aes(x = factor(Commentaire_activité, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Lorsque vous publiez une activité sur Strava, ajoutez-vous des commentaires ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### Photo activité
```{r graphique photo activite}
data_resumephotoactivité<- data%>%
  summarise(
    Moyenne = mean(Photo_activité, na.rm = TRUE),
    Médiane = median(Photo_activité, na.rm = TRUE),
    Ecart_type = sd(Photo_activité, na.rm=TRUE))

kable(data_resumephotoactivité)


ggplot(data, aes(x = factor(Photo_activité, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Lorsque vous publiez une activité sur Strava, ajoutez-vous des photos ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```


#### SCORE EXPOSITION
```{r graphique SCORE EXPOSITION}
data <- data %>% mutate (SCORE_EXPO = Activités + Horaires + FC + Allure + Carte + Entrainement_publié + Compétition_publiée + Nommage_activité + Commentaire_activité + Photo_activité)

data <- data %>% mutate(scoreExpo_categorystat = case_when(
    SCORE_EXPO < 12 ~  "1",
    SCORE_EXPO  >=12 & SCORE_EXPO <20 ~  "2",
    SCORE_EXPO  >=20 & SCORE_EXPO <35 ~  "3",
    SCORE_EXPO >=35 ~  "4"
  ))

chi2conformiteactivites<-chisq.test(table(data$Activités), p=rep(1/length(unique(data$Activités)),length(unique(data$Activités))))

chi2conformitehoraires<-chisq.test(table(data$Horaires), p=rep(1/length(unique(data$Horaires)),length(unique(data$Horaires))))

chi2conformiteFC<-chisq.test(table(data$FC), p=rep(1/length(unique(data$FC)),length(unique(data$FC))))

chi2conformiteAllure<-chisq.test(table(data$Allure), p=rep(1/length(unique(data$Allure)),length(unique(data$Allure))))

chi2conformiteCarte<-chisq.test(table(data$Carte), p=rep(1/length(unique(data$Carte)),length(unique(data$Carte))))
chi2conformiteEntrainementpublié<-chisq.test(table(data$Entrainement_publié), p=rep(1/length(unique(data$Entrainement_publié)),length(unique(data$Entrainement_publié))))
chi2conformiteCompetitionpubliée<-chisq.test(table(data$Compétition_publiée), p=rep(1/length(unique(data$Compétition_publiée)),length(unique(data$Compétition_publiée))))

chi2conformiteNommageactivité <- chisq.test(table(data$Nommage_activité), 
p = rep(1/length(table(data$Nommage_activité)),                               length(table(data$Nommage_activité))))


chi2conformiteCommentaireactivité<-chisq.test(table(data$Commentaire_activité), p=rep(1/length(table(data$Commentaire_activité)),length(table(data$Commentaire_activité))))

chi2conformitePhotoactivité<-chisq.test(table(data$Photo_activité), p=rep(1/length(table(data$Photo_activité)),length(table(data$Photo_activité))))

chi2conformiteSCOREEXPO <- chisq.test(table(na.omit(data$scoreExpo_categorystat)),  p=rep(1/length(table(data$scoreExpo_categorystat)),length(table(data$scoreExpo_categorystat))))


data_resumeEXPOround<- data%>%
  summarise(
    median = round(median(SCORE_EXPO, na.rm = TRUE),0),
    moyenne= round(mean(SCORE_EXPO, na.rm=TRUE),0),
    q1 = round(quantile(SCORE_EXPO, 0.25, na.rm=T),0),
    q3 = round(quantile(SCORE_EXPO, 0.75, na.rm=T),0)
  )

data_resumeEXPO<- data%>%
  summarise(
    Médiane = median(SCORE_EXPO, na.rm = TRUE),
    Moyenne= mean(SCORE_EXPO, na.rm=TRUE),
    Ecart_type = sd(SCORE_EXPO, na.rm=TRUE)
  )

table_EXPO <- data.frame(
  Variable = c("Activités", "Horaires", "Fréquence cardiaque", "Allure", "Départ et arrivée", "Entraînement", "Compétition", "Nommage activité", "Commentaire activité", "Photo activité", "Total"),
  
  Moyenne = c(data_resumeactivités$Moyenne, data_resumehoraires$Moyenne, data_resumeFC$Moyenne, data_resumeAllure$Moyenne, data_resumeCarte$Moyenne, data_resumeentrainementpublié$Moyenne, data_resumecompetitionpubliée$Moyenne, data_resumenommageactivité$Moyenne, data_resumecommentaireactivité$Moyenne, data_resumephotoactivité$Moyenne, data_resumeEXPO$Moyenne),
  
  Médiane = c(data_resumeactivités$Médiane, data_resumehoraires$Médiane, data_resumeFC$Médiane, data_resumeAllure$Médiane, data_resumeCarte$Médiane, data_resumeentrainementpublié$Médiane, data_resumecompetitionpubliée$Médiane, data_resumenommageactivité$Médiane, data_resumecommentaireactivité$Médiane, data_resumephotoactivité$Médiane, data_resumeEXPO$Médiane),
  
  Ecart_type = c(data_resumeactivités$Ecart_type, data_resumehoraires$Ecart_type, data_resumeFC$Ecart_type, data_resumeAllure$Ecart_type, data_resumeCarte$Ecart_type, data_resumeentrainementpublié$Ecart_type, data_resumecompetitionpubliée$Ecart_type, data_resumenommageactivité$Ecart_type, data_resumecommentaireactivité$Ecart_type, data_resumephotoactivité$Ecart_type, data_resumeEXPO$Ecart_type),
  
    Khi2_ajustement = c(chi2conformiteactivites$statistic, chi2conformitehoraires$statistic, chi2conformiteFC$statistic, chi2conformiteAllure$statistic, chi2conformiteCarte$statistic, chi2conformiteEntrainementpublié$statistic, chi2conformiteCompetitionpubliée$statistic, chi2conformiteNommageactivité$statistic, chi2conformiteCommentaireactivité$statistic, chi2conformitePhotoactivité$statistic, chi2conformiteSCOREEXPO$statistic ),
  
  P.value = ifelse(
    c(chi2conformiteactivites$p.value, chi2conformitehoraires$p.value, chi2conformiteFC$p.value, chi2conformiteAllure$p.value, chi2conformiteCarte$p.value, chi2conformiteEntrainementpublié$p.value, chi2conformiteCompetitionpubliée$p.value, chi2conformiteNommageactivité$p.value, chi2conformiteCommentaireactivité$p.value, chi2conformitePhotoactivité$p.value, chi2conformiteSCOREEXPO$p.value ) < 0.001, "<0.001", ">0.001"
  )
)

kable(table_EXPO)

vlinesEXPO <- data.frame(
  label = c("Q1", "Médiane", "Q3"),
  xintercept = c(data_resumeEXPOround$q1, data_resumeEXPOround$median, data_resumeEXPOround$q3)
)
vlinesEXPO$annotation <- paste(vlinesEXPO$label, ":", vlinesEXPO$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_EXPO), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_EXPO, na.rm = TRUE), 
                                max(data$SCORE_EXPO, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score d'EXPOSITION sur Strava au sein de l'échantillon",
       x = "Score EXPO", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesEXPO, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesEXPO, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```





### Autres mesures{.tabset}

#### Catégorie d'abonnement
```{r graphique categorie abonnement}
ggplot(data, aes(x = factor(Type_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")))) +
  geom_bar(aes(fill = factor(Type_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")), alpha=0.5)) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Répartition des catégories d'abonnement sur Strava au sein de l'échantillon",
       x = "Catégorie d'abonnement", y = "Nombre d'individus", fill="Type d'abonnement") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Ancienneté sur Strava
```{r graphique anciennete strava}
data$Ancienneté_Strava <- as.numeric(as.character(data$Ancienneté_Strava))

data_resumeanciennetestrava<- data%>%
  summarise(
    Moyenne = mean(Ancienneté_Strava, na.rm = TRUE),
    Médiane = median(Ancienneté_Strava, na.rm = TRUE),
    Ecart_type = sd(Ancienneté_Strava, na.rm=TRUE))

kable(data_resumeanciennetestrava)

data_resumeanciennetestravaround<- data%>%
  summarise(
    moyenne = round(mean(Ancienneté_Strava, na.rm = TRUE),0),
    median = round(median(Ancienneté_Strava, na.rm = TRUE),0),
    q1 = round(quantile(Ancienneté_Strava, 0.25, na.rm=T),0),
    q3 = round(quantile(Ancienneté_Strava, 0.75, na.rm=T),0)
  )

vlinesanciennetestrava <- data.frame(
  label = c("Q1", "Médiane", "Q3"),
  xintercept = c(data_resumeanciennetestravaround$q1, data_resumeanciennetestravaround$median, data_resumeanciennetestravaround$q3)
)
vlinesanciennetestrava$annotation <- paste(vlinesanciennetestrava$label, ":", vlinesanciennetestrava$xintercept)

ggplot(data) +
  geom_histogram(aes(x = Ancienneté_Strava), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$Ancienneté_Strava, na.rm = TRUE), 
                                max(data$Ancienneté_Strava, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition de l'ancienneté sur Strava au sein de l'échantillon",
       x = "Ancienneté sur Strava (en années)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesanciennetestrava, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesanciennetestrava, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```


#### Buts utilisation Strava

```{r graphique but strava}
labels_comptagebutstrava <- c(
  "1" = "Suivi de la performance",
  "2" = "Motivation personnelle",
  "3" = "Interaction sociale",
  "4" = "Comparaison avec d'autres coureurs",
  "5" = "Partage de vos activités",
  "6" = "Enregistrement de vos activités",
  "7" = "Suivi de progrès",
  "8" = "Idée de parcours",
  "9" = "Côté ludique (segment, classements, KOM/QOM…)",  # Espace enlevé avant "Côté"
  "10" = "Appartenance à une communauté",
  "11" = "Encouragements (kudos)",
  "12" = "Atteinte d'objectifs personnels",
  "13" = "Autre"
)

comptage_but_strava <- data %>%
  separate_rows(But_strava, sep = ",") %>% 
  mutate(But_strava = labels_comptagebutstrava[But_strava]) %>% 
  count(But_strava) %>%
  arrange(desc(n))

ggplot(comptage_but_strava, aes(x = reorder(But_strava, -n), y = n)) +
  geom_col(fill = "#FC4C02", alpha = 0.5) +
  labs(
    x = "Dans quel(s) but(s) utilisez-vous Strava ? (plusieurs réponses possibles)",
    y = "Nombre d'occurrences",
    title = ""
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

```

#### Fonctionnalité la plus utile dans la pratique
```{r graphique fonctionnalite strava}
labels_comptagefonctionnalitétrava <- c(
  "1" = "Enregistrement de vos activités",
  "2" = "Suivi GPS",
  "3" = "Analyse des performances",
  "4" = "Segments",
  "5" = "Classements",
  "6" = "Challenges",
  "7" = "Clubs",
  "8" = "Planification d'itinéraire",
  "9" = "Evènements",
  "10" = "Heatmap (endroit où vous vous êtes le plus entraîné)",
  "11" = "Interactions sociales",
  "12" = "Kudos",
  "13" = "Suivi des progrès",
  "14" = "Autre"

)

comptage_fonctionnalite_strava <- data %>%
  separate_rows(Fonctionnalité_strava, sep = ",") %>% 
  mutate(Fonctionnalité_strava = labels_comptagefonctionnalitétrava[Fonctionnalité_strava]) %>% 
  count(Fonctionnalité_strava) %>%
  arrange(desc(n))

ggplot(comptage_fonctionnalite_strava, aes(x = reorder(Fonctionnalité_strava, -n), y = n)) +
  geom_col(fill = "#FC4C02", alpha = 0.5) +
  labs(
    x = "Quelle(s) fonctionnalité(s) de Strava trouvez-vous le(s) plus utile(s) dans votre pratique ?",
    y = "Nombre d'occurrences",
    title = "",
    subtitle = ""
  ) +
  theme_minimal() +
  theme(legend.text = element_text(size = 8))+
  theme(axis.text.x = element_text(angle = 55, hjust = 1))

```

#### Restriction abonnés
```{r graphique restriction abonnes}
ggplot(data, aes(x = factor(Restriction_abonnés, levels = c(1, 2), labels = c("Uniquement les utilisateurs que j'accepte", "Tout le monde")))) +
  geom_bar(aes(fill = factor(Restriction_abonnés, levels = c(1, 2), labels = c("Uniquement les utilisateurs que j'accepte", "Tout le monde")), alpha=0.5)) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Qui peut s’abonner à votre compte Strava ?", y = "Nombre d'individus", fill="") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Désabonnement
```{r graphique desabonnement}
ggplot(data, aes(x = factor(Désabonnement, levels = c(1, 2), labels = c("Oui", "Non")))) +
  geom_bar(aes(fill = factor(Désabonnement, levels = c(1, 2), labels = c("Oui", "Non")), alpha=0.5)) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Vous êtes-vous déjà désabonné d’un compte d'un autre utilisateur ?", y = "Nombre d'individus", fill="") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Blocage
```{r graphique blocage}
ggplot(data, aes(x = factor(Blocage, levels = c(1, 2), labels = c("Oui", "Non")))) +
  geom_bar(aes(fill = factor(Blocage, levels = c(1, 2), labels = c("Oui", "Non")), alpha=0.5)) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Avez-vous déjà bloqué l’accès à votre compte à un autre utilisateur ?", y = "Nombre d'individus", fill="") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()


nbblocage<-nrow(data %>% filter (data$Blocage == "1"))
glue("Le nombre d'individus considérés {nbblocage}.")

ggplot(subset(data, Raisons_blocage != "NA"), 
       aes(x = factor(Raisons_blocage, levels = c(1, 2, 3), 
                      labels = c("Pour éviter de communiquer avec cet utilisateur", 
                                 "Pour éviter le harcèlement", 
                                 "Autre")))) +
  geom_bar(aes(fill = factor(Raisons_blocage, levels = c(1, 2, 3), 
                             labels = c("Pour éviter de communiquer avec cet utilisateur",                                         "Pour éviter le harcèlement", 
                                        "Autre"))), alpha = 0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "", x = "Raisons du blocage", y = "Nombre d'individus", fill = "") +
  theme_minimal() +
  theme(legend.position = "none")

```

#### Type d'abonnés
```{r graphique type abonnes}
labels_comptagetypeabonnés <- c(
  "1" = "Des amis",
  "2" = "Des connaissances",
  "3" = "Des membres de votre famille",
  "4" =" Des collègues de travail",
  "5" = "Des influenceurs",
  "6" = "Des athlètes professionnels",
  "7" = "Autre"
)

comptage_typeabonnés <- data %>%
  separate_rows(Type_abonnés, sep = ",") %>% 
  mutate(Type_abonnés = labels_comptagetypeabonnés[Type_abonnés]) %>% 
  count(Type_abonnés) %>%
  arrange(desc(n))

ggplot(comptage_typeabonnés, aes(x = reorder(Type_abonnés, -n), y = n)) +
  geom_col(fill = "#FC4C02", alpha = 0.5) +
  labs(
    x = "Parmi vos abonnés, vous avez : (plusieurs réponses possibles) ",
    y = "Nombre d'occurrences",
    title = "Répartition des types d'abonnés au sein de l'échantillon"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


#### Type d'abonnements
```{r graphique type abonnements}
labels_comptagetypeabonnements <- c(
  "1" = "Des amis",
  "2" = "Des connaissances",
  "3" = "Des membres de votre famille",
  "4" =" Des collègues de travail",
  "5" = "Des influenceurs",
  "6" = "Des athlètes professionnels",
  "7" = "Autre"
)

comptage_typeabonnements <- data %>%
  separate_rows(Type_abonnements, sep = ",") %>% 
  mutate(Type_abonnements = labels_comptagetypeabonnements[Type_abonnements]) %>% 
  count(Type_abonnements) %>%
  arrange(desc(n))

ggplot(comptage_typeabonnements, aes(x = reorder(Type_abonnements, -n), y = n)) +
  geom_col(fill = "#FC4C02", alpha = 0.5) +
  labs(
    x = "Parmi vos abonnements, vous avez : (plusieurs réponses possibles) ",
    y = "Nombre d'occurrences",
    title = "Répartition des types d'abonnements au sein de l'échantillon"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

# Lien données socio-démographiques et utilisation de Strava

### Age - Strava{.tabset}

La question est de savoir ici s'il existe des liens entre l'âge et l'utilisation de Strava. Il y a une faible corrélation entre l’âge et :

- Score SIS (-0.11)
- Fréquence publication (-0.12)
- Fréquence consultation (-0.18)
- Ancienneté Strava (0.24)

Il n'est pas possible de rejeter H0 pour le lien entre l'âge et la catégorie d’abonnement (gratuit/payant).

#### Corrélations

```{r correlation Strava Age}
### SIS – Age
cor_SIS_Age <- round(cor(data$SCORE_SIS_TOTAL, data$Age, use="complete.obs"),2)
cor_SIS_Ageh <- round(cor(subset(data, Sexe == "1")$SCORE_SIS_TOTAL, subset(data, Sexe == "1")$Age, use="complete.obs"),2)
cor_SIS_Agef <- round(cor(subset(data, Sexe == "2")$SCORE_SIS_TOTAL, subset(data, Sexe == "2")$Age, use="complete.obs"),2)

#### Expo – Age
cor_EXPO_Age <- round(cor(data$SCORE_EXPO, data$Age, use="complete.obs"),2)
cor_EXPO_Ageh <- round(cor(subset(data, Sexe == "1")$SCORE_EXPO, subset(data, Sexe == "1")$Age, use="complete.obs"),2)
cor_EXPO_Agef <- round(cor(subset(data, Sexe == "2")$SCORE_EXPO, subset(data, Sexe == "2")$Age, use="complete.obs"),2)

#### OSF – Age
cor_OSF_Age <- round(cor(data$SCORE_OSF, data$Age, use="complete.obs"),2)
cor_OSF_Ageh<- round(cor(subset(data, Sexe == "1")$SCORE_OSF, subset(data, Sexe == "1")$Age, use="complete.obs"),2)
cor_OSF_Agef <- round(cor(subset(data, Sexe == "2")$SCORE_OSF, subset(data, Sexe == "2")$Age, use="complete.obs"),2)

#### Club Strava- Age
cor_clubstrava_Age <- round(cor(data$Club_Strava, data$Age, use="complete.obs"),2)
cor_clubstrava_Ageh<- round(cor(subset(data, Sexe == "1")$Club_Strava, subset(data, Sexe == "1")$Age, use="complete.obs"),2)
cor_clubstrava_Agef <- round(cor(subset(data, Sexe == "2")$Club_Strava, subset(data, Sexe == "2")$Age, use="complete.obs"),2)

#### Kudos reçus – Age
cor_kudos_Age <- round(cor(data$Kudos_reçus, data$Age, use="complete.obs"),2)
cor_kudos_Ageh<- round(cor(subset(data, Sexe == "1")$ Kudos_reçus , subset(data, Sexe == "1")$Age, use="complete.obs"),2)
cor_kudos_Agef <- round(cor(subset(data, Sexe == "2")$Kudos_reçus, subset(data, Sexe == "2")$Age, use="complete.obs"),2)

#### Freq publication– Age
cor_freqpubli_Age <- round(cor(data$Fréquence_publication, data$Age, use="complete.obs"),2)
cor_freqpubli_Ageh<- round(cor(subset(data, Sexe == "1")$Fréquence_publication, subset(data, Sexe == "1")$Age, use="complete.obs"),2)
cor_freqpubli_Agef <- round(cor(subset(data, Sexe == "2")$Fréquence_publication, subset(data, Sexe == "2")$Age, use="complete.obs"),2)

#### Freq consultations– Age
cor_freqcons_Age <- round(cor(data$Fréquence_consultation, data$Age, use="complete.obs"),2)
cor_freqcons_Ageh<- round(cor(subset(data, Sexe == "1")$Fréquence_consultation, subset(data, Sexe == "1")$Age, use="complete.obs"),2)
cor_freqcons_Agef <- round(cor(subset(data, Sexe == "2")$Fréquence_consultation, subset(data, Sexe == "2")$Age, use="complete.obs"),2)

#### Nb abonnements– Age
cor_nbabonnements_Age <- round(cor(data$Nb_abonnements, data$Age, use="complete.obs"),2)
cor_nbabonnements_Ageh<- round(cor(subset(data, Sexe == "1")$Nb_abonnements, subset(data, Sexe == "1")$Age, use="complete.obs"),2)
cor_nbabonnements_Agef <- round(cor(subset(data, Sexe == "2")$Nb_abonnements, subset(data, Sexe == "2")$Age, use="complete.obs"),2)

#### Nb abonnés– Age
cor_nbabonnés_Age <- round(cor(data$Nb_abonnés, data$Age, use="complete.obs"),2)
cor_nbabonnés_Ageh<- round(cor(subset(data, Sexe == "1")$ Nb_abonnés, subset(data, Sexe == "1")$Age, use="complete.obs"),2)
cor_nbabonnés_Agef <- round(cor(subset(data, Sexe == "2")$ Nb_abonnés, subset(data, Sexe == "2")$Age, use="complete.obs"),2)

#### Nb abonnés– Age
cor_nbabonnés_Age<- round(cor(data$Nb_abonnés, data$Age, use="complete.obs"),2)
cor_nbabonnés_Ageh<- round(cor(subset(data, Sexe == "1")$ Nb_abonnés, subset(data, Sexe == "1")$Age, use="complete.obs"),2)
cor_nbabonnés_Agef <- round(cor(subset(data, Sexe == "2")$ Nb_abonnés, subset(data, Sexe == "2")$Age, use="complete.obs"),2)


#### Ancienneté Strava - Age
cor_anciennetestrava_Age<- round(cor(data$ Ancienneté_Strava, data$Age, use="complete.obs"),2)
cor_anciennetestrava_Ageh<- round(cor(subset(data, Sexe == "1")$ Ancienneté_Strava, subset(data, Sexe == "1")$Age, use="complete.obs"),2)
cor_anciennetestrava_Agef <- round(cor(subset(data, Sexe == "2")$ Ancienneté_Strava, subset(data, Sexe == "2")$Age, use="complete.obs"),2)
```

```{r affichage table age strava}
table_Age_Strava_Correlations <- data.frame(
  Variable = c("SCORE SIS ", "SCORE OSF ", "SCORE EXPO ", "Clubs Strava ", "Kudos reçus ", "Fréquence publication ", "Fréquence consultation ", "Nombre d'abonnés ", "Nombre d'abonnements ", "Ancienneté Strava "),
  Age = c(cor_SIS_Age, cor_OSF_Age, cor_EXPO_Age, cor_clubstrava_Age, cor_kudos_Age, cor_freqpubli_Age, cor_freqcons_Age, cor_nbabonnés_Age, cor_nbabonnements_Age, cor_anciennetestrava_Age))

table_Age_Strava_Correlations$Age <- case_when(
  table_Age_Strava_Correlations$Age > 0.4 ~ 
    paste0('<span style="color:green;">', table_Age_Strava_Correlations$Age, '</span>'),
  table_Age_Strava_Correlations$Age > 0.3 ~ 
    paste0('<span style="color:#FC4C02;">', table_Age_Strava_Correlations$Age, '</span>'),
  table_Age_Strava_Correlations$Age > 0.2 ~ 
    paste0('<span style="color:red;">', table_Age_Strava_Correlations$Age, '</span>'),
  TRUE ~ as.character(table_Age_Strava_Correlations$Age)
)

kable(table_Age_Strava_Correlations, format = "html", escape = FALSE)

```

#### Visualisation graphique{.tabset}

##### SCORE SIS
```{r visualisation correlation age - strava}
ggplot(data, aes(x = Age, y = SCORE_SIS_TOTAL, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_SIS_Age)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_SIS_Ageh)), 
                color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_SIS_Agef)), 
                color = "#4F4F4F") +
    scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F")) +
    labs(title = "",
         x = "Age (en années)",
         y = "SCORE SIS",
         color = "Sexe",
         linetype = "Régression linéaire") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"), color = guide_legend(title = "Sexe")) 
```   

##### Fréquence consultation
```{r freq cons age}
   ggplot(data, aes(x = Age, y = Fréquence_consultation, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_freqcons_Age)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_freqcons_Ageh)), 
                color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_freqcons_Agef)), 
                color = "#4F4F4F") +
    scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F")) +
    labs(title = "",
         x = "Age (en années)",
         y = "Fréquence consultation",
         color = "Sexe",
         linetype = "Régression linéaire") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"), color = guide_legend(title = "Sexe"))
```

##### Fréquence publication
```{r freq publi age}
    ggplot(data, aes(x = Age, y = Fréquence_publication, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_freqpubli_Age)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_freqpubli_Ageh)), 
                color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_freqpubli_Agef)), 
                color = "#4F4F4F") +
    scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F")) +
    labs(title = "",
         x = "Age (en années)",
         y = "Fréquence publication",
         color = "Sexe",
         linetype = "Régression linéaire") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"), color = guide_legend(title = "Sexe"))
```

##### Ancienneté Strava
```{r ancienneté strava age}
        ggplot(data, aes(x = Age, y = Ancienneté_Strava, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_anciennetestrava_Age)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_anciennetestrava_Ageh)), 
                color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_anciennetestrava_Agef)), 
                color = "#4F4F4F") +
    scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F")) +
    labs(title = "",
         x = "Age (en années)",
         y = "Fréquence publication",
         color = "Sexe",
         linetype = "Régression linéaire") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"), color = guide_legend(title = "Sexe"))
   
```


#### Test t de Student
```{r test t student pour strava et age}
t_typeabonnement_age <- t.test(as.numeric(Age) ~ as.factor(Type_abonnement), data = data, var.equal = TRUE)

moyenneage_typeabonnement <- data %>%
    group_by(Type_abonnement) %>%
    summarise(Moyenne = mean(Age, na.rm = TRUE))

table_typeabonnement_age <- data.frame(
    Variable = c(
        "Lien catégorie d'abonnement et age"),
    Student = c(
        as.numeric(t_typeabonnement_age$statistic)),
    p_value = c(
        ifelse(t_typeabonnement_age$p.value < 0.001, "<0.001", "sup. 0.001")),
    Gratuit = c(
        moyenneage_typeabonnement$Moyenne[1]),
    Payant = c(
        moyenneage_typeabonnement$Moyenne[2])
)

kable(table_typeabonnement_age, format = "html", escape = FALSE)

```

### Sexe - Strava{.tabset}

La question est de savoir ici s'il existe des liens entre le sexe et l'utilisation de Strava. 

Les moyennes sont significativement différentes entre hommes et femmes (p < 0.05) pour :

- Score EXPO (H : 26,3 / F: 24,9)
- Kudos reçus (H : 17,7 / F: 13,9)
- Fréquence publication (H : 4,3 / F: 3,7)
- Nombre abonnés (H : 82,7 / F: 52)
- Nombre abonnements (H : 81,3 / F: 53,4)
- Ancienneté Strava (H : 5,3 / F: 4,4)

Il est possible de rejeter H0 (p < 0.001) pour la dépendance entre le sexe et la catégorie d’abonnement. Il y a une faible dépendance (0,22) : les femmes choisissent plus l’abonnement gratuit.

#### Test t de Student
```{r test t student pour strava et sexe}
t_SIS_sexe <- t.test(as.numeric(SCORE_SIS_TOTAL) ~ as.factor(Sexe), data = data, var.equal = TRUE)

moyenneSIS_sexe <- data %>%
    group_by(Sexe) %>%
    summarise(Moyenne = mean(SCORE_SIS_TOTAL, na.rm = TRUE))

t_OSF_sexe <- t.test(as.numeric(SCORE_OSF) ~ as.factor(Sexe), data = data, var.equal = TRUE)

moyenneOSF_sexe <- data %>%
    group_by(Sexe) %>%
    summarise(Moyenne = mean(SCORE_OSF, na.rm = TRUE))

t_EXPO_sexe <- t.test(as.numeric(SCORE_EXPO) ~ as.factor(Sexe), data = data, var.equal = TRUE)

moyenneEXPO_sexe <- data %>%
    group_by(Sexe) %>%
    summarise(Moyenne = mean(SCORE_EXPO, na.rm = TRUE))

t_clubstrava_sexe <- t.test(as.numeric(Club_Strava) ~ as.factor(Sexe), data = data, var.equal = TRUE)

moyenneclubstrava_sexe <- data %>%
    group_by(Sexe) %>%
    summarise(Moyenne = mean(Club_Strava, na.rm = TRUE))

t_kudos_sexe <- t.test(as.numeric(Kudos_reçus) ~ as.factor(Sexe), data = data, var.equal = TRUE)

moyennekudos_sexe <- data %>%
    group_by(Sexe) %>%
    summarise(Moyenne = mean(Kudos_reçus, na.rm = TRUE))

t_freqpubli_sexe <- t.test(as.numeric(Fréquence_publication) ~ as.factor(Sexe), data = data, var.equal = TRUE)

moyennefreqpubli_sexe <- data %>%
    group_by(Sexe) %>%
    summarise(Moyenne = mean(Fréquence_publication, na.rm = TRUE))

t_freqconsult_sexe <- t.test(as.numeric(Fréquence_consultation) ~ as.factor(Sexe), data = data, var.equal = TRUE)

moyennefreqconsult_sexe <- data %>%
    group_by(Sexe) %>%
    summarise(Moyenne = mean(Fréquence_consultation, na.rm = TRUE))

t_nbabonnes_sexe <- t.test(as.numeric(Nb_abonnés) ~ as.factor(Sexe), data = data, var.equal = TRUE)

moyennenbabonnes_sexe <- data %>%
    group_by(Sexe) %>%
    summarise(Moyenne = mean(Nb_abonnés, na.rm = TRUE))

t_nbabonnements_sexe <- t.test(as.numeric(Nb_abonnements) ~ as.factor(Sexe), data = data, var.equal = TRUE)

moyennenbabonnements_sexe <- data %>%
    group_by(Sexe) %>%
    summarise(Moyenne = mean(Nb_abonnements, na.rm = TRUE))

t_anciennetestrava_sexe <- t.test(as.numeric(Ancienneté_Strava) ~ as.factor(Sexe), data = data, var.equal = TRUE)

moyenneanciennetestrava_sexe <- data %>%
    group_by(Sexe) %>%
    summarise(Moyenne = mean(Ancienneté_Strava, na.rm = TRUE))

table_strava_sexe <- data.frame(
    Variable = c(
        "SCORE SIS", "SCORE OSF", "SCORE EXPO", "Clubs Strava", "Kudos reçus", "Fréquence publication", "Fréquence consultation", "Nombre abonnés", "Nombre abonnements", "Ancienneté Strava"),
    Student = c(
        as.numeric(t_SIS_sexe$statistic, t_OSF_sexe$statistic, t_EXPO_sexe$statistic, t_clubstrava_sexe$statistic, t_kudos_sexe$statistic, t_freqpubli_sexe$statistic, t_freqconsult_sexe$statistic, t_nbabonnes_sexe$statistic, t_nbabonnements_sexe$statistic, t_anciennetestrava_sexe$statistic)),
    p_value = ifelse(c(t_SIS_sexe$p.value, t_OSF_sexe$p.value, t_EXPO_sexe$p.value, t_clubstrava_sexe$p.value, t_kudos_sexe$p.value, t_freqpubli_sexe$p.value, t_freqconsult_sexe$p.value, t_nbabonnes_sexe$p.value, t_nbabonnements_sexe$p.value, t_anciennetestrava_sexe$p.value) < 0.001, "<0.001", "sup. 0.001"),
    Homme = c(
        moyenneSIS_sexe$Moyenne[1], moyenneOSF_sexe$Moyenne[1], moyenneEXPO_sexe$Moyenne[1], moyenneclubstrava_sexe$Moyenne[1], moyennekudos_sexe$Moyenne[1], moyennefreqpubli_sexe$Moyenne[1], moyennefreqconsult_sexe$Moyenne[1], moyennenbabonnes_sexe$Moyenne[1], moyennenbabonnements_sexe$Moyenne[1], moyenneanciennetestrava_sexe$Moyenne[1]),
    Femme = c(
        moyenneSIS_sexe$Moyenne[2], moyenneOSF_sexe$Moyenne[2], moyenneEXPO_sexe$Moyenne[2], moyenneclubstrava_sexe$Moyenne[2], moyennekudos_sexe$Moyenne[2], moyennefreqpubli_sexe$Moyenne[2], moyennefreqconsult_sexe$Moyenne[2], moyennenbabonnes_sexe$Moyenne[2], moyennenbabonnements_sexe$Moyenne[2], moyenneanciennetestrava_sexe$Moyenne[2])
)

kable(table_strava_sexe, format = "html", escape = FALSE)

```

#### Visualisation graphique
```{r}
(ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = SCORE_EXPO,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Sexe",
       y = "SCORE EXPO",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() | 
   
   ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Kudos_reçus,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Sexe",
       y = "Kudos reçus en moyenne par activité",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
   )


(ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Fréquence_publication,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Sexe",
       y = "Fréquence publication",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() | 
   
   ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Nb_abonnés,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Sexe",
       y = "Nombre abonnés",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
   )

(ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Nb_abonnements,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Sexe",
       y = "Nombre abonnements",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() | 
   
   ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Ancienneté_Strava,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Sexe",
       y = "Ancienneté Strava",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
   )

```



#### Khi² et Cramer

```{r abonnement et sexe}
### Lien type abonnement et sexe
chi2_typeabonnement_sexe <-chisq.test (table(data$Type_abonnement, data$Sexe))
cramer_typeabonnement_sexe<- assocstats(table(data$Type_abonnement, data$Sexe))


table_typeabonnement_sexe <- data.frame(
  Variable = c("Lien catégorie d'abonnement et sexe"),
  Khi2_indépendance = as.numeric(round(c(chi2_typeabonnement_sexe$statistic),2)),
  P.value = ifelse(c(chi2_typeabonnement_sexe$p.value) < 0.001, "< 0.001", " sup. 0.001"),
  Coefficient_Cramer = round(c(cramer_typeabonnement_sexe$cramer),2)
)

kable(table_typeabonnement_sexe, format = "html", escape = FALSE)
```

#### Visualisation graphique
```{r heatmap categorie abonnement et sexe}

table_comparaison_typeabonnement_sexe <- data.frame(
  Type_abonnement = rep(rownames(chi2_typeabonnement_sexe$observed), times = ncol(chi2_typeabonnement_sexe$observed)),
  Sexe = rep(colnames(chi2_typeabonnement_sexe$observed), each = nrow(chi2_typeabonnement_sexe$observed)),
  Observé = as.vector(chi2_typeabonnement_sexe$observed),
  Attendu = as.vector(chi2_typeabonnement_sexe$expected)
)

table_comparaison_typeabonnement_sexe$Type_abonnement <- factor(
  table_comparaison_typeabonnement_sexe$Type_abonnement, 
  levels = c("1", "2"),  # Remplace "1" et "2" par leurs vraies valeurs si besoin
  labels = c("Gratuit", "Payant")
)

table_comparaison_typeabonnement_sexe$Sexe <- factor(
  table_comparaison_typeabonnement_sexe$Sexe, 
  levels = c("1", "2"),  # Remplace "1" et "2" par leurs vraies valeurs si besoin
  labels = c("Femme", "Homme")
)

kable(table_comparaison_typeabonnement_sexe)

heatmap_categorieabonnement_sexe <- data %>%
    filter(!is.na(Type_abonnement), !is.na(Sexe)) %>%
    group_by(Type_abonnement, Sexe) %>%
    summarise(n = n(), .groups = "drop")

heatmap_categorieabonnement_sexe <- heatmap_categorieabonnement_sexe %>%
    mutate(Sexe = recode_factor(Sexe, `1` = "Homme", `2` = "Femme"),
           Type_abonnement = recode_factor(Type_abonnement, `1` = "Gratuit", `2` = "Payant"))

ggplot(heatmap_categorieabonnement_sexe, aes(x = Sexe, y = Type_abonnement, fill = n)) +
    geom_tile(color = "#eff4f9") +
    scale_fill_gradient(low = "#eff4f9", high = "#FC4C02") +
    geom_text(aes(label = sprintf("%.1f%%", (n / sum(n)) * 100)), color = "black")+
    labs(title = "",
         x = "Sexe", 
         y = "Catégorie abonnement",
         fill = "Nombre de personnes") +
    theme_minimal() +
  scale_y_discrete()+
    theme(axis.text.x = element_text(angle = 45, hjust = 1))


```



### Catégorie socio-professionnelle - Strava{.tabset}

La question est de savoir ici s’il existe des liens entre la catégorie socio-professionnelle et l’utilisation de Strava.

Les moyennes sont significativement différentes entre CSP (p < 0.05) :

- Score SIS
- SCORE OSF
- SCORE EXPO
- Club Strava
- Kudos reçus
- Fréquence publication
- Fréquence consultation
- Nombre d’abonnés 
- Nombre d’abonnements
- Ancienneté Strava

Les étudiants (8) ont des moyennes significativement plus élevées que les artisans (2) et professions intermédiaires (4) et pour les scores SIS, OSF et EXPO, de même pour les ouvriers (6) par rapport aux professions intermédiaires. 

Les étudiants (8) ont des moyennes significativement plus élevées que les artisans (2), les cadres (3), les professions intermédiaires (4), les employés (5) et les retraités (7) pour la fréquence de consultation. 

Les étudiants (8) ont des moyennes significativement plus faibles que les artisans (2), les cadres (3) et les retraités (7) pour l’ancienneté sur Strava. 


Il n'est pas possible de rejeter H0 pour le lien entre la catégorie socio-professionnelle et la catégorie d’abonnement (gratuit/payant).

#### ANOVA
```{r}
anova_sis_cat <- summary(aov(SCORE_SIS_TOTAL ~ as.factor(Catégorie), data = data))
anova_osf_cat <- summary(aov(SCORE_OSF ~ as.factor(Catégorie), data = data))
anova_expo_cat <- summary(aov(SCORE_EXPO ~ as.factor(Catégorie), data = data))
anova_club_cat <- summary(aov(Club_Strava ~ as.factor(Catégorie), data = data))
anova_kudos_cat <- summary(aov(Kudos_reçus ~ as.factor(Catégorie), data = data))
anova_freqpubli_cat <- summary(aov(Fréquence_publication ~ as.factor(Catégorie), data = data))
anova_freqcons_cat <- summary(aov(Fréquence_consultation ~ as.factor(Catégorie), data = data))
anova_nbabonnés_cat <- summary(aov(Nb_abonnés ~ as.factor(Catégorie), data = data))
anova_nbabonnements_cat <- summary(aov(Nb_abonnements ~ as.factor(Catégorie), data = data))
anova_anciennetestrava_cat <- summary(aov(Ancienneté_Strava ~ as.factor(Catégorie), data = data))


moyenne_sis_cat <- data %>%
    group_by(Catégorie) %>%
    summarise(Moyenne = mean(SCORE_SIS_TOTAL, na.rm = TRUE))

moyenne_osf_cat <- data %>%
    group_by(Catégorie) %>%
    summarise(Moyenne = mean(SCORE_OSF, na.rm = TRUE))

moyenne_expo_cat <- data %>%
    group_by(Catégorie) %>%
    summarise(Moyenne = mean(SCORE_EXPO, na.rm = TRUE))

moyenne_club_cat <- data %>%
    group_by(Catégorie) %>%
    summarise(Moyenne = mean(Club_Strava, na.rm = TRUE))

moyenne_kudos_cat <- data %>%
    group_by(Catégorie) %>%
    summarise(Moyenne = mean(Kudos_reçus, na.rm = TRUE))

moyenne_freqpubli_cat <- data %>%
    group_by(Catégorie) %>%
    summarise(Moyenne = mean(Fréquence_publication, na.rm = TRUE))

moyenne_freqcons_cat <- data %>%
    group_by(Catégorie) %>%
    summarise(Moyenne = mean(Fréquence_consultation, na.rm = TRUE))

moyenne_nbabonnes_cat <- data %>%
    group_by(Catégorie) %>%
    summarise(Moyenne = mean(Nb_abonnés, na.rm = TRUE))

moyenne_nbabonnements_cat <- data %>%
    group_by(Catégorie) %>%
    summarise(Moyenne = mean(Nb_abonnements, na.rm = TRUE))

moyenne_anciennetestrava_cat <- data %>%
    group_by(Catégorie) %>%
    summarise(Moyenne = mean(Ancienneté_Strava, na.rm = TRUE))

anova_strava_cat <- data.frame(
  Variable = c("SCORE SIS", "SCORE OSF", "SCORE EXPO", "Club Strava", "Kudos reçus", "Fréquence publication", "Fréquence consultation", "Nombre abonnés", "Nombre abonnements", "Ancienneté Strava"),
  F_value = c(anova_sis_cat[[1]]["F value"][1,1], anova_osf_cat[[1]]["F value"][1,1], anova_expo_cat[[1]]["F value"][1,1],anova_club_cat[[1]]["F value"][1,1], anova_kudos_cat[[1]]["F value"][1,1], anova_freqpubli_cat[[1]]["F value"][1,1], anova_freqcons_cat[[1]]["F value"][1,1], anova_nbabonnés_cat[[1]]["F value"][1,1], anova_nbabonnements_cat[[1]]["F value"][1,1], anova_anciennetestrava_cat[[1]]["F value"][1,1]),
 P_value = ifelse(c(anova_sis_cat[[1]]["Pr(>F)"][1,1], anova_osf_cat[[1]]["Pr(>F)"][1,1], anova_expo_cat[[1]]["Pr(>F)"][1,1], anova_club_cat[[1]]["Pr(>F)"][1,1], anova_kudos_cat[[1]]["Pr(>F)"][1,1], anova_freqpubli_cat[[1]]["Pr(>F)"][1,1], anova_freqcons_cat[[1]]["Pr(>F)"][1,1], anova_nbabonnés_cat[[1]]["Pr(>F)"][1,1], anova_nbabonnements_cat[[1]]["Pr(>F)"][1,1], anova_anciennetestrava_cat[[1]]["Pr(>F)"][1,1]), "< 0.05", "sup. 0.05"),
 Agriculteurs = c(moyenne_sis_cat$Moyenne[1], moyenne_osf_cat$Moyenne[1], moyenne_expo_cat$Moyenne[1], moyenne_club_cat$Moyenne[1], moyenne_kudos_cat$Moyenne[1], moyenne_freqpubli_cat$Moyenne[1], moyenne_freqcons_cat$Moyenne[1], moyenne_nbabonnes_cat$Moyenne[1], moyenne_nbabonnements_cat$Moyenne[1], moyenne_anciennetestrava_cat$Moyenne[1]),
 Artisans = c(moyenne_sis_cat$Moyenne[2], moyenne_osf_cat$Moyenne[2], moyenne_expo_cat$Moyenne[2], moyenne_club_cat$Moyenne[2], moyenne_kudos_cat$Moyenne[2], moyenne_freqpubli_cat$Moyenne[2], moyenne_freqcons_cat$Moyenne[2], moyenne_nbabonnes_cat$Moyenne[2], moyenne_nbabonnements_cat$Moyenne[2], moyenne_anciennetestrava_cat$Moyenne[2]),
 Cadres = c(moyenne_sis_cat$Moyenne[3], moyenne_osf_cat$Moyenne[3], moyenne_expo_cat$Moyenne[3], moyenne_club_cat$Moyenne[3], moyenne_kudos_cat$Moyenne[3], moyenne_freqpubli_cat$Moyenne[3], moyenne_freqcons_cat$Moyenne[3], moyenne_nbabonnes_cat$Moyenne[3], moyenne_nbabonnements_cat$Moyenne[3], moyenne_anciennetestrava_cat$Moyenne[3]),
 Intermédiaires = c(moyenne_sis_cat$Moyenne[4], moyenne_osf_cat$Moyenne[4], moyenne_expo_cat$Moyenne[4], moyenne_club_cat$Moyenne[1], moyenne_kudos_cat$Moyenne[1], moyenne_freqpubli_cat$Moyenne[4], moyenne_freqcons_cat$Moyenne[4], moyenne_nbabonnes_cat$Moyenne[4], moyenne_nbabonnements_cat$Moyenne[4], moyenne_anciennetestrava_cat$Moyenne[4]),
 Employés = c(moyenne_sis_cat$Moyenne[5], moyenne_osf_cat$Moyenne[5], moyenne_expo_cat$Moyenne[5], moyenne_club_cat$Moyenne[5], moyenne_kudos_cat$Moyenne[5], moyenne_freqpubli_cat$Moyenne[5], moyenne_freqcons_cat$Moyenne[5], moyenne_nbabonnes_cat$Moyenne[5], moyenne_nbabonnements_cat$Moyenne[5], moyenne_anciennetestrava_cat$Moyenne[5]),
 Ouvriers = c(moyenne_sis_cat$Moyenne[6], moyenne_osf_cat$Moyenne[6], moyenne_expo_cat$Moyenne[6], moyenne_club_cat$Moyenne[6], moyenne_kudos_cat$Moyenne[6], moyenne_freqpubli_cat$Moyenne[6], moyenne_freqcons_cat$Moyenne[6], moyenne_nbabonnes_cat$Moyenne[6], moyenne_nbabonnements_cat$Moyenne[6], moyenne_anciennetestrava_cat$Moyenne[6]),
 Retraités = c(moyenne_sis_cat$Moyenne[7], moyenne_osf_cat$Moyenne[7], moyenne_expo_cat$Moyenne[7], moyenne_club_cat$Moyenne[7], moyenne_kudos_cat$Moyenne[7], moyenne_freqpubli_cat$Moyenne[7], moyenne_freqcons_cat$Moyenne[7], moyenne_nbabonnes_cat$Moyenne[7], moyenne_nbabonnements_cat$Moyenne[7], moyenne_anciennetestrava_cat$Moyenne[7]),
 Etudiants = c(moyenne_sis_cat$Moyenne[8], moyenne_osf_cat$Moyenne[8], moyenne_expo_cat$Moyenne[8], moyenne_club_cat$Moyenne[8], moyenne_kudos_cat$Moyenne[8], moyenne_freqpubli_cat$Moyenne[8], moyenne_freqcons_cat$Moyenne[8], moyenne_nbabonnes_cat$Moyenne[8], moyenne_nbabonnements_cat$Moyenne[8], moyenne_anciennetestrava_cat$Moyenne[8]),
 Autres = c(moyenne_sis_cat$Moyenne[9], moyenne_osf_cat$Moyenne[9], moyenne_expo_cat$Moyenne[9], moyenne_club_cat$Moyenne[9], moyenne_kudos_cat$Moyenne[9], moyenne_freqpubli_cat$Moyenne[9], moyenne_freqcons_cat$Moyenne[9], moyenne_nbabonnes_cat$Moyenne[9], moyenne_nbabonnements_cat$Moyenne[9], moyenne_anciennetestrava_cat$Moyenne[9])
)

kable(anova_strava_cat, format = "html", escape = FALSE)
```

#### Tests post hoc
```{r test post hoc strava et categorie socio}
tukey_sis_cat <- TukeyHSD(aov(SCORE_SIS_TOTAL ~ as.factor(Catégorie), data = data))
tukey_osf_cat <- TukeyHSD(aov(SCORE_SIS_TOTAL ~ as.factor(Catégorie), data = data))
tukey_expo_cat <- TukeyHSD(aov(SCORE_SIS_TOTAL ~ as.factor(Catégorie), data = data))
tukey_club_cat <- TukeyHSD(aov(Club_Strava ~ as.factor(Catégorie), data = data))
tukey_kudos_cat <- TukeyHSD(aov(Kudos_reçus ~ as.factor(Catégorie), data = data))
tukey_freqpubli_cat <- TukeyHSD(aov(Fréquence_publication ~ as.factor(Catégorie), data = data))
tukey_freqcons_cat <- TukeyHSD(aov(Fréquence_consultation ~ as.factor(Catégorie), data = data))
tukey_nbabonnés_cat <- TukeyHSD(aov(Nb_abonnés ~ as.factor(Catégorie), data = data))
tukey_nbabonnements_cat <- TukeyHSD(aov(Nb_abonnements ~ as.factor(Catégorie), data = data))
tukey_anciennetestrava_cat <- TukeyHSD(aov(Ancienneté_Strava ~ as.factor(Catégorie), data = data))

tukey_sis_cat_df <- as.data.frame(tukey_sis_cat[[1]]) 
tukey_sis_cat_df$Comparison <- rownames(tukey_sis_cat_df)
tukey_sis_cat_df$Variable <- "SCORE SIS TOTAL"
rownames(tukey_sis_cat_df) <- NULL

tukey_osf_cat_df <- as.data.frame(tukey_osf_cat[[1]]) 
tukey_osf_cat_df$Comparison <- rownames(tukey_osf_cat_df)
tukey_osf_cat_df$Variable <- "SCORE OSF"
rownames(tukey_osf_cat_df) <- NULL

tukey_expo_cat_df <- as.data.frame(tukey_expo_cat[[1]]) 
tukey_expo_cat_df$Comparison <- rownames(tukey_expo_cat_df)
tukey_expo_cat_df$Variable <- "SCORE EXPO"
rownames(tukey_expo_cat_df) <- NULL

tukey_club_cat_df <- as.data.frame(tukey_club_cat[[1]]) 
tukey_club_cat_df$Comparison <- rownames(tukey_club_cat_df)
tukey_club_cat_df$Variable <- "Club Strava"
rownames(tukey_club_cat_df) <- NULL

tukey_kudos_cat_df <- as.data.frame(tukey_kudos_cat[[1]]) 
tukey_kudos_cat_df$Comparison <- rownames(tukey_kudos_cat_df)
tukey_kudos_cat_df$Variable <- "Kudos reçus"
rownames(tukey_kudos_cat_df) <- NULL

tukey_freqpubli_cat_df <- as.data.frame(tukey_freqpubli_cat[[1]]) 
tukey_freqpubli_cat_df$Comparison <- rownames(tukey_freqpubli_cat_df)
tukey_freqpubli_cat_df$Variable <- "Fréquence publication"
rownames(tukey_freqpubli_cat_df) <- NULL

tukey_freqcons_cat_df <- as.data.frame(tukey_freqcons_cat[[1]]) 
tukey_freqcons_cat_df$Comparison <- rownames(tukey_freqcons_cat_df)
tukey_freqcons_cat_df$Variable <- "Fréquence consultation"
rownames(tukey_freqcons_cat_df) <- NULL

tukey_nbabonnés_cat_df <- as.data.frame(tukey_nbabonnés_cat[[1]]) 
tukey_nbabonnés_cat_df$Comparison <- rownames(tukey_nbabonnés_cat_df)
tukey_nbabonnés_cat_df$Variable <- "Nombre abonnés"
rownames(tukey_nbabonnés_cat_df) <- NULL

tukey_nbabonnements_cat_df <- as.data.frame(tukey_nbabonnements_cat[[1]]) 
tukey_nbabonnements_cat_df$Comparison <- rownames(tukey_nbabonnements_cat_df)
tukey_nbabonnements_cat_df$Variable <- "Nombre abonnements"
rownames(tukey_nbabonnements_cat_df) <- NULL

tukey_anciennetestrava_cat_df <- as.data.frame(tukey_anciennetestrava_cat[[1]]) 
tukey_anciennetestrava_cat_df$Comparison <- rownames(tukey_anciennetestrava_cat_df)
tukey_anciennetestrava_cat_df$Variable <- "Ancienneté Strava"
rownames(tukey_anciennetestrava_cat_df) <- NULL


tukey_results <- bind_rows(tukey_sis_cat_df, tukey_osf_cat_df, tukey_expo_cat_df, tukey_club_cat_df, tukey_kudos_cat_df, tukey_freqpubli_cat_df, tukey_freqcons_cat_df, tukey_nbabonnés_cat_df, tukey_nbabonnements_cat_df, tukey_anciennetestrava_cat_df)

tukey_signif <- tukey_results %>% filter(`p adj` < 0.05)

kable(tukey_signif, format = "html", escape = FALSE)
```


#### Visualisation graphique
```{r visualisation test post hoc}
ggplot(tukey_signif, aes(x = Comparison, y = diff, fill = Variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_errorbar(aes(ymin = lwr, ymax = upr), width = 0.2, position = position_dodge(0.9)) +
  theme_minimal() +
  labs(title = "Comparaisons post-hoc (Tukey HSD)", 
       x = "Comparaison entre groupes", 
       y = "Différence de moyenne") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


#### Khi² et Cramer
```{r abonnement et categorie}
### Lien type abonnement et categorie
chi2_typeabonnement_categorie <-chisq.test (table(data$Type_abonnement, data$Catégorie))
cramer_typeabonnement_categorie<- assocstats(table(data$Type_abonnement, data$Catégorie))


table_typeabonnement_categorie <- data.frame(
  Variable = c("Lien catégorie d'abonnement et CSP"),
  Khi2_indépendance = as.numeric(round(c(chi2_typeabonnement_categorie$statistic),2)),
  P.value = ifelse(c(chi2_typeabonnement_categorie$p.value) < 0.001, "< 0.001", " sup. 0.001"),
  Coefficient_Cramer = round(c(cramer_typeabonnement_categorie$cramer),2)
)

kable(table_typeabonnement_categorie, format = "html", escape = FALSE)

```


# Caractéristiques sportives

### Ancienneté et niveau{.tabset}

#### Répartition de l'ancienneté
```{r graphique anciennete}
data_resumeAnciennete<- data%>%
    summarise(
    Moyenne = mean(Ancienneté_pratique, na.rm = TRUE),
    Médiane = median(Ancienneté_pratique, na.rm = TRUE),
    Ecart_type= sd(Ancienneté_pratique, na.rm=TRUE)
  )

kable(data_resumeAnciennete)

data_resumeancienneteround<- data%>%
  summarise(
    moyenne = round(mean(Ancienneté_pratique, na.rm = TRUE),0),
    median = round(median(Ancienneté_pratique, na.rm = TRUE),0),
    q1 = round(quantile(Ancienneté_pratique, 0.25, na.rm=T),0),
    q3 = round(quantile(Ancienneté_pratique, 0.75, na.rm=T),0)
  )

vlinesanciennete <- data.frame(
  label = c("Q1", "Médiane", "Moyenne", "Q3"),
  xintercept = c(data_resumeancienneteround$q1, data_resumeancienneteround$median, data_resumeancienneteround$moyenne, data_resumeancienneteround$q3)
)
vlinesanciennete$annotation <- paste(vlinesanciennete$label, ":", vlinesanciennete$xintercept)

ggplot(data) +
  geom_histogram(aes(x = Ancienneté_pratique), fill = "#FC4C02", binwidth=5, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$Ancienneté_pratique, na.rm = TRUE), 
                                max(data$Ancienneté_pratique, na.rm = TRUE), 
                                by = 5))+
  labs(title = "Répartition de l'ancienneté dans la pratique au sein de l'échantillon",
       x = "Ancienneté dans la pratique (en années)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesanciennete, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesanciennete, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

#### Répartition de l'ancienneté par sexe
```{r graphique anciennete en fonction du sexe}

data_resumeAncienneteSexe<- data%>%
  mutate(Sexe = ifelse(Sexe == 1, "Homme", "Femme")) %>%
  group_by(Sexe)%>%
    summarise(
    Moyenne = mean(Ancienneté_pratique, na.rm = TRUE),
    Médiane = median(Ancienneté_pratique, na.rm = TRUE),
    Ecart_type= sd(Ancienneté_pratique, na.rm=TRUE)
  )

kable(data_resumeAncienneteSexe)


ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Ancienneté_pratique,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "Répartition de l'ancienneté dans la pratique par sexe au sein de l'échantillon",
       x = "Sexe",
       y = "Ancienneté dans la pratique (en années)",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Niveau de course à pied
```{r graphique niveau de cap}
data_resumeniveau<- data%>%
  summarise(
    Moyenne = mean(Niveau, na.rm = TRUE),
    Médiane = median(Niveau, na.rm = TRUE),
    Ecart_type= sd(Niveau, na.rm=TRUE)
  )

chi2conformiteniveau <- chisq.test(data$Niveau, p=rep(1/length(data$Niveau),length(data$Niveau)))

data_resumeniveau$Khi2_ajustement <- as.numeric(chi2conformiteniveau$statistic)
data_resumeniveau$p.value <- ifelse(chi2conformiteniveau$p.value < 0.001, "<0.001", ">0.001")

kable(data_resumeniveau)

ggplot(data, aes(x = factor(Niveau, 
                            levels = c(1, 2, 3, 4),
                            labels = c("Débutant(e)", "Intermédiaire", "Confirmé(e)", "Expert(e)")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(aes(label = ..count..), 
            stat = "count",
            vjust = -0.5,
            size = 2) +
  labs(title = "Répartition des niveaux de course à pied au sein de l'échantillon",
       x = "Niveau dans la course à pied",
       y = "Nombre d'individus", fill="Niveau dans la course à pied") +
  theme_minimal() +
  theme(legend.position = "none")
```

#### Niveau de course à pied par sexe
```{r graphique niveau cap par sexe}

data_resumeniveauSexe<- data%>%
  mutate(Sexe = ifelse(Sexe == 1, "Homme", "Femme")) %>%
  group_by(Sexe)%>%
  summarise(
    Moyenne = mean(Niveau, na.rm = TRUE),
    Médiane = median(Niveau, na.rm = TRUE),
    Ecart_type= sd(Niveau, na.rm=TRUE)
  )

kable(data_resumeniveauSexe)

ggplot(data) +  
  geom_bar(aes(x = factor(data$Niveau, levels = c(1, 2, 3, 4), labels = c("Débutant(e)", "Intermédiaire", "Confirmé(e)", "Expert(e)")), fill = factor(data$Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), position = "fill", alpha=0.5) +
  geom_text(aes(x = factor(data$Niveau, levels = c(1, 2, 3, 4), labels = c("Débutant(e)", "Intermédiaire", "Confirmé(e)", "Expert(e)")), label = ..count.., group = factor(data$Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
                stat = "count", 
                position = position_fill(vjust = 0.5)) +
  labs(title = "Répartition des niveaux de course à pied par sexe au sein de l'échantillon",
       x = "Niveau dans la course à pied par sexe",
       y = "Nombre d'individus",
       fill = "Sexe") + 
  theme_minimal()+
  default_fill_colors()
```

### Entraînement{.tabset}

#### Fréquence d'entraînement
```{r graphique frequence entrainement}
data$Frequence_pratique <- as.numeric(as.character(data$Frequence_pratique))

data_resumefreqentrainement<- data%>%
  summarise(
    Moyenne = mean(Frequence_pratique, na.rm = TRUE),
    Médiane = median(Frequence_pratique, na.rm = TRUE),
    Ecart_type= sd(Frequence_pratique, na.rm=TRUE)
  )

kable(data_resumefreqentrainement)


data_resumefrequenceround<- data %>%
  summarise(
    moyenne = round(mean(Frequence_pratique, na.rm = TRUE),0),
    median = round(median(Frequence_pratique, na.rm = TRUE),0),
    q1 = round(quantile(Frequence_pratique, 0.25, na.rm=TRUE),0),
    q3 = round(quantile(Frequence_pratique, 0.75, na.rm=TRUE),0)
  )

vlinesfrequence <- data.frame(
  label = c("Moyenne", "Médiane", "q1", "q2"),
  xintercept = c(data_resumefrequenceround$moyenne,data_resumefrequenceround$median, data_resumefrequenceround$q1, data_resumefrequenceround$q3 )
)
vlinesfrequence$annotation <- paste(vlinesfrequence$label, ":", vlinesfrequence$xintercept)

ggplot(data) +
  geom_histogram(aes(x = Frequence_pratique), fill = "#FC4C02", alpha=0.5, color="#FC4C02", binwidth = 1) +
  scale_x_continuous(breaks = seq(min(data$Frequence_pratique, na.rm = TRUE), 
                                max(data$Frequence_pratique, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition de la fréquence d'entraînement au sein de l'échantillon",
       x = "Nombre d'entraînement en course à pied par semaine", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesfrequence, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", linewidth = 0.5) +
  geom_text(data = vlinesfrequence, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

#### Fréquence d'entraînement par sexe
```{r graphique frequence entrainement par sexe}

data_resumefreqentrainementSexe<- data%>%
  mutate(Sexe = ifelse(Sexe == 1, "Homme", "Femme")) %>%
  group_by(Sexe)%>%
  summarise(
    Moyenne = mean(Frequence_pratique, na.rm = TRUE),
    Médiane = median(Frequence_pratique, na.rm = TRUE),
    Ecart_type= sd(Frequence_pratique, na.rm=TRUE)
  )

kable(data_resumefreqentrainementSexe)


ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Frequence_pratique,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "Répartition de la fréquence d'entraînement par sexe au sein de l'échantillon",
       x = "Sexe",
       y = "Nombre d'entraînement en course à pied par semaine",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Volume d'entraînement
```{r graphique volume entrainement}
data$Kilomètres <- as.numeric(as.character(data$Kilomètres))

data_resumevolume<- data%>%
  summarise(
    Moyenne = mean(Kilomètres, na.rm = TRUE),
    Médiane = median(Kilomètres, na.rm = TRUE),
    Ecart_type= sd(Kilomètres, na.rm=TRUE)
  )

kable(data_resumevolume)


data_resumekmround<- data %>%
  summarise(
    moyenne = round(mean(Kilomètres, na.rm = TRUE),0),
    median = round(median(Kilomètres, na.rm = TRUE),0),
    q1 = round(quantile(Kilomètres, 0.25, na.rm=TRUE),0),
    q3 = round(quantile(Kilomètres, 0.75, na.rm=TRUE),0)
  )

vlineskm <- data.frame(
  label = c("Q1", "Médiane", "Moyenne", "Q3"),
  xintercept = c(data_resumekmround$q1, data_resumekmround$median, data_resumekmround$moyenne, data_resumekmround$q3)
)
vlineskm$annotation <- paste(vlineskm$label, ":", vlineskm$xintercept)

ggplot(data) +
  geom_histogram(aes(x = Kilomètres), fill = "#FC4C02", alpha=0.5, color="#FC4C02", binwidth = 10) +
  scale_x_continuous(breaks = seq(min(data$Kilomètres, na.rm = TRUE), 
                                max(data$Kilomètres, na.rm = TRUE), 
                                by = 10))+
  labs(title = "Répartition du volume d'entraînement au sein de l'échantillon",
       x = "Nombre de kilomètres par semaine", 
       y = "Nombre d'individus") +
  geom_vline(data = vlineskm, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", linewidth = 0.5) +
  geom_text(data = vlineskm, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

#### Volume d'entraînement par sexe
```{r graphique volume entrainement par sexe}

data_resumevolumeSexe<- data%>%
  mutate(Sexe = ifelse(Sexe == 1, "Homme", "Femme")) %>%
  group_by(Sexe)%>%
  summarise(
    Moyenne = mean(Kilomètres, na.rm = TRUE),
    Médiane = median(Kilomètres, na.rm = TRUE),
    Ecart_type= sd(Kilomètres, na.rm=TRUE)
  )

kable(data_resumevolumeSexe)


ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Kilomètres,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "Répartition du volume d'entraînement par sexe au sein de l'échantillon",
       x = "Sexe",
       y = "Nombre de kilomètres par semaine",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Volume et fréquence
```{r heatmap volume et frequence}
heatmap_volume_frequence <- data %>%
    filter(!is.na(freqentrainement_category), !is.na(kmentrainement_category)) %>%
    group_by(freqentrainement_category, kmentrainement_category) %>%
    summarise(n = n(), .groups = "drop")

ggplot(heatmap_volume_frequence, aes(x = freqentrainement_category, y = kmentrainement_category, fill = n)) +
    geom_tile(color = "#eff4f9") +
    scale_fill_gradient(low = "#eff4f9", high = "#FC4C02") +
    geom_text(aes(label = sprintf("%.1f%%", (n / sum(heatmap_volume_frequence$n)) * 100)), color = "black")+
    labs(title = "Répartition des coureurs selon fréquence et volume d'entraînement au sein de l'échantillon",
         x = "Nombre de séances par semaine", 
         y = "Nombre de kilomètres par semaine",
         fill = "Nombre de personnes") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


### Compétitions{.tabset}

#### Nombre de compétitions par an
```{r graphique nb competitions}
data$Compétitions <- as.numeric(as.character(data$Compétitions))

data_resumeCompetition<- data%>%
  summarise(
    Moyenne = mean(Compétitions, na.rm = TRUE),
    Médiane = median(Compétitions, na.rm = TRUE),
    Ecart_type= sd(Compétitions, na.rm=TRUE)
  )

kable(data_resumeCompetition)


data_resumecompetitionround<- data %>%
  summarise(
    moyenne = round(mean(Compétitions, na.rm = TRUE),0),
    median = round(median(Compétitions, na.rm = TRUE),0),
    q1 = round(quantile(Compétitions, 0.25, na.rm=TRUE),0),
    q3 = round(quantile(Compétitions, 0.75, na.rm=TRUE),0)
  )

vlinescompetition <- data.frame(
  label = c("Q1", "Médiane", "Moyenne", "Q3"),
  xintercept = c(data_resumecompetitionround$q1, data_resumecompetitionround$median, data_resumecompetitionround$moyenne, data_resumecompetitionround$q3)
)
vlinescompetition$annotation <- paste(vlinescompetition$label, ":", vlinescompetition$xintercept)

ggplot(data) +
  geom_histogram(aes(x = Compétitions), fill = "#FC4C02", alpha=0.5, color="#FC4C02", binwidth = 1) +
  scale_x_continuous(breaks = seq(min(data$Compétitions, na.rm = TRUE), 
                                max(data$Compétitions, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du nombre de compétitions par an au sein de l'échantillon",
       x = "Nombre de compétitions par an (objectifs principaux)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinescompetition, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", linewidth = 0.5) +
  geom_text(data = vlinescompetition, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

#### Nombre de compétitions par an par sexe
```{r graphique nb competition par sexe}

data_resumecompetitionSexe<- data%>%
  mutate(Sexe = ifelse(Sexe == 1, "Homme", "Femme")) %>%
  group_by(Sexe)%>%
  summarise(
    Moyenne = mean(Compétitions, na.rm = TRUE),
    Médiane = median(Compétitions, na.rm = TRUE),
    Ecart_type= sd(Compétitions, na.rm=TRUE)
  )

kable(data_resumecompetitionSexe)


ggplot(data, aes(x = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")),
                 y = Compétitions,
                 fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "Répartition du nombre de compétitions par sexe par an au sein de l'échantillon",
       x = "Sexe",
       y = "Nombre de compétitions par an (objectifs principaux)",
       fill = "Sexe") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Objectif 2025
```{r graphique objectif 2025}

chi2conformiteobj <- chisq.test(data$Objectif, p=rep(1/length(data$Objectif),length(data$Objectif)))
table_obj <- data.frame(
  Variable = c("Objectif"),
  Khi2_ajustement = as.numeric(chi2conformiteobj$statistic),
  p.value = ifelse(chi2conformiteobj$p.value < 0.001, "<0.001", ">0.001")
)
kable(table_obj)

ggplot(data, aes(x = factor(Objectif, levels = c(1, 2), labels = c("Oui", "Non")))) +
  geom_bar(aes(fill = factor(Objectif, levels = c(1, 2), labels = c("Oui", "Non")), alpha=0.5)) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Objectif de course 2025", y = "Nombre d'individus", fill="Pratique en club") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors()
```

#### Type objectif 2025

```{r graphique type objectif 2025}
nbobjectif<-nrow(data %>% filter (data$Objectif == "1"))
glue("Le nombre d'individus considérés {nbobjectif}.")

chi2conformiteobjtype <- chisq.test(table(data$Objectif_KM),                                    p = rep(1/length(unique(data$Objectif_KM)), length(unique(data$Objectif_KM))))

table_objtype <- data.frame(
  Variable = c("Objectif"),
  Khi2_ajustement = as.numeric(chi2conformiteobjtype$statistic),
  p.value = ifelse(chi2conformiteobjtype$p.value < 0.001, "<0.001", ">0.001")
)
kable(table_objtype)


ggplot(data, aes(x = factor(Niveau, 
                            levels = c(1, 2, 3, 4),
                            labels = c("20 K", "50 K", "100 K", "100 M")), 
                 fill = factor(Sexe, 
                              levels = c(1,2), 
                              labels = c("Homme","Femme"))
                 ))+ 
  geom_bar(position = "stack", alpha = 0.7) + 
geom_text(stat = "count", aes(label = ..count.., group = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
            position = position_stack(vjust = 0.5), size = 4)+ 
  labs(title = "Répartition des types d'objectifs au sein de l'échantillon",
       x = "Objectif principal 2025",
       y = "Nombre d'individus",
       fill = "Sexe") + 
  theme_minimal() +
  theme(legend.position = "top")+
  default_fill_colors()
```

### Caractéristiques de la pratique{.tabset}

#### Lieu de pratique
```{r graphique trail ou route}

chi2conformitelieu <- chisq.test(data$Lieu, p=rep(1/length(data$Lieu),length(data$Lieu)))
table_lieu <- data.frame(
  Variable = c("Lieu"),
  Khi2_ajustement = as.numeric(chi2conformitelieu$statistic),
  p.value = ifelse(chi2conformitelieu$p.value < 0.001, "<0.001", ">0.001")
)
kable(table_lieu)

ggplot(data, aes(x = factor(Lieu, levels = c(1, 2), labels = c("Sur route", "Trail")))) +
  geom_bar(aes(fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), position = "stack", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count.., group = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
            position = position_stack(vjust = 0.5), size = 4) +
  labs(title = "Répartition des lieux de pratique au sein de l'échantillon",
       x = "Lieu de pratique", y = "Nombre d'individus", fill="Sexe") +
  theme_minimal()+
  default_fill_colors()

```

#### Club
```{r graphique club pratique}

chi2conformiteclub <- chisq.test(data$Club, p=rep(1/length(data$Club),length(data$Club)))
table_club <- data.frame(
  Variable = c("Club"),
  Khi2_ajustement = as.numeric(chi2conformiteclub$statistic),
  p.value = ifelse(chi2conformiteclub$p.value < 0.001, "<0.001", ">0.001")
)
kable(table_club)

ggplot(data, aes(x = factor(Club, levels = c(1, 2), labels = c("Oui", "Non")))) +
  geom_bar(aes(fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), position = "stack", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count.., group = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
            position = position_stack(vjust = 0.5), size = 4) +
  labs(title = "Répartition de l'appartenance à un club au sein de l'échantillon",
       x = "Pratique en club", y = "Nombre d'individus", fill="Sexe") +
  theme_minimal()+
  default_fill_colors()

```

#### Mode
```{r graphique seul ou groupe}

chi2conformitemode <- chisq.test(data$Mode, p=rep(1/length(data$Mode),length(data$Mode)))
table_mode <- data.frame(
  Variable = c("Mode"),
  Khi2_ajustement = as.numeric(chi2conformitemode$statistic),
  p.value = ifelse(chi2conformitemode$p.value < 0.001, "<0.001", ">0.001")
)
kable(table_mode)

ggplot(data, aes(x = factor(Mode, levels = c(1, 2), labels = c("Seul(e)", "En groupe")))) +
  geom_bar(aes(fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), position = "stack", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count.., group = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
            position = position_stack(vjust = 0.5), size = 4) +
  labs(title = "Répartition du mode de pratique au sein de l'échantillon",
       x = "Pratique seul(e) ou en groupe", y = "Nombre d'individus", fill="Sexe") +
  theme_minimal()+
  default_fill_colors()

```

#### Type coureur
```{r graphique type de coureur}
data <- data %>%
  mutate(Type_coureur_label = case_when(
    Type_coureur == "1 1 1" ~ "Route, Club, Seul(e)",
    Type_coureur == "1 2 1" ~ "Route, Pas de club, Seul(e)",
    Type_coureur == "1 1 2" ~ "Route, Club, En groupe",
    Type_coureur == "1 2 2" ~ "Route, Pas de club, En groupe",
    Type_coureur == "2 1 1" ~ "Trail, Club, Seul(e)",
    Type_coureur == "2 2 1" ~ "Trail, Pas de club, Seul(e)",
    Type_coureur == "2 1 2" ~ "Trail, Club, En groupe",
    Type_coureur == "2 2 2" ~ "Trail, Pas de club, En groupe",
    TRUE ~ "Autre"
  ))

table_type_coureur <- table(data$Type_coureur)  

chi2conformitypecoureur <- chisq.test(table_type_coureur, p = rep(1 / length(table_type_coureur), length(table_type_coureur)))  

data_resumetypecoureur <-data.frame(Khi2_ajustement= "", p.value ="")
data_resumetypecoureur$Khi2_ajustement<- as.numeric(chi2conformitypecoureur$statistic)
data_resumetypecoureur$p.value <- ifelse(chi2conformitypecoureur$p.value < 0.001, "<0.001", ">0.001")

kable(data_resumetypecoureur)

ggplot(data, aes(y = reorder(Type_coureur_label, table(Type_coureur_label)[Type_coureur_label]))) +
  geom_bar(fill = "#FC4C02", alpha = 0.5) +
  geom_text(stat = "count", aes(label = ..count..), hjust = -0.3, size = 3) +
  labs(title = "Répartition des type de coureurs au sein de l'échantillon",
       y = "Lieu de pratique, Club ou non, Mode de pratique",
       x = "Nombre d'individus") +
  theme_minimal()
```

#### Coach
```{r graphique coach}

chi2conformitecoach <- chisq.test(data$Coach, p=rep(1/length(data$Coach),length(data$Coach)))
table_coach <- data.frame(
  Variable = c("Coach"),
  Khi2_ajustement = as.numeric(chi2conformitecoach$statistic),
  p.value = ifelse(chi2conformitecoach$p.value < 0.001, "<0.001", ">0.001")
)
kable(table_coach)

ggplot(data, aes(x = factor(Coach, levels = c(1, 2), labels = c("Oui", "Non")))) +
  geom_bar(aes(fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), position = "stack", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count.., group = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
            position = position_stack(vjust = 0.5), size = 4) +
  labs(title = "Répartition des pratiquants avec coach au sein de l'échantillon",
       x = "Pratique avec un coach", y = "Nombre d'individus", fill="Sexe") +
  theme_minimal()+
  default_fill_colors()


```

#### Programme d'entraînement
```{r graphique pgrm entrainement}

chi2conformitepgrm <- chisq.test(data$Programme, p=rep(1/length(data$Objectif),length(data$Programme)))
table_pgrm <- data.frame(
  Variable = c("Programme"),
  Khi2_ajustement = as.numeric(chi2conformitepgrm$statistic),
  p.value = ifelse(chi2conformitepgrm$p.value < 0.001, "<0.001", ">0.001")
)
kable(table_pgrm)

ggplot(data, aes(x = factor(Programme, levels = c(1, 2), labels = c("Oui", "Non")))) +
  geom_bar(aes(fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), position = "stack", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count.., group = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
            position = position_stack(vjust = 0.5), size = 4) +
  labs(title = "Répartition des pratiquants avec un programme au sein de l'échantillon",
       x = "Pratique avec un programme d'entraînement", y = "Nombre d'individus", fill="Sexe") +
  theme_minimal()+
  default_fill_colors()


```


### Blessure{.tabset}

#### Blessure
```{r graphique blessure}

chi2conformiteblessure <- chisq.test(data$Blessure, p=rep(1/length(data$Blessure),length(data$Blessure)))
table_blessure <- data.frame(
  Variable = c("Blessure"),
  Khi2_ajustement = as.numeric(chi2conformiteblessure$statistic),
  p.value = ifelse(chi2conformiteblessure$p.value < 0.001, "<0.001", ">0.001")
)
kable(table_blessure)

ggplot(data, aes(x = factor(Blessure, levels = c(1, 2), labels = c("Oui", "Non")))) +
  geom_bar(aes(fill = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), position = "stack", alpha = 0.7) +
  geom_text(stat = "count", aes(label = ..count.., group = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme"))), 
            position = position_stack(vjust = 0.5), size = 4) +
  labs(title = "Répartition des pratiquants blessés au sein de l'échantillon",
       x = "Dans les 6 mois précédents, avez-vous eu une blessure liée à votre pratique ?", y = "Nombre d'individus", fill="Sexe") +
  theme_minimal()+
  default_fill_colors()

```

#### Pause
```{r graphique pause}
pauseblessure<-nrow(data %>% filter (data$Blessure == "1"))
glue("Le nombre d'individus considérés {pauseblessure}.")


chi2conformitepause <- chisq.test(table(data$Pause_blessure), p=rep(1/length(unique(data$Pause_blessure)),length(unique(data$Pause_blessure))))

table_pauseblessure <- data.frame(
  Variable = c("Pause blessure"),
  Khi2_ajustement = as.numeric(chi2conformitepause$statistic),
  p.value = ifelse(chi2conformitepause$p.value < 0.001, "<0.001", ">0.001")
)
kable(table_pauseblessure)

ggplot(subset(data, Pause_blessure != "NA"), 
       aes(x = factor(Pause_blessure, 
                      levels = c(1, 2, 3, 4),
                      labels = c("Oui quelques jours", 
                                 "Oui quelques semaines", 
                                 "Oui quelques mois", 
                                 "Non")))) +
  geom_bar(fill = "#FC4C02", alpha = 0.5) +
  geom_text(stat = "count", aes(label = ..count..), 
            vjust = -0.5, size = 2) +
  labs(title = "Répartition des durées de pause à cause d'une blessure au sein de l'échantillon",
       x = "Durée de la pause imposée par une blessure due à la course à pied",
       y = "Nombre d'individus", 
       fill = "Durée de la pause") +
  theme_minimal() +
  theme(legend.position = "none")

```

# Lien utilisation de Strava - caractéristiques sportives

Il s'agit de savoir s'il y a un lien entre l'utilisation de Strava et les caractéristiques sportives.

### Une première approche{.tabset}

#### Influence de Strava
```{r influence de strava}
data_resumeStrava_influence <- data%>%
  summarise(
    Moyenne = mean(Strava_influence, na.rm = TRUE),
    Médiane = median(Strava_influence, na.rm = TRUE),
    Ecart_type = sd(Strava_influence, na.rm=TRUE))

kable(data_resumeStrava_influence)


ggplot(data, aes(x = factor(Strava_influence, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Strava influence mon expérience en tant que coureur(se).", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Performance
```{r performance}
data_resumeStrava_perf <- data%>%
  summarise(
    Moyenne = mean(Strava_performance, na.rm = TRUE),
    Médiane = median(Strava_performance, na.rm = TRUE),
    Ecart_type = sd(Strava_performance, na.rm=TRUE))

kable(data_resumeStrava_influence)


ggplot(data, aes(x = factor(Strava_performance, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Depuis que j'utilise Strava, j'ai amélioré mes performances.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Fréquence
```{r frequence}
data_resumeStrava_freq <- data%>%
  summarise(
    Moyenne = mean(Strava_fréquence, na.rm = TRUE),
    Médiane = median(Strava_fréquence, na.rm = TRUE),
    Ecart_type = sd(Strava_fréquence, na.rm=TRUE))

kable(data_resumeStrava_freq)


ggplot(data, aes(x = factor(Strava_fréquence, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Depuis que j'utilise Strava, je cours plus souvent.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Kilomètres
```{r km strava}
data_resumeStrava_km <- data%>%
  summarise(
    Moyenne = mean(Strava_km, na.rm = TRUE),
    Médiane = median(Strava_km, na.rm = TRUE),
    Ecart_type = sd(Strava_km, na.rm=TRUE))

kable(data_resumeStrava_km)


ggplot(data, aes(x = factor(Strava_km, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Depuis que j'utilise Strava, je cours plus de kilomètres par semaine.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Compétitions
```{r compétitions strava}
data_resumeStrava_compétitions <- data%>%
  summarise(
    Moyenne = mean(Strava_compétition, na.rm = TRUE),
    Médiane = median(Strava_compétition, na.rm = TRUE),
    Ecart_type = sd(Strava_compétition, na.rm=TRUE))

kable(data_resumeStrava_compétitions)


ggplot(data, aes(x = factor(Strava_compétition, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Depuis que j'utilise Strava, je cours plus de kilomètres par semaine.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Ignorance blessure

```{r graph blessure Strava}
data_resumeStrava_blessure <- data%>%
  summarise(
    Moyenne = mean(Strava_blessure, na.rm = TRUE),
    Médiane = median(Strava_blessure, na.rm = TRUE),
    Ecart_type = sd(Strava_blessure, na.rm=TRUE))

kable(data_resumeStrava_blessure)

ggplot(data, aes(x = factor(Strava_blessure, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Utiliser Strava me pousse à ignorer des signaux de fatigue ou blessure.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### Ajout entraînement

```{r graph ajout entrainement Strava}
data_resumeStrava_change <- data%>%
  summarise(
    Moyenne = mean(Strava_change, na.rm = TRUE),
    Médiane = median(Strava_change, na.rm = TRUE),
    Ecart_type = sd(Strava_change, na.rm=TRUE))

kable(data_resumeStrava_change)

ggplot(data, aes(x = factor(Strava_change, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Si je n’ai pas prévu de faire un entraînement, le fait de regarder Strava peut me faire changer d’avis.") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### Changement entraînement

```{r graph change entrainement Strava}

nbcoach<-nrow(data %>% filter (data$Strava_entraînement != "NA"))
glue("Le nombre d'individus considérés {nbcoach}.")

data_resumeStrava_entrainement <- data%>%
  filter(!is.na(Strava_entraînement)) %>%
  summarise(
    Moyenne = mean(Strava_entraînement, na.rm = TRUE),
    Médiane = median(Strava_entraînement, na.rm = TRUE),
    Ecart_type = sd(Strava_entraînement, na.rm=TRUE))

kable(data_resumeStrava_entrainement)

ggplot(data %>% filter(Strava_entraînement!="NA"), aes(x = factor(Strava_entraînement, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "J'ai déjà modifié un entraînement prévu par mon entraîneur/plan d'entraînement à cause de Strava.") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### Changement programme

```{r graph change programme Strava}

nbpgrm<-nrow(data %>% filter (data$Strava_programme != "NA"))
glue("Le nombre d'individus considérés {nbcoach}.")

data_resumeStrava_programme <- data%>%
  filter(!is.na(Strava_programme)) %>%
  summarise(
    Moyenne = mean(Strava_programme, na.rm = TRUE),
    Médiane = median(Strava_programme, na.rm = TRUE),
    Ecart_type = sd(Strava_programme, na.rm=TRUE))

kable(data_resumeStrava_programme)

ggplot(data %>% filter(Strava_programme!="NA"), aes(x = factor(Strava_programme, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "J'ai déjà modifié mon programme d'entraînement à cause de Strava.") +
  theme_minimal()+
  theme(legend.position = "none")

```



### Statistiques{.tabset}

Les scores SIS, OSF et EXPO présentent des corrélations très faibles ou inexistantes avec la fréquence d'entraînement, le nombre de kilomètres parcourus et le nombre de compétitions par an. Il en va de même pour les clubs Strava et la fréquence de consultation.

```{r}
glue ("Rappel : l'alpha de Cronbach sur le SIS est {cronbachSIS$alpha}, sur le score OSF est {cronbachOSF$alpha} et sur le score EXPO {cronbachExpo$alpha}.")
```


Le nombre de kudos reçus est faiblement corrélé au nombre d'entraînements par semaine et modérément corrélé au nombre de kilomètres parcourus.

La fréquence de publication présente une corrélation élevée avec l'entraînement et les kilomètres parcourus, ce qui est intuitif : plus on court, plus on publie.

Le nombre d'abonnés et d'abonnements est modérément corrélé avec l'entraînement et les kilomètres parcourus : plus on a de relations sur Strava, plus on court fréquemment et sur de plus longues distances.

L’ancienneté sur Strava ne semble pas avoir d’impact notable sur ces comportements.

Enfin, les corrélations avec le nombre de compétitions par an restent faibles, ce qui indique que l'utilisation de Strava influence peu la participation aux compétitions.

Par ailleurs, il semble existe un lien faible entre la catégorie d'abonnement (gratuit ou payant) et les types d'objectifs (20K, 50K, 100K ou 100M) en 2025.

Enfin, les utilisations qui ont un compte payant ont un nombre d'entraînements par semaine et un nombre de kilomètres par semaine significativement plus élévés que les utilisateurs qui ont un compte gratuit.


```{r correlations strava et pratique cap}
### SIS – Compétitions
cor_SIS_Compétitions <- round(cor(data$SCORE_SIS_TOTAL, data$Compétitions, use="complete.obs"),2)
cor_SIS_Compétitionsh <- round(cor(subset(data, Sexe == "1")$SCORE_SIS_TOTAL, subset(data, Sexe == "1")$Compétitions, use="complete.obs"),2)
cor_SIS_Compétitionsf <- round(cor(subset(data, Sexe == "2")$SCORE_SIS_TOTAL, subset(data, Sexe == "2")$Compétitions, use="complete.obs"),2)

#### Expo – Compétitions
cor_EXPO_Compétitions <- round(cor(data$SCORE_EXPO, data$Compétitions, use="complete.obs"),2)
cor_EXPO_Compétitionsh <- round(cor(subset(data, Sexe == "1")$SCORE_EXPO, subset(data, Sexe == "1")$Compétitions, use="complete.obs"),2)
cor_EXPO_Compétitionsf <- round(cor(subset(data, Sexe == "2")$SCORE_EXPO, subset(data, Sexe == "2")$Compétitions, use="complete.obs"),2)
#### OSF – Compétitions
cor_OSF_Compétitions <- round(cor(data$SCORE_OSF, data$Compétitions, use="complete.obs"),2)
cor_OSF_Compétitionsh<- round(cor(subset(data, Sexe == "1")$SCORE_OSF, subset(data, Sexe == "1")$Compétitions, use="complete.obs"),2)
cor_OSF_Compétitionsf <- round(cor(subset(data, Sexe == "2")$SCORE_OSF, subset(data, Sexe == "2")$Compétitions, use="complete.obs"),2)
#### Club Strava- Compétitions
cor_clubstrava_Compétitions <- round(cor(data$Club_Strava, data$Compétitions, use="complete.obs"),2)
cor_clubstrava_Compétitionsh<- round(cor(subset(data, Sexe == "1")$Club_Strava, subset(data, Sexe == "1")$Compétitions, use="complete.obs"),2)
cor_clubstrava_Compétitionsf <- round(cor(subset(data, Sexe == "2")$Club_Strava, subset(data, Sexe == "2")$Compétitions, use="complete.obs"),2)
#### Kudos reçus – compétitions
cor_kudos_Compétitions <- round(cor(data$Kudos_reçus, data$Compétitions, use="complete.obs"),2)
cor_kudos_Compétitionsh<- round(cor(subset(data, Sexe == "1")$Kudos_reçus , subset(data, Sexe == "1")$Compétitions, use="complete.obs"),2)
cor_kudos_Compétitionsf <- round(cor(subset(data, Sexe == "2")$Kudos_reçus, subset(data, Sexe == "2")$Compétitions, use="complete.obs"),2)
#### Freq publications– Compétitions
cor_freqpubli_Compétitions <- round(cor(data$Fréquence_publication, data$Compétitions, use="complete.obs"),2)
cor_freqpubli_Compétitionsh<- round(cor(subset(data, Sexe == "1")$Fréquence_publication, subset(data, Sexe == "1")$Compétitions, use="complete.obs"),2)
cor_freqpubli_Compétitionsf <- round(cor(subset(data, Sexe == "2")$Fréquence_publication, subset(data, Sexe == "2")$Compétitions, use="complete.obs"),2)
#### Freq consultations– Compétitions
cor_freqcons_Compétitions <- round(cor(data$Fréquence_consultation, data$Compétitions, use="complete.obs"),2)
cor_freqcons_Compétitionsh<- round(cor(subset(data, Sexe == "1")$Fréquence_consultation, subset(data, Sexe == "1")$Compétitions, use="complete.obs"),2)
cor_freqcons_Compétitionsf <- round(cor(subset(data, Sexe == "2")$Fréquence_consultation, subset(data, Sexe == "2")$Compétitions, use="complete.obs"),2)

#### Nb abonnements– Compétitions
cor_nbabonnements_Compétitions <- round(cor(data$Nb_abonnements, data$Compétitions, use="complete.obs"),2)
cor_nbabonnements_Compétitionsh<- round(cor(subset(data, Sexe == "1")$Nb_abonnements, subset(data, Sexe == "1")$Compétitions, use="complete.obs"),2)
cor_nbabonnements_Compétitionsf <- round(cor(subset(data, Sexe == "2")$Nb_abonnements, subset(data, Sexe == "2")$Compétitions, use="complete.obs"),2)

#### Nb abonnés– Compétitions
cor_nbabonnés_Compétitions <- round(cor(data$Nb_abonnés, data$Compétitions, use="complete.obs"),2)
cor_nbabonnés_Compétitionsh<- round(cor(subset(data, Sexe == "1")$Nb_abonnés, subset(data, Sexe == "1")$Compétitions, use="complete.obs"),2)
cor_nbabonnés_Compétitionsf <- round(cor(subset(data, Sexe == "2")$Nb_abonnés, subset(data, Sexe == "2")$Compétitions, use="complete.obs"),2)

#### Nb abonnés– Compétitions
cor_nbabonnés_Compétitions <- round(cor(data$Nb_abonnés, data$Compétitions, use="complete.obs"),2)
cor_nbabonnés_Compétitionsh<- round(cor(subset(data, Sexe == "1")$Nb_abonnés, subset(data, Sexe == "1")$Compétitions, use="complete.obs"),2)
cor_nbabonnés_Compétitionsf <- round(cor(subset(data, Sexe == "2")$Nb_abonnés, subset(data, Sexe == "2")$Compétitions, use="complete.obs"),2)


#### Ancienneté Strava - Compétitions
cor_anciennetestrava_Compétitions <- round(cor(data$ Ancienneté_Strava, data$Compétitions, use="complete.obs"),2)
cor_anciennetestrava_Compétitionsh<- round(cor(subset(data, Sexe == "1")$ Ancienneté_Strava, subset(data, Sexe == "1")$Compétitions, use="complete.obs"),2)
cor_anciennetestrava_Compétitionsf <- round(cor(subset(data, Sexe == "2")$ Ancienneté_Strava, subset(data, Sexe == "2")$Compétitions, use="complete.obs"),2)

### SIS – Kilomètres
cor_SIS_Kilomètres <- round(cor(data$SCORE_SIS_TOTAL, data$Kilomètres, use="complete.obs"),2)
cor_SIS_Kilomètresh <- round(cor(subset(data, Sexe == "1")$SCORE_SIS_TOTAL, subset(data, Sexe == "1")$Kilomètres, use="complete.obs"),2)
cor_SIS_Kilomètresf <- round(cor(subset(data, Sexe == "2")$SCORE_SIS_TOTAL, subset(data, Sexe == "2")$Kilomètres, use="complete.obs"),2)
#### Expo – Kilomètres
cor_EXPO_Kilomètres <- round(cor(data$SCORE_EXPO, data$Kilomètres, use="complete.obs"),2)
cor_EXPO_Kilomètresh<- round(cor(subset(data, Sexe == "1")$SCORE_EXPO, subset(data, Sexe == "1")$Kilomètres, use="complete.obs"),2)
cor_EXPO_Kilomètresf <- round(cor(subset(data, Sexe == "2")$SCORE_EXPO, subset(data, Sexe == "2")$Kilomètres, use="complete.obs"),2)
#### OSF – Kilomètres
cor_OSF_Kilomètres <- round(cor(data$SCORE_OSF, data$Kilomètres, use="complete.obs"),2)
cor_OSF_Kilomètresh<- round(cor(subset(data, Sexe == "1")$SCORE_OSF, subset(data, Sexe == "1")$Kilomètres, use="complete.obs"),2)
cor_OSF_Kilomètresf <- round(cor(subset(data, Sexe == "2")$SCORE_OSF, subset(data, Sexe == "2")$Kilomètres, use="complete.obs"),2)
#### Club Strava- Kilomètres
cor_clubstrava_Kilomètres <- round(cor(data$Club_Strava, data$Kilomètres, use="complete.obs"),2)
cor_clubstrava_Kilomètresh<- round(cor(subset(data, Sexe == "1")$Club_Strava, subset(data, Sexe == "1")$Kilomètres, use="complete.obs"),2)
cor_clubstrava_Kilomètresf <- round(cor(subset(data, Sexe == "2")$Club_Strava, subset(data, Sexe == "2")$Kilomètres, use="complete.obs"),2)
#### Kudos reçus – Kilomètres
cor_kudos_Kilomètres <- round(cor(data$Kudos_reçus, data$Kilomètres, use="complete.obs"),2)
cor_kudos_Kilomètresh<- round(cor(subset(data, Sexe == "1")$Kudos_reçus , subset(data, Sexe == "1")$Kilomètres, use="complete.obs"),2)
cor_kudos_Kilomètresf <- round(cor(subset(data, Sexe == "2")$Kudos_reçus, subset(data, Sexe == "2")$Kilomètres, use="complete.obs"),2)
#### Freq publications– Kilomètres
cor_freqpubli_Kilomètres <- round(cor(data$Fréquence_publication, data$Kilomètres, use="complete.obs"),2)
cor_freqpubli_Kilomètresh<- round(cor(subset(data, Sexe == "1")$Fréquence_publication, subset(data, Sexe == "1")$Kilomètres, use="complete.obs"),2)
cor_freqpubli_Kilomètresf <- round(cor(subset(data, Sexe == "2")$Fréquence_publication, subset(data, Sexe == "2")$Kilomètres, use="complete.obs"),2)
#### Freq consultations– Kilomètres
cor_freqcons_Kilomètres <- round(cor(data$Fréquence_consultation, data$Kilomètres, use="complete.obs"),2)
cor_freqcons_Kilomètresh<- round(cor(subset(data, Sexe == "1")$Fréquence_consultation, subset(data, Sexe == "1")$Kilomètres, use="complete.obs"),2)
cor_freqcons_Kilomètresf <- round(cor(subset(data, Sexe == "2")$Fréquence_consultation, subset(data, Sexe == "2")$Kilomètres, use="complete.obs"),2)

#### Nb abonnements– Kilomètres
cor_nbabonnements_Kilomètres <- round(cor(data$Nb_abonnements, data$Kilomètres, use="complete.obs"),2)
cor_nbabonnements_Kilomètresh<- round(cor(subset(data, Sexe == "1")$Nb_abonnements, subset(data, Sexe == "1")$Kilomètres, use="complete.obs"),2)
cor_nbabonnements_Kilomètresf <- round(cor(subset(data, Sexe == "2")$Nb_abonnements, subset(data, Sexe == "2")$Kilomètres, use="complete.obs"),2)

#### Nb abonnés– Kilomètres
cor_nbabonnés_Kilomètres <- round(cor(data$Nb_abonnés, data$Kilomètres, use="complete.obs"),2)
cor_nbabonnés_Kilomètresh<- round(cor(subset(data, Sexe == "1")$Nb_abonnés, subset(data, Sexe == "1")$Kilomètres, use="complete.obs"),2)
cor_nbabonnés_Kilomètresf <- round(cor(subset(data, Sexe == "2")$Nb_abonnés, subset(data, Sexe == "2")$Kilomètres, use="complete.obs"),2)

#### Nb abonnés– Kilomètres
cor_nbabonnés_Kilomètres <- round(cor(data$Nb_abonnés, data$Kilomètres, use="complete.obs"),2)
cor_nbabonnés_Kilomètresh<- round(cor(subset(data, Sexe == "1")$Nb_abonnés, subset(data, Sexe == "1")$Kilomètres, use="complete.obs"),2)
cor_nbabonnés_Kilomètresf <- round(cor(subset(data, Sexe == "2")$Nb_abonnés, subset(data, Sexe == "2")$Kilomètres, use="complete.obs"),2)


#### Ancienneté Strava - Kilomètres
cor_anciennetestrava_Kilomètres <- round(cor(data$ Ancienneté_Strava, data$Kilomètres, use="complete.obs"),2)
cor_anciennetestrava_Kilomètresh<- round(cor(subset(data, Sexe == "1")$Ancienneté_Strava, subset(data, Sexe == "1")$Kilomètres, use="complete.obs"),2)
cor_anciennetestrava_Kilomètresf <- round(cor(subset(data, Sexe == "2")$Ancienneté_Strava, subset(data, Sexe == "2")$Kilomètres, use="complete.obs"),2)


### SIS – Frequence_pratique
cor_SIS_Frequence_pratique <- round(cor(data$SCORE_SIS_TOTAL, data$Frequence_pratique, use="complete.obs"),2)
cor_SIS_Frequence_pratiqueh <- round(cor(subset(data, Sexe == "1")$SCORE_SIS_TOTAL, subset(data, Sexe == "1")$Frequence_pratique, use="complete.obs"),2)
cor_SIS_Frequence_pratiquef <- round(cor(subset(data, Sexe == "2")$SCORE_SIS_TOTAL, subset(data, Sexe == "2")$Frequence_pratique, use="complete.obs"),2)
#### Expo – Frequence_pratique
cor_EXPO_Frequence_pratique <- round(cor(data$SCORE_EXPO, data$Frequence_pratique, use="complete.obs"),2)
cor_EXPO_Frequence_pratiqueh<- round(cor(subset(data, Sexe == "1")$SCORE_EXPO, subset(data, Sexe == "1")$Frequence_pratique, use="complete.obs"),2)
cor_EXPO_Frequence_pratiquef <- round(cor(subset(data, Sexe == "2")$SCORE_EXPO, subset(data, Sexe == "2")$Frequence_pratique, use="complete.obs"),2)
#### OSF – Frequence_pratique
cor_OSF_Frequence_pratique <- round(cor(data$SCORE_OSF, data$Frequence_pratique, use="complete.obs"),2)
cor_OSF_Frequence_pratiqueh<- round(cor(subset(data, Sexe == "1")$SCORE_OSF, subset(data, Sexe == "1")$Frequence_pratique, use="complete.obs"),2)
cor_OSF_Frequence_pratiquef <- round(cor(subset(data, Sexe == "2")$SCORE_OSF, subset(data, Sexe == "2")$Frequence_pratique, use="complete.obs"),2)
#### Club Strava- Frequence_pratique
cor_clubstrava_Frequence_pratique <- round(cor(data$Club_Strava, data$Frequence_pratique, use="complete.obs"),2)
cor_clubstrava_Frequence_pratiqueh<- round(cor(subset(data, Sexe == "1")$Club_Strava, subset(data, Sexe == "1")$Frequence_pratique, use="complete.obs"),2)
cor_clubstrava_Frequence_pratiquef <- round(cor(subset(data, Sexe == "2")$Club_Strava, subset(data, Sexe == "2")$Frequence_pratique, use="complete.obs"),2)
#### Kudos reçus – Frequence_pratique
cor_kudos_Frequence_pratique <- round(cor(data$Kudos_reçus, data$Frequence_pratique, use="complete.obs"),2)
cor_kudos_Frequence_pratiqueh<- round(cor(subset(data, Sexe == "1")$Kudos_reçus , subset(data, Sexe == "1")$Frequence_pratique, use="complete.obs"),2)
cor_kudos_Frequence_pratiquef <- round(cor(subset(data, Sexe == "2")$Kudos_reçus, subset(data, Sexe == "2")$Frequence_pratique, use="complete.obs"),2)
#### Freq publications– Frequence_pratique
cor_freqpubli_Frequence_pratique <- round(cor(data$Fréquence_publication, data$Frequence_pratique, use="complete.obs"),2)
cor_freqpubli_Frequence_pratiqueh<- round(cor(subset(data, Sexe == "1")$ Fréquence_publication, subset(data, Sexe == "1")$Frequence_pratique, use="complete.obs"),2)
cor_freqpubli_Frequence_pratiquef <- round(cor(subset(data, Sexe == "2")$ Fréquence_publication, subset(data, Sexe == "2")$Frequence_pratique, use="complete.obs"),2)
#### Freq consultations– Frequence_pratique
cor_freqcons_Frequence_pratique <- round(cor(data$Fréquence_consultation, data$Frequence_pratique, use="complete.obs"),2)
cor_freqcons_Frequence_pratiqueh<- round(cor(subset(data, Sexe == "1")$ Fréquence_consultation, subset(data, Sexe == "1")$Frequence_pratique, use="complete.obs"),2)
cor_freqcons_Frequence_pratiquef <- round(cor(subset(data, Sexe == "2")$ Fréquence_consultation, subset(data, Sexe == "2")$Frequence_pratique, use="complete.obs"),2)

#### Nb abonnements– Frequence_pratique
cor_nbabonnements_Frequence_pratique <- round(cor(data$Nb_abonnements, data$Frequence_pratique, use="complete.obs"),2)
cor_nbabonnements_Frequence_pratiqueh<- round(cor(subset(data, Sexe == "1")$Nb_abonnements, subset(data, Sexe == "1")$Frequence_pratique, use="complete.obs"),2)
cor_nbabonnements_Frequence_pratiquef <- round(cor(subset(data, Sexe == "2")$Nb_abonnements, subset(data, Sexe == "2")$Frequence_pratique, use="complete.obs"),2)

#### Nb abonnés– Frequence_pratique
cor_nbabonnés_Frequence_pratique <- round(cor(data$Nb_abonnés, data$Frequence_pratique, use="complete.obs"),2)
cor_nbabonnés_Frequence_pratiqueh<- round(cor(subset(data, Sexe == "1")$Nb_abonnés, subset(data, Sexe == "1")$Frequence_pratique, use="complete.obs"),2)
cor_nbabonnés_Frequence_pratiquef <- round(cor(subset(data, Sexe == "2")$Nb_abonnés, subset(data, Sexe == "2")$Frequence_pratique, use="complete.obs"),2)

#### Nb abonnés– Frequence_pratique
cor_nbabonnés_Frequence_pratique <- round(cor(data$Nb_abonnés, data$Frequence_pratique, use="complete.obs"),2)
cor_nbabonnés_Frequence_pratiqueh<- round(cor(subset(data, Sexe == "1")$Nb_abonnés, subset(data, Sexe == "1")$Frequence_pratique, use="complete.obs"),2)
cor_nbabonnés_Frequence_pratiquef <- round(cor(subset(data, Sexe == "2")$Nb_abonnés, subset(data, Sexe == "2")$Frequence_pratique, use="complete.obs"),2)


#### Ancienneté Strava - Frequence_pratique
cor_anciennetestrava_Frequence_pratique <- round(cor(data$Ancienneté_Strava, data$Frequence_pratique, use="complete.obs"),2)
cor_anciennetestrava_Frequence_pratiqueh<- round(cor(subset(data, Sexe == "1")$Ancienneté_Strava, subset(data, Sexe == "1")$Frequence_pratique, use="complete.obs"),2)
cor_anciennetestrava_Frequence_pratiquef <- round(cor(subset(data, Sexe == "2")$Ancienneté_Strava, subset(data, Sexe == "2")$Frequence_pratique, use="complete.obs"),2)
```

#### Corrélations
```{r affichage table pratique strava}
table_Pratique_Correlations <- data.frame(
  Variable = c("SCORE SIS ", "SCORE OSF ", "SCORE EXPO ", "Clubs Strava ", "Kudos reçus ", "Fréquence publication ", "Fréquence consultation ", "Nombre d'abonnés ", "Nombre d'abonnements ", "Ancienneté Strava "),
  Fréquence_pratique = c(cor_SIS_Frequence_pratique, cor_OSF_Frequence_pratique, cor_EXPO_Frequence_pratique, cor_clubstrava_Frequence_pratique, cor_kudos_Frequence_pratique, cor_freqpubli_Frequence_pratique, cor_freqcons_Frequence_pratique, cor_nbabonnés_Frequence_pratique, cor_nbabonnements_Frequence_pratique, cor_anciennetestrava_Frequence_pratique),
    Volume = c(cor_SIS_Kilomètres, cor_OSF_Kilomètres, cor_EXPO_Kilomètres, cor_clubstrava_Kilomètres, cor_kudos_Kilomètres, cor_freqpubli_Kilomètres, cor_freqcons_Kilomètres, cor_nbabonnés_Kilomètres, cor_nbabonnements_Kilomètres, cor_anciennetestrava_Kilomètres),
  Compétitions = c(cor_SIS_Compétitions, cor_OSF_Compétitions, cor_EXPO_Compétitions, cor_clubstrava_Compétitions, cor_kudos_Compétitions, cor_freqpubli_Compétitions, cor_freqcons_Compétitions, cor_nbabonnés_Compétitions, cor_nbabonnements_Compétitions, cor_anciennetestrava_Compétitions))

table_Pratique_Correlations$Fréquence_pratique <- case_when(
  table_Pratique_Correlations$Fréquence_pratique > 0.4 ~ 
    paste0('<span style="color:green;">', table_Pratique_Correlations$Fréquence_pratique, '</span>'),
  table_Pratique_Correlations$Fréquence_pratique > 0.3 ~ 
    paste0('<span style="color:#FC4C02;">', table_Pratique_Correlations$Fréquence_pratique, '</span>'),
  table_Pratique_Correlations$Fréquence_pratique > 0.2 ~ 
    paste0('<span style="color:red;">', table_Pratique_Correlations$Fréquence_pratique, '</span>'),
  TRUE ~ as.character(table_Pratique_Correlations$Fréquence_pratique)
)

table_Pratique_Correlations$Volume <- case_when(
  table_Pratique_Correlations$Volume > 0.4 ~ 
    paste0('<span style="color:green;">', table_Pratique_Correlations$Volume, '</span>'),
  table_Pratique_Correlations$Volume > 0.3 ~ 
    paste0('<span style="color:#FC4C02;">', table_Pratique_Correlations$Volume, '</span>'),
  table_Pratique_Correlations$Volume > 0.2 ~ 
    paste0('<span style="color:red;">', table_Pratique_Correlations$Volume, '</span>'),
  TRUE ~ as.character(table_Pratique_Correlations$Volume))

table_Pratique_Correlations$Compétitions <- case_when(
  table_Pratique_Correlations$Compétitions > 0.4 ~ 
    paste0('<span style="color:green;">', table_Pratique_Correlations$Compétitions, '</span>'),
  table_Pratique_Correlations$Compétitions > 0.3 ~ 
    paste0('<span style="color:#FC4C02;">', table_Pratique_Correlations$Compétitions, '</span>'),
  table_Pratique_Correlations$Compétitions > 0.2 ~ 
    paste0('<span style="color:red;">', table_Pratique_Correlations$Compétitions, '</span>'),
  TRUE ~ as.character(table_Pratique_Correlations$Compétitions) 
)

kable(table_Pratique_Correlations, format = "html", escape = FALSE)

```


```{r}
### Lien Niveau et variables strava
chi2_typeabonnement_niveau <-chisq.test (table(data$Type_abonnement, data$Niveau))
cramer_typeabonnement_niveau <- assocstats(table(data$Type_abonnement, data$Niveau))

### Lien Type de coureur et variable strava
chi2_typeabonnement_Type_coureur <-chisq.test (table(data$Type_abonnement, data$Type_coureur))
cramer_typeabonnement_Type_coureur <- assocstats(table(data$Type_abonnement, data$Type_coureur))
### Lien Coach et variable strava

chi2_typeabonnement_Coach <-chisq.test (table(data$Type_abonnement, data$Coach))
cramer_typeabonnement_Coach <- assocstats(table(data$Type_abonnement, data$Coach))


### Lien programme et variable strava

chi2_typeabonnement_Programme <-chisq.test (table(data$Type_abonnement, data$Programme))
cramer_typeabonnement_Programme <- assocstats(table(data$Type_abonnement, data$Programme))


### Lien objectif et variable strava

chi2_typeabonnement_Objectif_KM <-chisq.test (table(data$Type_abonnement, data$Objectif_KM))
cramer_typeabonnement_Objectif_KM <- assocstats(table(data$Type_abonnement, data$Objectif_KM))


### Lien blessure et variable strava

chi2_typeabonnement_Blessure <-chisq.test (table(data$Type_abonnement, data$Blessure))
cramer_typeabonnement_Blessure <- assocstats(table(data$Type_abonnement, data$Blessure))


### Lien pause blessure et variable strava

chi2_typeabonnement_Pause_blessure <-chisq.test (table(data$Type_abonnement, data$Pause_blessure))
cramer_typeabonnement_Pause_blessure <- assocstats(table(data$Type_abonnement, data$Pause_blessure))

```

#### Visualisation graphique{.tabset}

##### Kudos - Kilomètres par semaine
```{r graphique kudo kms par semaine}
ggplot(data, aes(x = Kudos_reçus, y = Kilomètres, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_kudos_Kilomètres)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_kudos_Kilomètresh)), 
                color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_kudos_Kilomètresf)), 
                color = "#4F4F4F") +
    scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F")) +
    labs(title = "Nombre de kilomètres par semaine en fonction du nombre de kudos reçus en moyenne par activité",
         x = "Nombre de kudos reçus en moyenne par activité",
         y = "Nombre de kilomètres par semaine",
         color = "Sexe",
         linetype = "Régression linéaire") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"), color = guide_legend(title = "Sexe"))
```


##### Fréquence de publication - Kilomètres par semaine
```{r graphique freq publi kms par semaine}
ggplot(data, aes(x = Fréquence_publication, y = Kilomètres, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_freqpubli_Kilomètres)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_freqpubli_Kilomètresh)), 
                color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_freqpubli_Kilomètresf)), 
                color = "#4F4F4F") +
    scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F")) +
    labs(title = "Nombre de kilomètres par semaine en fonction de la fréquence de publication",
         x = "Nombre de publication par semaine",
         y = "Nombre de kilomètres par semaine",
         color = "Sexe",
         linetype = "Régression avec R") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"), color = guide_legend(title = "Sexe"))

```

##### Fréquence de publication - Fréquence d'entraînement
```{r graphique freq publi freq entrainement par semaine}
ggplot(data, aes(x = Fréquence_publication, y = Frequence_pratique, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_freqpubli_Frequence_pratique)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_freqpubli_Frequence_pratiqueh)), 
                color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_freqpubli_Frequence_pratiquef)), 
                color = "#4F4F4F") +
    scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F")) +
    labs(title = "Nombre d'entraînements par semaine en fonction de la fréquence de publication",
         x = "Nombre de publications par semaine",
         y = "Nombre d'entraînements par semaine",
         color = "Sexe",
         linetype = "Régression avec R") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"), color = guide_legend(title = "Sexe"))

```

##### Nombre d'abonnés - Fréquence d'entraînement
```{r graphique nb abonnés freq entrainement par semaine}
ggplot(data, aes(x = Nb_abonnés, y = Frequence_pratique, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_nbabonnés_Frequence_pratique)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_nbabonnés_Frequence_pratiqueh)), 
                color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_nbabonnés_Frequence_pratiquef)), 
                color = "#4F4F4F") +
    scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F")) +
    labs(title = "Nombre d'entraînements par semaine en fonction du nombre d'abonnés",
         x = "Nombre d'abonnés",
         y = "Nombre d'entraînements par semaine",
         color = "Sexe",
         linetype = "Régression avec R") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"), color = guide_legend(title = "Sexe"))

```

##### Nombres d'abonnés - Kilomètres par semaine
```{r graphique nb abonnés kms par semaine}
ggplot(data, aes(x = Nb_abonnés, y = Kilomètres, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_nbabonnés_Kilomètres)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_nbabonnés_Kilomètresh)), 
                color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_nbabonnés_Kilomètresf)), 
                color = "#4F4F4F") +
    scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F")) +
    labs(title = "Nombre de kilomètres par semaine en fonction du nombre d'abonnés",
         x = "Nombre d'abonnés",
         y = "Nombre de kilomètres par semaine",
         color = "Sexe",
         linetype = "Régression avec R") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"), color = guide_legend(title = "Sexe"))

```


##### Nombre d'abonnements - Fréquence d'entraînement
```{r graphique nb abonnements freq entrainement par semaine}
ggplot(data, aes(x = Nb_abonnements, y = Frequence_pratique, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_nbabonnements_Frequence_pratique)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_nbabonnements_Frequence_pratiqueh)), 
                color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_nbabonnements_Frequence_pratiquef)), 
                color = "#4F4F4F") +
    scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F")) +
    labs(title = "Nombre d'entraînements par semaine en fonction du nombre d'abonnements",
         x = "Nombre d'abonnements",
         y = "Nombre d'entraînements par semaine",
         color = "Sexe",
         linetype = "Régression avec R") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"), color = guide_legend(title = "Sexe"))

```

##### Nombres d'abonnements - Kilomètres par semaine
```{r graphique nb abonnements kms par semaine}
ggplot(data, aes(x = Nb_abonnements, y = Kilomètres, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_nbabonnements_Kilomètres)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_nbabonnements_Kilomètresh)), 
                color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_nbabonnements_Kilomètresf)), 
                color = "#4F4F4F") +
    scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F")) +
    labs(title = "Nombre de kilomètres par semaine en fonction du nombre d'abonnements",
         x = "Nombre d'abonnements",
         y = "Nombre de kilomètres par semaine",
         color = "Sexe",
         linetype = "Régression avec R") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"), color = guide_legend(title = "Sexe"))

```



#### Khi² et Cramer
```{r}
table_Pratique_Independance <- data.frame(
  Variable = c("Lien catégorie abonnement et niveau", "Lien catégorie abonnement et type coureur", "Lien catégorie abonnement et coach", "Lien catégorie abonnement et programme", "Lien catégorie abonnement et objectif", "Lien catégorie abonnement et blessure", "Lien catégorie abonnement et pause"),
  Khi2_indépendance = round(c(chi2_typeabonnement_niveau$statistic, chi2_typeabonnement_Type_coureur$statistic, chi2_typeabonnement_Coach$statistic,  chi2_typeabonnement_Programme$statistic, chi2_typeabonnement_Objectif_KM$statistic,  chi2_typeabonnement_Blessure$statistic, chi2_typeabonnement_Pause_blessure$statistic),2),
  P.value = ifelse(c(chi2_typeabonnement_niveau$p.value,  chi2_typeabonnement_Type_coureur$p.value, chi2_typeabonnement_Coach$p.value,  chi2_typeabonnement_Programme$p.value,  chi2_typeabonnement_Objectif_KM$p.value,  chi2_typeabonnement_Blessure$p.value, chi2_typeabonnement_Pause_blessure$p.value) < 0.001, "< 0.001", " sup. 0.001"),
  Coefficient_Cramer = round(c(cramer_typeabonnement_niveau$cramer,  cramer_typeabonnement_Type_coureur$cramer, cramer_typeabonnement_Coach$cramer,  cramer_typeabonnement_Programme$cramer, cramer_typeabonnement_Objectif_KM$cramer,  cramer_typeabonnement_Blessure$cramer, cramer_typeabonnement_Pause_blessure$cramer),2)
)

kable(table_Pratique_Independance, format = "html", escape = FALSE)

```

#### Visualisation graphique{.tabset}

##### Niveau et catégorie d'abonnement
```{r heatmap niveau et categorie abonnement}
table_comparaison_typeabonnement_niveau <- data.frame(
  Type_abonnement = rep(rownames(chi2_typeabonnement_niveau$observed), times = ncol(chi2_typeabonnement_niveau$observed)),
  Niveau = rep(colnames(chi2_typeabonnement_niveau$observed), each = nrow(chi2_typeabonnement_niveau$observed)),
  Observé = as.vector(chi2_typeabonnement_niveau$observed),
  Attendu = as.vector(chi2_typeabonnement_niveau$expected)
)

table_comparaison_typeabonnement_niveau$Type_abonnement <- factor(
  table_comparaison_typeabonnement_niveau$Type_abonnement, 
  levels = c("1", "2"), 
  labels = c("Gratuit", "Payant")
)

table_comparaison_typeabonnement_niveau$Niveau <- factor(
  table_comparaison_typeabonnement_niveau$Niveau, 
  levels = c("1", "2", "3", "4"),  
  labels = c("Débutant", "Intermédiaire", "Confirmé", "Expert")
)

kable(table_comparaison_typeabonnement_niveau, format = "html", escape = FALSE)

heatmap_categorieabonnement_niveau <- data %>%
    filter(!is.na(Type_abonnement), !is.na(Niveau)) %>%
    group_by(Type_abonnement, Niveau) %>%
    summarise(n = n(), .groups = "drop")

heatmap_categorieabonnement_niveau <- heatmap_categorieabonnement_niveau %>%
    mutate(Niveau = recode_factor(Niveau, `1` = "Débutant", `2` = "Intermédiaire", `3` = "Confirmé" , `4` = "Expert"),
           Type_abonnement = recode_factor(Type_abonnement, `1` = "Gratuit", `2` = "Payant"))

ggplot(heatmap_categorieabonnement_niveau, aes(x = Niveau, y = Type_abonnement, fill = n)) +
    geom_tile(color = "#eff4f9") +
    scale_fill_gradient(low = "#eff4f9", high = "#FC4C02") +
    geom_text(aes(label = sprintf("%.1f%%", (n / sum(n)) * 100)), color = "black")+
    labs(title = "",
         x = "Niveau", 
         y = "Catégorie abonnement",
         fill = "Nombre de personnes") +
    theme_minimal() +
  scale_y_discrete()+
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


##### Type de coureur et catégorie d'abonnement
```{r type abonnement type coureur}

table_comparaison_typeabonnement_typecoureur <- data.frame(
  Type_abonnement = rep(rownames(chi2_typeabonnement_Type_coureur$observed), times = ncol(chi2_typeabonnement_Type_coureur$observed)),
  Type_coureur = rep(colnames(chi2_typeabonnement_Type_coureur$observed), each = nrow(chi2_typeabonnement_Type_coureur$observed)),
  Observé = as.vector(chi2_typeabonnement_Type_coureur$observed),
  Attendu = as.vector(chi2_typeabonnement_Type_coureur$expected)
)

table_comparaison_typeabonnement_typecoureur$Type_abonnement <- factor(
  table_comparaison_typeabonnement_typecoureur$Type_abonnement, 
  levels = c("1", "2"), 
  labels = c("Gratuit", "Payant")
)

table_comparaison_typeabonnement_typecoureur$Type_coureur <- factor(
  table_comparaison_typeabonnement_typecoureur$Type_coureur, 
  levels = c("1 1 1", "1 2 1", "1 1 2", "1 2 2", "2 1 1", "2 2 1", "2 1 2", "2 2 2"),  
  labels = c("Route, club, seul", "Route, pas de club, seul", "Route, club, en groupe", "Route, pas de club, en groupe", "Trail, club, seul", "Tail, pas de club, seul", "Trail, club, en groupe", "Trail, pas de club, en groupe")
)



kable(table_comparaison_typeabonnement_typecoureur, format = "html", escape = FALSE)

heatmap_categorieabonnement_typecoureur <- data %>%
    filter(!is.na(Type_abonnement), !is.na(Type_coureur)) %>%
    group_by(Type_abonnement, Type_coureur) %>%
    summarise(n = n(), .groups = "drop")

heatmap_categorieabonnement_typecoureur <- heatmap_categorieabonnement_typecoureur %>%
    mutate(Type_coureur = recode_factor(Type_coureur, `1 1 1` = "Route, club, seul", `1 2 1` = "Route, pas de club, seul", `1 1 2` = "Route, club, en groupe" , `1 2 2` = "Route, pas de club, en groupe", `2 1 1` = "Trail, club, seul", `2 2 1` = "Tail, pas de club, seul", `2 1 2` = "Trail, club, en groupe" , `2 2 2` = "Trail, pas de club, en groupe"),
           Type_abonnement = recode_factor(Type_abonnement, `1` = "Gratuit", `2` = "Payant"))


ggplot(heatmap_categorieabonnement_typecoureur, aes(x = Type_coureur, y = Type_abonnement, fill = n)) +
    geom_tile(color = "#eff4f9") +
    scale_fill_gradient(low = "#eff4f9", high = "#FC4C02") +
    geom_text(aes(label = sprintf("%.1f%%", (n / sum(n)) * 100)), color = "black")+
    labs(title = "",
         x = "Type de coureur (Lieu/Club/Mode)", 
         y = "Catégorie abonnement",
         fill = "Nombre de personnes") +
    theme_minimal() +
  scale_y_discrete()+
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
```



##### Objectif et catégorie d'abonnement
```{r heatmap objectif et catégorie abonnement}
table_comparaison_typeabonnement_objectif <- data.frame(
  Type_abonnement = rep(rownames(chi2_typeabonnement_Objectif_KM$observed), times = ncol(chi2_typeabonnement_Objectif_KM$observed)),
  Objectif_KM = rep(colnames(chi2_typeabonnement_Objectif_KM$observed), each = nrow(chi2_typeabonnement_Objectif_KM$observed)),
  Observé = as.vector(chi2_typeabonnement_Objectif_KM$observed),
  Attendu = as.vector(chi2_typeabonnement_Objectif_KM$expected)
)


table_comparaison_typeabonnement_objectif$Type_abonnement <- factor(
  table_comparaison_typeabonnement_objectif$Type_abonnement, 
  levels = c("1", "2"), 
  labels = c("Gratuit", "Payant")
)

table_comparaison_typeabonnement_objectif$Objectif_KM<- factor(
  table_comparaison_typeabonnement_objectif$Objectif_KM, 
  levels = c("0", "1", "2", "3", "4"),  
  labels = c("Pas d'objectif", "20 K", "50 K", "100 K", "100 M")
)

kable(table_comparaison_typeabonnement_objectif, format = "html", escape = FALSE)

heatmap_categorieabonnement_objectif <- data %>%
    filter(!is.na(Type_abonnement), !is.na(Objectif_KM)) %>%
    group_by(Type_abonnement, Objectif_KM) %>%
    summarise(n = n(), .groups = "drop")

heatmap_categorieabonnement_objectif <- heatmap_categorieabonnement_objectif %>%
    mutate(Objectif_KM = recode_factor(Objectif_KM, `0` = "Pas d'objectif", `1` = "20 K", `2` = "50 K", `3` = "100 K" , `4` = "100 M"),
           Type_abonnement = recode_factor(Type_abonnement, `1` = "Gratuit", `2` = "Payant"))

ggplot(heatmap_categorieabonnement_objectif, aes(x = Objectif_KM, y = Type_abonnement, fill = n)) +
    geom_tile(color = "#eff4f9") +
    scale_fill_gradient(low = "#eff4f9", high = "#FC4C02") +
    geom_text(aes(label = sprintf("%.1f%%", (n / sum(n)) * 100)), color = "black")+
    labs(title = "",
         x = "Objectif 2025", 
         y = "Catégorie abonnement",
         fill = "Nombre de personnes") +
    theme_minimal() +
  scale_y_discrete()+
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


#### Test t de Student
```{r test t student pour type abonnement et freq pratique}
t_typeabonnement_freqpratique <- t.test(as.numeric(Frequence_pratique) ~ as.factor(Type_abonnement), data = data, var.equal = TRUE)

moyennesfreqpratique_typeabonnement <- data %>%
    group_by(Type_abonnement) %>%
    summarise(Moyenne = mean(Frequence_pratique, na.rm = TRUE))

t_typeabonnement_km <- t.test(as.numeric(Kilomètres) ~ as.factor(Type_abonnement), data = data, var.equal = TRUE)

moyenneskm_typeabonnement <- data %>%
    group_by(Type_abonnement) %>%
    summarise(Moyenne = mean(Kilomètres, na.rm = TRUE))

t_typeabonnement_competitions <- t.test(as.numeric(Compétitions) ~ as.factor(Type_abonnement), data = data, var.equal = TRUE)

moyennescompetitions_typeabonnement <- data %>%
    group_by(Type_abonnement) %>%
    summarise(Moyenne = mean(Compétitions, na.rm = TRUE))

table_typeabonnement_pratique <- data.frame(
    Variable = c(
        "Type d'abonnement et entrainement par semaine", 
        "Type d'abonnement et kilomètres par semaine", 
        "Type d'abonnement et nombre de compétitions"
    ),
    Student = c(
        as.numeric(t_typeabonnement_freqpratique$statistic), 
        as.numeric(t_typeabonnement_km$statistic), 
        as.numeric(t_typeabonnement_competitions$statistic)
    ),
    p_value = c(
        ifelse(t_typeabonnement_freqpratique$p.value < 0.001, "<0.001", "sup. 0.001"),
        ifelse(t_typeabonnement_km$p.value < 0.001, "<0.001", "sup. 0.001"),
        ifelse(t_typeabonnement_competitions$p.value < 0.001, "<0.001", "sup. 0.001")
    ),
    Gratuit = c(
        moyennesfreqpratique_typeabonnement$Moyenne[1], 
        moyenneskm_typeabonnement$Moyenne[1], 
        moyennescompetitions_typeabonnement$Moyenne[1]
    ),
    Payant = c(
        moyennesfreqpratique_typeabonnement$Moyenne[2], 
        moyenneskm_typeabonnement$Moyenne[2], 
        moyennescompetitions_typeabonnement$Moyenne[2]
    )
)

kable(table_typeabonnement_pratique, format = "html", escape = FALSE)

```

#### Visualisation graphique
```{r}
(ggplot(data, aes(x = factor(Type_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")),
                 y = Frequence_pratique,
                 fill = factor(Type_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Type d'abonnement",
       y = "Fréquence d'entraînement",
       fill = "Type d'abonnement") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() |
   
   ggplot(data, aes(x = factor(Type_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")),
                 y = Kilomètres,
                 fill = factor(Type_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Type d'abonnement",
       y = "Kilomètres par semaine",
       fill = "Type d'abonnement") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
  
  )
```


# Mesure de l'auto-présentation

La présentation de soi est la tentative d’un individu de contrôler la façon dont les autres le perçoivent ^3^. Dans l'article de Russell, il y a des témoignanges sur le contrôle : « Si c'est une course très lente, je ne la mettrais peut-être pas sur Strava.», « Je n'aime pas poster des courses qui ne font pas au moins 3 miles, parce que c'est un peu comme une course de mauviette, comme si vous ne terminiez pas au moins un 5K, pour moi, ce n'est pas une bonne journée. Vous devriez au moins être capable de faire un 5 km. Parce que je ne veux pas que mes followers se demandent pourquoi elle est si lente », « Parfois, je cours un ou deux kilomètres de plus, juste parce que ça a l'air mieux sur Strava. ». ^3^

Mais il y a également des témoignages qui se rapproche plus d'une présentation authentique : « Et donc je suppose que je me sens comme... plus capable d'être honnête et moi-même sur Strava et c'est moins une question de photos et d'image et plus une question de ma propre course », « Même si la course n'a pas été géniale, je dirai à l'avance que j'ai eu des difficultés mentales aujourd'hui... J'ai l'impression d'être très ouvert sur Strava en ce qui concerne les bons et les mauvais jours.» ^3^

Le Self-presentation and Upward Social Comparison Inclination Scale mesure l'auto-présentation sur les réseaux sociaux. ^10^ ^17^ L'échelle comporte initialement 7 items qui ont été traduits et adaptés à l'étude. Le SPAUSCIS mesure le degré de focalisation sur l'auto-présentation et la comparaison sociale ascendante sur les réseaux sociaux. Il évalue plusieurs aspects du comportement des adolescents sur les réseaux sociaux, notamment la recherche de feedback, l'auto-présentation "améliorée" et la comparaison sociale avec des personnes perçues commet "meilleures". Il est à noter que cette échelle a été utilisée auprès d'adolescent. Dans l'étude de Hjetland ^17^, l'alpha est de 0.87.

Suite au pré-test, un item a été enlevé dans l'étude sur Strava ("It is important to me that my posts receive many likes and/or comments"). L'échelle traduite et adaptée comporte donc **6 items**.

Un score bas au SPAUSCIS indique que l'utilisateur accorde peu d'importance à son image sur Strava (ne recherche pas activement du feedback, pas de stratégie d'auto-présentation, pas de comparaison aux utilisateurs perçus comme "meilleurs") tandis qu'un score haut indique que l'utilisateur accorde beaucoup d'importance à son image sur Srava (recherche active de feedback, stratégie d'auto-présentation, comparaison aux autres).

Les scores obtenus sur l'échantillon sont bas.

### SPAUSCIS{.tabset}

```{r SCORE SPAUSCIS alpha cronbach}
data_SPAUSCIS <- data[, c("SPAUSCIS_1", "SPAUSCIS_2", "SPAUSCIS_3", "SPAUSCIS_4", "SPAUSCIS_5", "SPAUSCIS_6")]
cronbachSPAUSCIS<-cronbach(data_SPAUSCIS)

glue ("L'alpha de Cronbach sur les {cronbachSPAUSCIS$number.of.items} items est de {cronbachSPAUSCIS$alpha}")
```

L'alpha de Cronbach est assez faible, cela peut s'expliquer par le fait que c'est une traduction et adaptation dans le cadre de cette étude du questionnaire d'origine mais également par le fait que ce questionnaire était destiné plutôt à des publics adolescents.

#### SPAUSCIS 1
```{r SPAUSCIS 1}
data_resumeSPAUSCIS1 <- data%>%
  summarise(
    Moyenne = mean(SPAUSCIS_1, na.rm = TRUE),
    Médiane = median(SPAUSCIS_1, na.rm = TRUE),
    Ecart_type = sd(SPAUSCIS_1, na.rm=TRUE))

kable(data_resumeSPAUSCIS1)


ggplot(data, aes(x = factor(SPAUSCIS_1, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je consacre beaucoup de temps et d'énergie à publier mes activités sur Strava.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SPAUSCIS 2
```{r SPAUSCIS 2}
data_resumeSPAUSCIS2 <- data%>%
  summarise(
    Moyenne = mean(SPAUSCIS_2, na.rm = TRUE),
    Médiane = median(SPAUSCIS_2, na.rm = TRUE),
    Ecart_type = sd(SPAUSCIS_2, na.rm=TRUE))

kable(data_resumeSPAUSCIS2)

ggplot(data, aes(x = factor(SPAUSCIS_2, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Il est important pour moi d’avoir beaucoup d’abonnés sur Strava.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SPAUSCIS 3
```{r SPAUSCIS 3}

data_resumeSPAUSCIS3 <- data%>%
  summarise(
    Moyenne = mean(SPAUSCIS_3, na.rm = TRUE),
    Médiane = median(SPAUSCIS_3, na.rm = TRUE),
    Ecart_type = sd(SPAUSCIS_3, na.rm=TRUE))

kable(data_resumeSPAUSCIS3)


ggplot(data, aes(x = factor(SPAUSCIS_3, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je supprime mes activités sur Strava qui ne reçoivent pas assez de kudos et/ou de commentaires.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SPAUSCIS 4
```{r SPAUSCIS 4}

data_resumeSPAUSCIS4 <- data%>%
  summarise(
    Moyenne = mean(SPAUSCIS_4, na.rm = TRUE),
    Médiane = median(SPAUSCIS_4, na.rm = TRUE),
    Ecart_type = sd(SPAUSCIS_4, na.rm=TRUE))

kable(data_resumeSPAUSCIS4)


ggplot(data, aes(x = factor(SPAUSCIS_4, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je retouche mes activités avant de les publier sur Strava pour qu’elles paraissent meilleures.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SPAUSCIS 5
```{r SPAUSCIS 5}

data_resumeSPAUSCIS5 <- data%>%
  summarise(
    Moyenne = mean(SPAUSCIS_5, na.rm = TRUE),
    Médiane = median(SPAUSCIS_5, na.rm = TRUE),
    Ecart_type = sd(SPAUSCIS_5, na.rm=TRUE))

kable(data_resumeSPAUSCIS5)


ggplot(data, aes(x = factor(SPAUSCIS_5, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Ce que d’autres coureurs publient sur Strava me rend moins satisfait(e) de mes propres performances.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SPAUSCIS 6
```{r SPAUSCIS 6}

data_resumeSPAUSCIS6 <- data%>%
  summarise(
    Moyenne = mean(SPAUSCIS_6, na.rm = TRUE),
    Médiane = median(SPAUSCIS_6, na.rm = TRUE),
    Ecart_type = sd(SPAUSCIS_6, na.rm=TRUE))

kable(data_resumeSPAUSCIS2)


ggplot(data, aes(x = factor(SPAUSCIS_6, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Les commentaires et les kudos que je reçois à propos des mes activités sur Strava influence mon humeur.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### SCORE SPAUSCIS
```{r graphique score SPAUSCIS}
data <- data %>% mutate (SCORE_SPAUSCIS = (SPAUSCIS_1+ SPAUSCIS_2 + SPAUSCIS_3 + SPAUSCIS_4 + SPAUSCIS_5 + SPAUSCIS_6)/6)

data <- data %>% mutate(scoreSPAUSCIS_categorystat = case_when(
    SCORE_SPAUSCIS < 2 ~  "1",
    SCORE_SPAUSCIS  >=2 & SCORE_SPAUSCIS <3 ~  "2",
    SCORE_SPAUSCIS  >=3 & SCORE_SPAUSCIS <4 ~  "3",
    SCORE_SPAUSCIS  >=4 & SCORE_SPAUSCIS <5 ~  "4",
    SCORE_SPAUSCIS  >=5 & SCORE_SPAUSCIS <6 ~  "5",
    SCORE_SPAUSCIS >=6 ~  "6"
  ))

chi2conformiteSPAUSCIS1<-chisq.test(table(data$SPAUSCIS_1),
p=rep(1/length(unique(data$SPAUSCIS_1)),length(unique(data$SPAUSCIS_1))))
chi2conformiteSPAUSCIS2<-chisq.test(table(data$SPAUSCIS_2), p=rep(1/length(unique(data$SPAUSCIS_2)),length(unique(data$SPAUSCIS_2))))
chi2conformiteSPAUSCIS3<-chisq.test(table(data$SPAUSCIS_3), p=rep(1/length(unique(data$SPAUSCIS_3)),length(unique(data$SPAUSCIS_3))))
chi2conformiteSPAUSCIS4<-chisq.test(table(data$SPAUSCIS_4), p=rep(1/length(unique(data$SPAUSCIS_4)),length(unique(data$SPAUSCIS_4))))
chi2conformiteSPAUSCIS5<-chisq.test(table(data$SPAUSCIS_5), p=rep(1/length(unique(data$SPAUSCIS_5)),length(unique(data$SPAUSCIS_5))))
chi2conformiteSPAUSCIS6<-chisq.test(table(data$SPAUSCIS_6), p=rep(1/length(unique(data$SPAUSCIS_6)),length(unique(data$SPAUSCIS_6))))
chi2conformitescoreSPAUSCIS<-chisq.test(table(data$scoreSPAUSCIS_categorystat), p=rep(1/length(unique(data$scoreSPAUSCIS_categorystat)),length(unique(data$scoreSPAUSCIS_categorystat))))


data_resumeSPAUSCISround<- data%>%
  summarise(
    median = round(median(SCORE_SPAUSCIS, na.rm = TRUE),0),
    moyenne= round(mean(SCORE_SPAUSCIS, na.rm=TRUE),0),
    q1 = round(quantile(SCORE_SPAUSCIS, 0.25, na.rm=T),0),
    q3 = round(quantile(SCORE_SPAUSCIS, 0.75, na.rm=T),0)
  )

data_resumeSPAUSCIS<- data%>%
  summarise(
    Médiane = median(SCORE_SPAUSCIS, na.rm = TRUE),
    Moyenne= mean(SCORE_SPAUSCIS, na.rm=TRUE),
    Ecart_type = sd(SCORE_SPAUSCIS, na.rm=TRUE)
  )

table_SPAUSCIS <- data.frame(
Item = c("SPAUSCIS1", "SPAUSCIS2", "SPAUSCIS3", "SPAUSCIS4", "SPAUSCIS5", "SPAUSCIS6", "SCORE_SPAUSCIS"),
  Moyenne = c(data_resumeSPAUSCIS1$Moyenne, data_resumeSPAUSCIS2$Moyenne, 
              data_resumeSPAUSCIS3$Moyenne, data_resumeSPAUSCIS4$Moyenne, data_resumeSPAUSCIS5$Moyenne, data_resumeSPAUSCIS6$Moyenne, data_resumeSPAUSCIS$Moyenne),
  Médiane = c(data_resumeSPAUSCIS1$Médiane, data_resumeSPAUSCIS2$Médiane, 
              data_resumeSPAUSCIS3$Médiane, data_resumeSPAUSCIS4$Médiane, data_resumeSPAUSCIS5$Médiane, data_resumeSPAUSCIS6$Médiane, data_resumeSPAUSCIS$Médiane),
  Ecart_type = c(data_resumeSPAUSCIS1$Ecart_type, data_resumeSPAUSCIS2$Ecart_type, 
              data_resumeSPAUSCIS3$Ecart_type, data_resumeSPAUSCIS4$Ecart_type, data_resumeSPAUSCIS5$Ecart_type, data_resumeSPAUSCIS6$Ecart_type, data_resumeSPAUSCIS$Ecart_type),
  chi2_ajustement = c(chi2conformiteSPAUSCIS1$statistic, chi2conformiteSPAUSCIS2$statistic, chi2conformiteSPAUSCIS3$statistic, chi2conformiteSPAUSCIS4$statistic, chi2conformiteSPAUSCIS5$statistic, chi2conformiteSPAUSCIS6$statistic, chi2conformitescoreSPAUSCIS$statistic),
  P.value = ifelse(c(chi2conformiteSPAUSCIS1$p.value, chi2conformiteSPAUSCIS2$p.value, chi2conformiteSPAUSCIS3$p.value, chi2conformiteSPAUSCIS4$p.value, chi2conformiteSPAUSCIS5$p.value, chi2conformiteSPAUSCIS6$p.value, chi2conformitescoreSPAUSCIS$p.value) < 0.001, "<0.001", ">0.001")
)

kable(table_SPAUSCIS)

vlinesSPAUSCIS <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeSPAUSCISround$q1, data_resumeSPAUSCISround$moyenne, data_resumeSPAUSCISround$median, data_resumeSPAUSCISround$q3)
)
vlinesSPAUSCIS$annotation <- paste(vlinesSPAUSCIS$label, ":", vlinesSPAUSCIS$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_SPAUSCIS), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_SPAUSCIS, na.rm = TRUE), 
                                max(data$SCORE_SPAUSCIS, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score SPAUSCIS",
       x = "Score SPAUSCIS", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesSPAUSCIS, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesSPAUSCIS, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

# Lien utilisation de Strava - SPAUSCIS

Il s'agit de savoir s'il y a un lien entre l'utilisation de Strava et le score SPAUSCIS.

Le score SIS et le score OSF sont modérément corrélés au score SPAUSCIS.

Le score EXPO, le nombre de clubs Strava, les kudos reçus en moyenne par activité, la fréquence de consultation, le nombre d’abonnés et le nombre d’abonnements sont faiblement corrélés au score SPAUSCIS.

Il n’est pas possible de rejeter H0 pour le lien entre le score SPAUSCIS et la catégorie d’abonnement (gratuit/payant).

### Statistiques{.tabset}

#### Corrélations

```{r correlation Strava SPAUSCIS}
### SIS – SPAUSCIS
cor_SIS_SPAUSCIS <- round(cor(data$SCORE_SIS_TOTAL, data$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_SIS_SPAUSCISh <- round(cor(subset(data, Sexe == "1")$SCORE_SIS_TOTAL, subset(data, Sexe == "1")$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_SIS_SPAUSCISf <- round(cor(subset(data, Sexe == "2")$SCORE_SIS_TOTAL, subset(data, Sexe == "2")$SCORE_SPAUSCIS, use="complete.obs"),2)

#### Expo – SPAUSCIS
cor_EXPO_SPAUSCIS <- round(cor(data$SCORE_EXPO, data$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_EXPO_SPAUSCISh <- round(cor(subset(data, Sexe == "1")$SCORE_EXPO, subset(data, Sexe == "1")$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_EXPO_SPAUSCISf <- round(cor(subset(data, Sexe == "2")$SCORE_EXPO, subset(data, Sexe == "2")$SCORE_SPAUSCIS, use="complete.obs"),2)

#### OSF – SPAUSCIS
cor_OSF_SPAUSCIS <- round(cor(data$SCORE_OSF, data$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_OSF_SPAUSCISh<- round(cor(subset(data, Sexe == "1")$SCORE_OSF, subset(data, Sexe == "1")$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_OSF_SPAUSCISf <- round(cor(subset(data, Sexe == "2")$SCORE_OSF, subset(data, Sexe == "2")$SCORE_SPAUSCIS, use="complete.obs"),2)

#### Club Strava- SPAUSCIS
cor_clubstrava_SPAUSCIS <- round(cor(data$Club_Strava, data$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_clubstrava_SPAUSCISh<- round(cor(subset(data, Sexe == "1")$Club_Strava, subset(data, Sexe == "1")$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_clubstrava_SPAUSCISf <- round(cor(subset(data, Sexe == "2")$Club_Strava, subset(data, Sexe == "2")$SCORE_SPAUSCIS, use="complete.obs"),2)

#### Kudos reçus – SPAUSCIS
cor_kudos_SPAUSCIS <- round(cor(data$Kudos_reçus, data$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_kudos_SPAUSCISh<- round(cor(subset(data, Sexe == "1")$ Kudos_reçus , subset(data, Sexe == "1")$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_kudos_SPAUSCISf <- round(cor(subset(data, Sexe == "2")$Kudos_reçus, subset(data, Sexe == "2")$SCORE_SPAUSCIS, use="complete.obs"),2)

#### Freq publication– SPAUSCIS
cor_freqpubli_SPAUSCIS <- round(cor(data$Fréquence_publication, data$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_freqpubli_SPAUSCISh<- round(cor(subset(data, Sexe == "1")$Fréquence_publication, subset(data, Sexe == "1")$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_freqpubli_SPAUSCISf <- round(cor(subset(data, Sexe == "2")$Fréquence_publication, subset(data, Sexe == "2")$SCORE_SPAUSCIS, use="complete.obs"),2)

#### Freq consultations– SPAUSCIS
cor_freqcons_SPAUSCIS <- round(cor(data$Fréquence_consultation, data$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_freqcons_SPAUSCISh<- round(cor(subset(data, Sexe == "1")$Fréquence_consultation, subset(data, Sexe == "1")$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_freqcons_SPAUSCISf <- round(cor(subset(data, Sexe == "2")$Fréquence_consultation, subset(data, Sexe == "2")$SCORE_SPAUSCIS, use="complete.obs"),2)

#### Nb abonnements– SPAUSCIS
cor_nbabonnements_SPAUSCIS <- round(cor(data$Nb_abonnements, data$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_nbabonnements_SPAUSCISh<- round(cor(subset(data, Sexe == "1")$Nb_abonnements, subset(data, Sexe == "1")$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_nbabonnements_SPAUSCISf <- round(cor(subset(data, Sexe == "2")$Nb_abonnements, subset(data, Sexe == "2")$SCORE_SPAUSCIS, use="complete.obs"),2)

#### Nb abonnés– SPAUSCIS
cor_nbabonnés_SPAUSCIS <- round(cor(data$Nb_abonnés, data$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_nbabonnés_SPAUSCISh<- round(cor(subset(data, Sexe == "1")$ Nb_abonnés, subset(data, Sexe == "1")$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_nbabonnés_SPAUSCISf <- round(cor(subset(data, Sexe == "2")$ Nb_abonnés, subset(data, Sexe == "2")$SCORE_SPAUSCIS, use="complete.obs"),2)

#### Nb abonnés– SPAUSCIS
cor_nbabonnés_SPAUSCIS<- round(cor(data$Nb_abonnés, data$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_nbabonnés_SPAUSCISh<- round(cor(subset(data, Sexe == "1")$ Nb_abonnés, subset(data, Sexe == "1")$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_nbabonnés_SPAUSCISf <- round(cor(subset(data, Sexe == "2")$ Nb_abonnés, subset(data, Sexe == "2")$SCORE_SPAUSCIS, use="complete.obs"),2)


#### Ancienneté Strava - SPAUSCIS
cor_anciennetestrava_SPAUSCIS <- round(cor(data$ Ancienneté_Strava, data$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_anciennetestrava_SPAUSCISh<- round(cor(subset(data, Sexe == "1")$ Ancienneté_Strava, subset(data, Sexe == "1")$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_anciennetestrava_SPAUSCISf <- round(cor(subset(data, Sexe == "2")$ Ancienneté_Strava, subset(data, Sexe == "2")$SCORE_SPAUSCIS, use="complete.obs"),2)

table_SPAUSCIS_Strava_Correlations <- data.frame(
  Variable = c("SCORE SIS ", "SCORE OSF ", "SCORE EXPO ", "Clubs Strava ", "Kudos reçus ", "Fréquence publication ", "Fréquence consultation ", "Nombre d'abonnés ", "Nombre d'abonnements ", "Ancienneté Strava "),
  SPAUSCIS = c(cor_SIS_SPAUSCIS, cor_OSF_SPAUSCIS, cor_EXPO_SPAUSCIS, cor_clubstrava_SPAUSCIS, cor_kudos_SPAUSCIS, cor_freqpubli_SPAUSCIS, cor_freqcons_SPAUSCIS, cor_nbabonnés_SPAUSCIS, cor_nbabonnements_SPAUSCIS, cor_anciennetestrava_SPAUSCIS))

table_SPAUSCIS_Strava_Correlations$SPAUSCIS <- case_when(
  table_SPAUSCIS_Strava_Correlations$SPAUSCIS > 0.4 ~ 
    paste0('<span style="color:green;">', table_SPAUSCIS_Strava_Correlations$SPAUSCIS, '</span>'),
  table_SPAUSCIS_Strava_Correlations$SPAUSCIS > 0.3 ~ 
    paste0('<span style="color:#FC4C02;">', table_SPAUSCIS_Strava_Correlations$SPAUSCIS, '</span>'),
  table_SPAUSCIS_Strava_Correlations$SPAUSCIS > 0.2 ~ 
    paste0('<span style="color:red;">', table_SPAUSCIS_Strava_Correlations$SPAUSCIS, '</span>'),
  TRUE ~ as.character(table_SPAUSCIS_Strava_Correlations$SPAUSCIS)
)

kable(table_SPAUSCIS_Strava_Correlations, format = "html", escape = FALSE)

```

#### Visualisation graphique{.tabset}

##### SIS
```{r sis et spauscis}

ggplot(data, aes(x = SCORE_SIS_TOTAL, y = SCORE_SPAUSCIS, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_SIS_SPAUSCIS)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_SIS_SPAUSCISh)), 
                color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_SIS_SPAUSCISf)), 
                color = "#4F4F4F") +
    scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F")) +
    labs(title = "Score SPAUSCIS en fonction du score SIS",
         x = "SCORE SIS",
         y = "SCORE SPAUSCIS",
         color = "Sexe",
         linetype = "Régression linéaire") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"), color = guide_legend(title = "Sexe"))

```

##### OSF
```{r osf et spauscis}

ggplot(data, aes(x = SCORE_OSF, y = SCORE_SPAUSCIS, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_OSF_SPAUSCIS)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_OSF_SPAUSCISh)), 
                color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_OSF_SPAUSCISf)), 
                color = "#4F4F4F") +
    scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F")) +
    labs(title = "Score SPAUSCIS en fonction du score OSF",
         x = "SCORE OSF",
         y = "SCORE SPAUSCIS",
         color = "Sexe",
         linetype = "Régression linéaire") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"), color = guide_legend(title = "Sexe"))

```


#### Test t de Student

```{r test t student pour type abonnement et spauscis}
t_typeabonnement_spauscis <- t.test(as.numeric(SCORE_SPAUSCIS) ~ as.factor(Type_abonnement), data = data, var.equal = TRUE)

moyennesspauscis_typeabonnement <- data %>%
    group_by(Type_abonnement) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

table_typeabonnement_spauscis <- data.frame(
    Variable = c(
        "Type d'abonnement et SPAUSCIS"),
    Student = c(
        as.numeric(t_typeabonnement_spauscis$statistic)
    ),
    p_value = c(
        ifelse(t_typeabonnement_spauscis$p.value < 0.001, "<0.001", "sup. 0.001")
    ),
    Gratuit = c(
        moyennesspauscis_typeabonnement$Moyenne[1]
    ),
    Payant = c(
        moyennesspauscis_typeabonnement$Moyenne[2]
    )
)

kable(table_typeabonnement_spauscis, format = "html", escape = FALSE)

```

# Lien présentation de soi - caractéristiques sportives

Il s'agit de savoir s'il y a un lien entre le score SPAUSCIS et les caractéristiques sportives.

Il y a une faible corrélation entre le score SPAUSCIS et le nombre de compétitions par an.

Il n'est pas possible de rejeter H0 pour le lien entre le score SPAUSCIS et le fait d'avoir un coach, le fait de suivre un programme d'entraînement et le fait d'être blessé.

Les coureurs qui ont pour objectif un 100 kilomètres en 2025 ont une moyenne au score SPAUSCIS significativement plus élévée que ceux qui ont un 50 kilomètres pour objectif.


### Statistiques {.tabset}

#### Corrélations

```{r correlation pratique SPAUSCIS}
### Freq entrainement – SPAUSCIS
cor_freqentrainement_SPAUSCIS <- round(cor(data$Frequence_pratique, data$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_freqentrainement_SPAUSCISh <- round(cor(subset(data, Sexe == "1")$Frequence_pratique, subset(data, Sexe == "1")$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_freqentrainement_SPAUSCISf <- round(cor(subset(data, Sexe == "2")$Frequence_pratique, subset(data, Sexe == "2")$SCORE_SPAUSCIS, use="complete.obs"),2)

#### Volume – SPAUSCIS
cor_km_SPAUSCIS <- round(cor(data$Kilomètres, data$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_km_SPAUSCISh <- round(cor(subset(data, Sexe == "1")$Kilomètres, subset(data, Sexe == "1")$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_km_SPAUSCISf <- round(cor(subset(data, Sexe == "2")$Kilomètres, subset(data, Sexe == "2")$SCORE_SPAUSCIS, use="complete.obs"),2)

#### Compétitions – SPAUSCIS
cor_compet_SPAUSCIS <- round(cor(data$Compétitions, data$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_compet_SPAUSCISh<- round(cor(subset(data, Sexe == "1")$Compétitions, subset(data, Sexe == "1")$SCORE_SPAUSCIS, use="complete.obs"),2)
cor_compet_SPAUSCISf <- round(cor(subset(data, Sexe == "2")$Compétitions, subset(data, Sexe == "2")$SCORE_SPAUSCIS, use="complete.obs"),2)

table_SPAUSCIS_pratique_Correlations <- data.frame(
  Variable = c("Fréquence d'entraînement ", "Kilomètres par semaine ", "Compétitions par an"),
  SPAUSCIS = c(cor_freqentrainement_SPAUSCIS, cor_km_SPAUSCIS, cor_compet_SPAUSCIS))

table_SPAUSCIS_pratique_Correlations$SPAUSCIS <- case_when(
  table_SPAUSCIS_pratique_Correlations$SPAUSCIS > 0.4 ~ 
    paste0('<span style="color:green;">', table_SPAUSCIS_pratique_Correlations$SPAUSCIS, '</span>'),
  table_SPAUSCIS_pratique_Correlations$SPAUSCIS > 0.3 ~ 
    paste0('<span style="color:#FC4C02;">', table_SPAUSCIS_pratique_Correlations$SPAUSCIS, '</span>'),
  table_SPAUSCIS_pratique_Correlations$SPAUSCIS > 0.2 ~ 
    paste0('<span style="color:red;">', table_SPAUSCIS_pratique_Correlations$SPAUSCIS, '</span>'),
  TRUE ~ as.character(table_SPAUSCIS_pratique_Correlations$SPAUSCIS)
)

kable(table_SPAUSCIS_pratique_Correlations, format = "html", escape = FALSE)

```

#### Test t de Student
```{r test student spauscis}
t_coach_spauscis <- t.test(as.numeric(SCORE_SPAUSCIS) ~ as.factor(Coach), data = data, var.equal = TRUE)

moyennesspauscis_coach <- data %>%
    group_by(Coach) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

table_coach_spauscis <- data.frame(
    Variable = c(
        "Coach et SPAUSCIS"),
    Student = c(
        as.numeric(t_coach_spauscis$statistic)
    ),
    p_value = c(
        ifelse(t_coach_spauscis$p.value < 0.001, "<0.001", "sup. 0.001")
    ),
    Avec_coach = c(
        moyennesspauscis_coach$Moyenne[1]
    ),
    Sans_coach = c(
        moyennesspauscis_coach$Moyenne[2]
    )
)

kable(table_coach_spauscis, format = "html", escape = FALSE)

t_pgrm_spauscis <- t.test(as.numeric(SCORE_SPAUSCIS) ~ as.factor(Programme), data = data, var.equal = TRUE)

moyennesspauscis_pgrm <- data %>%
    group_by(Programme) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

table_pgrm_spauscis <- data.frame(
    Variable = c(
        "Programme et SPAUSCIS"),
    Student = c(
        as.numeric(t_pgrm_spauscis$statistic)
    ),
    p_value = c(
        ifelse(t_pgrm_spauscis$p.value < 0.001, "<0.001", "sup. 0.001")
    ),
    Avec_programme = c(
        moyennesspauscis_pgrm$Moyenne[1]
    ),
    Sans_programme = c(
        moyennesspauscis_pgrm$Moyenne[2]
    )
)

kable(table_pgrm_spauscis, format = "html", escape = FALSE)


t_blessure_spauscis <- t.test(as.numeric(SCORE_SPAUSCIS) ~ as.factor(Blessure), data = data, var.equal = TRUE)

moyennesspauscis_blessure <- data %>%
    group_by(Blessure) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

table_blessure_spauscis <- data.frame(
    Variable = c(
        "Blessure et SPAUSCIS"),
    Student = c(
        as.numeric(t_blessure_spauscis$statistic)
    ),
    p_value = c(
        ifelse(t_blessure_spauscis$p.value < 0.001, "<0.001", "sup. 0.001")
    ),
    Blessure = c(
        moyennesspauscis_blessure$Moyenne[1]
    ),
    Pas_de_blessure = c(
        moyennesspauscis_blessure$Moyenne[2]
    )
)

kable(table_blessure_spauscis, format = "html", escape = FALSE)

```

#### ANOVA

```{r anova spauscis pratique}
### Niveau, type coureur, objectif, pause blessure

anova_spauscis_niveau <- summary(aov(SCORE_SPAUSCIS ~ as.factor(Niveau), data = data))
anova_spauscis_type_coureur <- summary(aov(SCORE_SPAUSCIS ~ as.factor(Type_coureur), data = data))
anova_spauscis_objectif <- summary(aov(SCORE_SPAUSCIS ~ as.factor(Objectif_KM), data = data))
anova_spauscis_pause <- summary(aov(SCORE_SPAUSCIS ~ as.factor(Pause_blessure), data = data))

moyenne_spauscis_niveau <- data %>%
    group_by(Niveau) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

moyenne_spauscis_type_coureur <- data %>%
    group_by(Type_coureur) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

moyenne_spauscis_objectif <- data %>%
    group_by(Objectif_KM) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

moyenne_spauscis_pause <- data %>%
    group_by(Pause_blessure) %>%
    summarise(Moyenne = mean(SCORE_SPAUSCIS, na.rm = TRUE))

anova_spauscis_niveau <- data.frame(
  Variable = c("Lien score SPAUSCIS et niveau"),
  F_value = c(anova_spauscis_niveau[[1]]["F value"][1,1]),
 P_value = ifelse(c(anova_spauscis_niveau[[1]]["Pr(>F)"][1,1]), "< 0.05", "sup. 0.05"),
 Débutant = c(moyenne_spauscis_niveau$Moyenne[1]),
 Intermédiaire = c(moyenne_spauscis_niveau$Moyenne[2]),
 Confirmé = c(moyenne_spauscis_niveau$Moyenne[3]),
 Expert = c(moyenne_spauscis_niveau$Moyenne[4]))
 
kable(anova_spauscis_niveau, format = "html", escape = FALSE)

anova_spauscis_type_coureur <- data.frame(
  Variable = c("Lien score SPAUSCIS et type coureur"),
  F_value = c(anova_spauscis_type_coureur[[1]]["F value"][1,1]),
 P_value = ifelse(c(anova_spauscis_type_coureur[[1]]["Pr(>F)"][1,1]), "< 0.05", "sup. 0.05"))

anova_moyenne_type_coureur <- data.frame (
 Type_coureur = c("Route/Club/Seul", "Route/Pas club/Seul", "Route/Club/En groupe", "Route/Pas club/En groupe", "Trail/Club/Seul", "Trail/Pas club/Seul", "Trail/Club/En groupe", "Trail/Pas club/En groupe"),
 Moyenne = c(moyenne_spauscis_type_coureur$Moyenne[1], moyenne_spauscis_type_coureur$Moyenne[2], moyenne_spauscis_type_coureur$Moyenne[3], moyenne_spauscis_type_coureur$Moyenne[4],moyenne_spauscis_type_coureur$Moyenne[5], moyenne_spauscis_type_coureur$Moyenne[6], moyenne_spauscis_type_coureur$Moyenne[7], moyenne_spauscis_niveau$Moyenne[8]))

kable(anova_spauscis_type_coureur, format = "html", escape = FALSE)
kable(anova_moyenne_type_coureur)

anova_spauscis_objectif <- data.frame(
  Variable = c("Lien score SPAUSCIS et objectif 2025"),
  F_value = c(anova_spauscis_objectif[[1]]["F value"][1,1]),
 P_value = ifelse(c(anova_spauscis_objectif[[1]]["Pr(>F)"][1,1]), "< 0.05", "sup. 0.05"),
 Vingt_km = c(moyenne_spauscis_objectif$Moyenne[1]),
 Cinquante_km = c(moyenne_spauscis_objectif$Moyenne[2]),
 Cent_km = c(moyenne_spauscis_objectif$Moyenne[3]),
 Cent_miles = c(moyenne_spauscis_objectif$Moyenne[4]))
 
kable(anova_spauscis_objectif, format = "html", escape = FALSE)

anova_spauscis_pause <- data.frame(
  Variable = c("Lien score SPAUSCIS et pause blessure"),
  F_value = c(anova_spauscis_pause[[1]]["F value"][1,1]),
 P_value = ifelse(c(anova_spauscis_pause[[1]]["Pr(>F)"][1,1]), "< 0.05", "sup. 0.05"),
 Jours = c(moyenne_spauscis_pause$Moyenne[1]),
 Semaines = c(moyenne_spauscis_pause$Moyenne[2]),
 Mois = c(moyenne_spauscis_pause$Moyenne[3]),
 Pas_de_pause = c(moyenne_spauscis_pause$Moyenne[4]))
 
kable(anova_spauscis_pause, format = "html", escape = FALSE)



```

#### Test post hoc

```{r test post hoc spauscis et niveau}

tukey_spauscis_niveau <- TukeyHSD(aov(SCORE_SPAUSCIS ~ as.factor(Niveau), data = data))
tukey_spauscis_type_coureur <- TukeyHSD(aov(SCORE_SPAUSCIS ~ as.factor(Type_coureur), data = data))
tukey_spauscis_objectif <- TukeyHSD(aov(SCORE_SPAUSCIS ~ as.factor(Objectif_KM), data = data))
tukey_spauscis_blessure <- TukeyHSD(aov(SCORE_SPAUSCIS ~ as.factor(Pause_blessure), data = data))

tukey_spauscis_niveau_df <- as.data.frame(tukey_spauscis_niveau[[1]]) 
tukey_spauscis_niveau_df$Comparison <- rownames(tukey_spauscis_niveau_df)
tukey_spauscis_niveau_df$Variable <- "Lien score SPAUSCIS et niveau"
rownames(tukey_spauscis_niveau_df) <- NULL

tukey_spauscis_type_coureur_df <- as.data.frame(tukey_spauscis_type_coureur[[1]]) 
tukey_spauscis_type_coureur_df$Comparison <- rownames(tukey_spauscis_type_coureur_df)
tukey_spauscis_type_coureur_df$Variable <- "Lien score SPAUSCIS et type coureur"
rownames(tukey_spauscis_type_coureur_df) <- NULL

tukey_spauscis_objectif_df <- as.data.frame(tukey_spauscis_objectif[[1]]) 
tukey_spauscis_objectif_df$Comparison <- rownames(tukey_spauscis_objectif_df)
tukey_spauscis_objectif_df$Variable <- "Lien score SPAUSCIS et objectif 2025"
rownames(tukey_spauscis_objectif_df) <- NULL

tukey_spauscis_blessure_df <- as.data.frame(tukey_spauscis_blessure[[1]]) 
tukey_spauscis_blessure_df$Comparison <- rownames(tukey_spauscis_blessure_df)
tukey_spauscis_blessure_df$Variable <- "Lien score SPAUSCIS  et blessure"
rownames(tukey_spauscis_blessure_df) <- NULL

tukey_results_spauscis <- bind_rows(tukey_spauscis_niveau_df, tukey_spauscis_type_coureur_df, tukey_spauscis_objectif_df, tukey_spauscis_blessure_df)

tukey_signif_spauscis <- tukey_results_spauscis %>% filter(`p adj` < 0.05)

kable(tukey_signif_spauscis, format = "html", escape = FALSE)
```

#### Visualisation graphique
```{r visualisation test post hoc spauscis}
ggplot(tukey_signif_spauscis, aes(x = Comparison, y = diff, fill = Variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_errorbar(aes(ymin = lwr, ymax = upr), width = 0.2, position = position_dodge(0.9)) +
  theme_minimal() +
  labs(title = "Comparaisons post-hoc (Tukey HSD)", 
       x = "Comparaison entre groupes", 
       y = "Différence de moyenne") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


# Mesure du stress perçu

Dans l'article de Rusell^3^, il y a des témoignages concernant la pression perçue "I think it makes you feel like there’s pressure to do as much as other people are doing or as well as other people are doing… I had a really bad run or workout oneday, and I see others having better runs, then that can make me feel worse. 

Le Perceived Stress Scale mesure le stress perçu et la capacité d'adaptation. Les items ont étés traduits et adaptés à partir de l'étude de Sischka ^11^. L'étude de Chiu ^13^ recommande d'utiliser cette échelle mais en version 2 facteurs : stress perçu et capacité d'adaptation.

Les items 1, 2, 3, 6, 9, 10 de l'échelle mesure le stress perçu et 4, 5, 7, 8 mesurent la capacité à gérer son stress.

L'article de Chiu ^13^ indique un alpha de Cronbach de 0.81 pour le stress perçu et 0.71 pour la capacité d'adaptation.

Suite au pré-test, un item a été enlevé dans l'étude sur Strava ("In the last week, how often have you felt that you were on top of things? "). L'échelle traduite et adaptée comporte donc **9 items**.

Un score élevé sur le PSS (facteur stress perçu) indique un stress perçu élévé tandis qu'un score faible indique un stress perçu faible. Un score élevé sur le PSS (facteur capacité d'adaptation) montre que la personne arrive à gérer son stress correctement tandis qu'un score faible indique qu'elle a plus de mal. Ainsi, un individu peut avoir un haut niveau de stress mais aussi une forte capacité d’adaptation et inversement.

### PSS Facteurs stress perçu{.tabset}

```{r SCORE PSS alpha cronbach}
data_PSS_Stress <- data[, c("PSS_1", "PSS_2", "PSS_3", "PSS_6", "PSS_8", "PSS_9")]
cronbachPSS_Stress<-cronbach(data_PSS_Stress)

glue ("L'alpha de Cronbach sur les {cronbachPSS_Stress$number.of.items} items est de {cronbachPSS_Stress$alpha}")
```


#### PSS 1
```{r graphique PSS 1}
data_resumePSS1 <- data%>%
  summarise(
    Moyenne = mean(PSS_1, na.rm = TRUE),
    Médiane = median(PSS_1, na.rm = TRUE),
    Ecart_type = sd(PSS_1, na.rm=TRUE))

kable(data_resumePSS1)

ggplot(data, aes(x = factor(PSS_1, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Avez-vous été perturbé(e) par des réactions inattendues à vos publications sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### PSS 2
```{r graphique PSS 2}
data_resumePSS2 <- data%>%
  summarise(
    Moyenne = mean(PSS_2, na.rm = TRUE),
    Médiane = median(PSS_2, na.rm = TRUE),
    Ecart_type = sd(PSS_2, na.rm=TRUE))

kable(data_resumePSS2)

ggplot(data, aes(x = factor(PSS_2, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Avez-vous eu l’impression d’être obligé(e) de publier vos activités sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### PSS 3
```{r graphique PSS 3}
data_resumePSS3 <- data%>%
  summarise(
    Moyenne = mean(PSS_3, na.rm = TRUE),
    Médiane = median(PSS_3, na.rm = TRUE),
    Ecart_type = sd(PSS_3, na.rm=TRUE))

kable(data_resumePSS3)

ggplot(data, aes(x = factor(PSS_3, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Vous êtes-vous senti(e) nerveus(e) ou stressé(e) à l’idée de publier vos activités sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### PSS 6
```{r graphique PSS 6}
data_resumePSS6 <- data%>%
  summarise(
    Moyenne = mean(PSS_6, na.rm = TRUE),
    Médiane = median(PSS_6, na.rm = TRUE),
    Ecart_type = sd(PSS_6, na.rm=TRUE))

kable(data_resumePSS6)

ggplot(data, aes(x = factor(PSS_6, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Avez-vous constaté que vous n’étiez pas assez actif(ve) sur Strava (pas assez de publications d’activités) ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### PSS 8
```{r graphique PSS 8}
data_resumePSS8 <- data%>%
  summarise(
    Moyenne = mean(PSS_8, na.rm = TRUE),
    Médiane = median(PSS_8, na.rm = TRUE),
    Ecart_type = sd(PSS_8, na.rm=TRUE))

kable(data_resumePSS8)

ggplot(data, aes(x = factor(PSS_8, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Avez-vous été irrité(e) à cause de la performance des autres sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### PSS 9
```{r graphique PSS 9}
data_resumePSS9 <- data%>%
  summarise(
    Moyenne = mean(PSS_9, na.rm = TRUE),
    Médiane = median(PSS_9, na.rm = TRUE),
    Ecart_type = sd(PSS_9, na.rm=TRUE))

kable(data_resumePSS9)

ggplot(data, aes(x = factor(PSS_9, levels = c(1, 2, 3, 4), labels = c("Jamais", "Parfois", "Souvent", "Toujours")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Vous-êtes-vous senti(e) dépassé(e) par la pression d’atteindre vos objectifs sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### SCORE PSS Stress perçu
```{r graphique score pss stress}
data <- data %>% mutate (SCORE_PSS_Stress = PSS_1+ PSS_2 + PSS_3 + PSS_6 + PSS_8 + PSS_9)

data <- data %>% mutate(scorePSS_Stress_categorystat = case_when(
    SCORE_PSS_Stress < 5 ~  "1",
    SCORE_PSS_Stress  >=5 & SCORE_PSS_Stress <9 ~  "2",
    SCORE_PSS_Stress  >=9 & SCORE_PSS_Stress <13 ~  "3",
    SCORE_PSS_Stress  >=13 & SCORE_PSS_Stress <17 ~  "4",
    SCORE_PSS_Stress  >=17 & SCORE_PSS_Stress <21 ~  "5",
    SCORE_PSS_Stress >=21 ~  "6"
  ))

chi2conformitePSS1<-chisq.test(table(data$PSS_1), p=rep(1/length(unique(data$PSS_1)),length(unique(data$PSS_1))))
chi2conformitePSS2<-chisq.test(table(data$PSS_2), p=rep(1/length(unique(data$PSS_2)),length(unique(data$PSS_2))))
chi2conformitePSS3<-chisq.test(table(data$PSS_3), p=rep(1/length(unique(data$PSS_3)),length(unique(data$PSS_3))))
chi2conformitePSS6<-chisq.test(table(data$PSS_6), p=rep(1/length(unique(data$PSS_6)),length(unique(data$PSS_6))))
chi2conformitePSS8<-chisq.test(table(data$PSS_8), p=rep(1/length(unique(data$PSS_8)),length(unique(data$PSS_8))))
chi2conformitePSS9<-chisq.test(table(data$PSS_9), p=rep(1/length(unique(data$PSS_9)),length(unique(data$PSS_9))))

chi2conformitescorePSS_Stress<-chisq.test(table(data$scorePSS_Stress_categorystat), p=rep(1/length(unique(data$scorePSS_Stress_categorystat)),length(unique(data$scorePSS_Stress_categorystat))))


data_resumePSS_Stress_round<- data%>%
  summarise(
    median = round(median(SCORE_PSS_Stress, na.rm = TRUE),0),
    moyenne= round(mean(SCORE_PSS_Stress, na.rm=TRUE),0),
    q1 = round(quantile(SCORE_PSS_Stress, 0.25, na.rm=T),0),
    q3 = round(quantile(SCORE_PSS_Stress, 0.75, na.rm=T),0)
  )

data_resumePSS_Stress<- data%>%
  summarise(
    Médiane = median(SCORE_PSS_Stress, na.rm = TRUE),
    Moyenne= mean(SCORE_PSS_Stress, na.rm=TRUE),
    Ecart_type = sd(SCORE_PSS_Stress, na.rm=TRUE)
  )

table_PSS_Stress<- data.frame(
Item = c("PSS1", "PSS2", "PSS3", "PSS6", "PSS8", "PSS9", "SCORE_PSS_Stress"),
  Moyenne = c(data_resumePSS1$Moyenne, data_resumePSS2$Moyenne, 
              data_resumePSS3$Moyenne, data_resumePSS6$Moyenne, data_resumePSS8$Moyenne, data_resumePSS9$Moyenne, data_resumePSS_Stress$Moyenne),
  Médiane = c(data_resumePSS1$Médiane, data_resumePSS2$Médiane, 
              data_resumePSS3$Médiane, data_resumePSS6$Médiane, data_resumePSS8$Médiane, data_resumePSS9$Médiane, data_resumePSS_Stress$Médiane),
  Ecart_type = c(data_resumePSS1$Ecart_type, data_resumePSS2$Ecart_type, 
              data_resumePSS3$Ecart_type, data_resumePSS6$Ecart_type, data_resumePSS8$Ecart_type, data_resumePSS9$Ecart_type, data_resumePSS_Stress$Ecart_type),
  chi2_ajustement = c(chi2conformitePSS1$statistic, chi2conformitePSS2$statistic, chi2conformitePSS3$statistic, chi2conformitePSS6$statistic, chi2conformitePSS8$statistic, chi2conformitePSS9$statistic, chi2conformitescorePSS_Stress$statistic),
  P.value = ifelse(c(chi2conformitePSS1$p.value, chi2conformitePSS2$p.value, chi2conformitePSS3$p.value, chi2conformitePSS6$p.value, chi2conformitePSS8$p.value, chi2conformitePSS9$p.value, chi2conformitescorePSS_Stress$p.value) < 0.001, "<0.001", ">0.001")
)

kable(table_PSS_Stress)

vlinesPSS_Stress <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumePSS_Stress_round$q1, data_resumePSS_Stress_round$moyenne, data_resumePSS_Stress_round$median, data_resumePSS_Stress_round$q3)
)
vlinesPSS_Stress$annotation <- paste(vlinesPSS_Stress$label, ":", vlinesPSS_Stress$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_PSS_Stress), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_PSS_Stress, na.rm = TRUE), 
                                max(data$SCORE_PSS_Stress, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score PSS (facteur stress perçu)",
       x = "Score PSS stress perçu", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesPSS_Stress, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesPSS_Stress, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```



### PSS Facteurs adaptation au stress{.tabset}

```{r score PSS adaptation alpha cronbach}
data_PSS_Adaptation<- data[, c("PSS_4", "PSS_5", "PSS_7")]
cronbachPSS_Adaptation<-cronbach(data_PSS_Adaptation)

glue ("L'alpha de Cronbach sur les {cronbachPSS_Adaptation$number.of.items} items est de {cronbachPSS_Adaptation$alpha}")
```

#### PSS 4
```{r graphique PSS 4}
data_resumePSS4 <- data%>%
  summarise(
    Moyenne = mean(PSS_4, na.rm = TRUE),
    Médiane = median(PSS_4, na.rm = TRUE),
    Ecart_type = sd(PSS_4, na.rm=TRUE))

kable(data_resumePSS4)

ggplot(data, aes(x = factor(PSS_4, levels = c(1, 2, 3, 4), labels = c("Toujours", "Souvent", "Parfois", "Jamais")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Vous êtes-vous senti(e) confiant(e) par rapport à ce que vous publiez sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### PSS 5
```{r graphique PSS 5}
data_resumePSS5 <- data%>%
  summarise(
    Moyenne = mean(PSS_5, na.rm = TRUE),
    Médiane = median(PSS_5, na.rm = TRUE),
    Ecart_type = sd(PSS_5, na.rm=TRUE))

kable(data_resumePSS5)

ggplot(data, aes(x = factor(PSS_5, levels = c(1, 2, 3, 4), labels = c("Toujours", "Souvent", "Parfois", "Jamais")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "Avez-vous eu l'impression que vos activités sur Strava vous mettaient en valeur ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### PSS 7
```{r graphique PSS 7}
data_resumePSS7 <- data%>%
  summarise(
    Moyenne = mean(PSS_7, na.rm = TRUE),
    Médiane = median(PSS_7, na.rm = TRUE),
    Ecart_type = sd(PSS_7, na.rm=TRUE))

kable(data_resumePSS7)

ggplot(data, aes(x = factor(PSS_7, levels = c(1, 2, 3, 4), labels = c("Toujours", "Souvent", "Parfois", "Jamais")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "Au cours du dernier mois, à quelle fréquence :",
       x = "A quelle fréquence avez-vous eu l'impression de contrôler la manière dont vous présentez vos activités sur Strava ?", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### SCORE PSS Adapation au stress
```{r graphique score pss adaptation}
data <- data %>% mutate (SCORE_PSS_Adaptation = PSS_4+ PSS_5 + PSS_7)

data <- data %>% mutate(scorePSS_Adaptation_categorystat = case_when(
    SCORE_PSS_Adaptation < 5 ~  "1",
    SCORE_PSS_Adaptation  >=5 & SCORE_PSS_Adaptation <9 ~  "2",
    SCORE_PSS_Adaptation  >=9 ~  "3",
  ))

chi2conformitePSS4<-chisq.test(table(data$PSS_4), p=rep(1/length(unique(data$PSS_4)),length(unique(data$PSS_4))))
chi2conformitePSS5<-chisq.test(table(data$PSS_5), p=rep(1/length(unique(data$PSS_5)),length(unique(data$PSS_5))))
chi2conformitePSS7<-chisq.test(table(data$PSS_7), p=rep(1/length(unique(data$PSS_7)),length(unique(data$PSS_7))))

chi2conformitescorePSS_Adaptation<-chisq.test(table(data$scorePSS_Adaptation_categorystat), p=rep(1/length(unique(data$scorePSS_Adaptation_categorystat)),length(unique(data$scorePSS_Adaptation_categorystat))))


data_resumePSS_Adaptation_round<- data%>%
  summarise(
    median = round(median(SCORE_PSS_Adaptation, na.rm = TRUE),0),
    moyenne= round(mean(SCORE_PSS_Adaptation, na.rm=TRUE),0),
    q1 = round(quantile(SCORE_PSS_Adaptation, 0.25, na.rm=T),0),
    q3 = round(quantile(SCORE_PSS_Adaptation, 0.75, na.rm=T),0)
  )

data_resumePSS_Adaptation<- data%>%
  summarise(
    Médiane = median(SCORE_PSS_Adaptation, na.rm = TRUE),
    Moyenne= mean(SCORE_PSS_Adaptation, na.rm=TRUE),
    Ecart_type = sd(SCORE_PSS_Adaptation, na.rm=TRUE)
  )

table_PSS_Adaptation<- data.frame(
Item = c("PSS4", "PSS5", "PSS7","SCORE_PSS_Adaptation"),
  Moyenne = c(data_resumePSS4$Moyenne, data_resumePSS5$Moyenne, 
              data_resumePSS7$Moyenne, data_resumePSS_Adaptation$Moyenne),
  Médiane = c(data_resumePSS4$Médiane, data_resumePSS5$Médiane, 
              data_resumePSS7$Médiane, data_resumePSS_Adaptation$Médiane),
  Ecart_type = c(data_resumePSS4$Ecart_type, data_resumePSS5$Ecart_type, 
              data_resumePSS7$Ecart_type, data_resumePSS_Adaptation$Ecart_type),
chi2_ajustement = c(chi2conformitePSS4$statistic, chi2conformitePSS5$statistic, chi2conformitePSS7$statistic, chi2conformitescorePSS_Adaptation$statistic),
  P.value = ifelse(c(chi2conformitePSS4$p.value, chi2conformitePSS5$p.value, chi2conformitePSS7$p.value, chi2conformitescorePSS_Adaptation$p.value) < 0.001, "<0.001", ">0.001")
)

kable(table_PSS_Adaptation)

vlinesPSS_Adaptation <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumePSS_Adaptation_round$q1, data_resumePSS_Adaptation_round$moyenne, data_resumePSS_Adaptation_round$median, data_resumePSS_Adaptation_round$q3)
)
vlinesPSS_Adaptation$annotation <- paste(vlinesPSS_Adaptation$label, ":", vlinesPSS_Adaptation$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_PSS_Adaptation), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_PSS_Adaptation, na.rm = TRUE), 
                                max(data$SCORE_PSS_Adaptation, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score PSS (facteur adapatation)",
       x = "Score PSS adaptation au stress perçu", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesPSS_Adaptation, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesPSS_Adaptation, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()

```

# Lien utilisation de Strava et stress perçu

La question ici est de savoir si l'utilisation de Strava (intensité et fréquence d'utilisation, utilisation des fonctionnalités de sociabilisation en ligne et exposition d'informations personnelles...) engendre un stress perçu ou non.

### Une première approche{.tabset}

```{r graph stress Strava}
data_resumeStrava_stress <- data%>%
  summarise(
    Moyenne = mean(Strava_stress, na.rm = TRUE),
    Médiane = median(Strava_stress, na.rm = TRUE),
    Ecart_type = sd(Strava_stress, na.rm=TRUE))

kable(data_resumeStrava_stress)

ggplot(data, aes(x = factor(Strava_stress, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je me sens plus stressé(e) depuis que j'ai Strava.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

### Statistiques{.tabset}

####  Corrélations
```{r correlations calculs PSS}
#### SIS - PSS Stress

cor_SIS_PSS_Stress<- round(cor(data$SCORE_SIS_TOTAL, data$SCORE_PSS_Stress, use = "complete.obs"), 2)

cor_SIS_PSS_Stressh <- round(cor(subset(data, Sexe == "1")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "1")$SCORE_PSS_Stress, use = "complete.obs"), 2)
cor_SIS_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "2")$SCORE_PSS_Stress, use = "complete.obs"), 2)

#### SIS - PSS Adaptation

cor_SIS_PSS_Adaptation<- round(cor(data$SCORE_SIS_TOTAL, data$SCORE_PSS_Adaptation, use = "complete.obs"), 2)

cor_SIS_PSS_Adaptationh <- round(cor(subset(data, Sexe == "1")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "1")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)
cor_SIS_PSS_Adaptationf<- round(cor(subset(data, Sexe == "2")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "2")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)


#### OSF - PSS Stress

cor_OSF_PSS_Stress<- round(cor(data$SCORE_OSF, data$SCORE_PSS_Stress, use = "complete.obs"), 2)

cor_OSF_PSS_Stressh <- round(cor(subset(data, Sexe == "1")$SCORE_OSF, 
                 subset(data, Sexe == "1")$SCORE_PSS_Stress, use = "complete.obs"), 2)
cor_OSF_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$SCORE_OSF, 
                 subset(data, Sexe == "2")$SCORE_PSS_Stress, use = "complete.obs"), 2)

#### OSF - PSS Adaptation

cor_OSF_PSS_Adaptation<- round(cor(data$SCORE_OSF, data$SCORE_PSS_Adaptation, use = "complete.obs"), 2)

cor_OSF_PSS_Adaptationh <- round(cor(subset(data, Sexe == "1")$SCORE_OSF, 
                 subset(data, Sexe == "1")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)
cor_OSF_PSS_Adaptationf<- round(cor(subset(data, Sexe == "2")$SCORE_OSF, 
                 subset(data, Sexe == "2")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)


#### EXPO - PSS Stress

cor_EXPO_PSS_Stress<- round(cor(data$SCORE_EXPO, data$SCORE_PSS_Stress, use = "complete.obs"), 2)

cor_EXPO_PSS_Stressh <- round(cor(subset(data, Sexe == "1")$SCORE_EXPO, 
                 subset(data, Sexe == "1")$SCORE_PSS_Stress, use = "complete.obs"), 2)
cor_EXPO_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$SCORE_EXPO, 
                 subset(data, Sexe == "2")$SCORE_PSS_Stress, use = "complete.obs"), 2)

#### EXPO - PSS Adaptation

cor_EXPO_PSS_Adaptation<- round(cor(data$SCORE_EXPO, data$SCORE_PSS_Adaptation, use = "complete.obs"), 2)

cor_EXPO_PSS_Adaptationh <- round(cor(subset(data, Sexe == "1")$SCORE_EXPO, 
                 subset(data, Sexe == "1")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)
cor_EXPO_PSS_Adaptationf<- round(cor(subset(data, Sexe == "2")$SCORE_EXPO, 
                 subset(data, Sexe == "2")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)


#### Club Strava- PSS Stress

cor_Club_Strava_PSS_Stress<- round(cor(data$Club_Strava, data$SCORE_PSS_Stress, use = "complete.obs"), 2)

cor_Club_Strava_PSS_Stressh <- round(cor(subset(data, Sexe == "1")$Club_Strava, 
                 subset(data, Sexe == "1")$SCORE_PSS_Stress, use = "complete.obs"), 2)
cor_Club_Strava_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$Club_Strava, 
                 subset(data, Sexe == "2")$SCORE_PSS_Stress, use = "complete.obs"), 2)

#### Club Strava - PSS Adaptation

cor_Club_Strava_PSS_Adaptation<- round(cor(data$Club_Strava, data$SCORE_PSS_Adaptation, use = "complete.obs"), 2)

cor_Club_Strava_PSS_Adaptationh <- round(cor(subset(data, Sexe == "1")$Club_Strava, 
                 subset(data, Sexe == "1")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)
cor_Club_Strava_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$Club_Strava, 
                 subset(data, Sexe == "2")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)

#### Kudos recus- PSS Stress

cor_Kudos_recus_PSS_Stress<- round(cor(data$Kudos_reçus, data$SCORE_PSS_Stress, use = "complete.obs"), 2)

cor_Kudos_recus_PSS_Stressh <- round(cor(subset(data, Sexe == "1")$Kudos_reçus, 
                 subset(data, Sexe == "1")$SCORE_PSS_Stress, use = "complete.obs"), 2)
cor_Kudos_recus_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$Kudos_reçus, 
                 subset(data, Sexe == "2")$SCORE_PSS_Stress, use = "complete.obs"), 2)

#### Kudos reçus - PSS Adaptation

cor_Kudos_recus_PSS_Adaptation<- round(cor(data$Kudos_reçus, data$SCORE_PSS_Adaptation, use = "complete.obs"), 2)

cor_Kudos_recus_PSS_Adaptationh <- round(cor(subset(data, Sexe == "1")$Kudos_reçus, 
                 subset(data, Sexe == "1")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)
cor_Kudos_recus_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$Kudos_reçus, 
                 subset(data, Sexe == "2")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)


#### Fréquence publcitation - PSS Stress

cor_freq_publi_PSS_Stress<- round(cor(data$Fréquence_publication, data$SCORE_PSS_Stress, use = "complete.obs"), 2)

cor_freq_publi_PSS_Stressh <- round(cor(subset(data, Sexe == "1")$Fréquence_publication, 
                 subset(data, Sexe == "1")$SCORE_PSS_Stress, use = "complete.obs"), 2)
cor_freq_publi_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$Fréquence_publication, 
                 subset(data, Sexe == "2")$SCORE_PSS_Stress, use = "complete.obs"), 2)

#### Fréquence publication - PSS Adaptation

cor_freq_publi_PSS_Adaptation<- round(cor(data$Fréquence_publication, data$SCORE_PSS_Adaptation, use = "complete.obs"), 2)

cor_freq_publi_PSS_Adaptationh <- round(cor(subset(data, Sexe == "1")$Fréquence_publication, 
                 subset(data, Sexe == "1")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)
cor_freq_publi_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$Fréquence_publication, 
                 subset(data, Sexe == "2")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)

#### Fréquence consultation - PSS Stress

cor_freq_cons_PSS_Stress<- round(cor(data$Fréquence_consultation, data$SCORE_PSS_Stress, use = "complete.obs"), 2)

cor_freq_cons_PSS_Stressh <- round(cor(subset(data, Sexe == "1")$Fréquence_consultation, 
                 subset(data, Sexe == "1")$SCORE_PSS_Stress, use = "complete.obs"), 2)
cor_freq_cons_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$Fréquence_consultation, 
                 subset(data, Sexe == "2")$SCORE_PSS_Stress, use = "complete.obs"), 2)

#### Fréquence consultation - PSS Adaptation

cor_freq_cons_PSS_Adaptation<- round(cor(data$Fréquence_consultation, data$SCORE_PSS_Adaptation, use = "complete.obs"), 2)

cor_freq_cons_PSS_Adaptationh <- round(cor(subset(data, Sexe == "1")$Fréquence_consultation, 
                 subset(data, Sexe == "1")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)
cor_freq_cons_PSS_Adaptationf<- round(cor(subset(data, Sexe == "2")$Fréquence_consultation, 
                 subset(data, Sexe == "2")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)


#### Nb abonnés - PSS Stress

cor_nbabonnes_PSS_Stress<- round(cor(data$Nb_abonnés, data$SCORE_PSS_Stress, use = "complete.obs"), 2)

cor_nbabonnes_PSS_Stressh <- round(cor(subset(data, Sexe == "1")$Nb_abonnés, 
                 subset(data, Sexe == "1")$SCORE_PSS_Stress, use = "complete.obs"), 2)
cor_nbabonnes_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$Nb_abonnés, 
                 subset(data, Sexe == "2")$SCORE_PSS_Stress, use = "complete.obs"), 2)

#### Nb abonnes - PSS Adaptation

cor_nbabonnes_PSS_Adaptation<- round(cor(data$Nb_abonnés, data$SCORE_PSS_Adaptation, use = "complete.obs"), 2)

cor_nbabonnes_PSS_Adaptationh <- round(cor(subset(data, Sexe == "1")$Nb_abonnés, 
                 subset(data, Sexe == "1")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)
cor_nbabonnes_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$Nb_abonnés, 
                 subset(data, Sexe == "2")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)

#### Nb abonnements - PSS Stress

cor_nbabonnements_PSS_Stress<- round(cor(data$Nb_abonnements, data$SCORE_PSS_Stress, use = "complete.obs"), 2)

cor_nbabonnements_PSS_Stressh <- round(cor(subset(data, Sexe == "1")$Nb_abonnements, 
                 subset(data, Sexe == "1")$SCORE_PSS_Stress, use = "complete.obs"), 2)
cor_nbabonnements_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$Nb_abonnements, 
                 subset(data, Sexe == "2")$SCORE_PSS_Stress, use = "complete.obs"), 2)

#### Nb abonnements - PSS Adaptation

cor_nbabonnements_PSS_Adaptation<- round(cor(data$Nb_abonnements, data$SCORE_PSS_Adaptation, use = "complete.obs"), 2)

cor_nbabonnements_PSS_Adaptationh <- round(cor(subset(data, Sexe == "1")$Nb_abonnements, 
                 subset(data, Sexe == "1")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)
cor_nbabonnements_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$Nb_abonnements, 
                 subset(data, Sexe == "2")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)



#### Type d'abonnements - PSS Stress

cor_typeabonnement_PSS_Stress<- round(cor(data$Type_abonnement, data$SCORE_PSS_Stress, use = "complete.obs"), 2)

cor_typeabonnement_PSS_Stressh <- round(cor(subset(data, Sexe == "1")$Type_abonnement, 
                 subset(data, Sexe == "1")$SCORE_PSS_Stress, use = "complete.obs"), 2)
cor_typeabonnement_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$Type_abonnement, 
                 subset(data, Sexe == "2")$SCORE_PSS_Stress, use = "complete.obs"), 2)

#### Type d'abonnements - PSS Adaptation

cor_typeabonnement_PSS_Adaptation<- round(cor(data$Type_abonnement, data$SCORE_PSS_Adaptation, use = "complete.obs"), 2)

cor_typeabonnement_PSS_Adaptationh <- round(cor(subset(data, Sexe == "1")$Type_abonnement, 
                 subset(data, Sexe == "1")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)
cor_typeabonnement_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$Type_abonnement, 
                 subset(data, Sexe == "2")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)


#### Anciennete strava - PSS Stress

cor_anciennetestrava_PSS_Stress<- round(cor(data$Ancienneté_Strava, data$SCORE_PSS_Stress, use = "complete.obs"), 2)

cor_anciennetestrava_PSS_Stressh <- round(cor(subset(data, Sexe == "1")$Ancienneté_Strava, 
                 subset(data, Sexe == "1")$SCORE_PSS_Stress, use = "complete.obs"), 2)
cor_anciennetestrava_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$Ancienneté_Strava, 
                 subset(data, Sexe == "2")$SCORE_PSS_Stress, use = "complete.obs"), 2)

#### Anciennete Strava - PSS Adaptation

cor_anciennetestrava_PSS_Adaptation<- round(cor(data$Ancienneté_Strava, data$SCORE_PSS_Adaptation, use = "complete.obs"), 2)

cor_anciennetestrava_PSS_Adaptationh <- round(cor(subset(data, Sexe == "1")$Ancienneté_Strava, 
                 subset(data, Sexe == "1")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)
cor_anciennetestrava_PSS_Stressf<- round(cor(subset(data, Sexe == "2")$Ancienneté_Strava, 
                 subset(data, Sexe == "2")$SCORE_PSS_Adaptation, use = "complete.obs"), 2)



```


```{r correlations affichage PSS}
table_PSS_Correlations <- data.frame(
  Motivation = c("SCORE SIS ", "SCORE OSF ", "SCORE EXPO ", "Clubs Strava ", "Kudos reçus ", "Fréquence publication ", "Fréquence consultation ", "Nombre d'abonnés ", "Nombre d'abonnements ", "Type d'abonnement ", "Ancienneté Strava "),
  PSS_Stress = c(cor_SIS_PSS_Stress, cor_OSF_PSS_Stress, cor_EXPO_PSS_Stress, cor_Club_Strava_PSS_Stress, cor_Kudos_recus_PSS_Stress, cor_freq_publi_PSS_Stress, cor_freq_cons_PSS_Stress, cor_nbabonnes_PSS_Stress, cor_nbabonnements_PSS_Stress, cor_typeabonnement_PSS_Stress, cor_anciennetestrava_PSS_Stress),
  PSS_Adaptation = c(cor_SIS_PSS_Adaptation, cor_OSF_PSS_Adaptation, cor_EXPO_PSS_Adaptation, cor_Club_Strava_PSS_Adaptation, cor_Kudos_recus_PSS_Adaptation, cor_freq_publi_PSS_Adaptation, cor_freq_cons_PSS_Adaptation, cor_nbabonnes_PSS_Adaptation, cor_nbabonnements_PSS_Adaptation, cor_typeabonnement_PSS_Adaptation, cor_anciennetestrava_PSS_Adaptation))

table_PSS_Correlations$PSS_Stress <- ifelse(
  abs(table_PSS_Correlations$PSS_Stress) > 0.3, 
  paste0('<span style="color:green;">', table_PSS_Correlations$PSS_Stress, '</span>'),
  ifelse(
    abs(table_PSS_Correlations$PSS_Stress) > 0.2, 
    paste0('<span style="color:#FC4C02;">', table_PSS_Correlations$PSS_Stress, '</span>'),
    ifelse(
      abs(table_PSS_Correlations$PSS_Stress)> 0.1, 
      paste0('<span style="color:red;">', table_PSS_Correlations$PSS_Stress, '</span>'),
      table_PSS_Correlations$PSS_Stress
    )
  )
)


table_PSS_Correlations$PSS_Adaptation <- ifelse(
  abs(table_PSS_Correlations$PSS_Adaptation) > 0.3, 
  paste0('<span style="color:green;">', table_PSS_Correlations$PSS_Adaptation, '</span>'),
  ifelse(
    abs(table_PSS_Correlations$PSS_Adaptation) > 0.2, 
    paste0('<span style="color:#FC4C02;">', table_PSS_Correlations$PSS_Adaptation, '</span>'),
    ifelse(
      abs(table_PSS_Correlations$PSS_Adaptation) > 0.1, 
      paste0('<span style="color:red;">', table_PSS_Correlations$PSS_Adaptation, '</span>'),
      table_PSS_Correlations$PSS_Adaptation
    )
  )
)


kable(table_PSS_Correlations, format = "html", escape = FALSE)

```

#### Visualisation graphique{.tabset}

##### SIS- PSS Adaptation
```{r graphique pss adaptation et score sis}
ggplot(data, aes(x = SCORE_SIS_TOTAL , y = SCORE_PSS_Adaptation, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_SIS_PSS_Adaptation)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_SIS_PSS_Adaptationh)), color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_SIS_PSS_Adaptationf)), color = "#4F4F4F") +
  scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F"))+
    labs(title = "SCORE PSS Adaptation en fonction du SCORE SIS",
         x = "SCORE SIS (Intensité d'utilisation de Strava)",
         y = "SCORE PSS Adaptation",
         color = "Sexe",
         linetype = "Coefficient de corrélation") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"))
```

##### OSF - PSS Adaptation
```{r graphique pss adaptation et score osf}
ggplot(data, aes(x = SCORE_OSF , y = SCORE_PSS_Adaptation, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_OSF_PSS_Adaptation)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_OSF_PSS_Adaptationh)), color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_OSF_PSS_Adaptationf)), color = "#4F4F4F") +
    scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F"))+
    labs(title = "SCORE PSS Adaptation en fonction du SCORE SIS",
         x = "SCORE OSF (Online Sociability Functions)",
         y = "SCORE PSS Adaptation",
         color = "Sexe",
         linetype = "Coefficient de corrélation") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Régression avec R"))
```

##### EXPO- PSS Adaptation
```{r graphique pss adaptation et score expo}
ggplot(data, aes(x = SCORE_EXPO , y = SCORE_PSS_Adaptation, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_EXPO_PSS_Adaptation)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_EXPO_PSS_Adaptationh)), color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_EXPO_PSS_Adaptationf)), color = "#4F4F4F") +
scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F"))+
      labs(title = "SCORE PSS Adaptation en fonction du SCORE SIS",
         x = "SCORE Exposition",
         y = "SCORE PSS Adaptation",
         color = "Sexe",
         linetype = "Coefficient de corrélation") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"))
```


##### EXPO- PSS Adaptation
```{r graphique pss adaptation et freq consultation}
ggplot(data, aes(x = Fréquence_consultation , y = SCORE_PSS_Adaptation, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_freq_cons_PSS_Adaptation)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_freq_cons_PSS_Adaptationh)), color = "#FC4C02") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_freq_cons_PSS_Adaptationf)), color = "#4F4F4F") +
scale_color_manual(values = c("Homme" = "#FC4C02", "Femme" = "#4F4F4F"))+
      labs(title = "SCORE PSS Adaptation en fonction de la fréquence de consultation",
         x = "Fréquence consultation",
         y = "SCORE PSS Adaptation",
         color = "Sexe",
         linetype = "Coefficient de corrélation") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Coefficient de corrélation"))
```

#### Test t de Student

```{r test t student pour type abonnement et pss}
t_typeabonnement_pss_stress <- t.test(as.numeric(SCORE_PSS_Stress) ~ as.factor(Type_abonnement), data = data, var.equal = TRUE)

moyennes_pss_stress_typeabonnement <- data %>%
    group_by(Type_abonnement) %>%
    summarise(Moyenne = mean(SCORE_PSS_Stress, na.rm = TRUE))

table_typeabonnement_pss_stress <- data.frame(
    Variable = c(
        "Type d'abonnement et score PSS Stress"),
    Student = c(
        as.numeric(t_typeabonnement_pss_stress$statistic)
    ),
    p_value = c(
        ifelse(t_typeabonnement_pss_stress$p.value < 0.001, "<0.001", "sup. 0.001")
    ),
    Gratuit = c(
        moyennes_pss_stress_typeabonnement$Moyenne[1]
    ),
    Payant = c(
        moyennes_pss_stress_typeabonnement$Moyenne[2]
    )
)

kable(table_typeabonnement_pss_stress, format = "html", escape = FALSE)

t_typeabonnement_pss_adaptation <- t.test(as.numeric(SCORE_PSS_Adaptation) ~ as.factor(Type_abonnement), data = data, var.equal = TRUE)

moyennes_pss_adaptation_typeabonnement <- data %>%
    group_by(Type_abonnement) %>%
    summarise(Moyenne = mean(SCORE_PSS_Adaptation, na.rm = TRUE))

table_typeabonnement_pss_adaptation <- data.frame(
    Variable = c(
        "Type d'abonnement et score PSS Adaptation"),
    Student = c(
        as.numeric(t_typeabonnement_pss_adaptation$statistic)
    ),
    p_value = c(
        ifelse(t_typeabonnement_pss_adaptation$p.value < 0.001, "<0.001", "sup. 0.001")
    ),
    Gratuit = c(
        moyennes_pss_adaptation_typeabonnement$Moyenne[1]
    ),
    Payant = c(
        moyennes_pss_adaptation_typeabonnement$Moyenne[2]
    )
)

kable(table_typeabonnement_pss_adaptation, format = "html", escape = FALSE)

```

#### Visualisation graphique
```{r}
ggplot(data, aes(x = factor(Type_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")),
                 y = SCORE_PSS_Adaptation,
                 fill = factor(Type_abonnement, levels = c(1, 2), labels = c("Gratuit", "Payant")), alpha=0.5)) +
  geom_boxplot() +
  labs(title = "",
       x = "Type d'abonnement",
       y = "Score PSS Adaptation",
       fill = "Type d'abonnement") +
  theme_minimal()+
  theme(legend.position = "none")+
  default_fill_colors() 
```

# Lien stress perçu et caractéristiques sportives

Il s'agit de savoir s'il y a un lien entre les scores PSS Stress et PSS Adaptation et les caractéristiques sportives.

### Statistiques {.tabset}

#### Corrélations

```{r correlation pratique PSS Stress}
### Freq entrainement – PSS Stress
cor_freqentrainement_PSS_Stress <- round(cor(data$Frequence_pratique, data$SCORE_PSS_Stress, use="complete.obs"),2)
cor_freqentrainement_PSS_Stressh <- round(cor(subset(data, Sexe == "1")$Frequence_pratique, subset(data, Sexe == "1")$SCORE_PSS_Stress, use="complete.obs"),2)
cor_freqentrainement_PSS_Stressf <- round(cor(subset(data, Sexe == "2")$Frequence_pratique, subset(data, Sexe == "2")$SCORE_PSS_Stress, use="complete.obs"),2)

#### Volume – PSS Stress
cor_km_PSS_Stress <- round(cor(data$Kilomètres, data$ SCORE_PSS_Stress, use="complete.obs"),2)
cor_km_PSS_Stressh <- round(cor(subset(data, Sexe == "1")$Kilomètres, subset(data, Sexe == "1")$ SCORE_PSS_Stress, use="complete.obs"),2)
cor_km_PSS_Stressf <- round(cor(subset(data, Sexe == "2")$Kilomètres, subset(data, Sexe == "2")$ SCORE_PSS_Stress, use="complete.obs"),2)

#### Compétitions – PSS Stress
cor_compet_PSS_Stress <- round(cor(data$Compétitions, data$ SCORE_PSS_Stress, use="complete.obs"),2)
cor_compet_PSS_Stressh<- round(cor(subset(data, Sexe == "1")$Compétitions, subset(data, Sexe == "1")$ SCORE_PSS_Stress, use="complete.obs"),2)
cor_compet_PSS_Stressf <- round(cor(subset(data, Sexe == "2")$Compétitions, subset(data, Sexe == "2")$ SCORE_PSS_Stress, use="complete.obs"),2)

### Frequence entrainement - PSS Adaptation
cor_freqentrainement_PSS_Adaptation <- round(cor(data$Frequence_pratique, data$SCORE_PSS_Adaptation, use="complete.obs"),2)
cor_freqentrainement_PSS_Adaptationh <- round(cor(subset(data, Sexe == "1")$Frequence_pratique, subset(data, Sexe == "1")$SCORE_PSS_Adaptation, use="complete.obs"),2)
cor_freqentrainement_PSS_Adaptationf <- round(cor(subset(data, Sexe == "2")$Frequence_pratique, subset(data, Sexe == "2")$SCORE_PSS_Adaptation, use="complete.obs"),2)

#### Volume – PSS Adaptation
cor_km_PSS_Adaptation <- round(cor(data$Kilomètres, data$ SCORE_PSS_Adaptation, use="complete.obs"),2)
cor_km_PSS_Adaptationh <- round(cor(subset(data, Sexe == "1")$Kilomètres, subset(data, Sexe == "1")$ SCORE_PSS_Adaptation, use="complete.obs"),2)
cor_km_PSS_Adaptationf <- round(cor(subset(data, Sexe == "2")$Kilomètres, subset(data, Sexe == "2")$ SCORE_PSS_Adaptation, use="complete.obs"),2)

#### Compétitions – PSS Adaptation
cor_compet_PSS_Adaptation <- round(cor(data$Compétitions, data$ SCORE_PSS_Adaptation, use="complete.obs"),2)

cor_compet_PSS_Adaptationh<- round(cor(subset(data, Sexe == "1")$Compétitions, subset(data, Sexe == "1")$ SCORE_PSS_Adaptation, use="complete.obs"),2)

cor_compet_PSS_Adaptationf <- round(cor(subset(data, Sexe == "2")$Compétitions, subset(data, Sexe == "2")$ SCORE_PSS_Adaptation, use="complete.obs"),2)

table_PSS_Stress_pratique_Correlations <- data.frame(
  Variable = c("Fréquence d'entraînement ", "Kilomètres par semaine ", "Compétitions par an"),
  PSS_Stress = c(cor_freqentrainement_PSS_Stress, cor_km_PSS_Stress, cor_compet_PSS_Stress),
  PSS_Adaptation = c(cor_freqentrainement_PSS_Adaptation, cor_km_PSS_Adaptation, cor_compet_PSS_Adaptation))

table_PSS_Stress_pratique_Correlations$PSS_Stress <- case_when(
table_PSS_Stress_pratique_Correlations$PSS_Stress > 0.4 ~ 
    paste0('<span style="color:green;">', table_PSS_Stress_pratique_Correlations$PSS_Stress, '</span>'),
  table_PSS_Stress_pratique_Correlations$PSS_Stress > 0.3 ~ 
    paste0('<span style="color:#FC4C02;">', table_PSS_Stress_pratique_Correlations$PSS_Stress, '</span>'),
  table_PSS_Stress_pratique_Correlations$PSS_Stress > 0.2 ~ 
    paste0('<span style="color:red;">', table_PSS_Stress_pratique_Correlations$PSS_Stress, '</span>'),
  TRUE ~ as.character(table_PSS_Stress_pratique_Correlations$PSS_Stress)
)

table_PSS_Stress_pratique_Correlations$PSS_Adaptation <- case_when(
table_PSS_Stress_pratique_Correlations$PSS_Adaptation > 0.4 ~ 
    paste0('<span style="color:green;">', table_PSS_Stress_pratique_Correlations$PSS_Adaptation, '</span>'),
  table_PSS_Stress_pratique_Correlations$PSS_Adaptation > 0.3 ~ 
    paste0('<span style="color:#FC4C02;">', table_PSS_Stress_pratique_Correlations$PSS_Adaptation, '</span>'),
  table_PSS_Stress_pratique_Correlations$PSS_Adaptation > 0.2 ~ 
    paste0('<span style="color:red;">', table_PSS_Stress_pratique_Correlations$PSS_Adaptation, '</span>'),
  TRUE ~ as.character(table_PSS_Stress_pratique_Correlations$PSS_Adaptation)
)


kable(table_PSS_Stress_pratique_Correlations, format = "html", escape = FALSE)

```


# Mesure de la motivation
Cette échelle est une traduction et adaptation du BREQ-3 (Behavioural Regulation In Exercise Questionnaire) en 12 items, qui mesure la motivation intrinsèque, intégrée et identifiée (motivations autodéterminées) et la motivation introjectée et externe (motivations non-autodéterminées) et l'amotivation ^12^. Les alphas de Cronbach dans l'étude de Rocchi ^12^ ne sont pas mentionnés. L'Oméga de McDonald est utilisé à la place et les valeurs sont de :

- Motivation intrinsèque	0.72 - 0.82
- Régulation intégrée	0.56 - 0.79
- Régulation identifiée	0.44 - 0.76
- Régulation introjectée	0.60 - 0.77
- Régulation externe	0.54 - 0.70
- Amotivation	0.59 - 0.63

### Motivation intrinsèque{.tabset}

```{r score bres intrinseque alpha cronbach}
data_BREQIntrinseque<- data[, c("BREQ_1", "BREQ_2")]
cronbachBREQIntrinseque<-cronbach(data_BREQIntrinseque)

glue ("L'alpha de Cronbach sur les {cronbachBREQIntrinseque$number.of.items} items est de {cronbachBREQIntrinseque$alpha}")
```
#### BREQ 1
```{r graphique breq 1}
data_resumeBREQ1 <- data%>%
  summarise(
    Moyenne = mean(BREQ_1, na.rm = TRUE),
    Médiane = median(BREQ_1, na.rm = TRUE),
    Ecart_type = sd(BREQ_1, na.rm=TRUE))

kable(data_resumeBREQ1)

ggplot(data, aes(x = factor(BREQ_1, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je trouve que courir est une activité agréable.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### BREQ 2
```{r graphique breq 2}
data_resumeBREQ2 <- data%>%
  summarise(
    Moyenne = mean(BREQ_2, na.rm = TRUE),
    Médiane = median(BREQ_2, na.rm = TRUE),
    Ecart_type = sd(BREQ_2, na.rm=TRUE))

kable(data_resumeBREQ2)

ggplot(data, aes(x = factor(BREQ_2, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je cours parce que c’est amusant.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Score motivation intrinsèque
```{r  graphique score intrinseque}
data <- data %>% mutate (SCORE_BREQ_Intrinseque = (BREQ_1+BREQ_2)/2)

data <- data %>% mutate(score_breq_intrinseque_categorystat = case_when(
    SCORE_BREQ_Intrinseque <2 ~  "1",
    SCORE_BREQ_Intrinseque >= 2 & SCORE_BREQ_Intrinseque < 3 ~"2",
    SCORE_BREQ_Intrinseque >= 3 & SCORE_BREQ_Intrinseque < 4 ~"3",
    SCORE_BREQ_Intrinseque ==4 ~  "4"
  ))

chi2conformiteBREQ1<-chisq.test(table(data$BREQ_1), p=rep(1/length(unique(data$BREQ_1)),length(unique(data$BREQ_1))))
chi2conformiteBREQ2<-chisq.test(table(data$BREQ_2), p=rep(1/length(unique(data$BREQ_2)),length(unique(data$BREQ_2))))

chi2conformiteBREQINTRINSEQUE<-chisq.test(table(data$score_breq_intrinseque_categorystat), p=rep(1/length(table(data$score_breq_intrinseque_categorystat)),length(table(data$score_breq_intrinseque_categorystat))))

data_resumeBREQIntrinseque_round<- data%>%
  summarise(
    median = round(median(SCORE_BREQ_Intrinseque, na.rm = TRUE),1),
    moyenne= round(mean(SCORE_BREQ_Intrinseque, na.rm=TRUE),1),
    q1 = round(quantile(SCORE_BREQ_Intrinseque, 0.25, na.rm=T),1),
    q3 = round(quantile(SCORE_BREQ_Intrinseque, 0.75, na.rm=T),1)
  )

data_resumeBREQIntrinseque<- data%>%
  summarise(
    Médiane = median(SCORE_BREQ_Intrinseque, na.rm = TRUE),
    Moyenne= mean(SCORE_BREQ_Intrinseque, na.rm=TRUE),
    Ecart_type = sd(SCORE_BREQ_Intrinseque, na.rm=TRUE)
  )

table_BREQIntrinseque<- data.frame(
Item = c("BREQ 1", "BREQ 2", "SCORE_BREQ_Intrinseque"),
  Moyenne = c(data_resumeBREQ1$Moyenne, data_resumeBREQ2$Moyenne, 
              data_resumeBREQIntrinseque$Moyenne),
  Médiane = c(data_resumeBREQ1$Médiane, data_resumeBREQ2$Médiane, 
              data_resumeBREQIntrinseque$Médiane),
  Ecart_type = c(data_resumeBREQ1$Ecart_type, data_resumeBREQ2$Ecart_type, 
              data_resumeBREQIntrinseque$Ecart_type),
chi2_ajustement = c(chi2conformiteBREQ1$statistic, chi2conformiteBREQ2$statistic, chi2conformiteBREQINTRINSEQUE$statistic),
  P.value = ifelse(c(chi2conformiteBREQ1$p.value, chi2conformiteBREQ2$p.value, chi2conformiteBREQINTRINSEQUE$p.value) < 0.001, "<0.001", ">0.001")
)

kable(table_BREQIntrinseque)

vlinesBREQ_Intrinseque <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeBREQIntrinseque_round$q1, data_resumeBREQIntrinseque_round$moyenne, data_resumeBREQIntrinseque_round$median, data_resumeBREQIntrinseque_round$q3)
)
vlinesBREQ_Intrinseque$annotation <- paste(vlinesBREQ_Intrinseque$label, ":", vlinesBREQ_Intrinseque$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_BREQ_Intrinseque), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_BREQ_Intrinseque, na.rm = TRUE), 
                                max(data$SCORE_BREQ_Intrinseque, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score BREQ (motivation intrinsèque)",
       x = "Score BREQ (motivation intrinsèque)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesBREQ_Intrinseque, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesBREQ_Intrinseque, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()


```

### Motivation intégrée{.tabset}

```{r score breq integree alpha cronbach}
data_BREQIntegree <- data[, c("BREQ_3", "BREQ_4")]
cronbachBREQIntegree<-cronbach(data_BREQIntegree)

glue ("L'alpha de Cronbach sur les {cronbachBREQIntegree$number.of.items} items est de {cronbachBREQIntegree$alpha}")
```

#### BREQ 3
```{r graphique breq3}
data_resumeBREQ3 <- data%>%
  summarise(
    Moyenne = mean(BREQ_3, na.rm = TRUE),
    Médiane = median(BREQ_3, na.rm = TRUE),
    Ecart_type = sd(BREQ_3, na.rm=TRUE))

kable(data_resumeBREQ3)

ggplot(data, aes(x = factor(BREQ_3, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je cours parce que c’est une part fondamentale de qui je suis.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### BREQ 4
```{r graphique breq4}
data_resumeBREQ4 <- data%>%
  summarise(
    Moyenne = mean(BREQ_4, na.rm = TRUE),
    Médiane = median(BREQ_4, na.rm = TRUE),
    Ecart_type = sd(BREQ_4, na.rm=TRUE))

kable(data_resumeBREQ4)

ggplot(data, aes(x = factor(BREQ_4, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je cours parce que c’est en accord avec mes objectifs de vie.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Score motivation intégrée
```{r graphique score integree}
data <- data %>% mutate (SCORE_BREQ_Integree = (BREQ_3+BREQ_4)/2)

data <- data %>% mutate(score_breq_integree_categorystat = case_when(
    SCORE_BREQ_Integree <2 ~  "1",
    SCORE_BREQ_Integree >= 2 & SCORE_BREQ_Integree < 3 ~"2",
    SCORE_BREQ_Integree >= 3 & SCORE_BREQ_Integree < 4 ~"3",
    SCORE_BREQ_Integree ==4 ~  "4"
  ))

chi2conformiteBREQ3<-chisq.test(table(data$BREQ_3), p=rep(1/length(unique(data$BREQ_3)),length(unique(data$BREQ_3))))
chi2conformiteBREQ4<-chisq.test(table(data$BREQ_4), p=rep(1/length(unique(data$BREQ_4)),length(unique(data$BREQ_4))))

chi2conformiteBREQINTEGREE<-chisq.test(table(data$score_breq_integree_categorystat), p=rep(1/length(table(data$score_breq_integree_categorystat)),length(table(data$score_breq_integree_categorystat))))

data_resumeBREQIntegree_round<- data%>%
  summarise(
    median = round(median(SCORE_BREQ_Integree, na.rm = TRUE),1),
    moyenne= round(mean(SCORE_BREQ_Integree, na.rm=TRUE),1),
    q1 = round(quantile(SCORE_BREQ_Integree, 0.25, na.rm=T),1),
    q3 = round(quantile(SCORE_BREQ_Integree, 0.75, na.rm=T),1)
  )

data_resumeBREQIntegree<- data%>%
  summarise(
    Médiane = median(SCORE_BREQ_Integree, na.rm = TRUE),
    Moyenne= mean(SCORE_BREQ_Integree, na.rm=TRUE),
    Ecart_type = sd(SCORE_BREQ_Integree, na.rm=TRUE)
  )

table_BREQIntegree<- data.frame(
Item = c("BREQ 3", "BREQ 4", "SCORE_BREQ_Integree"),
  Moyenne = c(data_resumeBREQ3$Moyenne, data_resumeBREQ4$Moyenne, 
              data_resumeBREQIntegree$Moyenne),
  Médiane = c(data_resumeBREQ3$Médiane, data_resumeBREQ4$Médiane, 
              data_resumeBREQIntegree$Médiane),
  Ecart_type = c(data_resumeBREQ3$Ecart_type, data_resumeBREQ4$Ecart_type, 
              data_resumeBREQIntegree$Ecart_type),
chi2_ajustement = c(chi2conformiteBREQ3$statistic, chi2conformiteBREQ4$statistic, chi2conformiteBREQINTEGREE$statistic),
  P.value = ifelse(c(chi2conformiteBREQ3$p.value, chi2conformiteBREQ4$p.value, chi2conformiteBREQINTEGREE$p.value) < 0.001, "<0.001", ">0.001")
)

kable(table_BREQIntegree)

vlinesBREQ_Integree <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeBREQIntegree_round$q1, data_resumeBREQIntegree_round$moyenne, data_resumeBREQIntegree_round$median, data_resumeBREQIntegree_round$q3)
)
vlinesBREQ_Integree$annotation <- paste(vlinesBREQ_Integree$label, ":", vlinesBREQ_Integree$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_BREQ_Integree), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_BREQ_Integree, na.rm = TRUE), 
                                max(data$SCORE_BREQ_Integree, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score BREQ (motivation intégrée)",
       x = "Score BREQ (motivation intégrée)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesBREQ_Integree, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesBREQ_Integree, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```


### Motivation identifiée{.tabset}

```{r score breq identifee alpha cronbach}
data_BREQIdentifiee <- data[, c("BREQ_5", "BREQ_6")]
cronbachBREQIdentifiee<-cronbach(data_BREQIdentifiee)

glue ("L'alpha de Cronbach sur les {cronbachBREQIdentifiee$number.of.items} items est de {cronbachBREQIdentifiee$alpha}")
```

#### BREQ 5
```{r graphique breq5}
data_resumeBREQ5 <- data%>%
  summarise(
    Moyenne = mean(BREQ_5, na.rm = TRUE),
    Médiane = median(BREQ_5, na.rm = TRUE),
    Ecart_type = sd(BREQ_5, na.rm=TRUE))

kable(data_resumeBREQ5)

ggplot(data, aes(x = factor(BREQ_5, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Il est important pour moi de courir.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### BREQ 6
```{r graphique breq6}
data_resumeBREQ6 <- data%>%
  summarise(
    Moyenne = mean(BREQ_6, na.rm = TRUE),
    Médiane = median(BREQ_6, na.rm = TRUE),
    Ecart_type = sd(BREQ_6, na.rm=TRUE))

kable(data_resumeBREQ6)

ggplot(data, aes(x = factor(BREQ_6, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "J'apprécie les bénéfices de la course à pied.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Score motivation identifiée
```{r graphique score identifiee}
data <- data %>% mutate (SCORE_BREQ_Identifiee = (BREQ_5+BREQ_6)/2)

data <- data %>% mutate(score_breq_identifiee_categorystat = case_when(
    SCORE_BREQ_Identifiee <2 ~  "1",
    SCORE_BREQ_Identifiee >= 2 & SCORE_BREQ_Identifiee < 3 ~"2",
    SCORE_BREQ_Identifiee >= 3 & SCORE_BREQ_Identifiee < 4 ~"3",
    SCORE_BREQ_Identifiee ==4 ~  "4"
  ))

chi2conformiteBREQ5<-chisq.test(table(data$BREQ_5), p=rep(1/length(unique(data$BREQ_5)),length(unique(data$BREQ_5))))
chi2conformiteBREQ6<-chisq.test(table(data$BREQ_6), p=rep(1/length(unique(data$BREQ_6)),length(unique(data$BREQ_6))))

chi2conformiteBREQIDENTIFIEE<-chisq.test(table(data$score_breq_identifiee_categorystat), p=rep(1/length(table(data$score_breq_identifiee_categorystat)),length(table(data$score_breq_identifiee_categorystat))))

data_resumeBREQIdentifiee_round<- data%>%
  summarise(
    median = round(median(SCORE_BREQ_Identifiee, na.rm = TRUE),1),
    moyenne= round(mean(SCORE_BREQ_Identifiee, na.rm=TRUE),1),
    q1 = round(quantile(SCORE_BREQ_Identifiee, 0.25, na.rm=T),1),
    q3 = round(quantile(SCORE_BREQ_Identifiee, 0.75, na.rm=T),1)
  )

data_resumeBREQIdentifiee<- data%>%
  summarise(
    Médiane = median(SCORE_BREQ_Identifiee, na.rm = TRUE),
    Moyenne= mean(SCORE_BREQ_Identifiee, na.rm=TRUE),
    Ecart_type = sd(SCORE_BREQ_Identifiee, na.rm=TRUE)
  )

table_BREQIdentifiee<- data.frame(
Item = c("BREQ 5", "BREQ 6", "SCORE_BREQ_Identifiee"),
  Moyenne = c(data_resumeBREQ5$Moyenne, data_resumeBREQ6$Moyenne, 
              data_resumeBREQIdentifiee$Moyenne),
  Médiane = c(data_resumeBREQ5$Médiane, data_resumeBREQ6$Médiane, 
              data_resumeBREQIdentifiee$Médiane),
  Ecart_type = c(data_resumeBREQ5$Ecart_type, data_resumeBREQ6$Ecart_type, 
              data_resumeBREQIdentifiee$Ecart_type),
chi2_ajustement = c(chi2conformiteBREQ5$statistic, chi2conformiteBREQ6$statistic, chi2conformiteBREQIDENTIFIEE$statistic),
  P.value = ifelse(c(chi2conformiteBREQ5$p.value, chi2conformiteBREQ6$p.value, chi2conformiteBREQIDENTIFIEE$p.value) < 0.001, "<0.001", ">0.001")
)

kable(table_BREQIdentifiee)

vlinesBREQ_Identifiee <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeBREQIdentifiee_round$q1, data_resumeBREQIdentifiee_round$moyenne, data_resumeBREQIdentifiee_round$median, data_resumeBREQIdentifiee_round$q3)
)
vlinesBREQ_Identifiee$annotation <- paste(vlinesBREQ_Identifiee$label, ":", vlinesBREQ_Identifiee$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_BREQ_Identifiee), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_BREQ_Identifiee, na.rm = TRUE), 
                                max(data$SCORE_BREQ_Identifiee, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score BREQ (motivation identifiée)",
       x = "Score BREQ (motivation identifiée)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesBREQ_Identifiee, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesBREQ_Identifiee, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

### Motivation introjectéee{.tabset}

```{r breq score introjectee alpha cronbach }
data_BREQIntrojectee <- data[, c("BREQ_7", "BREQ_8")]
cronbachBREQIntrojectee<-cronbach(data_BREQIntrojectee)

glue ("L'alpha de Cronbach sur les {cronbachBREQIntrojectee$number.of.items} items est de {cronbachBREQIntrojectee$alpha}")
```

#### BREQ 7
```{r graphique breq7}
data_resumeBREQ7 <- data%>%
  summarise(
    Moyenne = mean(BREQ_7, na.rm = TRUE),
    Médiane = median(BREQ_7, na.rm = TRUE),
    Ecart_type = sd(BREQ_7, na.rm=TRUE))

kable(data_resumeBREQ7)

ggplot(data, aes(x = factor(BREQ_7, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je me sens honteux(se) si je manque un entraînement de course à pied.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### BREQ 8
```{r graphique breq8}
data_resumeBREQ8 <- data%>%
  summarise(
    Moyenne = mean(BREQ_8, na.rm = TRUE),
    Médiane = median(BREQ_8, na.rm = TRUE),
    Ecart_type = sd(BREQ_8, na.rm=TRUE))

kable(data_resumeBREQ8)

ggplot(data, aes(x = factor(BREQ_8, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je me sens en échec si je n’ai pas couru.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Score motivation introjectée
```{r graphique score introjectee}
data <- data %>% mutate (SCORE_BREQ_Introjectee = (BREQ_7+BREQ_8)/2)

data <- data %>% mutate(score_breq_Introjectee_categorystat = case_when(
    SCORE_BREQ_Introjectee <2 ~  "1",
    SCORE_BREQ_Introjectee >= 2 & SCORE_BREQ_Introjectee < 3 ~"2",
    SCORE_BREQ_Introjectee >= 3 & SCORE_BREQ_Introjectee < 4 ~"3",
    SCORE_BREQ_Introjectee ==4 ~  "4"
  ))

chi2conformiteBREQ7<-chisq.test(table(data$BREQ_7), p=rep(1/length(unique(data$BREQ_7)),length(unique(data$BREQ_7))))
chi2conformiteBREQ8<-chisq.test(table(data$BREQ_8), p=rep(1/length(unique(data$BREQ_8)),length(unique(data$BREQ_8))))

chi2conformiteBREQIntrojectee<-chisq.test(table(data$score_breq_Introjectee_categorystat), p=rep(1/length(table(data$score_breq_Introjectee_categorystat)),length(table(data$score_breq_Introjectee_categorystat))))

data_resumeBREQIntrojectee_round<- data%>%
  summarise(
    median = round(median(SCORE_BREQ_Introjectee, na.rm = TRUE),1),
    moyenne= round(mean(SCORE_BREQ_Introjectee, na.rm=TRUE),1),
    q1 = round(quantile(SCORE_BREQ_Introjectee, 0.25, na.rm=T),1),
    q3 = round(quantile(SCORE_BREQ_Introjectee, 0.75, na.rm=T),1)
  )

data_resumeBREQIntrojectee<- data%>%
  summarise(
    Médiane = median(SCORE_BREQ_Introjectee, na.rm = TRUE),
    Moyenne= mean(SCORE_BREQ_Introjectee, na.rm=TRUE),
    Ecart_type = sd(SCORE_BREQ_Introjectee, na.rm=TRUE)
  )

table_BREQIntrojectee<- data.frame(
Item = c("BREQ 7", "BREQ 8", "SCORE_BREQ_Introjectee"),
  Moyenne = c(data_resumeBREQ7$Moyenne, data_resumeBREQ8$Moyenne, 
              data_resumeBREQIntrojectee$Moyenne),
  Médiane = c(data_resumeBREQ7$Médiane, data_resumeBREQ8$Médiane, 
              data_resumeBREQIntrojectee$Médiane),
  Ecart_type = c(data_resumeBREQ7$Ecart_type, data_resumeBREQ8$Ecart_type, 
              data_resumeBREQIntrojectee$Ecart_type),
chi2_ajustement = c(chi2conformiteBREQ7$statistic, chi2conformiteBREQ8$statistic, chi2conformiteBREQIntrojectee$statistic),
  P.value = ifelse(c(chi2conformiteBREQ7$p.value, chi2conformiteBREQ8$p.value, chi2conformiteBREQIntrojectee$p.value) < 0.001, "<0.001", ">0.001")
)

kable(table_BREQIntrojectee)

vlinesBREQ_Introjectee <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeBREQIntrojectee_round$q1, data_resumeBREQIntrojectee_round$moyenne, data_resumeBREQIntrojectee_round$median, data_resumeBREQIntrojectee_round$q3)
)
vlinesBREQ_Introjectee$annotation <- paste(vlinesBREQ_Introjectee$label, ":", vlinesBREQ_Introjectee$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_BREQ_Introjectee), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_BREQ_Introjectee, na.rm = TRUE), 
                                max(data$SCORE_BREQ_Introjectee, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score BREQ (motivation introjectée)",
       x = "Score BREQ (motivation introjectée)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesBREQ_Introjectee, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesBREQ_Introjectee, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```


### Motivation externe{.tabset}

```{r score externe breq alpha cronbach}
data_BREQExterne <- data[, c("BREQ_9", "BREQ_10")]
cronbachBREQExterne<-cronbach(data_BREQExterne)

glue ("L'alpha de Cronbach sur les {cronbachBREQExterne$number.of.items} items est de {cronbachBREQExterne$alpha}")
```

#### BREQ 9
```{r graphique breq9}
data_resumeBREQ9 <- data%>%
  summarise(
    Moyenne = mean(BREQ_9, na.rm = TRUE),
    Médiane = median(BREQ_9, na.rm = TRUE),
    Ecart_type = sd(BREQ_9, na.rm=TRUE))

kable(data_resumeBREQ9)

ggplot(data, aes(x = factor(BREQ_9, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je ressens de la pression de mes amis pour courir.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### BREQ 10
```{r graphique breq10}
data_resumeBREQ10 <- data%>%
  summarise(
    Moyenne = mean(BREQ_10, na.rm = TRUE),
    Médiane = median(BREQ_10, na.rm = TRUE),
    Ecart_type = sd(BREQ_10, na.rm=TRUE))

kable(data_resumeBREQ10)

ggplot(data, aes(x = factor(BREQ_10, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je cours parce que les autres disent qu’il faut que je le fasse.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Score motivation externe
```{r graphique score externe breq}
data <- data %>% mutate (SCORE_BREQ_Externe = (BREQ_9+BREQ_10)/2)

data <- data %>% mutate(score_breq_Externe_categorystat = case_when(
    SCORE_BREQ_Externe <2 ~  "1",
    SCORE_BREQ_Externe >= 2 & SCORE_BREQ_Externe < 3 ~"2",
    SCORE_BREQ_Externe >= 3 & SCORE_BREQ_Externe < 4 ~"3",
    SCORE_BREQ_Externe ==4 ~  "4"
  ))

chi2conformiteBREQ9<-chisq.test(table(data$BREQ_9), p=rep(1/length(unique(data$BREQ_9)),length(unique(data$BREQ_9))))
chi2conformiteBREQ10<-chisq.test(table(data$BREQ_10), p=rep(1/length(unique(data$BREQ_10)),length(unique(data$BREQ_10))))

chi2conformiteBREQExterne<-chisq.test(table(data$score_breq_Externe_categorystat), p=rep(1/length(table(data$score_breq_Externe_categorystat)),length(table(data$score_breq_Externe_categorystat))))

data_resumeBREQExterne_round<- data%>%
  summarise(
    median = round(median(SCORE_BREQ_Externe, na.rm = TRUE),1),
    moyenne= round(mean(SCORE_BREQ_Externe, na.rm=TRUE),1),
    q1 = round(quantile(SCORE_BREQ_Externe, 0.25, na.rm=T),1),
    q3 = round(quantile(SCORE_BREQ_Externe, 0.75, na.rm=T),1)
  )

data_resumeBREQExterne<- data%>%
  summarise(
    Médiane = median(SCORE_BREQ_Externe, na.rm = TRUE),
    Moyenne= mean(SCORE_BREQ_Externe, na.rm=TRUE),
    Ecart_type = sd(SCORE_BREQ_Externe, na.rm=TRUE)
  )

table_BREQExterne<- data.frame(
Item = c("BREQ 9", "BREQ 10", "SCORE_BREQ_Externe"),
  Moyenne = c(data_resumeBREQ9$Moyenne, data_resumeBREQ10$Moyenne, 
              data_resumeBREQExterne$Moyenne),
  Médiane = c(data_resumeBREQ9$Médiane, data_resumeBREQ10$Médiane, 
              data_resumeBREQExterne$Médiane),
  Ecart_type = c(data_resumeBREQ9$Ecart_type, data_resumeBREQ10$Ecart_type, 
              data_resumeBREQExterne$Ecart_type),
chi2_ajustement = c(chi2conformiteBREQ9$statistic, chi2conformiteBREQ10$statistic, chi2conformiteBREQExterne$statistic),
  P.value = ifelse(c(chi2conformiteBREQ9$p.value, chi2conformiteBREQ10$p.value, chi2conformiteBREQExterne$p.value) < 0.001, "<0.001", ">0.001")
)

kable(table_BREQExterne)

vlinesBREQ_Externe <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeBREQExterne_round$q1, data_resumeBREQExterne_round$moyenne, data_resumeBREQExterne_round$median, data_resumeBREQExterne_round$q3)
)
vlinesBREQ_Externe$annotation <- paste(vlinesBREQ_Externe$label, ":", vlinesBREQ_Externe$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_BREQ_Externe), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_BREQ_Externe, na.rm = TRUE), 
                                max(data$SCORE_BREQ_Externe, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score BREQ (motivation externe)",
       x = "Score BREQ (motivation externe)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesBREQ_Externe, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesBREQ_Externe, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```


### Amotivation{.tabset}

```{r score amotivation breq alpha cronbach}
data_BREQA <- data[, c("BREQ_11", "BREQ_12")]
cronbachBREQA<-cronbach(data_BREQA)

glue ("L'alpha de Cronbach sur les {cronbachBREQA$number.of.items} items est de {cronbachBREQA$alpha}")
```

#### BREQ 11
```{r graphique breq11}
data_resumeBREQ11 <- data%>%
  summarise(
    Moyenne = mean(BREQ_11, na.rm = TRUE),
    Médiane = median(BREQ_11, na.rm = TRUE),
    Ecart_type = sd(BREQ_11, na.rm=TRUE))

kable(data_resumeBREQ11)

ggplot(data, aes(x = factor(BREQ_11, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je ne vois pas pourquoi je devrais courir.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### BREQ 12
```{r graphique breq12}
data_resumeBREQ12 <- data%>%
  summarise(
    Moyenne = mean(BREQ_12, na.rm = TRUE),
    Médiane = median(BREQ_12, na.rm = TRUE),
    Ecart_type = sd(BREQ_12, na.rm=TRUE))

kable(data_resumeBREQ12)

ggplot(data, aes(x = factor(BREQ_12, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je pense que courir est une perte de temps.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")
```

#### Score amotivation
```{r graphique score amotivation breq}
data <- data %>% mutate (SCORE_BREQA = (BREQ_11+BREQ_12)/2)

data <- data %>% mutate(score_breqa_categorystat = case_when(
    SCORE_BREQA <2 ~  "1",
    SCORE_BREQA >= 2 & SCORE_BREQA < 3 ~"2",
    SCORE_BREQA >= 3 & SCORE_BREQA < 4 ~"3",
    SCORE_BREQA ==4 ~  "4"
  ))

chi2conformiteBREQ11<-chisq.test(table(data$BREQ_11), p=rep(1/length(unique(data$BREQ_11)),length(unique(data$BREQ_11))))
chi2conformiteBREQ12<-chisq.test(table(data$BREQ_12), p=rep(1/length(unique(data$BREQ_12)),length(unique(data$BREQ_12))))

chi2conformiteBREQA<-chisq.test(table(data$score_breqa_categorystat), p=rep(1/length(table(data$score_breqa_categorystat)),length(table(data$score_breqa_categorystat))))

data_resumeBREQA_round<- data%>%
  summarise(
    median = round(median(SCORE_BREQA, na.rm = TRUE),1),
    moyenne= round(mean(SCORE_BREQA, na.rm=TRUE),1),
    q1 = round(quantile(SCORE_BREQA, 0.25, na.rm=T),1),
    q3 = round(quantile(SCORE_BREQA, 0.75, na.rm=T),1)
  )

data_resumeBREQA<- data%>%
  summarise(
    Médiane = median(SCORE_BREQA, na.rm = TRUE),
    Moyenne= mean(SCORE_BREQA, na.rm=TRUE),
    Ecart_type = sd(SCORE_BREQA, na.rm=TRUE)
  )

table_BREQA<- data.frame(
Item = c("BREQ 11", "BREQ 12", "SCORE_BREQ_Amovitation"),
  Moyenne = c(data_resumeBREQ11$Moyenne, data_resumeBREQ12$Moyenne, 
              data_resumeBREQA$Moyenne),
  Médiane = c(data_resumeBREQ11$Médiane, data_resumeBREQ12$Médiane, 
              data_resumeBREQA$Médiane),
  Ecart_type = c(data_resumeBREQ11$Ecart_type, data_resumeBREQ12$Ecart_type, 
              data_resumeBREQA$Ecart_type),
chi2_ajustement = c(chi2conformiteBREQ11$statistic, chi2conformiteBREQ12$statistic, chi2conformiteBREQA$statistic),
  P.value = ifelse(c(chi2conformiteBREQ11$p.value, chi2conformiteBREQ12$p.value, chi2conformiteBREQA$p.value) < 0.001, "<0.001", ">0.001")
)

kable(table_BREQA)

vlinesBREQA <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeBREQA_round$q1, data_resumeBREQA_round$moyenne, data_resumeBREQA_round$median, data_resumeBREQA_round$q3)
)
vlinesBREQA$annotation <- paste(vlinesBREQA$label, ":", vlinesBREQA$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_BREQA), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_BREQA, na.rm = TRUE), 
                                max(data$SCORE_BREQA, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition du score BREQ (amotivation)",
       x = "Score BREQ (amotivation)", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesBREQA, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesBREQA, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()
```

### Relative Autonomy Index{.tabset}
Le Relative Autonomy Index est un indice qui mesure l'autonomie motivationnelle en pondérant les types de motivation selon leur degré d'autodétermination^12^. Il se calcule en faisant la somme suivante :

(-3)xScore_amotivation + (-2)xScore_motivation_externe + (-1)xScore_motivation_introjectée + Score_motivitation identifiée + 2x Score_motivation_intégrée + 3x Score_motivationè_intrinsèque.

Un haut score signifie que que l'individu est motivé de manière autonome (raisons intrinsèques ou identifiées) tandis qu'un score bas indique que l'individu est amotivé ou a une motivation contrôlée.

```{r score rai breq}
data <- data %>% mutate (SCORE_RAI = (-3)*SCORE_BREQA+ (-2)*SCORE_BREQ_Externe + (-1)*SCORE_BREQ_Introjectee + SCORE_BREQ_Identifiee + 2*SCORE_BREQ_Integree + 3*SCORE_BREQ_Intrinseque)

data_resumeRAI_round<- data%>%
  summarise(
  median = round(median(SCORE_RAI, na.rm = TRUE),1),
    moyenne= round(mean(SCORE_RAI, na.rm=TRUE),1),
    q1 = round(quantile(SCORE_RAI, 0.25, na.rm=T),1),
    q3 = round(quantile(SCORE_RAI, 0.75, na.rm=T),1)
  )

data_resumeRAI<- data%>%
  summarise(
    Médiane = median(SCORE_RAI, na.rm = TRUE),
    Moyenne= mean(SCORE_RAI, na.rm=TRUE),
    Ecart_type = sd(SCORE_RAI, na.rm=TRUE)
  )

table_RAI<- data.frame(
Item = c("RAI"),
  Moyenne = c(data_resumeRAI$Moyenne),
  Médiane = c(data_resumeRAI$Médiane),
  Ecart_type = c(data_resumeRAI$Ecart_type))

kable(table_RAI)

vlinesRAI <- data.frame(
  label = c("Q1", "Moyenne", "Médiane", "Q3"),
  xintercept = c(data_resumeRAI_round$q1, data_resumeRAI_round$moyenne, data_resumeRAI_round$median, data_resumeRAI_round$q3)
)
vlinesRAI$annotation <- paste(vlinesRAI$label, ":", vlinesRAI$xintercept)

ggplot(data) +
  geom_histogram(aes(x = SCORE_RAI), fill = "#FC4C02", binwidth=1, alpha=0.5, color="#FC4C02") +
  scale_x_continuous(breaks = seq(min(data$SCORE_RAI, na.rm = TRUE), 
                                max(data$SCORE_RAI, na.rm = TRUE), 
                                by = 1))+
  labs(title = "Répartition de l'indice RAI",
       x = "Score RAI", 
       y = "Nombre d'individus") +
  geom_vline(data = vlinesRAI, aes(xintercept = xintercept), 
             color = "black", linetype = "dashed", size = 0.5) +
  geom_text(data = vlinesRAI, aes(x = xintercept, y = 0, label = annotation), 
            color = "black", vjust = 1.5, hjust = -1, angle = 90, size = 3) +
  theme_minimal()


```

# Lien Strava - motivation

La question ici est de savoir si l'utilisation de Strava (intensité et fréquence d'utilisation, utilisation des fonctionnalités de sociabilisation en ligne et exposition d'informations personnelles...) ont un lien avec la motivation à courir (scores BREQ).

#### Une première approche{.tabset}

##### Sentiment de motivation
```{r graph motivation Strava}
data_resumeStrava_motivation <- data%>%
  summarise(
    Moyenne = mean(Strava_motivation, na.rm = TRUE),
    Médiane = median(Strava_motivation, na.rm = TRUE),
    Ecart_type = sd(Strava_motivation, na.rm=TRUE))

kable(data_resumeStrava_motivation)

ggplot(data, aes(x = factor(Strava_motivation, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Je me sens plus motivé(e) depuis que j'ai Strava.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```


##### Changement d'entraînement
```{r graphique changement dentrainement suite strava}
data_resumeStrava_change <- data%>%
  summarise(
    Moyenne = mean(Strava_change, na.rm = TRUE),
    Médiane = median(Strava_change, na.rm = TRUE),
    Ecart_type = sd(Strava_change, na.rm=TRUE))

kable(data_resumeStrava_change)

ggplot(data, aes(x = factor(Strava_change, levels = c(1, 2, 3, 4), labels = c("Pas du tout d'accord", "Plutôt pas d'accord", "Plutôt d'accord", "Totalement d'accord")))) +
  geom_bar(fill="#FC4C02", alpha=0.5) +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +
  labs(title = "",
       x = "Si je n’ai pas prévu de faire un entraînement, le fait de regarder Strava peut me faire changer d’avis.", y = "Nombre d'individus") +
  theme_minimal()+
  theme(legend.position = "none")

```

#### Corrélations

```{r correlations calculs BREQ}
#### SIS - BREQ

cor_SIS_intrinseque<- round(cor(data$SCORE_SIS_TOTAL, data$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_SIS_intrinsequeh <- round(cor(subset(data, Sexe == "1")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)
cor_SIS_intrinsequef <- round(cor(subset(data, Sexe == "2")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_SIS_integree<- round(cor(data$SCORE_SIS_TOTAL, data$SCORE_BREQ_Integree, use = "complete.obs"), 2)
cor_SIS_integreeh <- round(cor(subset(data, Sexe == "1")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Integree, use = "complete.obs"), 2)
cor_SIS_integreef <- round(cor(subset(data, Sexe == "2")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_SIS_identifiee<- round(cor(data$SCORE_SIS_TOTAL, data$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)
cor_SIS_identifieeh <- round(cor(subset(data, Sexe == "1")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)
cor_SIS_identifieef <- round(cor(subset(data, Sexe == "2")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_SIS_introjectee<- round(cor(data$SCORE_SIS_TOTAL, data$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)
cor_SIS_introjecteeh <- round(cor(subset(data, Sexe == "1")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)
cor_SIS_introjecteef <- round(cor(subset(data, Sexe == "2")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_SIS_externe<- round(cor(data$SCORE_SIS_TOTAL, data$SCORE_BREQ_Externe, use = "complete.obs"), 2)
cor_SIS_externeh <- round(cor(subset(data, Sexe == "1")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Externe, use = "complete.obs"), 2)
cor_SIS_externef <- round(cor(subset(data, Sexe == "2")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_SIS_amotivation<- round(cor(data$SCORE_SIS_TOTAL, data$SCORE_BREQA, use = "complete.obs"), 2)
cor_SIS_amotivationh <- round(cor(subset(data, Sexe == "1")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "1")$SCORE_BREQA, use = "complete.obs"), 2)
cor_SIS_amotivationf <- round(cor(subset(data, Sexe == "2")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "2")$SCORE_BREQA, use = "complete.obs"), 2)

cor_SIS_rai<- round(cor(data$SCORE_SIS_TOTAL, data$SCORE_RAI, use = "complete.obs"), 2)
cor_SIS_raih <- round(cor(subset(data, Sexe == "1")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "1")$SCORE_RAI, use = "complete.obs"), 2)
cor_SIS_raif <- round(cor(subset(data, Sexe == "2")$SCORE_SIS_TOTAL, 
                 subset(data, Sexe == "2")$SCORE_RAI, use = "complete.obs"), 2)

##### OSF - BREQ

cor_OSF_intrinseque<- round(cor(data$SCORE_OSF, data$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)
cor_OSF_intrinsequeh <- round(cor(subset(data, Sexe == "1")$SCORE_OSF, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)
cor_OSF_intrinsequef <- round(cor(subset(data, Sexe == "2")$SCORE_OSF, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_OSF_integree<- round(cor(data$SCORE_OSF, data$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_OSF_integreeh <- round(cor(subset(data, Sexe == "1")$SCORE_OSF, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_OSF_integreef <- round(cor(subset(data, Sexe == "2")$SCORE_OSF, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_OSF_identifiee<- round(cor(data$SCORE_OSF, data$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_OSF_identifieeh <- round(cor(subset(data, Sexe == "1")$SCORE_OSF, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_OSF_identifieef <- round(cor(subset(data, Sexe == "2")$SCORE_OSF, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)
                   
cor_OSF_introjectee<- round(cor(data$SCORE_OSF, data$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_OSF_introjecteeh <- round(cor(subset(data, Sexe == "1")$SCORE_OSF, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_OSF_introjecteef <- round(cor(subset(data, Sexe == "2")$SCORE_OSF, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_OSF_externe<- round(cor(data$SCORE_OSF, data$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_OSF_externeh <- round(cor(subset(data, Sexe == "1")$SCORE_OSF, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_OSF_externef <- round(cor(subset(data, Sexe == "2")$SCORE_OSF, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_OSF_amotivation<- round(cor(data$SCORE_OSF, data$SCORE_BREQA, use = "complete.obs"), 2)

cor_OSF_amotivationh <- round(cor(subset(data, Sexe == "1")$SCORE_OSF, 
                 subset(data, Sexe == "1")$SCORE_BREQA, use = "complete.obs"), 2)

cor_OSF_amotivationf <- round(cor(subset(data, Sexe == "2")$SCORE_OSF, 
                 subset(data, Sexe == "2")$SCORE_BREQA, use = "complete.obs"), 2)

cor_OSF_rai<- round(cor(data$SCORE_OSF, data$SCORE_RAI, use = "complete.obs"), 2)

cor_OSF_raih <- round(cor(subset(data, Sexe == "1")$SCORE_OSF, 
                 subset(data, Sexe == "1")$SCORE_RAI, use = "complete.obs"), 2)

cor_OSF_raif <- round(cor(subset(data, Sexe == "2")$SCORE_OSF, 
                 subset(data, Sexe == "2")$SCORE_RAI, use = "complete.obs"), 2)


#### Lien SCORE EXPO - BREQ
cor_EXPO_intrinseque<- round(cor(data$SCORE_EXPO, data$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_EXPO_intrinsequeh <- round(cor(subset(data, Sexe == "1")$SCORE_EXPO, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_EXPO_intrinsequef <- round(cor(subset(data, Sexe == "2")$SCORE_EXPO, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_EXPO_integree<- round(cor(data$SCORE_EXPO, data$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_EXPO_integreeh <- round(cor(subset(data, Sexe == "1")$SCORE_EXPO, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_EXPO_integreef <- round(cor(subset(data, Sexe == "2")$SCORE_EXPO, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Integree, use = "complete.obs"), 2)
cor_EXPO_identifiee<- round(cor(data$SCORE_EXPO, data$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_EXPO_identifieeh <- round(cor(subset(data, Sexe == "1")$SCORE_EXPO, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_EXPO_identifieef <- round(cor(subset(data, Sexe == "2")$SCORE_EXPO, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)
cor_EXPO_introjectee<- round(cor(data$SCORE_EXPO, data$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_EXPO_introjecteeh <- round(cor(subset(data, Sexe == "1")$SCORE_EXPO, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_EXPO_introjecteef <- round(cor(subset(data, Sexe == "2")$SCORE_EXPO, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_EXPO_externe<- round(cor(data$SCORE_EXPO, data$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_EXPO_externeh <- round(cor(subset(data, Sexe == "1")$SCORE_EXPO, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_EXPO_externef <- round(cor(subset(data, Sexe == "2")$SCORE_EXPO, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Externe, use = "complete.obs"), 2)
cor_EXPO_amotivation<- round(cor(data$SCORE_EXPO, data$SCORE_BREQA, use = "complete.obs"), 2)

cor_EXPO_amotivationh <- round(cor(subset(data, Sexe == "1")$SCORE_EXPO, 
                 subset(data, Sexe == "1")$SCORE_BREQA, use = "complete.obs"), 2)

cor_EXPO_amotivationf <- round(cor(subset(data, Sexe == "2")$SCORE_EXPO, 
                 subset(data, Sexe == "2")$SCORE_BREQA, use = "complete.obs"), 2)

cor_EXPO_rai<- round(cor(data$SCORE_EXPO, data$SCORE_RAI, use = "complete.obs"), 2)

cor_EXPO_raih <- round(cor(subset(data, Sexe == "1")$SCORE_EXPO, 
                 subset(data, Sexe == "1")$SCORE_RAI, use = "complete.obs"), 2)

cor_EXPO_raif <- round(cor(subset(data, Sexe == "2")$SCORE_EXPO, 
                 subset(data, Sexe == "2")$SCORE_RAI, use = "complete.obs"), 2)

##### Lien nb club Strava et BREQ

cor_Club_Strava_intrinseque<- round(cor(data$Club_Strava, data$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_Club_Strava_intrinsequeh <- round(cor(subset(data, Sexe == "1")$Club_Strava, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_Club_Strava_intrinsequef <- round(cor(subset(data, Sexe == "2")$Club_Strava, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_Club_Strava_integree<- round(cor(data$Club_Strava, data$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_Club_Strava_integreeh <- round(cor(subset(data, Sexe == "1")$Club_Strava, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_Club_Strava_integreef <- round(cor(subset(data, Sexe == "2")$Club_Strava, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Integree, use = "complete.obs"), 2)
cor_Club_Strava_identifiee<- round(cor(data$Club_Strava, data$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_Club_Strava_identifieeh <- round(cor(subset(data, Sexe == "1")$Club_Strava, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_Club_Strava_identifieef <- round(cor(subset(data, Sexe == "2")$Club_Strava, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)
cor_Club_Strava_introjectee<- round(cor(data$Club_Strava, data$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_Club_Strava_introjecteeh <- round(cor(subset(data, Sexe == "1")$Club_Strava, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_Club_Strava_introjecteef <- round(cor(subset(data, Sexe == "2")$Club_Strava, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_Club_Strava_externe<- round(cor(data$Club_Strava, data$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_Club_Strava_externeh <- round(cor(subset(data, Sexe == "1")$Club_Strava, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_Club_Strava_externef <- round(cor(subset(data, Sexe == "2")$Club_Strava, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Externe, use = "complete.obs"), 2)


cor_Club_Strava_amotivation<- round(cor(data$Club_Strava, data$SCORE_BREQA, use = "complete.obs"), 2)

cor_Club_Strava_amotivationh <- round(cor(subset(data, Sexe == "1")$Club_Strava, 
                 subset(data, Sexe == "1")$SCORE_BREQA, use = "complete.obs"), 2)

cor_Club_Strava_amotivationf <- round(cor(subset(data, Sexe == "2")$Club_Strava, 
                 subset(data, Sexe == "2")$SCORE_BREQA, use = "complete.obs"), 2)
cor_Club_Strava_rai<- round(cor(data$Club_Strava, data$SCORE_RAI, use = "complete.obs"), 2)

cor_Club_Strava_raih <- round(cor(subset(data, Sexe == "1")$Club_Strava, 
                 subset(data, Sexe == "1")$SCORE_RAI, use = "complete.obs"), 2)

cor_Club_Strava_raif <- round(cor(subset(data, Sexe == "2")$Club_Strava, 
                 subset(data, Sexe == "2")$SCORE_RAI, use = "complete.obs"), 2)

#### Nbs kudos recus - BREQ

cor_Kudos_recus_intrinseque<- round(cor(data$Kudos_reçus, data$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_Kudos_recus_intrinsequeh <- round(cor(subset(data, Sexe == "1")$Kudos_reçus, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_Kudos_recus_intrinsequef <- round(cor(subset(data, Sexe == "2")$Kudos_reçus, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_Kudos_recus_integree<- round(cor(data$Kudos_reçus, data$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_Kudos_recus_integreeh <- round(cor(subset(data, Sexe == "1")$Kudos_reçus, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_Kudos_recus_integreef <- round(cor(subset(data, Sexe == "2")$Kudos_reçus, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Integree, use = "complete.obs"), 2)
cor_Kudos_recus_identifiee<- round(cor(data$Kudos_reçus, data$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_Kudos_recus_identifieeh <- round(cor(subset(data, Sexe == "1")$Kudos_reçus, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_Kudos_recus_identifieef <- round(cor(subset(data, Sexe == "2")$Kudos_reçus, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)
cor_Kudos_recus_introjectee<- round(cor(data$Kudos_reçus, data$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_Kudos_recus_introjecteeh <- round(cor(subset(data, Sexe == "1")$Kudos_reçus, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_Kudos_recus_introjecteef <- round(cor(subset(data, Sexe == "2")$Kudos_reçus, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_Kudos_recus_externe<- round(cor(data$Kudos_reçus, data$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_Kudos_recus_externeh <- round(cor(subset(data, Sexe == "1")$Kudos_reçus, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_Kudos_recus_externef <- round(cor(subset(data, Sexe == "2")$Kudos_reçus, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Externe, use = "complete.obs"), 2)


cor_Kudos_recus_amotivation<- round(cor(data$Kudos_reçus, data$SCORE_BREQA, use = "complete.obs"), 2)

cor_Kudos_recus_amotivationh <- round(cor(subset(data, Sexe == "1")$Kudos_reçus, 
                 subset(data, Sexe == "1")$SCORE_BREQA, use = "complete.obs"), 2)

cor_Kudos_recus_amotivationf <- round(cor(subset(data, Sexe == "2")$Kudos_reçus, 
                 subset(data, Sexe == "2")$SCORE_BREQA, use = "complete.obs"), 2)
cor_Kudos_recus_rai<- round(cor(data$Kudos_reçus, data$SCORE_RAI, use = "complete.obs"), 2)

cor_Kudos_recus_raih <- round(cor(subset(data, Sexe == "1")$Kudos_reçus, 
                 subset(data, Sexe == "1")$SCORE_RAI, use = "complete.obs"), 2)

cor_Kudos_recus_raif <- round(cor(subset(data, Sexe == "2")$Kudos_reçus, 
                 subset(data, Sexe == "2")$SCORE_RAI, use = "complete.obs"), 2)

### Frequence publication - BREQ

cor_freq_publi_intrinseque<- round(cor(data$Fréquence_publication, data$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_freq_publi_intrinsequeh <- round(cor(subset(data, Sexe == "1")$Fréquence_publication, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_freq_publi_intrinsequef <- round(cor(subset(data, Sexe == "2")$Fréquence_publication, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_freq_publi_integree<- round(cor(data$Fréquence_publication, data$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_freq_publi_integreeh <- round(cor(subset(data, Sexe == "1")$Fréquence_publication, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_freq_publi_integreef <- round(cor(subset(data, Sexe == "2")$Fréquence_publication, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Integree, use = "complete.obs"), 2)
cor_freq_publi_identifiee<- round(cor(data$Fréquence_publication, data$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_freq_publi_identifieeh <- round(cor(subset(data, Sexe == "1")$Fréquence_publication, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_freq_publi_identifieef <- round(cor(subset(data, Sexe == "2")$Fréquence_publication, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)
cor_freq_publi_introjectee<- round(cor(data$Fréquence_publication, data$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_freq_publi_introjecteeh <- round(cor(subset(data, Sexe == "1")$Fréquence_publication, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_freq_publi_introjecteef <- round(cor(subset(data, Sexe == "2")$Fréquence_publication, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_freq_publi_externe<- round(cor(data$Fréquence_publication, data$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_freq_publi_externeh <- round(cor(subset(data, Sexe == "1")$Fréquence_publication, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_freq_publi_externef <- round(cor(subset(data, Sexe == "2")$Fréquence_publication, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Externe, use = "complete.obs"), 2)


cor_freq_publi_amotivation<- round(cor(data$Fréquence_publication, data$SCORE_BREQA, use = "complete.obs"), 2)

cor_freq_publi_amotivationh <- round(cor(subset(data, Sexe == "1")$Fréquence_publication, 
                 subset(data, Sexe == "1")$SCORE_BREQA, use = "complete.obs"), 2)

cor_freq_publi_amotivationf <- round(cor(subset(data, Sexe == "2")$Fréquence_publication, 
                 subset(data, Sexe == "2")$SCORE_BREQA, use = "complete.obs"), 2)
cor_freq_publi_rai<- round(cor(data$Fréquence_publication, data$SCORE_RAI, use = "complete.obs"), 2)

cor_freq_publi_raih <- round(cor(subset(data, Sexe == "1")$Fréquence_publication, 
                 subset(data, Sexe == "1")$SCORE_RAI, use = "complete.obs"), 2)

cor_freq_publi_raif <- round(cor(subset(data, Sexe == "2")$Fréquence_publication, 
                 subset(data, Sexe == "2")$SCORE_RAI, use = "complete.obs"), 2)

### Frequence consultation - BREQ

cor_freq_cons_intrinseque<- round(cor(data$Fréquence_consultation, data$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_freq_cons_intrinsequeh <- round(cor(subset(data, Sexe == "1")$Fréquence_consultation, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_freq_cons_intrinsequef <- round(cor(subset(data, Sexe == "2")$Fréquence_consultation, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_freq_cons_integree<- round(cor(data$Fréquence_consultation, data$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_freq_cons_integreeh <- round(cor(subset(data, Sexe == "1")$Fréquence_consultation, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_freq_cons_integreef <- round(cor(subset(data, Sexe == "2")$Fréquence_consultation, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Integree, use = "complete.obs"), 2)
cor_freq_cons_identifiee<- round(cor(data$Fréquence_consultation, data$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_freq_cons_identifieeh <- round(cor(subset(data, Sexe == "1")$Fréquence_consultation, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_freq_cons_identifieef <- round(cor(subset(data, Sexe == "2")$Fréquence_consultation, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)
cor_freq_cons_introjectee<- round(cor(data$Fréquence_consultation, data$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_freq_cons_introjecteeh <- round(cor(subset(data, Sexe == "1")$Fréquence_consultation, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_freq_cons_introjecteef <- round(cor(subset(data, Sexe == "2")$Fréquence_consultation, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_freq_cons_externe<- round(cor(data$Fréquence_consultation, data$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_freq_cons_externeh <- round(cor(subset(data, Sexe == "1")$Fréquence_consultation, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_freq_cons_externef <- round(cor(subset(data, Sexe == "2")$Fréquence_consultation, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Externe, use = "complete.obs"), 2)


cor_freq_cons_amotivation<- round(cor(data$Fréquence_consultation, data$SCORE_BREQA, use = "complete.obs"), 2)

cor_freq_cons_amotivationh <- round(cor(subset(data, Sexe == "1")$Fréquence_consultation, 
                 subset(data, Sexe == "1")$SCORE_BREQA, use = "complete.obs"), 2)

cor_freq_cons_amotivationf <- round(cor(subset(data, Sexe == "2")$Fréquence_consultation, 
                 subset(data, Sexe == "2")$SCORE_BREQA, use = "complete.obs"), 2)
cor_freq_cons_rai<- round(cor(data$Fréquence_consultation, data$SCORE_RAI, use = "complete.obs"), 2)

cor_freq_cons_raih <- round(cor(subset(data, Sexe == "1")$Fréquence_consultation, 
                 subset(data, Sexe == "1")$SCORE_RAI, use = "complete.obs"), 2)

cor_freq_cons_raif <- round(cor(subset(data, Sexe == "2")$Fréquence_consultation, 
                 subset(data, Sexe == "2")$SCORE_RAI, use = "complete.obs"), 2)

### Nb abonnes - BREQ

cor_nbabonnes_intrinseque<- round(cor(data$Nb_abonnés, data$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_nbabonnes_intrinsequeh <- round(cor(subset(data, Sexe == "1")$Nb_abonnés, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_nbabonnes_intrinsequef <- round(cor(subset(data, Sexe == "2")$Nb_abonnés, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_nbabonnes_integree<- round(cor(data$Nb_abonnés, data$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_nbabonnes_integreeh <- round(cor(subset(data, Sexe == "1")$Nb_abonnés, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_nbabonnes_integreef <- round(cor(subset(data, Sexe == "2")$Nb_abonnés, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Integree, use = "complete.obs"), 2)
cor_nbabonnes_identifiee<- round(cor(data$Nb_abonnés, data$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_nbabonnes_identifieeh <- round(cor(subset(data, Sexe == "1")$Nb_abonnés, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_nbabonnes_identifieef <- round(cor(subset(data, Sexe == "2")$Nb_abonnés, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)
cor_nbabonnes_introjectee<- round(cor(data$Nb_abonnés, data$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_nbabonnes_introjecteeh <- round(cor(subset(data, Sexe == "1")$Nb_abonnés, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_nbabonnes_introjecteef <- round(cor(subset(data, Sexe == "2")$Nb_abonnés, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_nbabonnes_externe<- round(cor(data$Nb_abonnés, data$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_nbabonnes_externeh <- round(cor(subset(data, Sexe == "1")$Nb_abonnés, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_nbabonnes_externef <- round(cor(subset(data, Sexe == "2")$Nb_abonnés, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Externe, use = "complete.obs"), 2)


cor_nbabonnes_amotivation<- round(cor(data$Nb_abonnés, data$SCORE_BREQA, use = "complete.obs"), 2)

cor_nbabonnes_amotivationh <- round(cor(subset(data, Sexe == "1")$Nb_abonnés, 
                 subset(data, Sexe == "1")$SCORE_BREQA, use = "complete.obs"), 2)

cor_nbabonnes_amotivationf <- round(cor(subset(data, Sexe == "2")$Nb_abonnés, 
                 subset(data, Sexe == "2")$SCORE_BREQA, use = "complete.obs"), 2)
cor_nbabonnes_rai<- round(cor(data$Nb_abonnés, data$SCORE_RAI, use = "complete.obs"), 2)

cor_nbabonnes_raih <- round(cor(subset(data, Sexe == "1")$Nb_abonnés, 
                 subset(data, Sexe == "1")$SCORE_RAI, use = "complete.obs"), 2)

cor_nbabonnes_raif <- round(cor(subset(data, Sexe == "2")$Nb_abonnés, 
                 subset(data, Sexe == "2")$SCORE_RAI, use = "complete.obs"), 2)


### Nb abonnements - BREQ

cor_nbabonnements_intrinseque<- round(cor(data$Nb_abonnements, data$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_nbabonnements_intrinsequeh <- round(cor(subset(data, Sexe == "1")$Nb_abonnements, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_nbabonnements_intrinsequef <- round(cor(subset(data, Sexe == "2")$Nb_abonnements, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_nbabonnements_integree<- round(cor(data$Nb_abonnements, data$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_nbabonnements_integreeh <- round(cor(subset(data, Sexe == "1")$Nb_abonnements, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_nbabonnements_integreef <- round(cor(subset(data, Sexe == "2")$Nb_abonnements, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Integree, use = "complete.obs"), 2)
cor_nbabonnements_identifiee<- round(cor(data$Nb_abonnements, data$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_nbabonnements_identifieeh <- round(cor(subset(data, Sexe == "1")$Nb_abonnements, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_nbabonnements_identifieef <- round(cor(subset(data, Sexe == "2")$Nb_abonnements, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)
cor_nbabonnements_introjectee<- round(cor(data$Nb_abonnements, data$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_nbabonnements_introjecteeh <- round(cor(subset(data, Sexe == "1")$Nb_abonnements, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_nbabonnements_introjecteef <- round(cor(subset(data, Sexe == "2")$Nb_abonnements, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_nbabonnements_externe<- round(cor(data$Nb_abonnements, data$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_nbabonnements_externeh <- round(cor(subset(data, Sexe == "1")$Nb_abonnements, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_nbabonnements_externef <- round(cor(subset(data, Sexe == "2")$Nb_abonnements, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Externe, use = "complete.obs"), 2)


cor_nbabonnements_amotivation<- round(cor(data$Nb_abonnements, data$SCORE_BREQA, use = "complete.obs"), 2)

cor_nbabonnements_amotivationh <- round(cor(subset(data, Sexe == "1")$Nb_abonnements, 
                 subset(data, Sexe == "1")$SCORE_BREQA, use = "complete.obs"), 2)

cor_nbabonnements_amotivationf <- round(cor(subset(data, Sexe == "2")$Nb_abonnements, 
                 subset(data, Sexe == "2")$SCORE_BREQA, use = "complete.obs"), 2)
cor_nbabonnements_rai<- round(cor(data$Nb_abonnements, data$SCORE_RAI, use = "complete.obs"), 2)

cor_nbabonnements_raih <- round(cor(subset(data, Sexe == "1")$Nb_abonnements, 
                 subset(data, Sexe == "1")$SCORE_RAI, use = "complete.obs"), 2)

cor_nbabonnements_raif <- round(cor(subset(data, Sexe == "2")$Nb_abonnements, 
                 subset(data, Sexe == "2")$SCORE_RAI, use = "complete.obs"), 2)

### Type abonnement - BREQ

cor_typeabonnement_intrinseque<- round(cor(data$Type_abonnement, data$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_typeabonnement_intrinsequeh <- round(cor(subset(data, Sexe == "1")$Type_abonnement, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_typeabonnement_intrinsequef <- round(cor(subset(data, Sexe == "2")$Type_abonnement, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_typeabonnement_integree<- round(cor(data$Type_abonnement, data$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_typeabonnement_integreeh <- round(cor(subset(data, Sexe == "1")$Type_abonnement, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_typeabonnement_integreef <- round(cor(subset(data, Sexe == "2")$Type_abonnement, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Integree, use = "complete.obs"), 2)
cor_typeabonnement_identifiee<- round(cor(data$Type_abonnement, data$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_typeabonnement_identifieeh <- round(cor(subset(data, Sexe == "1")$Type_abonnement, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_typeabonnement_identifieef <- round(cor(subset(data, Sexe == "2")$Type_abonnement, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)
cor_typeabonnement_introjectee<- round(cor(data$Type_abonnement, data$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_typeabonnement_introjecteeh <- round(cor(subset(data, Sexe == "1")$Type_abonnement, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_typeabonnement_introjecteef <- round(cor(subset(data, Sexe == "2")$Type_abonnement, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_typeabonnement_externe<- round(cor(data$Type_abonnement, data$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_typeabonnement_externeh <- round(cor(subset(data, Sexe == "1")$Type_abonnement, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_typeabonnement_externef <- round(cor(subset(data, Sexe == "2")$Type_abonnement, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Externe, use = "complete.obs"), 2)


cor_typeabonnement_amotivation<- round(cor(data$Type_abonnement, data$SCORE_BREQA, use = "complete.obs"), 2)

cor_typeabonnement_amotivationh <- round(cor(subset(data, Sexe == "1")$Type_abonnement, 
                 subset(data, Sexe == "1")$SCORE_BREQA, use = "complete.obs"), 2)

cor_typeabonnement_amotivationf <- round(cor(subset(data, Sexe == "2")$Type_abonnement, 
                 subset(data, Sexe == "2")$SCORE_BREQA, use = "complete.obs"), 2)
cor_typeabonnement_rai<- round(cor(data$Type_abonnement, data$SCORE_RAI, use = "complete.obs"), 2)

cor_typeabonnement_raih <- round(cor(subset(data, Sexe == "1")$Type_abonnement, 
                 subset(data, Sexe == "1")$SCORE_RAI, use = "complete.obs"), 2)

cor_typeabonnement_raif <- round(cor(subset(data, Sexe == "2")$Type_abonnement, 
                 subset(data, Sexe == "2")$SCORE_RAI, use = "complete.obs"), 2)


### Anciennete strava - BREQ
cor_anciennetestrava_intrinseque<- round(cor(data$Ancienneté_Strava, data$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_anciennetestrava_intrinsequeh <- round(cor(subset(data, Sexe == "1")$Ancienneté_Strava, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_anciennetestrava_intrinsequef <- round(cor(subset(data, Sexe == "2")$Ancienneté_Strava, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Intrinseque, use = "complete.obs"), 2)

cor_anciennetestrava_integree<- round(cor(data$Ancienneté_Strava, data$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_anciennetestrava_integreeh <- round(cor(subset(data, Sexe == "1")$Ancienneté_Strava, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Integree, use = "complete.obs"), 2)

cor_anciennetestrava_integreef <- round(cor(subset(data, Sexe == "2")$Ancienneté_Strava, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Integree, use = "complete.obs"), 2)
cor_anciennetestrava_identifiee<- round(cor(data$Ancienneté_Strava, data$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_anciennetestrava_identifieeh <- round(cor(subset(data, Sexe == "1")$Ancienneté_Strava, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)

cor_anciennetestrava_identifieef <- round(cor(subset(data, Sexe == "2")$Ancienneté_Strava, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Identifiee, use = "complete.obs"), 2)
cor_anciennetestrava_introjectee<- round(cor(data$Ancienneté_Strava, data$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_anciennetestrava_introjecteeh <- round(cor(subset(data, Sexe == "1")$Ancienneté_Strava, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_anciennetestrava_introjecteef <- round(cor(subset(data, Sexe == "2")$Ancienneté_Strava, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Introjectee, use = "complete.obs"), 2)

cor_anciennetestrava_externe<- round(cor(data$Ancienneté_Strava, data$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_anciennetestrava_externeh <- round(cor(subset(data, Sexe == "1")$Ancienneté_Strava, 
                 subset(data, Sexe == "1")$SCORE_BREQ_Externe, use = "complete.obs"), 2)

cor_anciennetestrava_externef <- round(cor(subset(data, Sexe == "2")$Ancienneté_Strava, 
                 subset(data, Sexe == "2")$SCORE_BREQ_Externe, use = "complete.obs"), 2)


cor_anciennetestrava_amotivation<- round(cor(data$Ancienneté_Strava, data$SCORE_BREQA, use = "complete.obs"), 2)

cor_anciennetestrava_amotivationh <- round(cor(subset(data, Sexe == "1")$Ancienneté_Strava, 
                 subset(data, Sexe == "1")$SCORE_BREQA, use = "complete.obs"), 2)

cor_anciennetestrava_amotivationf <- round(cor(subset(data, Sexe == "2")$Ancienneté_Strava, 
                 subset(data, Sexe == "2")$SCORE_BREQA, use = "complete.obs"), 2)
cor_anciennetestrava_rai<- round(cor(data$Ancienneté_Strava, data$SCORE_RAI, use = "complete.obs"), 2)

cor_anciennetestrava_raih <- round(cor(subset(data, Sexe == "1")$Ancienneté_Strava, 
                 subset(data, Sexe == "1")$SCORE_RAI, use = "complete.obs"), 2)

cor_anciennetestrava_raif <- round(cor(subset(data, Sexe == "2")$Ancienneté_Strava, 
                 subset(data, Sexe == "2")$SCORE_RAI, use = "complete.obs"), 2)




```

```{r correlations affichage BREQ}
table_Motivation_Correlations <- data.frame(
  Motivation = c("SCORE SIS ", "SCORE OSF ", "SCORE EXPO ", "Clubs Strava ", "Kudos reçus ", "Fréquence publication ", "Fréquence consultation ", "Nombre d'abonnés ", "Nombre d'abonnements ", "Type d'abonnement ", "Ancienneté Strava "),
  intrinseque = c(cor_SIS_intrinseque, cor_OSF_intrinseque, cor_EXPO_intrinseque, cor_Club_Strava_intrinseque, cor_Kudos_recus_intrinseque, cor_freq_publi_intrinseque, cor_freq_cons_intrinseque, cor_nbabonnes_intrinseque, cor_nbabonnements_intrinseque, cor_typeabonnement_intrinseque, cor_anciennetestrava_intrinseque),
  integree = c(cor_SIS_integree, cor_OSF_integree, cor_EXPO_integree, cor_Club_Strava_integree, cor_Kudos_recus_integree, cor_freq_publi_integree, cor_freq_cons_integree, cor_nbabonnes_integree, cor_nbabonnements_integree, cor_typeabonnement_integree, cor_anciennetestrava_integree),
  identifiee = c(cor_SIS_identifiee, cor_OSF_identifiee, cor_EXPO_identifiee, cor_Club_Strava_identifiee, cor_Kudos_recus_identifiee, cor_freq_publi_identifiee, cor_freq_cons_identifiee, cor_nbabonnes_identifiee, cor_nbabonnements_identifiee, cor_typeabonnement_identifiee, cor_anciennetestrava_identifiee),
  introjectee = c(cor_SIS_introjectee, cor_OSF_introjectee, cor_EXPO_introjectee, cor_Club_Strava_introjectee, cor_Kudos_recus_introjectee, cor_freq_publi_introjectee, cor_freq_cons_introjectee, cor_nbabonnes_introjectee, cor_nbabonnements_introjectee, cor_typeabonnement_introjectee, cor_anciennetestrava_introjectee),
  externe = c(cor_SIS_externe, cor_OSF_externe, cor_EXPO_externe, cor_Club_Strava_externe, cor_Kudos_recus_externe, cor_freq_publi_externe, cor_freq_cons_externe, cor_nbabonnes_externe, cor_nbabonnements_externe, cor_typeabonnement_externe, cor_anciennetestrava_externe),
  amotivation = c(cor_SIS_amotivation, cor_OSF_amotivation, cor_EXPO_amotivation, cor_Club_Strava_amotivation, cor_Kudos_recus_amotivation, cor_freq_publi_amotivation, cor_freq_cons_amotivation, cor_nbabonnes_amotivation, cor_nbabonnements_amotivation, cor_typeabonnement_amotivation, cor_anciennetestrava_amotivation),
  RAI =  c(cor_SIS_rai, cor_OSF_rai, cor_EXPO_rai, cor_Club_Strava_rai, cor_Kudos_recus_rai, cor_freq_publi_rai, cor_freq_cons_rai, cor_nbabonnes_rai, cor_nbabonnements_rai, cor_typeabonnement_rai, cor_anciennetestrava_rai)
)

table_Motivation_Correlations$intrinseque <- ifelse(
  table_Motivation_Correlations$intrinseque > 0.3, 
  paste0('<span style="color:green;">', table_Motivation_Correlations$intrinseque, '</span>'),
  ifelse(
    table_Motivation_Correlations$intrinseque > 0.2, 
    paste0('<span style="color:#FC4C02;">', table_Motivation_Correlations$intrinseque, '</span>'),
    ifelse(
      table_Motivation_Correlations$intrinseque > 0.1, 
      paste0('<span style="color:red;">', table_Motivation_Correlations$intrinseque, '</span>'),
      table_Motivation_Correlations$intrinseque
    )
  )
)

table_Motivation_Correlations$integree <- ifelse(
  table_Motivation_Correlations$integree > 0.3, 
  paste0('<span style="color:green;">', table_Motivation_Correlations$integree, '</span>'),
  ifelse(
    table_Motivation_Correlations$integree > 0.2, 
    paste0('<span style="color:#FC4C02;">', table_Motivation_Correlations$integree, '</span>'),
    ifelse(
      table_Motivation_Correlations$integree > 0.1, 
      paste0('<span style="color:red;">', table_Motivation_Correlations$integree, '</span>'),
      table_Motivation_Correlations$integree
    )
  )
)

table_Motivation_Correlations$identifiee <- ifelse(
  table_Motivation_Correlations$identifiee > 0.3, 
  paste0('<span style="color:green;">', table_Motivation_Correlations$identifiee, '</span>'),
  ifelse(
    table_Motivation_Correlations$identifiee > 0.2, 
    paste0('<span style="color:#FC4C02;">', table_Motivation_Correlations$identifiee, '</span>'),
    ifelse(
      table_Motivation_Correlations$identifiee > 0.1, 
      paste0('<span style="color:red;">', table_Motivation_Correlations$identifiee, '</span>'),
      table_Motivation_Correlations$identifiee
    )
  )
)

table_Motivation_Correlations$introjectee <- ifelse(
  table_Motivation_Correlations$introjectee > 0.3, 
  paste0('<span style="color:green;">', table_Motivation_Correlations$introjectee, '</span>'),
  ifelse(
    table_Motivation_Correlations$introjectee > 0.2, 
    paste0('<span style="color:#FC4C02;">', table_Motivation_Correlations$introjectee, '</span>'),
    ifelse(
      table_Motivation_Correlations$introjectee > 0.1, 
      paste0('<span style="color:red;">', table_Motivation_Correlations$introjectee, '</span>'),
      table_Motivation_Correlations$introjectee
    )
  )
)

table_Motivation_Correlations$externe <- ifelse(
  table_Motivation_Correlations$externe > 0.3, 
  paste0('<span style="color:green;">', table_Motivation_Correlations$externe, '</span>'),
  ifelse(
    table_Motivation_Correlations$externe > 0.2, 
    paste0('<span style="color:#FC4C02;">', table_Motivation_Correlations$externe, '</span>'),
    ifelse(
      table_Motivation_Correlations$externe > 0.1, 
      paste0('<span style="color:red;">', table_Motivation_Correlations$externe, '</span>'),
      table_Motivation_Correlations$externe
    )
  )
)

table_Motivation_Correlations$amotivation <- ifelse(
  table_Motivation_Correlations$amotivation > 0.3, 
  paste0('<span style="color:green;">', table_Motivation_Correlations$amotivation, '</span>'),
  ifelse(
    table_Motivation_Correlations$amotivation > 0.2, 
    paste0('<span style="color:#FC4C02;">', table_Motivation_Correlations$amotivation, '</span>'),
    ifelse(
      table_Motivation_Correlations$amotivation > 0.1, 
      paste0('<span style="color:red;">', table_Motivation_Correlations$amotivation, '</span>'),
      table_Motivation_Correlations$amotivation
    )
  )
)

table_Motivation_Correlations$RAI <- ifelse(
  table_Motivation_Correlations$RAI > 0.3, 
  paste0('<span style="color:green;">', table_Motivation_Correlations$RAI, '</span>'),
  ifelse(
    table_Motivation_Correlations$RAI > 0.2, 
    paste0('<span style="color:#FC4C02;">', table_Motivation_Correlations$RAI, '</span>'),
    ifelse(
      table_Motivation_Correlations$RAI > 0.1, 
      paste0('<span style="color:red;">', table_Motivation_Correlations$RAI, '</span>'),
      table_Motivation_Correlations$RAI
    )
  )
)

kable(table_Motivation_Correlations, format = "html", escape = FALSE)

```

#### Graphiques corrélations >0.2{.tabset}

##### SIS- Introjectée
```{r graphique score sis en fonction introjectee}
ggplot(data, aes(x = SCORE_SIS_TOTAL , y = SCORE_BREQ_Introjectee, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_SIS_introjectee)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)", cor_SIS_introjecteeh)), color = "#F8766D") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_SIS_introjecteef)), color = "#00BFC4") +
    labs(title = "SCORE BREQ motivation introjectée en fonction du SCORE SIS",
         x = "SCORE SIS (Intensité d'utilisation de Strava)",
         y = "SCORE BREQ motivation introjectée",
         color = "Sexe",
         linetype = "Régression avec R") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Régression avec R"))
```

##### Kudos- Intégrée
```{r graphique nb kudos recus intégrée}
ggplot(data, aes(x = Kudos_reçus , y = SCORE_BREQ_Integree, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_Kudos_recus_integree)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)",cor_Kudos_recus_integreeh)), color = "#F8766D") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_Kudos_recus_integreef)), color = "#00BFC4") +
    labs(title = "SCORE BREQ motivation intégrée en fonction du nombre de kudos reçus",
         x = "Nombre de kudos reçus en moyenne sur une activité",
         y = "SCORE BREQ motivation intégrée",
         color = "Sexe",
         linetype = "Régression avec R") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Régression avec R"))
```

##### Fréquence de publication - Intrinsèque
```{r graphique freq publi recus intrinseque}
ggplot(data, aes(x = Fréquence_publication , y = SCORE_BREQ_Intrinseque, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_freq_publi_intrinseque)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)",cor_freq_publi_intrinsequeh)), color = "#F8766D") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_freq_publi_intrinsequef)), color = "#00BFC4") +
    labs(title = "SCORE BREQ motivation intrinsèque en fonction du nombre de publication",
         x = "Fréquence publication (nombre de fois par semaine)",
         y = "SCORE BREQ motivation intrinsèque",
         color = "Sexe",
         linetype = "Régression avec R") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Régression avec R"))
```

##### Fréquence de publication - Intégrée
```{r graphique freq publi recus intégrée}
ggplot(data, aes(x = Fréquence_publication , y = SCORE_BREQ_Integree, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_freq_publi_integree)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)",cor_freq_publi_integreeh)), color = "#F8766D") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_freq_publi_integreef)), color = "#00BFC4") +
    labs(title = "SCORE BREQ motivation intégrée en fonction du nombre de publication",
         x = "Fréquence publication (nombre de fois par semaine)",
         y = "SCORE BREQ motivation intégrée",
         color = "Sexe",
         linetype = "Régression avec R") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Régression avec R"))
```

##### Fréquence de publication - Identifiée
```{r graphique freq publi recus identifiée}
ggplot(data, aes(x = Fréquence_publication , y = SCORE_BREQ_Identifiee, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_freq_publi_identifiee)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)",cor_freq_publi_identifieeh)), color = "#F8766D") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_freq_publi_identifieef)), color = "#00BFC4") +
    labs(title = "SCORE BREQ motivation identifiée en fonction du nombre de publication",
         x = "Fréquence publication (nombre de fois par semaine)",
         y = "SCORE BREQ motivation identifiée",
         color = "Sexe",
         linetype = "Régression avec R") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Régression avec R"))
```

##### Nombre abonnements - Intégrée
```{r graphique nb abonnements intégrée}
ggplot(data, aes(x = Nb_abonnements , y = SCORE_BREQ_Integree, 
                 color = factor(Sexe, levels = c(1, 2), labels = c("Homme", "Femme")))) +
    geom_point() +  
    geom_smooth(method = "lm", se = FALSE, aes(linetype = sprintf("Général (R = %.2f)", cor_nbabonnements_integree)), color = "black") +  
    geom_smooth(data = subset(data, Sexe == "1"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Homme (R = %.2f)",cor_nbabonnements_integreeh)), color = "#F8766D") +  
    geom_smooth(data = subset(data, Sexe == "2"), method = "lm", se = FALSE, 
                aes(linetype = sprintf("Femme (R = %.2f)", cor_nbabonnements_integreef)), color = "#00BFC4") +
    labs(title = "SCORE BREQ motivation intégrée en fonction du nombre d'abonnements",
         x = "Nombre d'abonnements",
         y = "SCORE BREQ motivation intégrée",
         color = "Sexe",
         linetype = "Régression avec R") +
    theme_minimal() +
    guides(linetype = guide_legend(title = "Régression avec R"))
```

# Limites
Il s'agit d'un questionnaire en ligne diffusé sur les réseaux sociaux donc il est difficile de maîtriser la véracité des réponses. De plus, il s'agit d'auto-évalution pour chaque réponse donc il peut y avoir un biais de désirabilité sociale, un biais de confirmation, un effet de halo, et un biais d'auto-complaisance. Il n'y a pas de mesures objectives. Par ailleurs, il s'agit uniquement de personnes volontaires qui ont répondus. Mon étude ne tient pas compte des coureurs amateurs qui ont utilisé Strava et ont choisi de l'arrêter ou qui n'ont jamais utilisé Strava.

Il aurait également pu être intéressant de mesurer la tendance à la comparaison sociale en utilisant le questionnaire INCOM de Gibbons ^14^ ou le bien-être psychologique avec le Well-Being Scale ^15^ ou encore l'estime de soi ^16^ mais le questionnaire ne devait pas être trop long afin de ne pas décourager les répondants.

# Bibliographie
[1] : Strava. (2024). Year in sport: The trend report. Strava. https://downloads.ctfassets.net/wad4jonn1ykp/1sJg4OiBKFoGYDtw9NV9v4/69d6c0b71cfebb350f27b8f8abcf42f9/Strava_Year_in_Sport_-The_Trend_Report-_fr-FR.pdf

[2] : Strava. (2023). Rapport global Strava 2023. Strava. https://downloads.ctfassets.net/9olkiac82a1q/iU421iiO6Hky1MVvYThmz/618d11560020aaf123d5e1670fd50514/Strava-Global-Report-2023-fr-FR.pdf

[3] : Russell, H. C., Potts, C., & Nelson, E. (2023). “If it’s not on strava it didn’t happen”: Perceived psychosocial implications of strava use in collegiate club runners. Recreational Sports Journal, 47(1), 15‑25. https://doi.org/10.1177/15588661221148170

[4] : Evans, B. (2019). Why we run. An exploration of what and who motivates us to run. URL: https://whywerun. strava. com/assets/whitepaper/Whitepaper_Strava_WhyWeRun_012320. pdf(дата звернення: 10.12. 2020).

[5] : Chapman, L. G. (2024). Social Comparison Predicts Well-Being in Non-Elite Young Adult Runners Who Use Strava (Master's thesis, Miami University).

[6] : Petersen, J. M., Kemps, E., Lewis, L. K., & Prichard, I. (2020). Associations between commercial app use and physical activity: cross-sectional study. Journal of medical Internet research, 22(6), e17152.

[7] : Stragier, J., Vanden Abeele, M., & De Marez, L. (2018). Recreational athletes’ running motivations as predictors of their use of online fitness community features. Behaviour & Information Technology, 37(8), 815-827.

[8] : Ellison, N. B., Steinfield, C., & Lampe, C. (2007). The benefits of facebook “friends:” social capital and college students’ use of online social network sites. Journal of Computer-Mediated Communication, 12(4), 1143‑1168. https://doi.org/10.1111/j.1083-6101.2007.00367.

[9] : Ross, C., Orr, E. S., Sisic, M., Arseneault, J. M., Simmering, M. G., & Orr, R. R. (2009). Personality and motivations associated with Facebook use. Computers in Human Behavior, 25(2), 578‑586. https://doi.org/10.1016/j.chb.2008.12.024

[10] : Hjetland, G. J., Finserås, T. R., Sivertsen, B., Colman, I., Hella, R. T., & Skogen, J. C. (2022). Focus on self-presentation on social media across sociodemographic variables, lifestyles, and personalities: A cross-sectional study. International journal of environmental research and public health, 19(17), 11133.

[11] : Sischka, P. E., Grübbel, L., Reisinger, C., Neufang, K. M., & Schmidt, A. F. (2024). On the dimensionality, suitability of sum/mean scores, and cross-country measurement invariance of the Perceived Stress Scale 10 (PSS-10)–Evidence from 41 countries. Management, 18, 04.

[12] : Rocchi, M. A., Wilson, P. M., Sylvester, B. D., Guerin, E., Shi, Z., & Sweet, S. N. (2023). Toward brief tools assessing motivation for exercise: Rationale and development of a six-and 12-item version of the Behavioral Regulation in Exercise 3 (BREQ3) Questionnaire. Sport, Exercise, and Performance Psychology, 12(3), 205.

[13] : Chiu, Y. H., Lu, F. J. H., Lin, J. H., Nien, C. L., Hsu, Y. W., & Liu, H. Y. (2016). Psychometric properties of the Perceived Stress Scale (PSS): measurement invariance between athletes and non-athletes and construct validity. PeerJ, 4, e2790.

[14] : Gibbons, F. X., & Buunk, B. P. (1999). Individual differences in social comparison: development of a scale of social comparison orientation. Journal of personality and social psychology, 76(1), 129.

[15] : Trousselard, M., Steiler, D., Dutheil, F., Claverie, D., Canini, F., Fenouillet, F., ... & Franck, N. (2016). Validation of the Warwick-Edinburgh mental well-being scale (WEMWBS) in French psychiatric and general populations. Psychiatry research, 245, 282-290.

[16] : Repišti, S., & Kerla, M. (2016). Social self-esteem scale(Sses). Unpublished. https://doi.org/10.13140/RG.2.1.3118.3128

[17] : Hjetland, G. J., Finserås, T. R., Sivertsen, B., Colman, I., Hella, R. T., Andersen, A. I. O., & Skogen, J. C. (2024). Digital self-presentation and adolescent mental health: Cross-sectional and longitudinal insights from the “LifeOnSoMe”-study. BMC Public Health, 24(1), 2635.

# Annexes

Questionnaire utilisé dans le cadre de l'étude :

##### Questions générales
1. Âge : *de 18 à 86 ans et plus*
2. Sexe : *Homme / Femme*
3. Catégorie socio-professionnelle : *Agriculteurs exploitants / Artisans / Commerçants et chefs d'entreprise / Cadres et professions intellectuelles supérieures / Professions intermédiaires / Employés / Ouvriers / Retraités / Etudiants / Autres personnes sans activité professionelle*

##### Quantification de la pratique de la course à pied
4. Depuis combien de temps pratiquez-vous la course à pied (en années) ? *Réponse libre chiffrée*
5. Êtes-vous un(e) coureur (se) : *Débutant(e) / Intermédiaire / Confirmé(e) /	Expert(e)*
6. Combien de fois courez-vous par semaine en moyenne ? *Réponse libre chiffrée*
7. Combien de kilomètres parcourez-vous par semaine en moyenne ? *Réponse libre chiffrée*
8. A combien de compétitions (objectifs principaux) participez-vous par an en moyenne ? *Réponse libre chiffrée*
9. Vous pratiquez le plus souvent la course à pied : *Sur route / En montagne ou sentiers de pleine nature (trail)*
10. Êtes-vous dans un club de course à pied ? *Oui / Non*
11. Etes-vous accompagné(e) par un coach ou un entraîneur personnel ? *Oui / Non*
12. Suivez-vous un programme d'entraînement (type RunMotionCoach, Decathlon, Nolio, ...) ? *Oui / Non*
13. Vous vous entraînez le plus souvent : *Seul / En groupe*
14. Avez-vous un objectif de compétition en 2025 ? *Oui / Non*
15. Si oui, précisez le nombre de kilomètres de votre objectif principal (le plus long en distance si plusieurs objectifs) : *20K / 50 K / 100 K / 100M* (Non obligatoire)
16. Au cours des 6 mois précédents, avez-vous été blessé(e) à cause de la course à pied ? *Oui / Non*
17. Si oui, cette blessure a-t-elle imposée une pause dans votre pratique ? *Oui, quelques jours / Oui, quelques semaines / Oui, quelques mois	/ Non* (Non obligatoire)

##### Quantitifaction de l'utilisation de Strava
18. A quelle fréquence publiez-vous vos activités sur Strava ? (nombre de jours par semaine) : *Réponse libre chiffrée*[a]
19. A quelle fréquence consultez-vous votre fil Strava ? (nombre de jours par semaine) : *Réponse libre chiffrée* [a] 
20. Strava fait partie de mon activité quotidienne : *Pas du tout d'accord /	Plutôt pas d'accord / Plutôt d'accord /	Totalement d'accord* [a]
21. Je suis fier(fière) de dire aux gens que j’utilise Strava : *Pas du tout d'accord /	Plutôt pas d'accord / Plutôt d'accord /	Totalement d'accord* [a]
22. Je me sens déconnecté(e) lorsque je n’ai pas utilisé Strava depuis un certain temps : *Pas du tout d'accord /	Plutôt pas d'accord / Plutôt d'accord /	Totalement d'accord* [a]
23. J’ai l’impression de faire partie de la communauté Strava : *Pas du tout d'accord /	Plutôt pas d'accord / Plutôt d'accord /	Totalement d'accord* [a]
24. Je ne pourrais pas arrêter d'utiliser Strava : *Pas du tout d'accord /	Plutôt pas d'accord / Plutôt d'accord /	Totalement d'accord* [a]
25. Qui peut voir les éléments suivants sur votre compte Strava ? [c]
- Vos activités : *Uniquement vous-même / Uniquement vos abonnés / Tout le monde*
- Horaire de départ de vos activités : *Uniquement vous-même / Uniquement vos abonnés / Tout le monde*
- Fréquence cardiaque : *Uniquement vous-même / Uniquement vos abonnés / Tout le monde*
- Allure : *Uniquement vous-même / Uniquement vos abonnés / Tout le monde*
- Points de départ et arrivée de vos activités : *Uniquement vous-même / Uniquement vos abonnés / Tout le monde*
26. Vous publiez sur Strava : *Quasiment aucun entraînement / Uniquement certain de vos entraînements / Quasiment tous vos entraînements	/ Tous vos entraînements* [c]
27. Vous publiez sur Strava : *Quasiement aucune compétition	/ Uniquement certaines de vos compétitions / Quasiment toutes vos compétitions / Toutes vos compéititions* [c]
28. Lorsque vous publiez une activité sur Strava : [c]
- Nommez-vous votre activité ? *Jamais /	Parfois	/ Souvent /	Toujours*
- Ajoutez-vous des commentaires ?  *Jamais /	Parfois	/ Souvent /	Toujours*
- Ajoutez-vous des photos ? *Jamais /	Parfois	/ Souvent /	Toujours*
29. Le plus important pour vous lors de la publication d'une activité est : *Le temps total écoulé	La durée totale de déplacement*
30. Qui peut s’abonner à votre compte Strava ? *Uniquement les utilisateurs que j'accepte	Tout le monde*
31. Vous êtes-vous déjà désabonné d’un compte d'un autre utilisateur ? *Oui / Non*
32. Avez-vous déjà bloqué l’accès à votre compte à un autre utilisateur ?  *Oui / Non*
33. Si oui, pour quelle(s) raison(s) ? *Pour éviter de communiquer avec cet utilisateur	/ Pour éviter le harcèlement / Autre* (Non obligatoire)
34. A combien de personnes êtes-vous abonné(e) ? (estimation) *Réponse libre chiffrée* [a]
35. Parmi les personnes auxquelles vous êtes abonnés, vous avez : (plusieurs réponses possibles) *Des amis /	Des connaissances /	Des membres de votre famille /	Des collègues de travail /	Des influenceurs /	Des athlètes professionnels	/ Autre*
36. Combien d’abonnés avez-vous sur Strava ? (estimation) *Réponse libre chiffrée* [a]
37. Parmi vos abonnés, vous avez : (plusieurs réponses possibles) *Des amis /	Des connaissances /	Des membres de votre famille /	Des collègues de travail /	Des influenceurs /	Des athlètes professionnels	/ Autre*
38. De combien de clubs Strava faites-vous partie ? *Réponse libre chiffrée*
39. Envoyez-vous des kudos ? *Jamais /	Parfois	/ Souvent /	Toujours* [b]
40. Laissez-vous des commentaires ? *Jamais /	Parfois	/ Souvent /	Toujours* [b]
41. Faites-vous des publications (hors activités) ? *Jamais /	Parfois	/ Souvent /	Toujours* [b]
42. Recevez-vous des commentaires ? *Jamais /	Parfois	/ Souvent /	Toujours* [b]
43. Combien de kudos recevez-vous en moyenne sur une activité de type entraînement standard ? *Réponse libre chiffrée*
44. Dans quel(s) but(s) utilisez-vous Strava ? (plusieurs réponses possibles) *Suivi de la performance	/ Motivation personnelle	/ Interaction sociale /	Comparaison avec d'autres coureurs /	Partage de vos activités / Enregistrement de vos activités	/ Suivi de progrès /	Idée de parcours /	Côté ludique (segment, classements, KOM/QOM…)	/ Appartenance à une communauté /	Encouragements (kudos) /	Atteinte d'objectifs personnels	/ Autre*
45. Quelle(s) fonctionnalité(s) de Strava trouvez-vous le(s) plus utile(s) dans votre pratique ? (Plusieurs réponses possibles) :*Enregistrement de vos activités / Suivi GPS .	Analyse des performances /	Segments /	Classements /	Challenges  /	Clubs /	Planification d'itinéraire /	Evènements /	Heatmap (endroit où vous vous êtes le plus entraîné) / Interactions sociales /	Kudos	/ Suivi des progrès /	Autre*

##### Self-Presentation and Upward Social Comparison Inclination Scale

46. Je consacre beaucoup de temps et d'énergie à publier mes activités sur Strava.  *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [e]
47. Il est important pour moi d’avoir beaucoup d’abonnés sur Strava. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [e]
48. Je supprime mes activités sur Strava qui ne reçoivent pas assez de kudos et/ou de commentaires. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [e]
49. Je retouche mes activités avant de les publier sur Strava pour qu’elles paraissent meilleures. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [e]
50. Ce que d’autres coureurs publient sur Strava me rend moins satisfait(e) de mes propres performances. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [e]
51. Les commentaires et les kudos que je reçois à propos des mes activités sur Strava influence mon humeur.*Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [e]
52. Le plus important pour vous lors de la publication d'une activité est : *Le temps total écoulé / La durée totale de déplacement*

##### Perceived Stress Scale
53. Au cours du dernier mois, à quelle fréquence avez-vous été perturbé(e) par des réactions inattendues à vos publications sur Strava ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 
54. Au cours du dernier mois, à quelle fréquence avez-vous eu l’impression d’être obligé(e) de publier vos activités sur Strava ?*Jamais /	Parfois	/ Souvent /	Toujours* [f] 
55. Au cours du dernier mois, à quelle fréquence vous êtes-vous senti(e) nerveus(e) ou stressé(e) à l’idée de publier vos activités sur Strava ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 
56. Au cours du dernier mois, à quelle fréquence vous êtes-vous senti(e) confiant(e) par rapport à ce que vous publiez sur Strava ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 
57. Au cours du dernier mois, à quelle fréquence avez-vous eu l'impression que vos activités sur Strava vous mettaient en valeur ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 
58. Au cours du dernier mois, à quelle fréquence avez-vous constaté que vous n’étiez pas assez actif(ve) sur Strava (pas assez de publications d’activités) ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 
59. Au cours du dernier mois, à quelle fréquence avez-vous eu l'impression de contrôler la manière dont vous présentez vos activités sur Strava ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 
60. Au cours du dernier mois, à quelle fréquence avez-vous été irrité(e) à cause de la performance des autres sur Strava ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 
61. Au cours du dernier mois, à quelle fréquence vous-êtes-vous senti(e) dépassé(e) par la pression d’atteindre vos objectifs sur Strava ? *Jamais /	Parfois	/ Souvent /	Toujours* [f] 

##### Mesure de la motivation à courir :  Behavioral Regulation in Exercise 3 (BREQ3) Questionnaire
62. Je trouve que courir est une activité agréable. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
63. Je cours parce que c’est amusant. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
64. Je cours parce que c’est une part fondamentale de qui je suis. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
65. Je cours parce que c’est en accord avec mes objectifs de vie. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
66. Il est important pour moi de courir. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
67. J'apprécie les bénéfices de la course à pied. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
68. Je me sens honteux(se) si je manque un entraînement de course à pied. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
69. Je me sens en échec si je n’ai pas couru. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
70. Je ressens de la pression de mes amis pour courir. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
71. Je cours parce que les autres disent qu’il faut que je le fasse. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
72. Je ne vois pas pourquoi je devrais courir. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f]
73. Je pense que courir est une perte de temps. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord* [f] 

##### Questions annexes
74. Strava influence mon expérience en tant que coureur(se). *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
75. Je me sens plus motivé(e) depuis que j'ai Strava. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
76. Je me sens plus stressé(e) depuis que j'ai Strava. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
77. Utiliser Strava me pousse à ignorer des signaux de fatigue ou blessure. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
78. Depuis que j'utilise Strava, j'ai amélioré mes performances. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
79. Depuis que j'utilise Strava, je cours plus souvent. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
80. Depuis que j'utilise Strava, je cours plus de kilomètres par semaine. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
81. Je participe à plus de compétitions depuis que j’ai Strava. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
82. Si je n’ai pas prévu de faire un entraînement, le fait de regarder Strava peut me faire changer d’avis. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
83. J'ai déjà modifié un entraînement prévu par mon entraîneur ou mon plan d'entraînement à cause de Strava. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*
84. J'ai déjà modifié mon programme d'entraînement à cause de Strava. *Pas du tout d'accord /	Plutôt pas d'accord	/ Plutôt d'accord /	Totalement d'accord*



[a] : traduction et adaptation du questionnaire "Facebook Intensity Scale" utilisé dans l'étude d'Ellison^8^ et de Ross^9^
[b] : traduction et adaptation du questionne "Online Sociability Functions" utilisé dans l'étude de Ross^9^
[c] : extrait, traduction et adaptation du questionnaire "Facebook questionnaire" utilisé dans l'étude de Ross^9^
[d] : traduction et adaptattion du questionnaire "Self-Presentation and Upward Social Comparison Inclination Scale " dans l'étude de Hjetland^10^
[e] : traduction et adapatation du questionnaire "Perceived Stress Scale" dans l'étude de Sischka ^11^
[f] : traduction et adaptation du questionnaire "12 items BREQ 3" dans l'étude de Rocchi ^12^